[{
  "history_id" : "0c4d8eisk1c",
  "history_input" : "No code saved",
  "history_output" : "Skipped",
  "history_begin_time" : 1712452760498,
  "history_end_time" : 1712452760498,
  "history_notes" : null,
  "history_process" : "1jepv8",
  "host_id" : "100001",
  "indicator" : "Skipped"
},{
  "history_id" : "k6u7k4xl1dl",
  "history_input" : "No code saved",
  "history_output" : "Skipped",
  "history_begin_time" : 1712452760498,
  "history_end_time" : 1712452760498,
  "history_notes" : null,
  "history_process" : "w4lpt8",
  "host_id" : "100001",
  "indicator" : "Skipped"
},{
  "history_id" : "0m0hfuf7ips",
  "history_input" : "No code saved",
  "history_output" : "Skipped",
  "history_begin_time" : 1712452760499,
  "history_end_time" : 1712452760499,
  "history_notes" : null,
  "history_process" : "521ngk",
  "host_id" : "100001",
  "indicator" : "Skipped"
},{
  "history_id" : "glxqdsm30v3",
  "history_input" : "No code saved",
  "history_output" : "Skipped",
  "history_begin_time" : 1712452760499,
  "history_end_time" : 1712452760499,
  "history_notes" : null,
  "history_process" : "x8kqk7",
  "host_id" : "100001",
  "indicator" : "Skipped"
},{
  "history_id" : "f9pxx2kbgrk",
  "history_input" : "No code saved",
  "history_output" : "Skipped",
  "history_begin_time" : 1712452760499,
  "history_end_time" : 1712452760499,
  "history_notes" : null,
  "history_process" : "wjq4fr",
  "host_id" : "100001",
  "indicator" : "Skipped"
},{
  "history_id" : "19vuw9ewx0f",
  "history_input" : "No code saved",
  "history_output" : "Skipped",
  "history_begin_time" : 1712452760500,
  "history_end_time" : 1712452760500,
  "history_notes" : null,
  "history_process" : "l4eb73",
  "host_id" : "100001",
  "indicator" : "Skipped"
},{
  "history_id" : "5nnmhjzlbwf",
  "history_input" : "No code saved",
  "history_output" : "Skipped",
  "history_begin_time" : 1712452760500,
  "history_end_time" : 1712452760500,
  "history_notes" : null,
  "history_process" : "pv7d8l",
  "host_id" : "100001",
  "indicator" : "Skipped"
},{
  "history_id" : "0391izr078t",
  "history_input" : "No code saved",
  "history_output" : "Skipped",
  "history_begin_time" : 1712452760501,
  "history_end_time" : 1712452760501,
  "history_notes" : null,
  "history_process" : "xku47i",
  "host_id" : "100001",
  "indicator" : "Skipped"
},{
  "history_id" : "wg0bwqdwjvk",
  "history_input" : "import os\nimport pickle\nimport matplotlib.pyplot as plt\nfrom fc_model_creation import model_path\n\n# get one prediction and reverse inference the model and get explanation for that prediction\n\n# Explanable AI - SHAP\n\n# target_predict_file = \"/groups/ESS3/zsun/firecasting/data/output/output_xgboost_2020_two_months/20210714/firedata_20210714_predicted.txt\"\n\n#model_path=\"/groups/ESS3/zsun/firecasting/model/fc_xgb_model_v1_weighted_5_days_2020_maxdepth_8_linear_weights_100_slurm_test.pkl\"\n\n# # Load the saved model\n# with open(model_path, 'rb') as model_file:\n#   loaded_model = pickle.load(model_file)\n\n# df = pd.read_csv(target_predict_file)\n  \n# X, y = prepare_testing_data_for_2_weeks_forecasting(single_day_current_date_str, date_str, specific_date_result_folder)\n\n# # Make predictions\n# y_pred = loaded_model.predict(X)\n\n# calculate feature importance - indirect evaluation\n\n\n    \ndef plot_feature_importance():\n  \n    # Load the saved model\n    with open(model_path, 'rb') as model_file:\n      loaded_model = pickle.load(model_file)\n    \n    feature_importances = loaded_model.feature_importances_\n    \n    feature_names = [\n#       'LAT', ' LON', \n      ' FWI', ' VPD', ' HT', ' T', ' RH', ' U', ' V', ' P',\n ' RAIN', ' CAPE', ' ST', ' SM', ' FRP_1_days_ago', ' FRP_2_days_ago',\n ' FRP_3_days_ago', ' FRP_4_days_ago', ' FRP_5_days_ago',\n ' FRP_6_days_ago', ' FRP_7_days_ago', 'Nearest_1', 'Nearest_2',\n 'Nearest_3', 'Nearest_4', 'Nearest_5', 'Nearest_6', 'Nearest_7',\n 'Nearest_8', 'Nearest_9', 'Nearest_10', 'Nearest_11', 'Nearest_12',\n 'Nearest_13', 'Nearest_14', 'Nearest_15', 'Nearest_16', 'Nearest_17',\n 'Nearest_18', 'Nearest_19', 'Nearest_20', 'Nearest_21', 'Nearest_22',\n 'Nearest_23', 'Nearest_24']\n\n    # Create a bar plot of feature importances\n    plt.figure(figsize=(12, 6))\n    print(feature_names)\n    print(feature_importances)\n    plt.barh(feature_names, feature_importances)\n    plt.xlabel('Feature Importance')\n    plt.ylabel('Features')\n    plt.title('Feature Importance Plot')\n    file_name = os.path.basename(model_path)\n    plt.savefig(f'/groups/ESS3/zsun/firecasting/data/output/importance_summary_plot_{file_name}.png')\n    \n    \nif __name__ == \"__main__\":\n    plot_feature_importance()\n\n# explain why it makes that decision (look into the model itself) - direct evaluation\n\n\n# local explanation \n\n\n# global explanation\n\n\n\n",
  "history_output" : "[' FWI', ' VPD', ' HT', ' T', ' RH', ' U', ' V', ' P', ' RAIN', ' CAPE', ' ST', ' SM', ' FRP_1_days_ago', ' FRP_2_days_ago', ' FRP_3_days_ago', ' FRP_4_days_ago', ' FRP_5_days_ago', ' FRP_6_days_ago', ' FRP_7_days_ago', 'Nearest_1', 'Nearest_2', 'Nearest_3', 'Nearest_4', 'Nearest_5', 'Nearest_6', 'Nearest_7', 'Nearest_8', 'Nearest_9', 'Nearest_10', 'Nearest_11', 'Nearest_12', 'Nearest_13', 'Nearest_14', 'Nearest_15', 'Nearest_16', 'Nearest_17', 'Nearest_18', 'Nearest_19', 'Nearest_20', 'Nearest_21', 'Nearest_22', 'Nearest_23', 'Nearest_24']\n[0.01437724 0.02104696 0.02533676 0.03626653 0.03506615 0.03048977\n 0.02074175 0.02723226 0.00543232 0.02470401 0.04609315 0.02877827\n 0.04732126 0.01565095 0.0090276  0.00637199 0.0040631  0.00515436\n 0.00967002 0.0249844  0.01609165 0.01559902 0.00939693 0.03306102\n 0.02403658 0.02012634 0.01406942 0.01734121 0.02028953 0.03030797\n 0.03622767 0.01820673 0.01501514 0.01400734 0.0713059  0.06184476\n 0.00937655 0.03352852 0.00903145 0.01003745 0.01182142 0.01842807\n 0.05304047]\n",
  "history_begin_time" : 1712454431269,
  "history_end_time" : 1712454437589,
  "history_notes" : null,
  "history_process" : "dp0hiw",
  "host_id" : "100001",
  "indicator" : "Done"
},{
  "history_id" : "xz3ab5gwm0s",
  "history_input" : "#!/bin/bash\n\n# move the generated PNG images and metrics to the public website folders\necho \"Copying FRP predicted png files to public server..\"\n#scp -i /home/zsun/.ssh/id_geobrain_no.pem /groups/ESS3/zsun/cmaq/ai_results/evaluation/* zsun@129.174.131.229:/var/www/html/cmaq_site/evaluation/\nrsync -u -e \"ssh -i /home/zsun/.ssh/geobrain_upload_fire.pem\" -avz /groups/ESS3/zsun/firecasting/data/output/output_xgboost_window_7_days_forecasting/20210714/* chetana@129.174.131.229:/var/www/html/wildfire_site/data/\n\nrsync -u -e \"ssh -i /home/zsun/.ssh/geobrain_upload_fire.pem\" -avz  /groups/ESS3/zsun/firecasting/data/output/importance_summary_plot_* chetana@129.174.131.229:/var/www/html/wildfire_site/model/\n\n",
  "history_output" : "Copying FRP predicted png files to public server..\nWarning: Permanently added '129.174.131.229' (ECDSA) to the list of known hosts.\nsending incremental file list\ndate_list.csv\nfiredata_20210714_predicted.txt\nfiredata_20210714_predicted.txt.png\nfiredata_20210714_predicted.txt_output.tif\nfiredata_20210714_predicted.txt_output.tif.map\nfiredata_20210715_predicted.txt\nfiredata_20210715_predicted.txt.png\nfiredata_20210715_predicted.txt_output.tif\nfiredata_20210715_predicted.txt_output.tif.map\nfiredata_20210716_predicted.txt\nfiredata_20210716_predicted.txt.png\nfiredata_20210716_predicted.txt_output.tif\nfiredata_20210716_predicted.txt_output.tif.map\nfiredata_20210717_predicted.txt\nfiredata_20210717_predicted.txt.png\nfiredata_20210717_predicted.txt_output.tif\nfiredata_20210717_predicted.txt_output.tif.map\nfiredata_20210718_predicted.txt\nfiredata_20210718_predicted.txt.png\nfiredata_20210718_predicted.txt_output.tif\nfiredata_20210718_predicted.txt_output.tif.map\nfiredata_20210719_predicted.txt\nfiredata_20210719_predicted.txt.png\nfiredata_20210719_predicted.txt_output.tif\nfiredata_20210719_predicted.txt_output.tif.map\nfiredata_20210720_predicted.txt\nfiredata_20210720_predicted.txt.png\nfiredata_20210720_predicted.txt_output.tif\nfiredata_20210720_predicted.txt_output.tif.map\nmetrics_20210714_predicted.txt\nmetrics_20210715_predicted.txt\nmetrics_20210716_predicted.txt\nmetrics_20210717_predicted.txt\nmetrics_20210718_predicted.txt\nmetrics_20210719_predicted.txt\nmetrics_20210720_predicted.txt\nsent 37,083,116 bytes  received 723,704 bytes  2,800,505.19 bytes/sec\ntotal size is 720,279,303  speedup is 19.05\nWarning: Permanently added '129.174.131.229' (ECDSA) to the list of known hosts.\nsending incremental file list\nimportance_summary_plot_fc_xgb_model_v1_latest.pkl.png\nsent 332 bytes  received 629 bytes  640.67 bytes/sec\ntotal size is 237,269  speedup is 246.90\n",
  "history_begin_time" : 1712454831117,
  "history_end_time" : 1712454849966,
  "history_notes" : null,
  "history_process" : "b3cx6j",
  "host_id" : "100001",
  "indicator" : "Done"
},{
  "history_id" : "wp4a6r2lzse",
  "history_input" : "No code saved",
  "history_output" : "Skipped",
  "history_begin_time" : 1712452760504,
  "history_end_time" : 1712452760504,
  "history_notes" : null,
  "history_process" : "k84mqm",
  "host_id" : "100001",
  "indicator" : "Skipped"
},{
  "history_id" : "9kl9o46se4k",
  "history_input" : "#!/bin/bash\n\necho \"start to run fc_model_predict_2weeks.sh\"\npwd\n\n# Specify the name of the script you want to submit\nSCRIPT_NAME=\"fc_model_predict_2weeks_slurm_generated.sh\"\necho \"write the slurm script into ${SCRIPT_NAME}\"\ncat > ${SCRIPT_NAME} << EOF\n#!/bin/bash\n#SBATCH -J fc_model_predict_2weeks       # Job name\n#SBATCH --output=/scratch/%u/%x-%N-%j.out  # Output file`\n#SBATCH --error=/scratch/%u/%x-%N-%j.err   # Error file`\n#SBATCH -n 1               # Number of tasks\n#SBATCH -c 12               # Number of CPUs per task (threads)\n#SBATCH --mem=50G          # Memory per node (use units like G for gigabytes) - this job must need 200GB lol\n#SBATCH -t 0-10:00         # Runtime in D-HH:MM format\n## Slurm can send you updates via email\n#SBATCH --mail-type=FAIL  # BEGIN,END,FAIL         # ALL,NONE,BEGIN,END,FAIL,REQUEUE,..\n#SBATCH --mail-user=zsun@gmu.edu     # Put your GMU email address here\n\n# Activate your customized virtual environment\nsource /home/zsun/anaconda3/bin/activate\n\n# Call the Python script using process substitution\npython -u << INNER_EOF\n\nfrom fc_model_predict_2weeks import predict_2weeks\n\nstart_date = \"20210714\"\nend_date = \"20210714\"\n\npredict_2weeks(start_date, end_date)\n\n\nINNER_EOF\n\nEOF\n\n# Submit the Slurm job and wait for it to finish\necho \"sbatch ${SCRIPT_NAME}\"\n# should have another check. if there is another job running, should cancel it before submitting a new job.\n\n# Find and cancel existing running jobs with the same script name\n#existing_jobs=$(squeue -h -o \"%A %j\" -u $(whoami) | awk -v script=\"$SCRIPT_NAME\" '$2 == script {print $1}')\n\n# if [ -n \"$existing_jobs\" ]; then\n#     echo \"Canceling existing jobs with the script name '$SCRIPT_NAME'...\"\n#     for job_id in $existing_jobs; do\n#         scancel $job_id\n#     done\n# else\n#     echo \"No existing jobs with the script name '$SCRIPT_NAME' found.\"\n# fi\n\n# Submit the Slurm job\njob_id=$(sbatch ${SCRIPT_NAME} | awk '{print $4}')\necho \"job_id=\"${job_id}\n\nif [ -z \"${job_id}\" ]; then\n    echo \"job id is empty. something wrong with the slurm job submission.\"\n    exit 1\nfi\n\n# Wait for the Slurm job to finish\nfile_name=$(find /scratch/zsun -name '*'${job_id}'.out' -print -quit)\nprevious_content=$(cat file_name)\nexit_code=0\nwhile true; do\n    # Capture the current content\\\n    #echo ${job_id}\n    file_name=$(find /scratch/zsun -name '*'${job_id}'.out' -print -quit)\n    #echo \"file_name=\"$file_name\n    current_content=$(<\"${file_name}\")\n    #echo \"current_content = \"$current_content\n\n    # Compare current content with previous content\n    diff_result=$(diff <(echo \"$previous_content\") <(echo \"$current_content\"))\n    # Check if there is new content\n    if [ -n \"$diff_result\" ]; then\n        # Print the newly added content\n        #echo \"New content added:\"\n        echo \"$diff_result\"\n        #echo \"---------------------\"\n    fi\n    # Update previous content\n    previous_content=\"$current_content\"\n\n\n    job_status=$(scontrol show job ${job_id} | awk '/JobState=/{print $1}')\n    #echo \"job_status \"$job_status\n    #if [[ $job_status == \"JobState=COMPLETED\" ]]; then\n    #    break\n    #fi\n    if [[ $job_status == *\"COMPLETED\"* ]]; then\n        echo \"Job $job_id has finished with state: $job_status\"\n        break;\n    elif [[ $job_status == *\"CANCELLED\"* || $job_status == *\"FAILED\"* || $job_status == *\"TIMEOUT\"* || $job_status == *\"NODE_FAIL\"* || $job_status == *\"PREEMPTED\"* || $job_status == *\"OUT_OF_MEMORY\"* ]]; then\n        echo \"Job $job_id has finished with state: $job_status\"\n        exit_code=1\n        break;\n    fi\n    sleep 10  # Adjust the sleep interval as needed\ndone\n\necho \"Slurm job ($job_id) has finished.\"\n\necho \"Print the job's output logs\"\nsacct --format=JobID,JobName,State,ExitCode,MaxRSS,Start,End -j $job_id\n# find /scratch/zsun/ -type f -name \"*${job_id}.out\" -exec cat {} \\;\n\n#cat /scratch/zsun/test_data_slurm-*-$job_id.out\n\necho \"All slurm job for ${SCRIPT_NAME} finishes.\"\n\nexit $exit_code\n",
  "history_output" : "start to run fc_model_predict_2weeks.sh\n/home/zsun/gw-workspace/9kl9o46se4k\nwrite the slurm script into fc_model_predict_2weeks_slurm_generated.sh\nsbatch fc_model_predict_2weeks_slurm_generated.sh\njob_id=1738362\ncat: file_name: No such file or directory\n/home/zsun/gw-workspace/9kl9o46se4k/gw-0f2mRA1JQ3xNSxM8pmaylrrGH7-9kl9o46se4k.sh: line 74: : No such file or directory\n/home/zsun/gw-workspace/9kl9o46se4k/gw-0f2mRA1JQ3xNSxM8pmaylrrGH7-9kl9o46se4k.sh: line 74: : No such file or directory\n/home/zsun/gw-workspace/9kl9o46se4k/gw-0f2mRA1JQ3xNSxM8pmaylrrGH7-9kl9o46se4k.sh: line 74: : No such file or directory\n/home/zsun/gw-workspace/9kl9o46se4k/gw-0f2mRA1JQ3xNSxM8pmaylrrGH7-9kl9o46se4k.sh: line 74: : No such file or directory\n1c1,11\n< \n---\n> /home/zsun/anaconda3/lib/python3.8/site-packages/dask/dataframe/utils.py:367: FutureWarning: pandas.Int64Index is deprecated and will be removed from pandas in a future version. Use pandas.Index with the appropriate dtype instead.\n>   _numeric_index_types = (pd.Int64Index, pd.Float64Index, pd.UInt64Index)\n> /home/zsun/anaconda3/lib/python3.8/site-packages/dask/dataframe/utils.py:367: FutureWarning: pandas.Float64Index is deprecated and will be removed from pandas in a future version. Use pandas.Index with the appropriate dtype instead.\n>   _numeric_index_types = (pd.Int64Index, pd.Float64Index, pd.UInt64Index)\n> /home/zsun/anaconda3/lib/python3.8/site-packages/dask/dataframe/utils.py:367: FutureWarning: pandas.UInt64Index is deprecated and will be removed from pandas in a future version. Use pandas.Index with the appropriate dtype instead.\n>   _numeric_index_types = (pd.Int64Index, pd.Float64Index, pd.UInt64Index)\n> the model in use is /groups/ESS3/zsun/firecasting/model/fc_xgb_model_v1_latest.pkl\n> current date:  2021-07-14 00:00:00\n> single_day_current_date =  2021-07-14 00:00:00\n> single_day_predict_end_date =  2021-07-21 00:00:00\n> predicting:  20210714\n11a12,50\n> Read from original folder for current date: 20210714\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata/firedata_20210714.txt\n> reading past files for 2021-07-13 00:00:00\n> reading from original folder\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata/firedata_20210713.txt\n> reading past files for 2021-07-12 00:00:00\n> reading from original folder\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata/firedata_20210712.txt\n> reading past files for 2021-07-11 00:00:00\n> reading from original folder\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata/firedata_20210711.txt\n> reading past files for 2021-07-10 00:00:00\n> reading from original folder\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata/firedata_20210710.txt\n> reading past files for 2021-07-09 00:00:00\n> reading from original folder\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata/firedata_20210709.txt\n> reading past files for 2021-07-08 00:00:00\n> reading from original folder\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata/firedata_20210708.txt\n> reading past files for 2021-07-07 00:00:00\n> reading from original folder\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata/firedata_20210707.txt\n> original_df.describe                  LAT            LON  ...   FRP_6_days_ago   FRP_7_days_ago\n> count  156861.000000  156861.000000  ...    156861.000000    156861.000000\n> mean       37.500002     -95.999998  ...         0.163110         0.227513\n> std         7.534390      17.349407  ...        18.545293        34.938262\n> min        24.500000    -126.000000  ...         0.000000         0.000000\n> 25%        31.000000    -111.000000  ...         0.000000         0.000000\n> 50%        37.500000     -96.000000  ...         0.000000         0.000000\n> 75%        44.000000     -81.000000  ...         0.000000         0.000000\n> max        50.500000     -66.000000  ...      5464.172363     11733.906250\n> \n> [8 rows x 22 columns]\n> original_df columns:  Index(['LAT', ' LON', ' FRP', ' FWI', ' VPD', ' HT', ' T', ' RH', ' U', ' V',\n>        ' P', ' RAIN', ' CAPE', ' ST', ' SM', ' FRP_1_days_ago',\n>        ' FRP_2_days_ago', ' FRP_3_days_ago', ' FRP_4_days_ago',\n>        ' FRP_5_days_ago', ' FRP_6_days_ago', ' FRP_7_days_ago'],\n>       dtype='object')\n50a51,85\n> new_df.shape =  (156861, 24)\n> df.shape =  (156861, 22)\n> New time series dataframe:      LAT         LON   FRP  ...  Nearest_22  Nearest_23  Nearest_24\n> 0  24.5 -126.000000   0.0  ...         0.0         0.0         0.0\n> 1  24.5 -125.899994   0.0  ...         0.0         0.0         0.0\n> 2  24.5 -125.800003   0.0  ...         0.0         0.0         0.0\n> 3  24.5 -125.699997   0.0  ...         0.0         0.0         0.0\n> 4  24.5 -125.599998   0.0  ...         0.0         0.0         0.0\n> \n> [5 rows x 46 columns]\n> Original df is created:  (156861, 46)\n> Original df filled the na with -9999 \n> X and y are loaded into memory for 20210714\n> the loaded model is:  XGBRegressor(base_score=0.5, booster='gbtree', callbacks=None,\n>              colsample_bylevel=1, colsample_bynode=1, colsample_bytree=1,\n>              early_stopping_rounds=None, enable_categorical=False,\n>              eval_metric=None, gamma=0, gpu_id=-1, grow_policy='depthwise',\n>              importance_type=None, interaction_constraints='',\n>              learning_rate=0.1, max_bin=256, max_cat_to_onehot=4,\n>              max_delta_step=0, max_depth=8, max_leaves=0, min_child_weight=1,\n>              missing=nan, monotone_constraints='()', n_estimators=100, n_jobs=0,\n>              num_parallel_tree=1, predictor='auto', random_state=0, reg_alpha=0,\n>              reg_lambda=1, ...)\n> Prediction for 20210714 of start day 20210714 is finished\n> new columns to check:  [' FRP_1_days_ago', 'Nearest_1', 'Nearest_2', 'Nearest_3', 'Nearest_4', 'Nearest_5', 'Nearest_6', 'Nearest_7', 'Nearest_8']\n> current merged_df columns:  Index([' FWI', ' VPD', ' HT', ' T', ' RH', ' U', ' V', ' P', ' RAIN', ' CAPE',\n>        ' ST', ' SM', ' FRP_1_days_ago', ' FRP_2_days_ago', ' FRP_3_days_ago',\n>        ' FRP_4_days_ago', ' FRP_5_days_ago', ' FRP_6_days_ago',\n>        ' FRP_7_days_ago', 'Nearest_1', 'Nearest_2', 'Nearest_3', 'Nearest_4',\n>        'Nearest_5', 'Nearest_6', 'Nearest_7', 'Nearest_8', 'Nearest_9',\n>        'Nearest_10', 'Nearest_11', 'Nearest_12', 'Nearest_13', 'Nearest_14',\n>        'Nearest_15', 'Nearest_16', 'Nearest_17', 'Nearest_18', 'Nearest_19',\n>        'Nearest_20', 'Nearest_21', 'Nearest_22', 'Nearest_23', 'Nearest_24',\n>        'Predicted_FRP'],\n>       dtype='object')\n85a86,137\n> Prediction results are saved to /groups/ESS3/zsun/firecasting/data/output/output_xgboost_window_7_days_forecasting//20210714/firedata_20210714_predicted.txt\n> ['Mean Absolute Error (MAE): 1.3661271128390966', 'Mean Squared Error (MSE): 1206.072221240035', 'Root Mean Squared Error (RMSE): 34.72855052028569', 'R-squared (R2) Score: -0.6941427231085702', 'Explained Variance Score: -0.6931500610793142', 'Median Absolute Error (MedAE): 0.0', 'Max Error: 5539.898010441406', 'Mean: 0.31889202218524665', 'Median: 0.0', 'Standard Deviation: 26.681672203030356', 'Minimum: 0.0', 'Maximum: 5842.833008', 'Count: 156861']\n> Metrics saved to /groups/ESS3/zsun/firecasting/data/output/output_xgboost_window_7_days_forecasting//20210714/metrics_20210714_predicted.txt\n> predicting:  20210715\n> Read from original folder for current date: 20210715\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata/firedata_20210715.txt\n> reading past files for 2021-07-14 00:00:00\n> reading from predicted folder\n> current final_df head:       FWI    VPD   HT  ...  Nearest_23  Nearest_24  Predicted_FRP\n> 0 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> 1 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> 2 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> 3 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> 4 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> \n> [5 rows x 44 columns]\n> renaming Predicted_FRP to FRP\n> remove the current predicted_frp\n> reading past files for 2021-07-13 00:00:00\n> reading from original folder\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata/firedata_20210713.txt\n> reading past files for 2021-07-12 00:00:00\n> reading from original folder\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata/firedata_20210712.txt\n> reading past files for 2021-07-11 00:00:00\n> reading from original folder\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata/firedata_20210711.txt\n> reading past files for 2021-07-10 00:00:00\n> reading from original folder\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata/firedata_20210710.txt\n> reading past files for 2021-07-09 00:00:00\n> reading from original folder\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata/firedata_20210709.txt\n> reading past files for 2021-07-08 00:00:00\n> reading from original folder\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata/firedata_20210708.txt\n> original_df.describe                  LAT            LON  ...   FRP_6_days_ago   FRP_7_days_ago\n> count  156861.000000  156861.000000  ...    156861.000000    156861.000000\n> mean       37.500002     -95.999998  ...         0.580826         0.163110\n> std         7.534390      17.349407  ...        74.094883        18.545293\n> min        24.500000    -126.000000  ...         0.000000         0.000000\n> 25%        31.000000    -111.000000  ...         0.000000         0.000000\n> 50%        37.500000     -96.000000  ...         0.000000         0.000000\n> 75%        44.000000     -81.000000  ...         0.000000         0.000000\n> max        50.500000     -66.000000  ...     19605.007812      5464.172363\n> \n> [8 rows x 22 columns]\n> original_df columns:  Index(['LAT', ' LON', ' FRP', ' FWI', ' VPD', ' HT', ' T', ' RH', ' U', ' V',\n>        ' P', ' RAIN', ' CAPE', ' ST', ' SM', ' FRP_1_days_ago',\n>        ' FRP_2_days_ago', ' FRP_3_days_ago', ' FRP_4_days_ago',\n>        ' FRP_5_days_ago', ' FRP_6_days_ago', ' FRP_7_days_ago'],\n>       dtype='object')\n137a138,172\n> new_df.shape =  (156861, 24)\n> df.shape =  (156861, 22)\n> New time series dataframe:      LAT         LON    FRP  ...  Nearest_22  Nearest_23  Nearest_24\n> 0  24.5 -126.000000 -999.0  ...         0.0         0.0         0.0\n> 1  24.5 -125.899994 -999.0  ...         0.0         0.0         0.0\n> 2  24.5 -125.800003 -999.0  ...         0.0         0.0         0.0\n> 3  24.5 -125.699997 -999.0  ...         0.0         0.0         0.0\n> 4  24.5 -125.599998 -999.0  ...         0.0         0.0         0.0\n> \n> [5 rows x 46 columns]\n> Original df is created:  (156861, 46)\n> Original df filled the na with -9999 \n> X and y are loaded into memory for 20210715\n> the loaded model is:  XGBRegressor(base_score=0.5, booster='gbtree', callbacks=None,\n>              colsample_bylevel=1, colsample_bynode=1, colsample_bytree=1,\n>              early_stopping_rounds=None, enable_categorical=False,\n>              eval_metric=None, gamma=0, gpu_id=-1, grow_policy='depthwise',\n>              importance_type=None, interaction_constraints='',\n>              learning_rate=0.1, max_bin=256, max_cat_to_onehot=4,\n>              max_delta_step=0, max_depth=8, max_leaves=0, min_child_weight=1,\n>              missing=nan, monotone_constraints='()', n_estimators=100, n_jobs=0,\n>              num_parallel_tree=1, predictor='auto', random_state=0, reg_alpha=0,\n>              reg_lambda=1, ...)\n> Prediction for 20210715 of start day 20210714 is finished\n> new columns to check:  [' FRP_1_days_ago', 'Nearest_1', 'Nearest_2', 'Nearest_3', 'Nearest_4', 'Nearest_5', 'Nearest_6', 'Nearest_7', 'Nearest_8']\n> current merged_df columns:  Index([' FWI', ' VPD', ' HT', ' T', ' RH', ' U', ' V', ' P', ' RAIN', ' CAPE',\n>        ' ST', ' SM', ' FRP_1_days_ago', ' FRP_2_days_ago', ' FRP_3_days_ago',\n>        ' FRP_4_days_ago', ' FRP_5_days_ago', ' FRP_6_days_ago',\n>        ' FRP_7_days_ago', 'Nearest_1', 'Nearest_2', 'Nearest_3', 'Nearest_4',\n>        'Nearest_5', 'Nearest_6', 'Nearest_7', 'Nearest_8', 'Nearest_9',\n>        'Nearest_10', 'Nearest_11', 'Nearest_12', 'Nearest_13', 'Nearest_14',\n>        'Nearest_15', 'Nearest_16', 'Nearest_17', 'Nearest_18', 'Nearest_19',\n>        'Nearest_20', 'Nearest_21', 'Nearest_22', 'Nearest_23', 'Nearest_24',\n>        'Predicted_FRP'],\n>       dtype='object')\n172a173,233\n> Prediction results are saved to /groups/ESS3/zsun/firecasting/data/output/output_xgboost_window_7_days_forecasting//20210714/firedata_20210715_predicted.txt\n> ['Mean Absolute Error (MAE): 1000.951050941806', 'Mean Squared Error (MSE): 1002606.3991313314', 'Root Mean Squared Error (RMSE): 1001.3023515059432', 'R-squared (R2) Score: 0.0', 'Explained Variance Score: 0.0', 'Median Absolute Error (MedAE): 999.0', 'Max Error: 2554.1917724609375', 'Mean: -999.0', 'Median: -999.0', 'Standard Deviation: 0.0', 'Minimum: -999.0', 'Maximum: -999.0', 'Count: 156861']\n> Metrics saved to /groups/ESS3/zsun/firecasting/data/output/output_xgboost_window_7_days_forecasting//20210714/metrics_20210715_predicted.txt\n> predicting:  20210716\n> Read from original folder for current date: 20210716\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata/firedata_20210716.txt\n> reading past files for 2021-07-15 00:00:00\n> reading from predicted folder\n> current final_df head:       FWI    VPD   HT  ...  Nearest_23  Nearest_24  Predicted_FRP\n> 0 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> 1 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> 2 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> 3 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> 4 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> \n> [5 rows x 44 columns]\n> renaming Predicted_FRP to FRP\n> remove the current predicted_frp\n> reading past files for 2021-07-14 00:00:00\n> reading from predicted folder\n> current final_df head:       FWI    VPD   HT  ...  Nearest_23  Nearest_24  Predicted_FRP\n> 0 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> 1 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> 2 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> 3 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> 4 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> \n> [5 rows x 44 columns]\n> renaming Predicted_FRP to FRP\n> remove the current predicted_frp\n> reading past files for 2021-07-13 00:00:00\n> reading from original folder\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata/firedata_20210713.txt\n> reading past files for 2021-07-12 00:00:00\n> reading from original folder\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata/firedata_20210712.txt\n> reading past files for 2021-07-11 00:00:00\n> reading from original folder\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata/firedata_20210711.txt\n> reading past files for 2021-07-10 00:00:00\n> reading from original folder\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata/firedata_20210710.txt\n> reading past files for 2021-07-09 00:00:00\n> reading from original folder\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata/firedata_20210709.txt\n> original_df.describe                  LAT            LON  ...   FRP_6_days_ago   FRP_7_days_ago\n> count  156861.000000  156861.000000  ...    156861.000000    156861.000000\n> mean       37.500002     -95.999998  ...         0.678789         0.580826\n> std         7.534390      17.349407  ...        85.790401        74.094883\n> min        24.500000    -126.000000  ...         0.000000         0.000000\n> 25%        31.000000    -111.000000  ...         0.000000         0.000000\n> 50%        37.500000     -96.000000  ...         0.000000         0.000000\n> 75%        44.000000     -81.000000  ...         0.000000         0.000000\n> max        50.500000     -66.000000  ...     23213.011719     19605.007812\n> \n> [8 rows x 22 columns]\n> original_df columns:  Index(['LAT', ' LON', ' FRP', ' FWI', ' VPD', ' HT', ' T', ' RH', ' U', ' V',\n>        ' P', ' RAIN', ' CAPE', ' ST', ' SM', ' FRP_1_days_ago',\n>        ' FRP_2_days_ago', ' FRP_3_days_ago', ' FRP_4_days_ago',\n>        ' FRP_5_days_ago', ' FRP_6_days_ago', ' FRP_7_days_ago'],\n>       dtype='object')\n233a234,268\n> new_df.shape =  (156861, 24)\n> df.shape =  (156861, 22)\n> New time series dataframe:      LAT         LON    FRP  ...  Nearest_22  Nearest_23  Nearest_24\n> 0  24.5 -126.000000 -999.0  ...         0.0         0.0         0.0\n> 1  24.5 -125.899994 -999.0  ...         0.0         0.0         0.0\n> 2  24.5 -125.800003 -999.0  ...         0.0         0.0         0.0\n> 3  24.5 -125.699997 -999.0  ...         0.0         0.0         0.0\n> 4  24.5 -125.599998 -999.0  ...         0.0         0.0         0.0\n> \n> [5 rows x 46 columns]\n> Original df is created:  (156861, 46)\n> Original df filled the na with -9999 \n> X and y are loaded into memory for 20210716\n> the loaded model is:  XGBRegressor(base_score=0.5, booster='gbtree', callbacks=None,\n>              colsample_bylevel=1, colsample_bynode=1, colsample_bytree=1,\n>              early_stopping_rounds=None, enable_categorical=False,\n>              eval_metric=None, gamma=0, gpu_id=-1, grow_policy='depthwise',\n>              importance_type=None, interaction_constraints='',\n>              learning_rate=0.1, max_bin=256, max_cat_to_onehot=4,\n>              max_delta_step=0, max_depth=8, max_leaves=0, min_child_weight=1,\n>              missing=nan, monotone_constraints='()', n_estimators=100, n_jobs=0,\n>              num_parallel_tree=1, predictor='auto', random_state=0, reg_alpha=0,\n>              reg_lambda=1, ...)\n> Prediction for 20210716 of start day 20210714 is finished\n> new columns to check:  [' FRP_1_days_ago', 'Nearest_1', 'Nearest_2', 'Nearest_3', 'Nearest_4', 'Nearest_5', 'Nearest_6', 'Nearest_7', 'Nearest_8']\n> current merged_df columns:  Index([' FWI', ' VPD', ' HT', ' T', ' RH', ' U', ' V', ' P', ' RAIN', ' CAPE',\n>        ' ST', ' SM', ' FRP_1_days_ago', ' FRP_2_days_ago', ' FRP_3_days_ago',\n>        ' FRP_4_days_ago', ' FRP_5_days_ago', ' FRP_6_days_ago',\n>        ' FRP_7_days_ago', 'Nearest_1', 'Nearest_2', 'Nearest_3', 'Nearest_4',\n>        'Nearest_5', 'Nearest_6', 'Nearest_7', 'Nearest_8', 'Nearest_9',\n>        'Nearest_10', 'Nearest_11', 'Nearest_12', 'Nearest_13', 'Nearest_14',\n>        'Nearest_15', 'Nearest_16', 'Nearest_17', 'Nearest_18', 'Nearest_19',\n>        'Nearest_20', 'Nearest_21', 'Nearest_22', 'Nearest_23', 'Nearest_24',\n>        'Predicted_FRP'],\n>       dtype='object')\n268a269,338\n> Prediction results are saved to /groups/ESS3/zsun/firecasting/data/output/output_xgboost_window_7_days_forecasting//20210714/firedata_20210716_predicted.txt\n> ['Mean Absolute Error (MAE): 1001.7522266847633', 'Mean Squared Error (MSE): 1004436.8833114606', 'Root Mean Squared Error (RMSE): 1002.215986357961', 'R-squared (R2) Score: 0.0', 'Explained Variance Score: 0.0', 'Median Absolute Error (MedAE): 999.0', 'Max Error: 2778.1651611328125', 'Mean: -999.0', 'Median: -999.0', 'Standard Deviation: 0.0', 'Minimum: -999.0', 'Maximum: -999.0', 'Count: 156861']\n> Metrics saved to /groups/ESS3/zsun/firecasting/data/output/output_xgboost_window_7_days_forecasting//20210714/metrics_20210716_predicted.txt\n> predicting:  20210717\n> Read from original folder for current date: 20210717\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata/firedata_20210717.txt\n> reading past files for 2021-07-16 00:00:00\n> reading from predicted folder\n> current final_df head:       FWI    VPD   HT  ...  Nearest_23  Nearest_24  Predicted_FRP\n> 0 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> 1 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> 2 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> 3 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> 4 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> \n> [5 rows x 44 columns]\n> renaming Predicted_FRP to FRP\n> remove the current predicted_frp\n> reading past files for 2021-07-15 00:00:00\n> reading from predicted folder\n> current final_df head:       FWI    VPD   HT  ...  Nearest_23  Nearest_24  Predicted_FRP\n> 0 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> 1 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> 2 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> 3 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> 4 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> \n> [5 rows x 44 columns]\n> renaming Predicted_FRP to FRP\n> remove the current predicted_frp\n> reading past files for 2021-07-14 00:00:00\n> reading from predicted folder\n> current final_df head:       FWI    VPD   HT  ...  Nearest_23  Nearest_24  Predicted_FRP\n> 0 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> 1 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> 2 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> 3 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> 4 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> \n> [5 rows x 44 columns]\n> renaming Predicted_FRP to FRP\n> remove the current predicted_frp\n> reading past files for 2021-07-13 00:00:00\n> reading from original folder\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata/firedata_20210713.txt\n> reading past files for 2021-07-12 00:00:00\n> reading from original folder\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata/firedata_20210712.txt\n> reading past files for 2021-07-11 00:00:00\n> reading from original folder\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata/firedata_20210711.txt\n> reading past files for 2021-07-10 00:00:00\n> reading from original folder\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata/firedata_20210710.txt\n> original_df.describe                  LAT            LON  ...   FRP_6_days_ago   FRP_7_days_ago\n> count  156861.000000  156861.000000  ...    156861.000000    156861.000000\n> mean       37.500002     -95.999998  ...         0.302685         0.678789\n> std         7.534390      17.349407  ...        23.155200        85.790401\n> min        24.500000    -126.000000  ...         0.000000         0.000000\n> 25%        31.000000    -111.000000  ...         0.000000         0.000000\n> 50%        37.500000     -96.000000  ...         0.000000         0.000000\n> 75%        44.000000     -81.000000  ...         0.000000         0.000000\n> max        50.500000     -66.000000  ...      5055.526367     23213.011719\n> \n> [8 rows x 22 columns]\n> original_df columns:  Index(['LAT', ' LON', ' FRP', ' FWI', ' VPD', ' HT', ' T', ' RH', ' U', ' V',\n>        ' P', ' RAIN', ' CAPE', ' ST', ' SM', ' FRP_1_days_ago',\n>        ' FRP_2_days_ago', ' FRP_3_days_ago', ' FRP_4_days_ago',\n>        ' FRP_5_days_ago', ' FRP_6_days_ago', ' FRP_7_days_ago'],\n>       dtype='object')\n338a339,373\n> new_df.shape =  (156861, 24)\n> df.shape =  (156861, 22)\n> New time series dataframe:      LAT         LON    FRP  ...  Nearest_22  Nearest_23  Nearest_24\n> 0  24.5 -126.000000 -999.0  ...         0.0         0.0         0.0\n> 1  24.5 -125.899994 -999.0  ...         0.0         0.0         0.0\n> 2  24.5 -125.800003 -999.0  ...         0.0         0.0         0.0\n> 3  24.5 -125.699997 -999.0  ...         0.0         0.0         0.0\n> 4  24.5 -125.599998 -999.0  ...         0.0         0.0         0.0\n> \n> [5 rows x 46 columns]\n> Original df is created:  (156861, 46)\n> Original df filled the na with -9999 \n> X and y are loaded into memory for 20210717\n> the loaded model is:  XGBRegressor(base_score=0.5, booster='gbtree', callbacks=None,\n>              colsample_bylevel=1, colsample_bynode=1, colsample_bytree=1,\n>              early_stopping_rounds=None, enable_categorical=False,\n>              eval_metric=None, gamma=0, gpu_id=-1, grow_policy='depthwise',\n>              importance_type=None, interaction_constraints='',\n>              learning_rate=0.1, max_bin=256, max_cat_to_onehot=4,\n>              max_delta_step=0, max_depth=8, max_leaves=0, min_child_weight=1,\n>              missing=nan, monotone_constraints='()', n_estimators=100, n_jobs=0,\n>              num_parallel_tree=1, predictor='auto', random_state=0, reg_alpha=0,\n>              reg_lambda=1, ...)\n> Prediction for 20210717 of start day 20210714 is finished\n> new columns to check:  [' FRP_1_days_ago', 'Nearest_1', 'Nearest_2', 'Nearest_3', 'Nearest_4', 'Nearest_5', 'Nearest_6', 'Nearest_7', 'Nearest_8']\n> current merged_df columns:  Index([' FWI', ' VPD', ' HT', ' T', ' RH', ' U', ' V', ' P', ' RAIN', ' CAPE',\n>        ' ST', ' SM', ' FRP_1_days_ago', ' FRP_2_days_ago', ' FRP_3_days_ago',\n>        ' FRP_4_days_ago', ' FRP_5_days_ago', ' FRP_6_days_ago',\n>        ' FRP_7_days_ago', 'Nearest_1', 'Nearest_2', 'Nearest_3', 'Nearest_4',\n>        'Nearest_5', 'Nearest_6', 'Nearest_7', 'Nearest_8', 'Nearest_9',\n>        'Nearest_10', 'Nearest_11', 'Nearest_12', 'Nearest_13', 'Nearest_14',\n>        'Nearest_15', 'Nearest_16', 'Nearest_17', 'Nearest_18', 'Nearest_19',\n>        'Nearest_20', 'Nearest_21', 'Nearest_22', 'Nearest_23', 'Nearest_24',\n>        'Predicted_FRP'],\n>       dtype='object')\n373a374,452\n> Prediction results are saved to /groups/ESS3/zsun/firecasting/data/output/output_xgboost_window_7_days_forecasting//20210714/firedata_20210717_predicted.txt\n> ['Mean Absolute Error (MAE): 1002.1451009549118', 'Mean Squared Error (MSE): 1005174.7933785754', 'Root Mean Squared Error (RMSE): 1002.5840580113846', 'R-squared (R2) Score: 0.0', 'Explained Variance Score: 0.0', 'Median Absolute Error (MedAE): 999.0', 'Max Error: 2752.228515625', 'Mean: -999.0', 'Median: -999.0', 'Standard Deviation: 0.0', 'Minimum: -999.0', 'Maximum: -999.0', 'Count: 156861']\n> Metrics saved to /groups/ESS3/zsun/firecasting/data/output/output_xgboost_window_7_days_forecasting//20210714/metrics_20210717_predicted.txt\n> predicting:  20210718\n> Read from original folder for current date: 20210718\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata/firedata_20210718.txt\n> reading past files for 2021-07-17 00:00:00\n> reading from predicted folder\n> current final_df head:       FWI    VPD   HT  ...  Nearest_23  Nearest_24  Predicted_FRP\n> 0 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> 1 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> 2 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> 3 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> 4 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> \n> [5 rows x 44 columns]\n> renaming Predicted_FRP to FRP\n> remove the current predicted_frp\n> reading past files for 2021-07-16 00:00:00\n> reading from predicted folder\n> current final_df head:       FWI    VPD   HT  ...  Nearest_23  Nearest_24  Predicted_FRP\n> 0 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> 1 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> 2 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> 3 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> 4 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> \n> [5 rows x 44 columns]\n> renaming Predicted_FRP to FRP\n> remove the current predicted_frp\n> reading past files for 2021-07-15 00:00:00\n> reading from predicted folder\n> current final_df head:       FWI    VPD   HT  ...  Nearest_23  Nearest_24  Predicted_FRP\n> 0 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> 1 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> 2 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> 3 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> 4 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> \n> [5 rows x 44 columns]\n> renaming Predicted_FRP to FRP\n> remove the current predicted_frp\n> reading past files for 2021-07-14 00:00:00\n> reading from predicted folder\n> current final_df head:       FWI    VPD   HT  ...  Nearest_23  Nearest_24  Predicted_FRP\n> 0 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> 1 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> 2 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> 3 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> 4 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> \n> [5 rows x 44 columns]\n> renaming Predicted_FRP to FRP\n> remove the current predicted_frp\n> reading past files for 2021-07-13 00:00:00\n> reading from original folder\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata/firedata_20210713.txt\n> reading past files for 2021-07-12 00:00:00\n> reading from original folder\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata/firedata_20210712.txt\n> reading past files for 2021-07-11 00:00:00\n> reading from original folder\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata/firedata_20210711.txt\n> original_df.describe                  LAT            LON  ...   FRP_6_days_ago   FRP_7_days_ago\n> count  156861.000000  156861.000000  ...    156861.000000    156861.000000\n> mean       37.500002     -95.999998  ...         0.469768         0.302685\n> std         7.534390      17.349407  ...        52.007267        23.155200\n> min        24.500000    -126.000000  ...         0.000000         0.000000\n> 25%        31.000000    -111.000000  ...         0.000000         0.000000\n> 50%        37.500000     -96.000000  ...         0.000000         0.000000\n> 75%        44.000000     -81.000000  ...         0.000000         0.000000\n> max        50.500000     -66.000000  ...     15687.671875      5055.526367\n> \n> [8 rows x 22 columns]\n> original_df columns:  Index(['LAT', ' LON', ' FRP', ' FWI', ' VPD', ' HT', ' T', ' RH', ' U', ' V',\n>        ' P', ' RAIN', ' CAPE', ' ST', ' SM', ' FRP_1_days_ago',\n>        ' FRP_2_days_ago', ' FRP_3_days_ago', ' FRP_4_days_ago',\n>        ' FRP_5_days_ago', ' FRP_6_days_ago', ' FRP_7_days_ago'],\n>       dtype='object')\n452a453,487\n> new_df.shape =  (156861, 24)\n> df.shape =  (156861, 22)\n> New time series dataframe:      LAT         LON    FRP  ...  Nearest_22  Nearest_23  Nearest_24\n> 0  24.5 -126.000000 -999.0  ...         0.0         0.0         0.0\n> 1  24.5 -125.899994 -999.0  ...         0.0         0.0         0.0\n> 2  24.5 -125.800003 -999.0  ...         0.0         0.0         0.0\n> 3  24.5 -125.699997 -999.0  ...         0.0         0.0         0.0\n> 4  24.5 -125.599998 -999.0  ...         0.0         0.0         0.0\n> \n> [5 rows x 46 columns]\n> Original df is created:  (156861, 46)\n> Original df filled the na with -9999 \n> X and y are loaded into memory for 20210718\n> the loaded model is:  XGBRegressor(base_score=0.5, booster='gbtree', callbacks=None,\n>              colsample_bylevel=1, colsample_bynode=1, colsample_bytree=1,\n>              early_stopping_rounds=None, enable_categorical=False,\n>              eval_metric=None, gamma=0, gpu_id=-1, grow_policy='depthwise',\n>              importance_type=None, interaction_constraints='',\n>              learning_rate=0.1, max_bin=256, max_cat_to_onehot=4,\n>              max_delta_step=0, max_depth=8, max_leaves=0, min_child_weight=1,\n>              missing=nan, monotone_constraints='()', n_estimators=100, n_jobs=0,\n>              num_parallel_tree=1, predictor='auto', random_state=0, reg_alpha=0,\n>              reg_lambda=1, ...)\n> Prediction for 20210718 of start day 20210714 is finished\n> new columns to check:  [' FRP_1_days_ago', 'Nearest_1', 'Nearest_2', 'Nearest_3', 'Nearest_4', 'Nearest_5', 'Nearest_6', 'Nearest_7', 'Nearest_8']\n> current merged_df columns:  Index([' FWI', ' VPD', ' HT', ' T', ' RH', ' U', ' V', ' P', ' RAIN', ' CAPE',\n>        ' ST', ' SM', ' FRP_1_days_ago', ' FRP_2_days_ago', ' FRP_3_days_ago',\n>        ' FRP_4_days_ago', ' FRP_5_days_ago', ' FRP_6_days_ago',\n>        ' FRP_7_days_ago', 'Nearest_1', 'Nearest_2', 'Nearest_3', 'Nearest_4',\n>        'Nearest_5', 'Nearest_6', 'Nearest_7', 'Nearest_8', 'Nearest_9',\n>        'Nearest_10', 'Nearest_11', 'Nearest_12', 'Nearest_13', 'Nearest_14',\n>        'Nearest_15', 'Nearest_16', 'Nearest_17', 'Nearest_18', 'Nearest_19',\n>        'Nearest_20', 'Nearest_21', 'Nearest_22', 'Nearest_23', 'Nearest_24',\n>        'Predicted_FRP'],\n>       dtype='object')\n487a488,575\n> Prediction results are saved to /groups/ESS3/zsun/firecasting/data/output/output_xgboost_window_7_days_forecasting//20210714/firedata_20210718_predicted.txt\n> ['Mean Absolute Error (MAE): 1003.3418466528782', 'Mean Squared Error (MSE): 1007995.5192635342', 'Root Mean Squared Error (RMSE): 1003.989800378238', 'R-squared (R2) Score: 0.0', 'Explained Variance Score: 0.0', 'Median Absolute Error (MedAE): 999.0', 'Max Error: 2486.4324951171875', 'Mean: -999.0', 'Median: -999.0', 'Standard Deviation: 0.0', 'Minimum: -999.0', 'Maximum: -999.0', 'Count: 156861']\n> Metrics saved to /groups/ESS3/zsun/firecasting/data/output/output_xgboost_window_7_days_forecasting//20210714/metrics_20210718_predicted.txt\n> predicting:  20210719\n> Read from original folder for current date: 20210719\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata/firedata_20210719.txt\n> reading past files for 2021-07-18 00:00:00\n> reading from predicted folder\n> current final_df head:       FWI    VPD   HT  ...  Nearest_23  Nearest_24  Predicted_FRP\n> 0 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> 1 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> 2 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> 3 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> 4 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> \n> [5 rows x 44 columns]\n> renaming Predicted_FRP to FRP\n> remove the current predicted_frp\n> reading past files for 2021-07-17 00:00:00\n> reading from predicted folder\n> current final_df head:       FWI    VPD   HT  ...  Nearest_23  Nearest_24  Predicted_FRP\n> 0 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> 1 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> 2 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> 3 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> 4 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> \n> [5 rows x 44 columns]\n> renaming Predicted_FRP to FRP\n> remove the current predicted_frp\n> reading past files for 2021-07-16 00:00:00\n> reading from predicted folder\n> current final_df head:       FWI    VPD   HT  ...  Nearest_23  Nearest_24  Predicted_FRP\n> 0 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> 1 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> 2 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> 3 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> 4 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> \n> [5 rows x 44 columns]\n> renaming Predicted_FRP to FRP\n> remove the current predicted_frp\n> reading past files for 2021-07-15 00:00:00\n> reading from predicted folder\n> current final_df head:       FWI    VPD   HT  ...  Nearest_23  Nearest_24  Predicted_FRP\n> 0 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> 1 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> 2 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> 3 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> 4 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> \n> [5 rows x 44 columns]\n> renaming Predicted_FRP to FRP\n> remove the current predicted_frp\n> reading past files for 2021-07-14 00:00:00\n> reading from predicted folder\n> current final_df head:       FWI    VPD   HT  ...  Nearest_23  Nearest_24  Predicted_FRP\n> 0 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> 1 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> 2 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> 3 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> 4 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> \n> [5 rows x 44 columns]\n> renaming Predicted_FRP to FRP\n> remove the current predicted_frp\n> reading past files for 2021-07-13 00:00:00\n> reading from original folder\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata/firedata_20210713.txt\n> reading past files for 2021-07-12 00:00:00\n> reading from original folder\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata/firedata_20210712.txt\n> original_df.describe                  LAT            LON  ...   FRP_6_days_ago   FRP_7_days_ago\n> count  156861.000000  156861.000000  ...    156861.000000    156861.000000\n> mean       37.500002     -95.999998  ...         0.240383         0.469768\n> std         7.534390      17.349407  ...        17.442142        52.007267\n> min        24.500000    -126.000000  ...         0.000000         0.000000\n> 25%        31.000000    -111.000000  ...         0.000000         0.000000\n> 50%        37.500000     -96.000000  ...         0.000000         0.000000\n> 75%        44.000000     -81.000000  ...         0.000000         0.000000\n> max        50.500000     -66.000000  ...      3668.386230     15687.671875\n> \n> [8 rows x 22 columns]\n> original_df columns:  Index(['LAT', ' LON', ' FRP', ' FWI', ' VPD', ' HT', ' T', ' RH', ' U', ' V',\n>        ' P', ' RAIN', ' CAPE', ' ST', ' SM', ' FRP_1_days_ago',\n>        ' FRP_2_days_ago', ' FRP_3_days_ago', ' FRP_4_days_ago',\n>        ' FRP_5_days_ago', ' FRP_6_days_ago', ' FRP_7_days_ago'],\n>       dtype='object')\n575a576,610\n> new_df.shape =  (156861, 24)\n> df.shape =  (156861, 22)\n> New time series dataframe:      LAT         LON    FRP  ...  Nearest_22  Nearest_23  Nearest_24\n> 0  24.5 -126.000000 -999.0  ...         0.0         0.0         0.0\n> 1  24.5 -125.899994 -999.0  ...         0.0         0.0         0.0\n> 2  24.5 -125.800003 -999.0  ...         0.0         0.0         0.0\n> 3  24.5 -125.699997 -999.0  ...         0.0         0.0         0.0\n> 4  24.5 -125.599998 -999.0  ...         0.0         0.0         0.0\n> \n> [5 rows x 46 columns]\n> Original df is created:  (156861, 46)\n> Original df filled the na with -9999 \n> X and y are loaded into memory for 20210719\n> the loaded model is:  XGBRegressor(base_score=0.5, booster='gbtree', callbacks=None,\n>              colsample_bylevel=1, colsample_bynode=1, colsample_bytree=1,\n>              early_stopping_rounds=None, enable_categorical=False,\n>              eval_metric=None, gamma=0, gpu_id=-1, grow_policy='depthwise',\n>              importance_type=None, interaction_constraints='',\n>              learning_rate=0.1, max_bin=256, max_cat_to_onehot=4,\n>              max_delta_step=0, max_depth=8, max_leaves=0, min_child_weight=1,\n>              missing=nan, monotone_constraints='()', n_estimators=100, n_jobs=0,\n>              num_parallel_tree=1, predictor='auto', random_state=0, reg_alpha=0,\n>              reg_lambda=1, ...)\n> Prediction for 20210719 of start day 20210714 is finished\n> new columns to check:  [' FRP_1_days_ago', 'Nearest_1', 'Nearest_2', 'Nearest_3', 'Nearest_4', 'Nearest_5', 'Nearest_6', 'Nearest_7', 'Nearest_8']\n> current merged_df columns:  Index([' FWI', ' VPD', ' HT', ' T', ' RH', ' U', ' V', ' P', ' RAIN', ' CAPE',\n>        ' ST', ' SM', ' FRP_1_days_ago', ' FRP_2_days_ago', ' FRP_3_days_ago',\n>        ' FRP_4_days_ago', ' FRP_5_days_ago', ' FRP_6_days_ago',\n>        ' FRP_7_days_ago', 'Nearest_1', 'Nearest_2', 'Nearest_3', 'Nearest_4',\n>        'Nearest_5', 'Nearest_6', 'Nearest_7', 'Nearest_8', 'Nearest_9',\n>        'Nearest_10', 'Nearest_11', 'Nearest_12', 'Nearest_13', 'Nearest_14',\n>        'Nearest_15', 'Nearest_16', 'Nearest_17', 'Nearest_18', 'Nearest_19',\n>        'Nearest_20', 'Nearest_21', 'Nearest_22', 'Nearest_23', 'Nearest_24',\n>        'Predicted_FRP'],\n>       dtype='object')\n610a611,707\n> Prediction results are saved to /groups/ESS3/zsun/firecasting/data/output/output_xgboost_window_7_days_forecasting//20210714/firedata_20210719_predicted.txt\n> ['Mean Absolute Error (MAE): 1005.9507385728172', 'Mean Squared Error (MSE): 1014021.6908726116', 'Root Mean Squared Error (RMSE): 1006.9864402625349', 'R-squared (R2) Score: 0.0', 'Explained Variance Score: 0.0', 'Median Absolute Error (MedAE): 999.0', 'Max Error: 2913.8359375', 'Mean: -999.0', 'Median: -999.0', 'Standard Deviation: 0.0', 'Minimum: -999.0', 'Maximum: -999.0', 'Count: 156861']\n> Metrics saved to /groups/ESS3/zsun/firecasting/data/output/output_xgboost_window_7_days_forecasting//20210714/metrics_20210719_predicted.txt\n> predicting:  20210720\n> Read from original folder for current date: 20210720\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata/firedata_20210720.txt\n> reading past files for 2021-07-19 00:00:00\n> reading from predicted folder\n> current final_df head:       FWI    VPD   HT  ...  Nearest_23  Nearest_24  Predicted_FRP\n> 0 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> 1 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> 2 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> 3 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> 4 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> \n> [5 rows x 44 columns]\n> renaming Predicted_FRP to FRP\n> remove the current predicted_frp\n> reading past files for 2021-07-18 00:00:00\n> reading from predicted folder\n> current final_df head:       FWI    VPD   HT  ...  Nearest_23  Nearest_24  Predicted_FRP\n> 0 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> 1 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> 2 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> 3 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> 4 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> \n> [5 rows x 44 columns]\n> renaming Predicted_FRP to FRP\n> remove the current predicted_frp\n> reading past files for 2021-07-17 00:00:00\n> reading from predicted folder\n> current final_df head:       FWI    VPD   HT  ...  Nearest_23  Nearest_24  Predicted_FRP\n> 0 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> 1 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> 2 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> 3 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> 4 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> \n> [5 rows x 44 columns]\n> renaming Predicted_FRP to FRP\n> remove the current predicted_frp\n> reading past files for 2021-07-16 00:00:00\n> reading from predicted folder\n> current final_df head:       FWI    VPD   HT  ...  Nearest_23  Nearest_24  Predicted_FRP\n> 0 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> 1 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> 2 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> 3 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> 4 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> \n> [5 rows x 44 columns]\n> renaming Predicted_FRP to FRP\n> remove the current predicted_frp\n> reading past files for 2021-07-15 00:00:00\n> reading from predicted folder\n> current final_df head:       FWI    VPD   HT  ...  Nearest_23  Nearest_24  Predicted_FRP\n> 0 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> 1 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> 2 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> 3 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> 4 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> \n> [5 rows x 44 columns]\n> renaming Predicted_FRP to FRP\n> remove the current predicted_frp\n> reading past files for 2021-07-14 00:00:00\n> reading from predicted folder\n> current final_df head:       FWI    VPD   HT  ...  Nearest_23  Nearest_24  Predicted_FRP\n> 0 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> 1 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> 2 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> 3 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> 4 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> \n> [5 rows x 44 columns]\n> renaming Predicted_FRP to FRP\n> remove the current predicted_frp\n> reading past files for 2021-07-13 00:00:00\n> reading from original folder\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata/firedata_20210713.txt\n> original_df.describe                  LAT            LON  ...   FRP_6_days_ago   FRP_7_days_ago\n> count  156861.000000  156861.000000  ...    156861.000000    156861.000000\n> mean       37.500002     -95.999998  ...         1.159537         0.240383\n> std         7.534390      17.349407  ...        24.568478        17.442142\n> min        24.500000    -126.000000  ...         0.000000         0.000000\n> 25%        31.000000    -111.000000  ...         0.000000         0.000000\n> 50%        37.500000     -96.000000  ...         0.000000         0.000000\n> 75%        44.000000     -81.000000  ...         0.000000         0.000000\n> max        50.500000     -66.000000  ...      1742.300659      3668.386230\n> \n> [8 rows x 22 columns]\n> original_df columns:  Index(['LAT', ' LON', ' FRP', ' FWI', ' VPD', ' HT', ' T', ' RH', ' U', ' V',\n>        ' P', ' RAIN', ' CAPE', ' ST', ' SM', ' FRP_1_days_ago',\n>        ' FRP_2_days_ago', ' FRP_3_days_ago', ' FRP_4_days_ago',\n>        ' FRP_5_days_ago', ' FRP_6_days_ago', ' FRP_7_days_ago'],\n>       dtype='object')\n707a708,742\n> new_df.shape =  (156861, 24)\n> df.shape =  (156861, 22)\n> New time series dataframe:      LAT         LON    FRP  ...  Nearest_22  Nearest_23  Nearest_24\n> 0  24.5 -126.000000 -999.0  ...         0.0         0.0         0.0\n> 1  24.5 -125.899994 -999.0  ...         0.0         0.0         0.0\n> 2  24.5 -125.800003 -999.0  ...         0.0         0.0         0.0\n> 3  24.5 -125.699997 -999.0  ...         0.0         0.0         0.0\n> 4  24.5 -125.599998 -999.0  ...         0.0         0.0         0.0\n> \n> [5 rows x 46 columns]\n> Original df is created:  (156861, 46)\n> Original df filled the na with -9999 \n> X and y are loaded into memory for 20210720\n> the loaded model is:  XGBRegressor(base_score=0.5, booster='gbtree', callbacks=None,\n>              colsample_bylevel=1, colsample_bynode=1, colsample_bytree=1,\n>              early_stopping_rounds=None, enable_categorical=False,\n>              eval_metric=None, gamma=0, gpu_id=-1, grow_policy='depthwise',\n>              importance_type=None, interaction_constraints='',\n>              learning_rate=0.1, max_bin=256, max_cat_to_onehot=4,\n>              max_delta_step=0, max_depth=8, max_leaves=0, min_child_weight=1,\n>              missing=nan, monotone_constraints='()', n_estimators=100, n_jobs=0,\n>              num_parallel_tree=1, predictor='auto', random_state=0, reg_alpha=0,\n>              reg_lambda=1, ...)\n> Prediction for 20210720 of start day 20210714 is finished\n> new columns to check:  [' FRP_1_days_ago', 'Nearest_1', 'Nearest_2', 'Nearest_3', 'Nearest_4', 'Nearest_5', 'Nearest_6', 'Nearest_7', 'Nearest_8']\n> current merged_df columns:  Index([' FWI', ' VPD', ' HT', ' T', ' RH', ' U', ' V', ' P', ' RAIN', ' CAPE',\n>        ' ST', ' SM', ' FRP_1_days_ago', ' FRP_2_days_ago', ' FRP_3_days_ago',\n>        ' FRP_4_days_ago', ' FRP_5_days_ago', ' FRP_6_days_ago',\n>        ' FRP_7_days_ago', 'Nearest_1', 'Nearest_2', 'Nearest_3', 'Nearest_4',\n>        'Nearest_5', 'Nearest_6', 'Nearest_7', 'Nearest_8', 'Nearest_9',\n>        'Nearest_10', 'Nearest_11', 'Nearest_12', 'Nearest_13', 'Nearest_14',\n>        'Nearest_15', 'Nearest_16', 'Nearest_17', 'Nearest_18', 'Nearest_19',\n>        'Nearest_20', 'Nearest_21', 'Nearest_22', 'Nearest_23', 'Nearest_24',\n>        'Predicted_FRP'],\n>       dtype='object')\n742a743,745\n> Prediction results are saved to /groups/ESS3/zsun/firecasting/data/output/output_xgboost_window_7_days_forecasting//20210714/firedata_20210720_predicted.txt\n> ['Mean Absolute Error (MAE): 1011.2155075039509', 'Mean Squared Error (MSE): 1026365.7495599205', 'Root Mean Squared Error (RMSE): 1013.0971076653612', 'R-squared (R2) Score: 0.0', 'Explained Variance Score: 0.0', 'Median Absolute Error (MedAE): 999.0', 'Max Error: 2492.212890625', 'Mean: -999.0', 'Median: -999.0', 'Standard Deviation: 0.0', 'Minimum: -999.0', 'Maximum: -999.0', 'Count: 156861']\n> Metrics saved to /groups/ESS3/zsun/firecasting/data/output/output_xgboost_window_7_days_forecasting//20210714/metrics_20210720_predicted.txt\nJob 1738362 has finished with state: JobState=COMPLETED\nSlurm job (1738362) has finished.\nPrint the job's output logs\nJobID           JobName      State ExitCode     MaxRSS               Start                 End \n------------ ---------- ---------- -------- ---------- ------------------- ------------------- \n1738362      fc_model_+  COMPLETED      0:0            2024-04-06T21:19:26 2024-04-06T21:47:01 \n1738362.bat+      batch  COMPLETED      0:0    590060K 2024-04-06T21:19:26 2024-04-06T21:47:01 \n1738362.ext+     extern  COMPLETED      0:0          0 2024-04-06T21:19:26 2024-04-06T21:47:01 \nAll slurm job for fc_model_predict_2weeks_slurm_generated.sh finishes.\n",
  "history_begin_time" : 1712452764755,
  "history_end_time" : 1712454430749,
  "history_notes" : null,
  "history_process" : "55wou8",
  "host_id" : "100001",
  "indicator" : "Done"
},{
  "history_id" : "z94a6r65to3",
  "history_input" : "No code saved",
  "history_output" : "Skipped",
  "history_begin_time" : 1712452760505,
  "history_end_time" : 1712452760505,
  "history_notes" : null,
  "history_process" : "uhet3k",
  "host_id" : "100001",
  "indicator" : "Skipped"
},{
  "history_id" : "7nj0ge4v3iv",
  "history_input" : "No code saved",
  "history_output" : "Skipped",
  "history_begin_time" : 1712452760505,
  "history_end_time" : 1712452760505,
  "history_notes" : null,
  "history_process" : "b6x5kk",
  "host_id" : "100001",
  "indicator" : "Skipped"
},{
  "history_id" : "av8a3d7wwmk",
  "history_input" : "#!/bin/bash\n\necho \"start to run plot_results.sh\"\npwd\n\n# Specify the name of the script you want to submit\nSCRIPT_NAME=\"plot_results_generated.sh\"\necho \"write the slurm script into ${SCRIPT_NAME}\"\ncat > ${SCRIPT_NAME} << EOF\n#!/bin/bash\n#SBATCH -J plot_results       # Job name\n#SBATCH --output=/scratch/%u/%x-%N-%j.out  # Output file`\n#SBATCH --error=/scratch/%u/%x-%N-%j.err   # Error file`\n#SBATCH -n 1               # Number of tasks\n#SBATCH -c 12               # Number of CPUs per task (threads)\n#SBATCH --mem=20G          # Memory per node (use units like G for gigabytes) - this job must need 200GB lol\n#SBATCH -t 0-10:00         # Runtime in D-HH:MM format\n## Slurm can send you updates via email\n#SBATCH --mail-type=FAIL  # BEGIN,END,FAIL         # ALL,NONE,BEGIN,END,FAIL,REQUEUE,..\n#SBATCH --mail-user=zsun@gmu.edu     # Put your GMU email address here\n\n# Activate your customized virtual environment\nsource /home/zsun/anaconda3/bin/activate\n\n# Call the Python script using process substitution\npython -u << INNER_EOF\n\nfrom plot_results import plot_images\n\nplot_images()\n\nINNER_EOF\n\nEOF\n\n# Submit the Slurm job and wait for it to finish\necho \"sbatch ${SCRIPT_NAME}\"\n# should have another check. if there is another job running, should cancel it before submitting a new job.\n\n# Find and cancel existing running jobs with the same script name\n#existing_jobs=$(squeue -h -o \"%A %j\" -u $(whoami) | awk -v script=\"$SCRIPT_NAME\" '$2 == script {print $1}')\n\n# if [ -n \"$existing_jobs\" ]; then\n#     echo \"Canceling existing jobs with the script name '$SCRIPT_NAME'...\"\n#     for job_id in $existing_jobs; do\n#         scancel $job_id\n#     done\n# else\n#     echo \"No existing jobs with the script name '$SCRIPT_NAME' found.\"\n# fi\n\n# Submit the Slurm job\njob_id=$(sbatch ${SCRIPT_NAME} | awk '{print $4}')\necho \"job_id=\"${job_id}\n\nif [ -z \"${job_id}\" ]; then\n    echo \"job id is empty. something wrong with the slurm job submission.\"\n    exit 1\nfi\n\n# Wait for the Slurm job to finish\nfile_name=$(find /scratch/zsun -name '*'${job_id}'.out' -print -quit)\nprevious_content=$(cat file_name)\nexit_code=0\nwhile true; do\n    # Capture the current content\\\n    #echo ${job_id}\n    file_name=$(find /scratch/zsun -name '*'${job_id}'.out' -print -quit)\n    #echo \"file_name=\"$file_name\n    current_content=$(<\"${file_name}\")\n    #echo \"current_content = \"$current_content\n\n    # Compare current content with previous content\n    diff_result=$(diff <(echo \"$previous_content\") <(echo \"$current_content\"))\n    # Check if there is new content\n    if [ -n \"$diff_result\" ]; then\n        # Print the newly added content\n        #echo \"New content added:\"\n        echo \"$diff_result\"\n        #echo \"---------------------\"\n    fi\n    # Update previous content\n    previous_content=\"$current_content\"\n\n\n    job_status=$(scontrol show job ${job_id} | awk '/JobState=/{print $1}')\n    #echo \"job_status \"$job_status\n    #if [[ $job_status == \"JobState=COMPLETED\" ]]; then\n    #    break\n    #fi\n    if [[ $job_status == *\"COMPLETED\"* ]]; then\n        echo \"Job $job_id has finished with state: $job_status\"\n        break;\n    elif [[ $job_status == *\"CANCELLED\"* || $job_status == *\"FAILED\"* || $job_status == *\"TIMEOUT\"* || $job_status == *\"NODE_FAIL\"* || $job_status == *\"PREEMPTED\"* || $job_status == *\"OUT_OF_MEMORY\"* ]]; then\n        echo \"Job $job_id has finished with state: $job_status\"\n        exit_code=1\n        break;\n    fi\n    sleep 10  # Adjust the sleep interval as needed\ndone\n\necho \"Slurm job ($job_id) has finished.\"\n\necho \"Print the job's output logs\"\nsacct --format=JobID,JobName,State,ExitCode,MaxRSS,Start,End -j $job_id\n# find /scratch/zsun/ -type f -name \"*${job_id}.out\" -exec cat {} \\;\n\n#cat /scratch/zsun/test_data_slurm-*-$job_id.out\n\necho \"All slurm job for ${SCRIPT_NAME} finishes.\"\n\nexit $exit_code\n",
  "history_output" : "start to run plot_results.sh\n/home/zsun/gw-workspace/av8a3d7wwmk\nwrite the slurm script into plot_results_generated.sh\nsbatch plot_results_generated.sh\njob_id=1738408\ncat: file_name: No such file or directory\n/home/zsun/gw-workspace/av8a3d7wwmk/gw-0f2mRA1JQ3xNSxM8pmaylrrGH7-av8a3d7wwmk.sh: line 70: : No such file or directory\n/home/zsun/gw-workspace/av8a3d7wwmk/gw-0f2mRA1JQ3xNSxM8pmaylrrGH7-av8a3d7wwmk.sh: line 70: : No such file or directory\n/home/zsun/gw-workspace/av8a3d7wwmk/gw-0f2mRA1JQ3xNSxM8pmaylrrGH7-av8a3d7wwmk.sh: line 70: : No such file or directory\n/home/zsun/gw-workspace/av8a3d7wwmk/gw-0f2mRA1JQ3xNSxM8pmaylrrGH7-av8a3d7wwmk.sh: line 70: : No such file or directory\n0a1,12\n> /home/zsun/anaconda3/lib/python3.8/site-packages/dask/dataframe/utils.py:367: FutureWarning: pandas.Int64Index is deprecated and will be removed from pandas in a future version. Use pandas.Index with the appropriate dtype instead.\n>   _numeric_index_types = (pd.Int64Index, pd.Float64Index, pd.UInt64Index)\n> /home/zsun/anaconda3/lib/python3.8/site-packages/dask/dataframe/utils.py:367: FutureWarning: pandas.Float64Index is deprecated and will be removed from pandas in a future version. Use pandas.Index with the appropriate dtype instead.\n>   _numeric_index_types = (pd.Int64Index, pd.Float64Index, pd.UInt64Index)\n> /home/zsun/anaconda3/lib/python3.8/site-packages/dask/dataframe/utils.py:367: FutureWarning: pandas.UInt64Index is deprecated and will be removed from pandas in a future version. Use pandas.Index with the appropriate dtype instead.\n>   _numeric_index_types = (pd.Int64Index, pd.Float64Index, pd.UInt64Index)\n>      FWI    VPD   HT  ...  Nearest_23  Nearest_24  Predicted_FRP\n> 0 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> 1 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> 2 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> 3 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> 4 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n1a14\n> [5 rows x 44 columns]\n14a15,47\n> test image is saved at /groups/ESS3/zsun/firecasting/data/output/output_xgboost_window_7_days_forecasting/20210714/firedata_20210719_predicted.txt.png\n> min_lat =  24.5\n> max_lat =  50.5\n> min_lon =  -126.0\n> max_lon =  -66.0\n> width =  6000\n> height =  2600\n> xi =  [[-126.         -125.98999833 -125.97999667 ...  -66.02000333\n>    -66.01000167  -66.        ]\n>  [-126.         -125.98999833 -125.97999667 ...  -66.02000333\n>    -66.01000167  -66.        ]\n>  [-126.         -125.98999833 -125.97999667 ...  -66.02000333\n>    -66.01000167  -66.        ]\n>  ...\n>  [-126.         -125.98999833 -125.97999667 ...  -66.02000333\n>    -66.01000167  -66.        ]\n>  [-126.         -125.98999833 -125.97999667 ...  -66.02000333\n>    -66.01000167  -66.        ]\n>  [-126.         -125.98999833 -125.97999667 ...  -66.02000333\n>    -66.01000167  -66.        ]]\n> yi =  [[50.5        50.5        50.5        ... 50.5        50.5\n>   50.5       ]\n>  [50.48999615 50.48999615 50.48999615 ... 50.48999615 50.48999615\n>   50.48999615]\n>  [50.4799923  50.4799923  50.4799923  ... 50.4799923  50.4799923\n>   50.4799923 ]\n>  ...\n>  [24.5200077  24.5200077  24.5200077  ... 24.5200077  24.5200077\n>   24.5200077 ]\n>  [24.51000385 24.51000385 24.51000385 ... 24.51000385 24.51000385\n>   24.51000385]\n>  [24.5        24.5        24.5        ... 24.5        24.5\n>   24.5       ]]\n47a48,56\n> GeoTIFF file created: /groups/ESS3/zsun/firecasting/data/output/output_xgboost_window_7_days_forecasting/20210714/firedata_20210719_predicted.txt_output.tif\n>      FWI    VPD   HT  ...  Nearest_23  Nearest_24  Predicted_FRP\n> 0 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> 1 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> 2 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> 3 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> 4 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> \n> [5 rows x 44 columns]\n56a57,89\n> test image is saved at /groups/ESS3/zsun/firecasting/data/output/output_xgboost_window_7_days_forecasting/20210714/firedata_20210720_predicted.txt.png\n> min_lat =  24.5\n> max_lat =  50.5\n> min_lon =  -126.0\n> max_lon =  -66.0\n> width =  6000\n> height =  2600\n> xi =  [[-126.         -125.98999833 -125.97999667 ...  -66.02000333\n>    -66.01000167  -66.        ]\n>  [-126.         -125.98999833 -125.97999667 ...  -66.02000333\n>    -66.01000167  -66.        ]\n>  [-126.         -125.98999833 -125.97999667 ...  -66.02000333\n>    -66.01000167  -66.        ]\n>  ...\n>  [-126.         -125.98999833 -125.97999667 ...  -66.02000333\n>    -66.01000167  -66.        ]\n>  [-126.         -125.98999833 -125.97999667 ...  -66.02000333\n>    -66.01000167  -66.        ]\n>  [-126.         -125.98999833 -125.97999667 ...  -66.02000333\n>    -66.01000167  -66.        ]]\n> yi =  [[50.5        50.5        50.5        ... 50.5        50.5\n>   50.5       ]\n>  [50.48999615 50.48999615 50.48999615 ... 50.48999615 50.48999615\n>   50.48999615]\n>  [50.4799923  50.4799923  50.4799923  ... 50.4799923  50.4799923\n>   50.4799923 ]\n>  ...\n>  [24.5200077  24.5200077  24.5200077  ... 24.5200077  24.5200077\n>   24.5200077 ]\n>  [24.51000385 24.51000385 24.51000385 ... 24.51000385 24.51000385\n>   24.51000385]\n>  [24.5        24.5        24.5        ... 24.5        24.5\n>   24.5       ]]\n89a90,98\n> GeoTIFF file created: /groups/ESS3/zsun/firecasting/data/output/output_xgboost_window_7_days_forecasting/20210714/firedata_20210720_predicted.txt_output.tif\n>      FWI    VPD   HT  ...  Nearest_23  Nearest_24  Predicted_FRP\n> 0 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> 1 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> 2 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> 3 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> 4 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> \n> [5 rows x 44 columns]\n98a99,131\n> test image is saved at /groups/ESS3/zsun/firecasting/data/output/output_xgboost_window_7_days_forecasting/20210714/firedata_20210716_predicted.txt.png\n> min_lat =  24.5\n> max_lat =  50.5\n> min_lon =  -126.0\n> max_lon =  -66.0\n> width =  6000\n> height =  2600\n> xi =  [[-126.         -125.98999833 -125.97999667 ...  -66.02000333\n>    -66.01000167  -66.        ]\n>  [-126.         -125.98999833 -125.97999667 ...  -66.02000333\n>    -66.01000167  -66.        ]\n>  [-126.         -125.98999833 -125.97999667 ...  -66.02000333\n>    -66.01000167  -66.        ]\n>  ...\n>  [-126.         -125.98999833 -125.97999667 ...  -66.02000333\n>    -66.01000167  -66.        ]\n>  [-126.         -125.98999833 -125.97999667 ...  -66.02000333\n>    -66.01000167  -66.        ]\n>  [-126.         -125.98999833 -125.97999667 ...  -66.02000333\n>    -66.01000167  -66.        ]]\n> yi =  [[50.5        50.5        50.5        ... 50.5        50.5\n>   50.5       ]\n>  [50.48999615 50.48999615 50.48999615 ... 50.48999615 50.48999615\n>   50.48999615]\n>  [50.4799923  50.4799923  50.4799923  ... 50.4799923  50.4799923\n>   50.4799923 ]\n>  ...\n>  [24.5200077  24.5200077  24.5200077  ... 24.5200077  24.5200077\n>   24.5200077 ]\n>  [24.51000385 24.51000385 24.51000385 ... 24.51000385 24.51000385\n>   24.51000385]\n>  [24.5        24.5        24.5        ... 24.5        24.5\n>   24.5       ]]\n131a132,140\n> GeoTIFF file created: /groups/ESS3/zsun/firecasting/data/output/output_xgboost_window_7_days_forecasting/20210714/firedata_20210716_predicted.txt_output.tif\n>      FWI    VPD   HT  ...  Nearest_23  Nearest_24  Predicted_FRP\n> 0 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> 1 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> 2 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> 3 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> 4 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> \n> [5 rows x 44 columns]\n140a141,182\n> test image is saved at /groups/ESS3/zsun/firecasting/data/output/output_xgboost_window_7_days_forecasting/20210714/firedata_20210714_predicted.txt.png\n> min_lat =  24.5\n> max_lat =  50.5\n> min_lon =  -126.0\n> max_lon =  -66.0\n> width =  6000\n> height =  2600\n> xi =  [[-126.         -125.98999833 -125.97999667 ...  -66.02000333\n>    -66.01000167  -66.        ]\n>  [-126.         -125.98999833 -125.97999667 ...  -66.02000333\n>    -66.01000167  -66.        ]\n>  [-126.         -125.98999833 -125.97999667 ...  -66.02000333\n>    -66.01000167  -66.        ]\n>  ...\n>  [-126.         -125.98999833 -125.97999667 ...  -66.02000333\n>    -66.01000167  -66.        ]\n>  [-126.         -125.98999833 -125.97999667 ...  -66.02000333\n>    -66.01000167  -66.        ]\n>  [-126.         -125.98999833 -125.97999667 ...  -66.02000333\n>    -66.01000167  -66.        ]]\n> yi =  [[50.5        50.5        50.5        ... 50.5        50.5\n>   50.5       ]\n>  [50.48999615 50.48999615 50.48999615 ... 50.48999615 50.48999615\n>   50.48999615]\n>  [50.4799923  50.4799923  50.4799923  ... 50.4799923  50.4799923\n>   50.4799923 ]\n>  ...\n>  [24.5200077  24.5200077  24.5200077  ... 24.5200077  24.5200077\n>   24.5200077 ]\n>  [24.51000385 24.51000385 24.51000385 ... 24.51000385 24.51000385\n>   24.51000385]\n>  [24.5        24.5        24.5        ... 24.5        24.5\n>   24.5       ]]\n> GeoTIFF file created: /groups/ESS3/zsun/firecasting/data/output/output_xgboost_window_7_days_forecasting/20210714/firedata_20210714_predicted.txt_output.tif\n>      FWI    VPD   HT  ...  Nearest_23  Nearest_24  Predicted_FRP\n> 0 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> 1 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> 2 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> 3 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> 4 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> \n> [5 rows x 44 columns]\n182a183,215\n> test image is saved at /groups/ESS3/zsun/firecasting/data/output/output_xgboost_window_7_days_forecasting/20210714/firedata_20210715_predicted.txt.png\n> min_lat =  24.5\n> max_lat =  50.5\n> min_lon =  -126.0\n> max_lon =  -66.0\n> width =  6000\n> height =  2600\n> xi =  [[-126.         -125.98999833 -125.97999667 ...  -66.02000333\n>    -66.01000167  -66.        ]\n>  [-126.         -125.98999833 -125.97999667 ...  -66.02000333\n>    -66.01000167  -66.        ]\n>  [-126.         -125.98999833 -125.97999667 ...  -66.02000333\n>    -66.01000167  -66.        ]\n>  ...\n>  [-126.         -125.98999833 -125.97999667 ...  -66.02000333\n>    -66.01000167  -66.        ]\n>  [-126.         -125.98999833 -125.97999667 ...  -66.02000333\n>    -66.01000167  -66.        ]\n>  [-126.         -125.98999833 -125.97999667 ...  -66.02000333\n>    -66.01000167  -66.        ]]\n> yi =  [[50.5        50.5        50.5        ... 50.5        50.5\n>   50.5       ]\n>  [50.48999615 50.48999615 50.48999615 ... 50.48999615 50.48999615\n>   50.48999615]\n>  [50.4799923  50.4799923  50.4799923  ... 50.4799923  50.4799923\n>   50.4799923 ]\n>  ...\n>  [24.5200077  24.5200077  24.5200077  ... 24.5200077  24.5200077\n>   24.5200077 ]\n>  [24.51000385 24.51000385 24.51000385 ... 24.51000385 24.51000385\n>   24.51000385]\n>  [24.5        24.5        24.5        ... 24.5        24.5\n>   24.5       ]]\n215a216,224\n> GeoTIFF file created: /groups/ESS3/zsun/firecasting/data/output/output_xgboost_window_7_days_forecasting/20210714/firedata_20210715_predicted.txt_output.tif\n>      FWI    VPD   HT  ...  Nearest_23  Nearest_24  Predicted_FRP\n> 0 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> 1 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> 2 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> 3 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> 4 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> \n> [5 rows x 44 columns]\n224a225,257\n> test image is saved at /groups/ESS3/zsun/firecasting/data/output/output_xgboost_window_7_days_forecasting/20210714/firedata_20210717_predicted.txt.png\n> min_lat =  24.5\n> max_lat =  50.5\n> min_lon =  -126.0\n> max_lon =  -66.0\n> width =  6000\n> height =  2600\n> xi =  [[-126.         -125.98999833 -125.97999667 ...  -66.02000333\n>    -66.01000167  -66.        ]\n>  [-126.         -125.98999833 -125.97999667 ...  -66.02000333\n>    -66.01000167  -66.        ]\n>  [-126.         -125.98999833 -125.97999667 ...  -66.02000333\n>    -66.01000167  -66.        ]\n>  ...\n>  [-126.         -125.98999833 -125.97999667 ...  -66.02000333\n>    -66.01000167  -66.        ]\n>  [-126.         -125.98999833 -125.97999667 ...  -66.02000333\n>    -66.01000167  -66.        ]\n>  [-126.         -125.98999833 -125.97999667 ...  -66.02000333\n>    -66.01000167  -66.        ]]\n> yi =  [[50.5        50.5        50.5        ... 50.5        50.5\n>   50.5       ]\n>  [50.48999615 50.48999615 50.48999615 ... 50.48999615 50.48999615\n>   50.48999615]\n>  [50.4799923  50.4799923  50.4799923  ... 50.4799923  50.4799923\n>   50.4799923 ]\n>  ...\n>  [24.5200077  24.5200077  24.5200077  ... 24.5200077  24.5200077\n>   24.5200077 ]\n>  [24.51000385 24.51000385 24.51000385 ... 24.51000385 24.51000385\n>   24.51000385]\n>  [24.5        24.5        24.5        ... 24.5        24.5\n>   24.5       ]]\n257a258,266\n> GeoTIFF file created: /groups/ESS3/zsun/firecasting/data/output/output_xgboost_window_7_days_forecasting/20210714/firedata_20210717_predicted.txt_output.tif\n>      FWI    VPD   HT  ...  Nearest_23  Nearest_24  Predicted_FRP\n> 0 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> 1 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> 2 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> 3 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> 4 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> \n> [5 rows x 44 columns]\n266a267,301\n> test image is saved at /groups/ESS3/zsun/firecasting/data/output/output_xgboost_window_7_days_forecasting/20210714/firedata_20210718_predicted.txt.png\n> min_lat =  24.5\n> max_lat =  50.5\n> min_lon =  -126.0\n> max_lon =  -66.0\n> width =  6000\n> height =  2600\n> xi =  [[-126.         -125.98999833 -125.97999667 ...  -66.02000333\n>    -66.01000167  -66.        ]\n>  [-126.         -125.98999833 -125.97999667 ...  -66.02000333\n>    -66.01000167  -66.        ]\n>  [-126.         -125.98999833 -125.97999667 ...  -66.02000333\n>    -66.01000167  -66.        ]\n>  ...\n>  [-126.         -125.98999833 -125.97999667 ...  -66.02000333\n>    -66.01000167  -66.        ]\n>  [-126.         -125.98999833 -125.97999667 ...  -66.02000333\n>    -66.01000167  -66.        ]\n>  [-126.         -125.98999833 -125.97999667 ...  -66.02000333\n>    -66.01000167  -66.        ]]\n> yi =  [[50.5        50.5        50.5        ... 50.5        50.5\n>   50.5       ]\n>  [50.48999615 50.48999615 50.48999615 ... 50.48999615 50.48999615\n>   50.48999615]\n>  [50.4799923  50.4799923  50.4799923  ... 50.4799923  50.4799923\n>   50.4799923 ]\n>  ...\n>  [24.5200077  24.5200077  24.5200077  ... 24.5200077  24.5200077\n>   24.5200077 ]\n>  [24.51000385 24.51000385 24.51000385 ... 24.51000385 24.51000385\n>   24.51000385]\n>  [24.5        24.5        24.5        ... 24.5        24.5\n>   24.5       ]]\n> GeoTIFF file created: /groups/ESS3/zsun/firecasting/data/output/output_xgboost_window_7_days_forecasting/20210714/firedata_20210718_predicted.txt_output.tif\n> All done\nJob 1738408 has finished with state: JobState=COMPLETED\nSlurm job (1738408) has finished.\nPrint the job's output logs\nJobID           JobName      State ExitCode     MaxRSS               Start                 End \n------------ ---------- ---------- -------- ---------- ------------------- ------------------- \n1738408      plot_resu+  COMPLETED      0:0            2024-04-06T21:47:17 2024-04-06T21:53:37 \n1738408.bat+      batch  COMPLETED      0:0   1067160K 2024-04-06T21:47:17 2024-04-06T21:53:37 \n1738408.ext+     extern  COMPLETED      0:0          0 2024-04-06T21:47:17 2024-04-06T21:53:37 \nAll slurm job for plot_results_generated.sh finishes.\n",
  "history_begin_time" : 1712454432247,
  "history_end_time" : 1712454821899,
  "history_notes" : null,
  "history_process" : "rg5g1a",
  "host_id" : "100001",
  "indicator" : "Done"
},{
  "history_id" : "zdbr41flpa7",
  "history_input" : "# Generate new map files for new geotifs\n\nimport os\nimport shutil\nimport re\nimport pandas as pd\nfrom datetime import datetime\n\nfrom plot_results import output_folder\n\ndef create_mapserver_map_config(target_geotiff_file_path, force=False):\n  geotiff_file_name = os.path.basename(target_geotiff_file_path)\n  geotiff_dir_name = os.path.dirname(target_geotiff_file_path)\n  geotiff_mapserver_file_path = f\"{geotiff_dir_name}/{geotiff_file_name}.map\"\n  if not geotiff_file_name.endswith(\".tif\"):\n    print(f\"{geotiff_file_name} is not geotiff\")\n    return\n  \n  if os.path.exists(geotiff_mapserver_file_path) and not force:\n    print(f\"{geotiff_mapserver_file_path} already exists\")\n    return geotiff_mapserver_file_path\n  \n  # Define a regular expression pattern to match the date in the filename\n  pattern = r\"\\d{4}\\d{2}\\d{2}\"\n\n  # Use re.search to find the match\n  match = re.search(pattern, geotiff_file_name)\n\n  # Check if a match is found\n  if match:\n      date_string = match.group()\n      print(\"Date:\", date_string)\n  else:\n      print(\"No date found in the filename.\")\n      return f\"The file's name {target_geotiff_file} is wrong\"\n  \n#   Driver: GTiff/GeoTIFF\n# Files: firedata_20210725_predicted.txt_output.tif\n# Size is 6000, 2600\n# Coordinate System is:\n# GEOGCS[\"WGS 84\",\n#     DATUM[\"WGS_1984\",\n#         SPHEROID[\"WGS 84\",6378137,298.257223563,\n#             AUTHORITY[\"EPSG\",\"7030\"]],\n#         AUTHORITY[\"EPSG\",\"6326\"]],\n#     PRIMEM[\"Greenwich\",0],\n#     UNIT[\"degree\",0.0174532925199433],\n#     AUTHORITY[\"EPSG\",\"4326\"]]\n# Origin = (-126.000000000000000,50.500000000000000)\n# Pixel Size = (0.010000000000000,-0.010000000000000)\n# Metadata:\n#   AREA_OR_POINT=Area\n# Image Structure Metadata:\n#   INTERLEAVE=BAND\n# Corner Coordinates:\n# Upper Left  (-126.0000000,  50.5000000) (126d 0' 0.00\"W, 50d30' 0.00\"N)\n# Lower Left  (-126.0000000,  24.5000000) (126d 0' 0.00\"W, 24d30' 0.00\"N)\n# Upper Right ( -66.0000000,  50.5000000) ( 66d 0' 0.00\"W, 50d30' 0.00\"N)\n# Lower Right ( -66.0000000,  24.5000000) ( 66d 0' 0.00\"W, 24d30' 0.00\"N)\n# Center      ( -96.0000000,  37.5000000) ( 96d 0' 0.00\"W, 37d30' 0.00\"N)\n# Band 1 Block=6000x1 Type=Float32, ColorInterp=Gray\n  \n  mapserver_config_content = f\"\"\"\nMAP\n  NAME \"wildfiremap\"\n  STATUS ON\n  EXTENT -126 24.5 -66 50.5\n  SIZE 6000 2600\n  UNITS DD\n  SHAPEPATH \"/var/www/html/wildfire_site/data\"\n\n  PROJECTION\n    \"init=epsg:4326\"\n  END\n\n  WEB\n    IMAGEPATH \"/temp/\"\n    IMAGEURL \"/temp/\"\n    METADATA\n      \"wms_title\" \"Wildfire MapServer WMS\"\n      \"wms_onlineresource\" \"http://geobrain.csiss.gmu.edu/cgi-bin/mapserv?map=/var/www/html/wildfire_site/data/wildfire.map&\"\n      WMS_ENABLE_REQUEST      \"*\"\n      WCS_ENABLE_REQUEST      \"*\"\n      \"wms_srs\" \"epsg:5070 epsg:4326 epsg:3857\"\n    END\n  END\n\n\n  LAYER\n    NAME \"predicted_wildfire_{date_string}\"\n    TYPE RASTER\n    STATUS DEFAULT\n    DATA \"/var/www/html/wildfire_site/data/{geotiff_file_name}\"\n\n    PROJECTION\n      \"init=epsg:4326\"\n    END\n\n    METADATA\n      \"wms_include_items\" \"all\"\n    END\n    PROCESSING \"SCALE=0.0,50000\"\n    PROCESSING \"SCALE_BUCKETS=15\"\n    PROCESSING \"NODATA=0\"\n    STATUS ON\n    DUMP TRUE\n    TYPE RASTER\n    OFFSITE 0 0 0\n    CLASSITEM \"[pixel]\"\n    TEMPLATE \"template.html\"\n    INCLUDE \"legend_wildfire.map\"\n  END\nEND\n\"\"\"\n  \n  with open(geotiff_mapserver_file_path, \"w\") as file:\n    file.write(mapserver_config_content)\n    \n  print(f\"Mapserver config is created at {geotiff_mapserver_file_path}\")\n  return geotiff_mapserver_file_path\n\ndef refresh_available_date_list(target_geotiff_file_path):\n  geotiff_dir_name = os.path.dirname(target_geotiff_file_path)\n  \n  # Define columns for the DataFrame\n  columns = [\"date\", \"predicted_wildfire_url_prefix\"]\n\n  # Create an empty DataFrame with columns\n  df = pd.DataFrame(columns=columns)\n  \n  for filename in os.listdir(geotiff_dir_name):\n    target_geotiff_file = os.path.join(geotiff_dir_name, filename)\n    \n    if \".tif\" not in target_geotiff_file:\n      continue\n      \n    print(\"Processing \", target_geotiff_file)\n      \n    # generate map file first\n    create_mapserver_map_config(target_geotiff_file, force=True)\n    \n    date_str = re.search(r\"\\d{4}\\d{2}\\d{2}\", filename).group()\n    date = datetime.strptime(date_str, \"%Y%m%d\")\n    formatted_date = date.strftime(\"%Y-%m-%d\")\n    # Append a new row to the DataFrame\n    df = df.append({\n      \"date\": formatted_date, \n      \"predicted_wildfire_url_prefix\": f\"{filename}\"\n    }, ignore_index=True)\n  \n  # Save DataFrame to a CSV file\n  df.to_csv(f\"{geotiff_dir_name}/date_list.csv\", index=False)\n\n  # Display the final DataFrame\n  print(df)\n  \n\n\n\ndef generate_mapfiles():\n  #output_folder = f\"/groups/ESS3/zsun/firecasting/data/output/{output_folder}/20210714/\"\n  print(\"Current folder: \", output_folder)\n  refresh_available_date_list(output_folder)\n\nif __name__ == \"__main__\":\n  generate_mapfiles()\n\n",
  "history_output" : "/home/zsun/anaconda3/lib/python3.8/site-packages/dask/dataframe/utils.py:367: FutureWarning: pandas.Int64Index is deprecated and will be removed from pandas in a future version. Use pandas.Index with the appropriate dtype instead.\n  _numeric_index_types = (pd.Int64Index, pd.Float64Index, pd.UInt64Index)\n/home/zsun/anaconda3/lib/python3.8/site-packages/dask/dataframe/utils.py:367: FutureWarning: pandas.Float64Index is deprecated and will be removed from pandas in a future version. Use pandas.Index with the appropriate dtype instead.\n  _numeric_index_types = (pd.Int64Index, pd.Float64Index, pd.UInt64Index)\n/home/zsun/anaconda3/lib/python3.8/site-packages/dask/dataframe/utils.py:367: FutureWarning: pandas.UInt64Index is deprecated and will be removed from pandas in a future version. Use pandas.Index with the appropriate dtype instead.\n  _numeric_index_types = (pd.Int64Index, pd.Float64Index, pd.UInt64Index)\nCurrent folder:  /groups/ESS3/zsun/firecasting/data/output/output_xgboost_window_7_days_forecasting/20210714/\nProcessing  /groups/ESS3/zsun/firecasting/data/output/output_xgboost_window_7_days_forecasting/20210714/firedata_20210718_predicted.txt_output.tif.map\nfiredata_20210718_predicted.txt_output.tif.map is not geotiff\ngenerate_mapfiles.py:146: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n  df = df.append({\nProcessing  /groups/ESS3/zsun/firecasting/data/output/output_xgboost_window_7_days_forecasting/20210714/firedata_20210720_predicted.txt_output.tif\nDate: 20210720\nMapserver config is created at /groups/ESS3/zsun/firecasting/data/output/output_xgboost_window_7_days_forecasting/20210714/firedata_20210720_predicted.txt_output.tif.map\ngenerate_mapfiles.py:146: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n  df = df.append({\nProcessing  /groups/ESS3/zsun/firecasting/data/output/output_xgboost_window_7_days_forecasting/20210714/firedata_20210716_predicted.txt_output.tif.map\nfiredata_20210716_predicted.txt_output.tif.map is not geotiff\ngenerate_mapfiles.py:146: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n  df = df.append({\nProcessing  /groups/ESS3/zsun/firecasting/data/output/output_xgboost_window_7_days_forecasting/20210714/firedata_20210719_predicted.txt_output.tif.map\nfiredata_20210719_predicted.txt_output.tif.map is not geotiff\ngenerate_mapfiles.py:146: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n  df = df.append({\nProcessing  /groups/ESS3/zsun/firecasting/data/output/output_xgboost_window_7_days_forecasting/20210714/firedata_20210715_predicted.txt_output.tif\nDate: 20210715\nMapserver config is created at /groups/ESS3/zsun/firecasting/data/output/output_xgboost_window_7_days_forecasting/20210714/firedata_20210715_predicted.txt_output.tif.map\ngenerate_mapfiles.py:146: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n  df = df.append({\nProcessing  /groups/ESS3/zsun/firecasting/data/output/output_xgboost_window_7_days_forecasting/20210714/firedata_20210714_predicted.txt_output.tif\nDate: 20210714\nMapserver config is created at /groups/ESS3/zsun/firecasting/data/output/output_xgboost_window_7_days_forecasting/20210714/firedata_20210714_predicted.txt_output.tif.map\ngenerate_mapfiles.py:146: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n  df = df.append({\nProcessing  /groups/ESS3/zsun/firecasting/data/output/output_xgboost_window_7_days_forecasting/20210714/firedata_20210717_predicted.txt_output.tif.map\nfiredata_20210717_predicted.txt_output.tif.map is not geotiff\ngenerate_mapfiles.py:146: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n  df = df.append({\nProcessing  /groups/ESS3/zsun/firecasting/data/output/output_xgboost_window_7_days_forecasting/20210714/firedata_20210716_predicted.txt_output.tif\nDate: 20210716\nMapserver config is created at /groups/ESS3/zsun/firecasting/data/output/output_xgboost_window_7_days_forecasting/20210714/firedata_20210716_predicted.txt_output.tif.map\ngenerate_mapfiles.py:146: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n  df = df.append({\nProcessing  /groups/ESS3/zsun/firecasting/data/output/output_xgboost_window_7_days_forecasting/20210714/firedata_20210720_predicted.txt_output.tif.map\nfiredata_20210720_predicted.txt_output.tif.map is not geotiff\ngenerate_mapfiles.py:146: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n  df = df.append({\nProcessing  /groups/ESS3/zsun/firecasting/data/output/output_xgboost_window_7_days_forecasting/20210714/firedata_20210717_predicted.txt_output.tif\nDate: 20210717\nMapserver config is created at /groups/ESS3/zsun/firecasting/data/output/output_xgboost_window_7_days_forecasting/20210714/firedata_20210717_predicted.txt_output.tif.map\ngenerate_mapfiles.py:146: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n  df = df.append({\nProcessing  /groups/ESS3/zsun/firecasting/data/output/output_xgboost_window_7_days_forecasting/20210714/firedata_20210714_predicted.txt_output.tif.map\nfiredata_20210714_predicted.txt_output.tif.map is not geotiff\ngenerate_mapfiles.py:146: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n  df = df.append({\nProcessing  /groups/ESS3/zsun/firecasting/data/output/output_xgboost_window_7_days_forecasting/20210714/firedata_20210715_predicted.txt_output.tif.map\nfiredata_20210715_predicted.txt_output.tif.map is not geotiff\ngenerate_mapfiles.py:146: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n  df = df.append({\nProcessing  /groups/ESS3/zsun/firecasting/data/output/output_xgboost_window_7_days_forecasting/20210714/firedata_20210719_predicted.txt_output.tif\nDate: 20210719\nMapserver config is created at /groups/ESS3/zsun/firecasting/data/output/output_xgboost_window_7_days_forecasting/20210714/firedata_20210719_predicted.txt_output.tif.map\ngenerate_mapfiles.py:146: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n  df = df.append({\nProcessing  /groups/ESS3/zsun/firecasting/data/output/output_xgboost_window_7_days_forecasting/20210714/firedata_20210718_predicted.txt_output.tif\nDate: 20210718\nMapserver config is created at /groups/ESS3/zsun/firecasting/data/output/output_xgboost_window_7_days_forecasting/20210714/firedata_20210718_predicted.txt_output.tif.map\ngenerate_mapfiles.py:146: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n  df = df.append({\n          date                   predicted_wildfire_url_prefix\n0   2021-07-18  firedata_20210718_predicted.txt_output.tif.map\n1   2021-07-20      firedata_20210720_predicted.txt_output.tif\n2   2021-07-16  firedata_20210716_predicted.txt_output.tif.map\n3   2021-07-19  firedata_20210719_predicted.txt_output.tif.map\n4   2021-07-15      firedata_20210715_predicted.txt_output.tif\n5   2021-07-14      firedata_20210714_predicted.txt_output.tif\n6   2021-07-17  firedata_20210717_predicted.txt_output.tif.map\n7   2021-07-16      firedata_20210716_predicted.txt_output.tif\n8   2021-07-20  firedata_20210720_predicted.txt_output.tif.map\n9   2021-07-17      firedata_20210717_predicted.txt_output.tif\n10  2021-07-14  firedata_20210714_predicted.txt_output.tif.map\n11  2021-07-15  firedata_20210715_predicted.txt_output.tif.map\n12  2021-07-19      firedata_20210719_predicted.txt_output.tif\n",
  "history_begin_time" : 1712454823276,
  "history_end_time" : 1712454829942,
  "history_notes" : null,
  "history_process" : "k09hf7",
  "host_id" : "100001",
  "indicator" : "Done"
},{
  "history_id" : "vvp5c6z75q5",
  "history_input" : "No code saved",
  "history_output" : "Skipped",
  "history_begin_time" : 1712452760507,
  "history_end_time" : 1712452760507,
  "history_notes" : null,
  "history_process" : "r7g97f",
  "host_id" : "100001",
  "indicator" : "Skipped"
}]
