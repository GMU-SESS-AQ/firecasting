[{
  "history_id" : "sqnkvwe42g4",
  "history_input" : "No code saved",
  "history_output" : "Skipped",
  "history_begin_time" : 1720812753707,
  "history_end_time" : 1720812753707,
  "history_notes" : null,
  "history_process" : "1jepv8",
  "host_id" : "100001",
  "indicator" : "Skipped"
},{
  "history_id" : "ybal6b1l1wr",
  "history_input" : "No code saved",
  "history_output" : "Skipped",
  "history_begin_time" : 1720812753716,
  "history_end_time" : 1720812753716,
  "history_notes" : null,
  "history_process" : "w4lpt8",
  "host_id" : "100001",
  "indicator" : "Skipped"
},{
  "history_id" : "9041txy79v1",
  "history_input" : "No code saved",
  "history_output" : "Skipped",
  "history_begin_time" : 1720812753717,
  "history_end_time" : 1720812753717,
  "history_notes" : null,
  "history_process" : "521ngk",
  "host_id" : "100001",
  "indicator" : "Skipped"
},{
  "history_id" : "klmkpkmtc6x",
  "history_input" : "No code saved",
  "history_output" : "Skipped",
  "history_begin_time" : 1720812753718,
  "history_end_time" : 1720812753718,
  "history_notes" : null,
  "history_process" : "x8kqk7",
  "host_id" : "100001",
  "indicator" : "Skipped"
},{
  "history_id" : "91ggv6io3og",
  "history_input" : "No code saved",
  "history_output" : "Skipped",
  "history_begin_time" : 1720812753718,
  "history_end_time" : 1720812753718,
  "history_notes" : null,
  "history_process" : "wjq4fr",
  "host_id" : "100001",
  "indicator" : "Skipped"
},{
  "history_id" : "1k3talvlhur",
  "history_input" : "No code saved",
  "history_output" : "Skipped",
  "history_begin_time" : 1720812753720,
  "history_end_time" : 1720812753720,
  "history_notes" : null,
  "history_process" : "l4eb73",
  "host_id" : "100001",
  "indicator" : "Skipped"
},{
  "history_id" : "bthi9owyhju",
  "history_input" : "No code saved",
  "history_output" : "Skipped",
  "history_begin_time" : 1720812753720,
  "history_end_time" : 1720812753720,
  "history_notes" : null,
  "history_process" : "pv7d8l",
  "host_id" : "100001",
  "indicator" : "Skipped"
},{
  "history_id" : "jtr0yoevqmx",
  "history_input" : "No code saved",
  "history_output" : "Skipped",
  "history_begin_time" : 1720812753720,
  "history_end_time" : 1720812753720,
  "history_notes" : null,
  "history_process" : "xku47i",
  "host_id" : "100001",
  "indicator" : "Skipped"
},{
  "history_id" : "5jbrt6znbyr",
  "history_input" : null,
  "history_output" : null,
  "history_begin_time" : null,
  "history_end_time" : 1720814717255,
  "history_notes" : null,
  "history_process" : "dp0hiw",
  "host_id" : "100001",
  "indicator" : "Stopped"
},{
  "history_id" : "qg1p3b426t1",
  "history_input" : null,
  "history_output" : null,
  "history_begin_time" : null,
  "history_end_time" : 1720814717266,
  "history_notes" : null,
  "history_process" : "b3cx6j",
  "host_id" : "100001",
  "indicator" : "Stopped"
},{
  "history_id" : "4pvk8x6bei2",
  "history_input" : "No code saved",
  "history_output" : "Skipped",
  "history_begin_time" : 1720812753725,
  "history_end_time" : 1720812753725,
  "history_notes" : null,
  "history_process" : "k84mqm",
  "host_id" : "100001",
  "indicator" : "Skipped"
},{
  "history_id" : "50lutl24lgw",
  "history_input" : "#!/bin/bash\n\necho \"start to run fc_model_predict_2weeks.sh\"\npwd\n\n# clean up the old log\n> /home/zsun/fc_model_predict_2weeks.out\n> /home/zsun/fc_model_predict_2weeks.err\n\n# Specify the name of the script you want to submit\nSCRIPT_NAME=\"fc_model_predict_2weeks_slurm_generated.sh\"\necho \"write the slurm script into ${SCRIPT_NAME}\"\ncat > ${SCRIPT_NAME} << EOF\n#!/bin/bash\n#SBATCH -J fc_model_predict_2weeks       # Job name\n#SBATCH --qos=qtong             #\n#SBATCH --partition=contrib     # partition (queue): debug, interactive, contrib, normal, orc-test\n#SBATCH --time=24:00:00         # walltime\n#SBATCH --nodes=1               # Number of nodes I want to use, max is 15 for lin-group, each node has 48 cores\n#SBATCH --ntasks-per-node=12    # Number of MPI tasks, multiply number of nodes with cores per node. 2*48=96\n#SBATCH --mail-user=zsun@gmu.edu    #Email account\n#SBATCH --mail-type=FAIL           #When to email\n#SBATCH --mem=20G\n#SBATCH --cores-per-socket=8\n#SBATCH --output=/scratch/%u/%x-%N-%j.out  # Output file`\n#SBATCH --error=/scratch/%u/%x-%N-%j.err   # Error file`\n\n\n# Activate your customized virtual environment\nsource /home/zsun/anaconda3/bin/activate\n\n# Call the Python script using process substitution\npython -u << INNER_EOF\n\nfrom fc_model_predict_2weeks import predict_2weeks\n\nstart_date = \"20210701\"\nend_date = \"20210831\"\n\npredict_2weeks(start_date, end_date)\n\n\nINNER_EOF\n\nEOF\n\n# Submit the Slurm job and wait for it to finish\necho \"sbatch ${SCRIPT_NAME}\"\n# should have another check. if there is another job running, should cancel it before submitting a new job.\n\n# Find and cancel existing running jobs with the same script name\n#existing_jobs=$(squeue -h -o \"%A %j\" -u $(whoami) | awk -v script=\"$SCRIPT_NAME\" '$2 == script {print $1}')\n\n# if [ -n \"$existing_jobs\" ]; then\n#     echo \"Canceling existing jobs with the script name '$SCRIPT_NAME'...\"\n#     for job_id in $existing_jobs; do\n#         scancel $job_id\n#     done\n# else\n#     echo \"No existing jobs with the script name '$SCRIPT_NAME' found.\"\n# fi\n\n# Submit the Slurm job\njob_id=$(sbatch ${SCRIPT_NAME} | awk '{print $4}')\necho \"job_id=\"${job_id}\n\nif [ -z \"${job_id}\" ]; then\n    echo \"job id is empty. something wrong with the slurm job submission.\"\n    exit 1\nfi\n\n# Wait for the Slurm job to finish\nfile_name=$(find /scratch/zsun -name '*'${job_id}'.out' -print -quit)\nprevious_content=$(cat file_name)\nexit_code=0\nwhile true; do\n    # Capture the current content\\\n    #echo ${job_id}\n    file_name=$(find /scratch/zsun -name '*'${job_id}'.out' -print -quit)\n    #echo \"file_name=\"$file_name\n    current_content=$(<\"${file_name}\")\n    #echo \"current_content = \"$current_content\n\n    # Compare current content with previous content\n    diff_result=$(diff <(echo \"$previous_content\") <(echo \"$current_content\"))\n    # Check if there is new content\n    if [ -n \"$diff_result\" ]; then\n        # Print the newly added content\n        #echo \"New content added:\"\n        echo \"$diff_result\"\n        #echo \"---------------------\"\n    fi\n    # Update previous content\n    previous_content=\"$current_content\"\n\n\n    job_status=$(scontrol show job ${job_id} | awk '/JobState=/{print $1}')\n    #echo \"job_status \"$job_status\n    #if [[ $job_status == \"JobState=COMPLETED\" ]]; then\n    #    break\n    #fi\n    if [[ $job_status == *\"COMPLETED\"* ]]; then\n        echo \"Job $job_id has finished with state: $job_status\"\n        break;\n    elif [[ $job_status == *\"CANCELLED\"* || $job_status == *\"FAILED\"* || $job_status == *\"TIMEOUT\"* || $job_status == *\"NODE_FAIL\"* || $job_status == *\"PREEMPTED\"* || $job_status == *\"OUT_OF_MEMORY\"* ]]; then\n        echo \"Job $job_id has finished with state: $job_status\"\n        exit_code=1\n        break;\n    fi\n    sleep 10  # Adjust the sleep interval as needed\ndone\n\necho \"Slurm job ($job_id) has finished.\"\n\necho \"Print the job's output logs\"\nsacct --format=JobID,JobName,State,ExitCode,MaxRSS,Start,End -j $job_id\nfind /scratch/zsun/ -type f -name \"*${job_id}.out\" -exec cat {} \\;\ncat /scratch/zsun/test_data_slurm-*-$job_id.out\n\necho \"All slurm job for ${SCRIPT_NAME} finishes.\"\n\nexit $exit_code\n",
  "history_output" : "start to run fc_model_predict_2weeks.sh\n/home/zsun/gw-workspace/50lutl24lgw\nwrite the slurm script into fc_model_predict_2weeks_slurm_generated.sh\nsbatch fc_model_predict_2weeks_slurm_generated.sh\njob_id=2042501\ncat: file_name: No such file or directory\n/home/zsun/gw-workspace/50lutl24lgw/gw-EeCxhWXimtRSaSOTgCRV9PaCFx-50lutl24lgw.sh: line 81: : No such file or directory\n1c1,6\n< \n---\n> /home/zsun/anaconda3/lib/python3.8/site-packages/dask/dataframe/utils.py:367: FutureWarning: pandas.Int64Index is deprecated and will be removed from pandas in a future version. Use pandas.Index with the appropriate dtype instead.\n>   _numeric_index_types = (pd.Int64Index, pd.Float64Index, pd.UInt64Index)\n> /home/zsun/anaconda3/lib/python3.8/site-packages/dask/dataframe/utils.py:367: FutureWarning: pandas.Float64Index is deprecated and will be removed from pandas in a future version. Use pandas.Index with the appropriate dtype instead.\n>   _numeric_index_types = (pd.Int64Index, pd.Float64Index, pd.UInt64Index)\n> /home/zsun/anaconda3/lib/python3.8/site-packages/dask/dataframe/utils.py:367: FutureWarning: pandas.UInt64Index is deprecated and will be removed from pandas in a future version. Use pandas.Index with the appropriate dtype instead.\n>   _numeric_index_types = (pd.Int64Index, pd.Float64Index, pd.UInt64Index)\n6a7,33\n> the model in use is /groups/ESS3/zsun/firecasting/model/fc_tabnet_model_v1_latest.pkl.zip\n> /home/zsun/anaconda3/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:82: UserWarning: Device used : cpu\n>   warnings.warn(f\"Device used : {self.device}\")\n> current date:  2021-07-01 00:00:00\n> single_day_current_date =  2021-07-01 00:00:00\n> single_day_predict_end_date =  2021-07-08 00:00:00\n> predicting:  20210701\n> Read from original folder for current date: 20210701\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210701.txt\n> reading past files for 2021-06-30 00:00:00\n> reading from original folder\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210630.txt\n> reading past files for 2021-06-29 00:00:00\n> reading from original folder\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210629.txt\n> reading past files for 2021-06-28 00:00:00\n> reading from original folder\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210628.txt\n> reading past files for 2021-06-27 00:00:00\n> reading from original folder\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210627.txt\n> reading past files for 2021-06-26 00:00:00\n> reading from original folder\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210626.txt\n> reading past files for 2021-06-25 00:00:00\n> reading from original folder\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210625.txt\n33a34,67\n> reading past files for 2021-06-24 00:00:00\n> reading from original folder\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210624.txt\n> New time series dataframe:      LAT         LON    FRP  ...  VPD_7_days_ago   P_7_days_ago  FRP_7_days_ago\n> 0  24.5 -126.000000 -999.0  ...          -999.0  101879.484375          -999.0\n> 1  24.5 -125.899994 -999.0  ...          -999.0  101879.484375          -999.0\n> 2  24.5 -125.800003 -999.0  ...          -999.0  101873.890625          -999.0\n> 3  24.5 -125.699997 -999.0  ...          -999.0  101873.890625          -999.0\n> 4  24.5 -125.599998 -999.0  ...          -999.0  101867.890625          -999.0\n> \n> [5 rows x 74 columns]\n> Original df is created:  (156861, 74)\n> Original df filled the na with -9999 \n> X and y are loaded into memory for 20210701\n> the loaded model is:  TabNetRegressor(n_d=17, n_a=41, n_steps=4, gamma=1.1546672563068268, cat_idxs=[], cat_dims=[], cat_emb_dim=[], n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.00042602006758391, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=71, output_dim=1, device_name='auto', n_shared_decoder=1, n_indep_decoder=1, grouped_features=[])\n> Loaded model is a TabNet model.\n> Prediction for 20210701 of start day 20210701 is finished\n> new columns to check:  ['FRP_1_days_ago', 'Nearest_1', 'Nearest_2', 'Nearest_3', 'Nearest_4', 'Nearest_5', 'Nearest_6', 'Nearest_7', 'Nearest_8']\n> current merged_df columns:  Index(['FWI', 'VPD', 'HT', 'T', 'RH', 'U', 'V', 'P', 'RAIN', 'CAPE', 'ST',\n>        'SM', 'Nearest_1', 'Nearest_2', 'Nearest_3', 'Nearest_4', 'Nearest_5',\n>        'Nearest_6', 'Nearest_7', 'Nearest_8', 'Nearest_9', 'Nearest_10',\n>        'Nearest_11', 'Nearest_12', 'Nearest_13', 'Nearest_14', 'Nearest_15',\n>        'Nearest_16', 'Nearest_17', 'Nearest_18', 'Nearest_19', 'Nearest_20',\n>        'Nearest_21', 'Nearest_22', 'Nearest_23', 'Nearest_24', 'Land_Use',\n>        'VCI_AVE', 'TCI_AVE', 'VHI_AVE', 'VCI_TOT', 'TCI_TOT', 'VHI_TOT',\n>        'FWI_1_days_ago', 'VPD_1_days_ago', 'P_1_days_ago', 'FRP_1_days_ago',\n>        'FWI_2_days_ago', 'VPD_2_days_ago', 'P_2_days_ago', 'FRP_2_days_ago',\n>        'FWI_3_days_ago', 'VPD_3_days_ago', 'P_3_days_ago', 'FRP_3_days_ago',\n>        'FWI_4_days_ago', 'VPD_4_days_ago', 'P_4_days_ago', 'FRP_4_days_ago',\n>        'FWI_5_days_ago', 'VPD_5_days_ago', 'P_5_days_ago', 'FRP_5_days_ago',\n>        'FWI_6_days_ago', 'VPD_6_days_ago', 'P_6_days_ago', 'FRP_6_days_ago',\n>        'FWI_7_days_ago', 'VPD_7_days_ago', 'P_7_days_ago', 'FRP_7_days_ago',\n>        'Predicted_FRP'],\n>       dtype='object')\n67a68,116\n> Prediction results are saved to /groups/ESS3/zsun/firecasting/data/output/output_tabnet_window_7_days_forecasting_with_new_yunyao_window_time_series_landuse_vhi_latlon//20210701/firedata_20210701_predicted.txt\n> ['Mean Absolute Error (MAE): 21.924801736676713', 'Mean Squared Error (MSE): 21908.046918238004', 'Root Mean Squared Error (RMSE): 148.01367138963212', 'R-squared (R2) Score: -0.022151944494863907', 'Explained Variance Score: 8.072396029401574e-07', 'Median Absolute Error (MedAE): 0.0', 'Max Error: 2366.392403045167', 'Mean: -21.78996688754375', 'Median: 0.0', 'Standard Deviation: 146.40148634334543', 'Minimum: -999.0', 'Maximum: 2366.637939', 'Count: 156861']\n> Metrics saved to /groups/ESS3/zsun/firecasting/data/output/output_tabnet_window_7_days_forecasting_with_new_yunyao_window_time_series_landuse_vhi_latlon//20210701/metrics_20210701_predicted.txt\n> predicting:  20210702\n> Read from original folder for current date: 20210702\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210702.txt\n> reading past files for 2021-07-01 00:00:00\n> reading from predicted folder\n> current final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n> 0 -999.0 -999.0  0.0  ...  101879.484375          -999.0            0.0\n> 1 -999.0 -999.0  0.0  ...  101879.484375          -999.0            0.0\n> 2 -999.0 -999.0  0.0  ...  101873.890625          -999.0            0.0\n> 3 -999.0 -999.0  0.0  ...  101873.890625          -999.0            0.0\n> 4 -999.0 -999.0  0.0  ...  101867.890625          -999.0            0.0\n> \n> [5 rows x 72 columns]\n> renaming Predicted_FRP to FRP\n> remove the current predicted_frp\n> reading past files for 2021-06-30 00:00:00\n> reading from original folder\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210630.txt\n> reading past files for 2021-06-29 00:00:00\n> reading from original folder\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210629.txt\n> reading past files for 2021-06-28 00:00:00\n> reading from original folder\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210628.txt\n> reading past files for 2021-06-27 00:00:00\n> reading from original folder\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210627.txt\n> reading past files for 2021-06-26 00:00:00\n> reading from original folder\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210626.txt\n> reading past files for 2021-06-25 00:00:00\n> reading from original folder\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210625.txt\n> New time series dataframe:      LAT         LON    FRP  ...  VPD_7_days_ago   P_7_days_ago  FRP_7_days_ago\n> 0  24.5 -126.000000 -999.0  ...          -999.0  101861.375000          -999.0\n> 1  24.5 -125.899994 -999.0  ...          -999.0  101861.375000          -999.0\n> 2  24.5 -125.800003 -999.0  ...          -999.0  101853.773438          -999.0\n> 3  24.5 -125.699997 -999.0  ...          -999.0  101853.773438          -999.0\n> 4  24.5 -125.599998 -999.0  ...          -999.0  101844.171875          -999.0\n> \n> [5 rows x 74 columns]\n> Original df is created:  (156861, 74)\n> Original df filled the na with -9999 \n> X and y are loaded into memory for 20210702\n> the loaded model is:  TabNetRegressor(n_d=17, n_a=41, n_steps=4, gamma=1.1546672563068268, cat_idxs=[], cat_dims=[], cat_emb_dim=[], n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.00042602006758391, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=71, output_dim=1, device_name='auto', n_shared_decoder=1, n_indep_decoder=1, grouped_features=[])\n> Loaded model is a TabNet model.\n116a117,134\n> Prediction for 20210702 of start day 20210701 is finished\n> new columns to check:  ['FRP_1_days_ago', 'Nearest_1', 'Nearest_2', 'Nearest_3', 'Nearest_4', 'Nearest_5', 'Nearest_6', 'Nearest_7', 'Nearest_8']\n> current merged_df columns:  Index(['FWI', 'VPD', 'HT', 'T', 'RH', 'U', 'V', 'P', 'RAIN', 'CAPE', 'ST',\n>        'SM', 'Nearest_1', 'Nearest_2', 'Nearest_3', 'Nearest_4', 'Nearest_5',\n>        'Nearest_6', 'Nearest_7', 'Nearest_8', 'Nearest_9', 'Nearest_10',\n>        'Nearest_11', 'Nearest_12', 'Nearest_13', 'Nearest_14', 'Nearest_15',\n>        'Nearest_16', 'Nearest_17', 'Nearest_18', 'Nearest_19', 'Nearest_20',\n>        'Nearest_21', 'Nearest_22', 'Nearest_23', 'Nearest_24', 'Land_Use',\n>        'VCI_AVE', 'TCI_AVE', 'VHI_AVE', 'VCI_TOT', 'TCI_TOT', 'VHI_TOT',\n>        'FWI_1_days_ago', 'VPD_1_days_ago', 'P_1_days_ago', 'FRP_1_days_ago',\n>        'FWI_2_days_ago', 'VPD_2_days_ago', 'P_2_days_ago', 'FRP_2_days_ago',\n>        'FWI_3_days_ago', 'VPD_3_days_ago', 'P_3_days_ago', 'FRP_3_days_ago',\n>        'FWI_4_days_ago', 'VPD_4_days_ago', 'P_4_days_ago', 'FRP_4_days_ago',\n>        'FWI_5_days_ago', 'VPD_5_days_ago', 'P_5_days_ago', 'FRP_5_days_ago',\n>        'FWI_6_days_ago', 'VPD_6_days_ago', 'P_6_days_ago', 'FRP_6_days_ago',\n>        'FWI_7_days_ago', 'VPD_7_days_ago', 'P_7_days_ago', 'FRP_7_days_ago',\n>        'Predicted_FRP'],\n>       dtype='object')\n134a135,176\n> Prediction results are saved to /groups/ESS3/zsun/firecasting/data/output/output_tabnet_window_7_days_forecasting_with_new_yunyao_window_time_series_landuse_vhi_latlon//20210701/firedata_20210702_predicted.txt\n> ['Mean Absolute Error (MAE): 21.878395609157476', 'Mean Squared Error (MSE): 21840.908165086676', 'Root Mean Squared Error (RMSE): 147.78669820077405', 'R-squared (R2) Score: -0.02231900468152559', 'Explained Variance Score: 2.648734451771162e-07', 'Median Absolute Error (MedAE): 0.0', 'Max Error: 999.0', 'Mean: -21.836369149265913', 'Median: 0.0', 'Standard Deviation: 146.16504128154463', 'Minimum: -999.0', 'Maximum: 639.787903', 'Count: 156861']\n> Metrics saved to /groups/ESS3/zsun/firecasting/data/output/output_tabnet_window_7_days_forecasting_with_new_yunyao_window_time_series_landuse_vhi_latlon//20210701/metrics_20210702_predicted.txt\n> predicting:  20210703\n> Read from original folder for current date: 20210703\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210703.txt\n> reading past files for 2021-07-02 00:00:00\n> reading from predicted folder\n> current final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n> 0 -999.0 -999.0  0.0  ...  101861.375000          -999.0            0.0\n> 1 -999.0 -999.0  0.0  ...  101861.375000          -999.0            0.0\n> 2 -999.0 -999.0  0.0  ...  101853.773438          -999.0            0.0\n> 3 -999.0 -999.0  0.0  ...  101853.773438          -999.0            0.0\n> 4 -999.0 -999.0  0.0  ...  101844.171875          -999.0            0.0\n> \n> [5 rows x 72 columns]\n> renaming Predicted_FRP to FRP\n> remove the current predicted_frp\n> reading past files for 2021-07-01 00:00:00\n> reading from predicted folder\n> current final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n> 0 -999.0 -999.0  0.0  ...  101879.484375          -999.0            0.0\n> 1 -999.0 -999.0  0.0  ...  101879.484375          -999.0            0.0\n> 2 -999.0 -999.0  0.0  ...  101873.890625          -999.0            0.0\n> 3 -999.0 -999.0  0.0  ...  101873.890625          -999.0            0.0\n> 4 -999.0 -999.0  0.0  ...  101867.890625          -999.0            0.0\n> \n> [5 rows x 72 columns]\n> renaming Predicted_FRP to FRP\n> remove the current predicted_frp\n> reading past files for 2021-06-30 00:00:00\n> reading from original folder\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210630.txt\n> reading past files for 2021-06-29 00:00:00\n> reading from original folder\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210629.txt\n> reading past files for 2021-06-28 00:00:00\n> reading from original folder\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210628.txt\n> reading past files for 2021-06-27 00:00:00\n> reading from original folder\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210627.txt\n176a177,210\n> reading past files for 2021-06-26 00:00:00\n> reading from original folder\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210626.txt\n> New time series dataframe:      LAT         LON    FRP  ...  VPD_7_days_ago   P_7_days_ago  FRP_7_days_ago\n> 0  24.5 -126.000000 -999.0  ...          -999.0  101701.023438          -999.0\n> 1  24.5 -125.899994 -999.0  ...          -999.0  101701.023438          -999.0\n> 2  24.5 -125.800003 -999.0  ...          -999.0  101689.023438          -999.0\n> 3  24.5 -125.699997 -999.0  ...          -999.0  101689.023438          -999.0\n> 4  24.5 -125.599998 -999.0  ...          -999.0  101676.625000          -999.0\n> \n> [5 rows x 74 columns]\n> Original df is created:  (156861, 74)\n> Original df filled the na with -9999 \n> X and y are loaded into memory for 20210703\n> the loaded model is:  TabNetRegressor(n_d=17, n_a=41, n_steps=4, gamma=1.1546672563068268, cat_idxs=[], cat_dims=[], cat_emb_dim=[], n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.00042602006758391, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=71, output_dim=1, device_name='auto', n_shared_decoder=1, n_indep_decoder=1, grouped_features=[])\n> Loaded model is a TabNet model.\n> Prediction for 20210703 of start day 20210701 is finished\n> new columns to check:  ['FRP_1_days_ago', 'Nearest_1', 'Nearest_2', 'Nearest_3', 'Nearest_4', 'Nearest_5', 'Nearest_6', 'Nearest_7', 'Nearest_8']\n> current merged_df columns:  Index(['FWI', 'VPD', 'HT', 'T', 'RH', 'U', 'V', 'P', 'RAIN', 'CAPE', 'ST',\n>        'SM', 'Nearest_1', 'Nearest_2', 'Nearest_3', 'Nearest_4', 'Nearest_5',\n>        'Nearest_6', 'Nearest_7', 'Nearest_8', 'Nearest_9', 'Nearest_10',\n>        'Nearest_11', 'Nearest_12', 'Nearest_13', 'Nearest_14', 'Nearest_15',\n>        'Nearest_16', 'Nearest_17', 'Nearest_18', 'Nearest_19', 'Nearest_20',\n>        'Nearest_21', 'Nearest_22', 'Nearest_23', 'Nearest_24', 'Land_Use',\n>        'VCI_AVE', 'TCI_AVE', 'VHI_AVE', 'VCI_TOT', 'TCI_TOT', 'VHI_TOT',\n>        'FWI_1_days_ago', 'VPD_1_days_ago', 'P_1_days_ago', 'FRP_1_days_ago',\n>        'FWI_2_days_ago', 'VPD_2_days_ago', 'P_2_days_ago', 'FRP_2_days_ago',\n>        'FWI_3_days_ago', 'VPD_3_days_ago', 'P_3_days_ago', 'FRP_3_days_ago',\n>        'FWI_4_days_ago', 'VPD_4_days_ago', 'P_4_days_ago', 'FRP_4_days_ago',\n>        'FWI_5_days_ago', 'VPD_5_days_ago', 'P_5_days_ago', 'FRP_5_days_ago',\n>        'FWI_6_days_ago', 'VPD_6_days_ago', 'P_6_days_ago', 'FRP_6_days_ago',\n>        'FWI_7_days_ago', 'VPD_7_days_ago', 'P_7_days_ago', 'FRP_7_days_ago',\n>        'Predicted_FRP'],\n>       dtype='object')\n210a211,277\n> Prediction results are saved to /groups/ESS3/zsun/firecasting/data/output/output_tabnet_window_7_days_forecasting_with_new_yunyao_window_time_series_landuse_vhi_latlon//20210701/firedata_20210703_predicted.txt\n> ['Mean Absolute Error (MAE): 21.894034137598595', 'Mean Squared Error (MSE): 21850.512678440944', 'Root Mean Squared Error (RMSE): 147.8191891414675', 'R-squared (R2) Score: -0.022276170930274786', 'Explained Variance Score: 5.933651832101816e-07', 'Median Absolute Error (MedAE): 0.0', 'Max Error: 1241.735596', 'Mean: -21.820777627262355', 'Median: 0.0', 'Standard Deviation: 146.20023852683786', 'Minimum: -999.0', 'Maximum: 1241.735596', 'Count: 156861']\n> Metrics saved to /groups/ESS3/zsun/firecasting/data/output/output_tabnet_window_7_days_forecasting_with_new_yunyao_window_time_series_landuse_vhi_latlon//20210701/metrics_20210703_predicted.txt\n> predicting:  20210704\n> Read from original folder for current date: 20210704\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210704.txt\n> reading past files for 2021-07-03 00:00:00\n> reading from predicted folder\n> current final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n> 0 -999.0 -999.0  0.0  ...  101701.023438          -999.0            0.0\n> 1 -999.0 -999.0  0.0  ...  101701.023438          -999.0            0.0\n> 2 -999.0 -999.0  0.0  ...  101689.023438          -999.0            0.0\n> 3 -999.0 -999.0  0.0  ...  101689.023438          -999.0            0.0\n> 4 -999.0 -999.0  0.0  ...  101676.625000          -999.0            0.0\n> \n> [5 rows x 72 columns]\n> renaming Predicted_FRP to FRP\n> remove the current predicted_frp\n> reading past files for 2021-07-02 00:00:00\n> reading from predicted folder\n> current final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n> 0 -999.0 -999.0  0.0  ...  101861.375000          -999.0            0.0\n> 1 -999.0 -999.0  0.0  ...  101861.375000          -999.0            0.0\n> 2 -999.0 -999.0  0.0  ...  101853.773438          -999.0            0.0\n> 3 -999.0 -999.0  0.0  ...  101853.773438          -999.0            0.0\n> 4 -999.0 -999.0  0.0  ...  101844.171875          -999.0            0.0\n> \n> [5 rows x 72 columns]\n> renaming Predicted_FRP to FRP\n> remove the current predicted_frp\n> reading past files for 2021-07-01 00:00:00\n> reading from predicted folder\n> current final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n> 0 -999.0 -999.0  0.0  ...  101879.484375          -999.0            0.0\n> 1 -999.0 -999.0  0.0  ...  101879.484375          -999.0            0.0\n> 2 -999.0 -999.0  0.0  ...  101873.890625          -999.0            0.0\n> 3 -999.0 -999.0  0.0  ...  101873.890625          -999.0            0.0\n> 4 -999.0 -999.0  0.0  ...  101867.890625          -999.0            0.0\n> \n> [5 rows x 72 columns]\n> renaming Predicted_FRP to FRP\n> remove the current predicted_frp\n> reading past files for 2021-06-30 00:00:00\n> reading from original folder\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210630.txt\n> reading past files for 2021-06-29 00:00:00\n> reading from original folder\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210629.txt\n> reading past files for 2021-06-28 00:00:00\n> reading from original folder\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210628.txt\n> reading past files for 2021-06-27 00:00:00\n> reading from original folder\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210627.txt\n> New time series dataframe:      LAT         LON    FRP  ...  VPD_7_days_ago   P_7_days_ago  FRP_7_days_ago\n> 0  24.5 -126.000000 -999.0  ...          -999.0  101521.437500          -999.0\n> 1  24.5 -125.899994 -999.0  ...          -999.0  101521.437500          -999.0\n> 2  24.5 -125.800003 -999.0  ...          -999.0  101507.437500          -999.0\n> 3  24.5 -125.699997 -999.0  ...          -999.0  101507.437500          -999.0\n> 4  24.5 -125.599998 -999.0  ...          -999.0  101494.640625          -999.0\n> \n> [5 rows x 74 columns]\n> Original df is created:  (156861, 74)\n> Original df filled the na with -9999 \n> X and y are loaded into memory for 20210704\n> the loaded model is:  TabNetRegressor(n_d=17, n_a=41, n_steps=4, gamma=1.1546672563068268, cat_idxs=[], cat_dims=[], cat_emb_dim=[], n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.00042602006758391, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=71, output_dim=1, device_name='auto', n_shared_decoder=1, n_indep_decoder=1, grouped_features=[])\n> Loaded model is a TabNet model.\n277a278,295\n> Prediction for 20210704 of start day 20210701 is finished\n> new columns to check:  ['FRP_1_days_ago', 'Nearest_1', 'Nearest_2', 'Nearest_3', 'Nearest_4', 'Nearest_5', 'Nearest_6', 'Nearest_7', 'Nearest_8']\n> current merged_df columns:  Index(['FWI', 'VPD', 'HT', 'T', 'RH', 'U', 'V', 'P', 'RAIN', 'CAPE', 'ST',\n>        'SM', 'Nearest_1', 'Nearest_2', 'Nearest_3', 'Nearest_4', 'Nearest_5',\n>        'Nearest_6', 'Nearest_7', 'Nearest_8', 'Nearest_9', 'Nearest_10',\n>        'Nearest_11', 'Nearest_12', 'Nearest_13', 'Nearest_14', 'Nearest_15',\n>        'Nearest_16', 'Nearest_17', 'Nearest_18', 'Nearest_19', 'Nearest_20',\n>        'Nearest_21', 'Nearest_22', 'Nearest_23', 'Nearest_24', 'Land_Use',\n>        'VCI_AVE', 'TCI_AVE', 'VHI_AVE', 'VCI_TOT', 'TCI_TOT', 'VHI_TOT',\n>        'FWI_1_days_ago', 'VPD_1_days_ago', 'P_1_days_ago', 'FRP_1_days_ago',\n>        'FWI_2_days_ago', 'VPD_2_days_ago', 'P_2_days_ago', 'FRP_2_days_ago',\n>        'FWI_3_days_ago', 'VPD_3_days_ago', 'P_3_days_ago', 'FRP_3_days_ago',\n>        'FWI_4_days_ago', 'VPD_4_days_ago', 'P_4_days_ago', 'FRP_4_days_ago',\n>        'FWI_5_days_ago', 'VPD_5_days_ago', 'P_5_days_ago', 'FRP_5_days_ago',\n>        'FWI_6_days_ago', 'VPD_6_days_ago', 'P_6_days_ago', 'FRP_6_days_ago',\n>        'FWI_7_days_ago', 'VPD_7_days_ago', 'P_7_days_ago', 'FRP_7_days_ago',\n>        'Predicted_FRP'],\n>       dtype='object')\n295a296,352\n> Prediction results are saved to /groups/ESS3/zsun/firecasting/data/output/output_tabnet_window_7_days_forecasting_with_new_yunyao_window_time_series_landuse_vhi_latlon//20210701/firedata_20210704_predicted.txt\n> ['Mean Absolute Error (MAE): 21.89682939741859', 'Mean Squared Error (MSE): 21857.45495846014', 'Root Mean Squared Error (RMSE): 147.84266961354606', 'R-squared (R2) Score: -0.02226336989362232', 'Explained Variance Score: 4.1125496874627743e-07', 'Median Absolute Error (MedAE): 0.0', 'Max Error: 1181.0896852640576', 'Mean: -21.818007558577342', 'Median: 0.0', 'Standard Deviation: 146.2243773555253', 'Minimum: -999.0', 'Maximum: 1181.141357', 'Count: 156861']\n> Metrics saved to /groups/ESS3/zsun/firecasting/data/output/output_tabnet_window_7_days_forecasting_with_new_yunyao_window_time_series_landuse_vhi_latlon//20210701/metrics_20210704_predicted.txt\n> predicting:  20210705\n> Read from original folder for current date: 20210705\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210705.txt\n> reading past files for 2021-07-04 00:00:00\n> reading from predicted folder\n> current final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n> 0 -999.0 -999.0  0.0  ...  101521.437500          -999.0            0.0\n> 1 -999.0 -999.0  0.0  ...  101521.437500          -999.0            0.0\n> 2 -999.0 -999.0  0.0  ...  101507.437500          -999.0            0.0\n> 3 -999.0 -999.0  0.0  ...  101507.437500          -999.0            0.0\n> 4 -999.0 -999.0  0.0  ...  101494.640625          -999.0            0.0\n> \n> [5 rows x 72 columns]\n> renaming Predicted_FRP to FRP\n> remove the current predicted_frp\n> reading past files for 2021-07-03 00:00:00\n> reading from predicted folder\n> current final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n> 0 -999.0 -999.0  0.0  ...  101701.023438          -999.0            0.0\n> 1 -999.0 -999.0  0.0  ...  101701.023438          -999.0            0.0\n> 2 -999.0 -999.0  0.0  ...  101689.023438          -999.0            0.0\n> 3 -999.0 -999.0  0.0  ...  101689.023438          -999.0            0.0\n> 4 -999.0 -999.0  0.0  ...  101676.625000          -999.0            0.0\n> \n> [5 rows x 72 columns]\n> renaming Predicted_FRP to FRP\n> remove the current predicted_frp\n> reading past files for 2021-07-02 00:00:00\n> reading from predicted folder\n> current final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n> 0 -999.0 -999.0  0.0  ...  101861.375000          -999.0            0.0\n> 1 -999.0 -999.0  0.0  ...  101861.375000          -999.0            0.0\n> 2 -999.0 -999.0  0.0  ...  101853.773438          -999.0            0.0\n> 3 -999.0 -999.0  0.0  ...  101853.773438          -999.0            0.0\n> 4 -999.0 -999.0  0.0  ...  101844.171875          -999.0            0.0\n> \n> [5 rows x 72 columns]\n> renaming Predicted_FRP to FRP\n> remove the current predicted_frp\n> reading past files for 2021-07-01 00:00:00\n> reading from predicted folder\n> current final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n> 0 -999.0 -999.0  0.0  ...  101879.484375          -999.0            0.0\n> 1 -999.0 -999.0  0.0  ...  101879.484375          -999.0            0.0\n> 2 -999.0 -999.0  0.0  ...  101873.890625          -999.0            0.0\n> 3 -999.0 -999.0  0.0  ...  101873.890625          -999.0            0.0\n> 4 -999.0 -999.0  0.0  ...  101867.890625          -999.0            0.0\n> \n> [5 rows x 72 columns]\n> renaming Predicted_FRP to FRP\n> remove the current predicted_frp\n> reading past files for 2021-06-30 00:00:00\n> reading from original folder\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210630.txt\n352a353,389\n> reading past files for 2021-06-29 00:00:00\n> reading from original folder\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210629.txt\n> reading past files for 2021-06-28 00:00:00\n> reading from original folder\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210628.txt\n> New time series dataframe:      LAT         LON    FRP  ...  VPD_7_days_ago   P_7_days_ago  FRP_7_days_ago\n> 0  24.5 -126.000000 -999.0  ...          -999.0  101352.601562          -999.0\n> 1  24.5 -125.899994 -999.0  ...          -999.0  101352.601562          -999.0\n> 2  24.5 -125.800003 -999.0  ...          -999.0  101336.601562          -999.0\n> 3  24.5 -125.699997 -999.0  ...          -999.0  101336.601562          -999.0\n> 4  24.5 -125.599998 -999.0  ...          -999.0  101320.203125          -999.0\n> \n> [5 rows x 74 columns]\n> Original df is created:  (156861, 74)\n> Original df filled the na with -9999 \n> X and y are loaded into memory for 20210705\n> the loaded model is:  TabNetRegressor(n_d=17, n_a=41, n_steps=4, gamma=1.1546672563068268, cat_idxs=[], cat_dims=[], cat_emb_dim=[], n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.00042602006758391, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=71, output_dim=1, device_name='auto', n_shared_decoder=1, n_indep_decoder=1, grouped_features=[])\n> Loaded model is a TabNet model.\n> Prediction for 20210705 of start day 20210701 is finished\n> new columns to check:  ['FRP_1_days_ago', 'Nearest_1', 'Nearest_2', 'Nearest_3', 'Nearest_4', 'Nearest_5', 'Nearest_6', 'Nearest_7', 'Nearest_8']\n> current merged_df columns:  Index(['FWI', 'VPD', 'HT', 'T', 'RH', 'U', 'V', 'P', 'RAIN', 'CAPE', 'ST',\n>        'SM', 'Nearest_1', 'Nearest_2', 'Nearest_3', 'Nearest_4', 'Nearest_5',\n>        'Nearest_6', 'Nearest_7', 'Nearest_8', 'Nearest_9', 'Nearest_10',\n>        'Nearest_11', 'Nearest_12', 'Nearest_13', 'Nearest_14', 'Nearest_15',\n>        'Nearest_16', 'Nearest_17', 'Nearest_18', 'Nearest_19', 'Nearest_20',\n>        'Nearest_21', 'Nearest_22', 'Nearest_23', 'Nearest_24', 'Land_Use',\n>        'VCI_AVE', 'TCI_AVE', 'VHI_AVE', 'VCI_TOT', 'TCI_TOT', 'VHI_TOT',\n>        'FWI_1_days_ago', 'VPD_1_days_ago', 'P_1_days_ago', 'FRP_1_days_ago',\n>        'FWI_2_days_ago', 'VPD_2_days_ago', 'P_2_days_ago', 'FRP_2_days_ago',\n>        'FWI_3_days_ago', 'VPD_3_days_ago', 'P_3_days_ago', 'FRP_3_days_ago',\n>        'FWI_4_days_ago', 'VPD_4_days_ago', 'P_4_days_ago', 'FRP_4_days_ago',\n>        'FWI_5_days_ago', 'VPD_5_days_ago', 'P_5_days_ago', 'FRP_5_days_ago',\n>        'FWI_6_days_ago', 'VPD_6_days_ago', 'P_6_days_ago', 'FRP_6_days_ago',\n>        'FWI_7_days_ago', 'VPD_7_days_ago', 'P_7_days_ago', 'FRP_7_days_ago',\n>        'Predicted_FRP'],\n>       dtype='object')\n389a390,474\n> Prediction results are saved to /groups/ESS3/zsun/firecasting/data/output/output_tabnet_window_7_days_forecasting_with_new_yunyao_window_time_series_landuse_vhi_latlon//20210701/firedata_20210705_predicted.txt\n> ['Mean Absolute Error (MAE): 21.89977847352078', 'Mean Squared Error (MSE): 21849.950923035296', 'Root Mean Squared Error (RMSE): 147.8172889855422', 'R-squared (R2) Score: -0.022265212698645342', 'Explained Variance Score: 3.631281273452913e-07', 'Median Absolute Error (MedAE): 0.0', 'Max Error: 1216.9396944375744', 'Mean: -21.81510091978249', 'Median: 0.0', 'Standard Deviation: 146.19914277086232', 'Minimum: -999.0', 'Maximum: 1216.946899', 'Count: 156861']\n> Metrics saved to /groups/ESS3/zsun/firecasting/data/output/output_tabnet_window_7_days_forecasting_with_new_yunyao_window_time_series_landuse_vhi_latlon//20210701/metrics_20210705_predicted.txt\n> predicting:  20210706\n> Read from original folder for current date: 20210706\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210706.txt\n> reading past files for 2021-07-05 00:00:00\n> reading from predicted folder\n> current final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n> 0 -999.0 -999.0  0.0  ...  101352.601562          -999.0            0.0\n> 1 -999.0 -999.0  0.0  ...  101352.601562          -999.0            0.0\n> 2 -999.0 -999.0  0.0  ...  101336.601562          -999.0            0.0\n> 3 -999.0 -999.0  0.0  ...  101336.601562          -999.0            0.0\n> 4 -999.0 -999.0  0.0  ...  101320.203125          -999.0            0.0\n> \n> [5 rows x 72 columns]\n> renaming Predicted_FRP to FRP\n> remove the current predicted_frp\n> reading past files for 2021-07-04 00:00:00\n> reading from predicted folder\n> current final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n> 0 -999.0 -999.0  0.0  ...  101521.437500          -999.0            0.0\n> 1 -999.0 -999.0  0.0  ...  101521.437500          -999.0            0.0\n> 2 -999.0 -999.0  0.0  ...  101507.437500          -999.0            0.0\n> 3 -999.0 -999.0  0.0  ...  101507.437500          -999.0            0.0\n> 4 -999.0 -999.0  0.0  ...  101494.640625          -999.0            0.0\n> \n> [5 rows x 72 columns]\n> renaming Predicted_FRP to FRP\n> remove the current predicted_frp\n> reading past files for 2021-07-03 00:00:00\n> reading from predicted folder\n> current final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n> 0 -999.0 -999.0  0.0  ...  101701.023438          -999.0            0.0\n> 1 -999.0 -999.0  0.0  ...  101701.023438          -999.0            0.0\n> 2 -999.0 -999.0  0.0  ...  101689.023438          -999.0            0.0\n> 3 -999.0 -999.0  0.0  ...  101689.023438          -999.0            0.0\n> 4 -999.0 -999.0  0.0  ...  101676.625000          -999.0            0.0\n> \n> [5 rows x 72 columns]\n> renaming Predicted_FRP to FRP\n> remove the current predicted_frp\n> reading past files for 2021-07-02 00:00:00\n> reading from predicted folder\n> current final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n> 0 -999.0 -999.0  0.0  ...  101861.375000          -999.0            0.0\n> 1 -999.0 -999.0  0.0  ...  101861.375000          -999.0            0.0\n> 2 -999.0 -999.0  0.0  ...  101853.773438          -999.0            0.0\n> 3 -999.0 -999.0  0.0  ...  101853.773438          -999.0            0.0\n> 4 -999.0 -999.0  0.0  ...  101844.171875          -999.0            0.0\n> \n> [5 rows x 72 columns]\n> renaming Predicted_FRP to FRP\n> remove the current predicted_frp\n> reading past files for 2021-07-01 00:00:00\n> reading from predicted folder\n> current final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n> 0 -999.0 -999.0  0.0  ...  101879.484375          -999.0            0.0\n> 1 -999.0 -999.0  0.0  ...  101879.484375          -999.0            0.0\n> 2 -999.0 -999.0  0.0  ...  101873.890625          -999.0            0.0\n> 3 -999.0 -999.0  0.0  ...  101873.890625          -999.0            0.0\n> 4 -999.0 -999.0  0.0  ...  101867.890625          -999.0            0.0\n> \n> [5 rows x 72 columns]\n> renaming Predicted_FRP to FRP\n> remove the current predicted_frp\n> reading past files for 2021-06-30 00:00:00\n> reading from original folder\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210630.txt\n> reading past files for 2021-06-29 00:00:00\n> reading from original folder\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210629.txt\n> New time series dataframe:      LAT         LON    FRP  ...  VPD_7_days_ago   P_7_days_ago  FRP_7_days_ago\n> 0  24.5 -126.000000 -999.0  ...          -999.0  101329.468750          -999.0\n> 1  24.5 -125.899994 -999.0  ...          -999.0  101329.468750          -999.0\n> 2  24.5 -125.800003 -999.0  ...          -999.0  101317.062500          -999.0\n> 3  24.5 -125.699997 -999.0  ...          -999.0  101317.062500          -999.0\n> 4  24.5 -125.599998 -999.0  ...          -999.0  101301.859375          -999.0\n> \n> [5 rows x 74 columns]\n> Original df is created:  (156861, 74)\n> Original df filled the na with -9999 \n> X and y are loaded into memory for 20210706\n> the loaded model is:  TabNetRegressor(n_d=17, n_a=41, n_steps=4, gamma=1.1546672563068268, cat_idxs=[], cat_dims=[], cat_emb_dim=[], n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.00042602006758391, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=71, output_dim=1, device_name='auto', n_shared_decoder=1, n_indep_decoder=1, grouped_features=[])\n> Loaded model is a TabNet model.\n474a475,492\n> Prediction for 20210706 of start day 20210701 is finished\n> new columns to check:  ['FRP_1_days_ago', 'Nearest_1', 'Nearest_2', 'Nearest_3', 'Nearest_4', 'Nearest_5', 'Nearest_6', 'Nearest_7', 'Nearest_8']\n> current merged_df columns:  Index(['FWI', 'VPD', 'HT', 'T', 'RH', 'U', 'V', 'P', 'RAIN', 'CAPE', 'ST',\n>        'SM', 'Nearest_1', 'Nearest_2', 'Nearest_3', 'Nearest_4', 'Nearest_5',\n>        'Nearest_6', 'Nearest_7', 'Nearest_8', 'Nearest_9', 'Nearest_10',\n>        'Nearest_11', 'Nearest_12', 'Nearest_13', 'Nearest_14', 'Nearest_15',\n>        'Nearest_16', 'Nearest_17', 'Nearest_18', 'Nearest_19', 'Nearest_20',\n>        'Nearest_21', 'Nearest_22', 'Nearest_23', 'Nearest_24', 'Land_Use',\n>        'VCI_AVE', 'TCI_AVE', 'VHI_AVE', 'VCI_TOT', 'TCI_TOT', 'VHI_TOT',\n>        'FWI_1_days_ago', 'VPD_1_days_ago', 'P_1_days_ago', 'FRP_1_days_ago',\n>        'FWI_2_days_ago', 'VPD_2_days_ago', 'P_2_days_ago', 'FRP_2_days_ago',\n>        'FWI_3_days_ago', 'VPD_3_days_ago', 'P_3_days_ago', 'FRP_3_days_ago',\n>        'FWI_4_days_ago', 'VPD_4_days_ago', 'P_4_days_ago', 'FRP_4_days_ago',\n>        'FWI_5_days_ago', 'VPD_5_days_ago', 'P_5_days_ago', 'FRP_5_days_ago',\n>        'FWI_6_days_ago', 'VPD_6_days_ago', 'P_6_days_ago', 'FRP_6_days_ago',\n>        'FWI_7_days_ago', 'VPD_7_days_ago', 'P_7_days_ago', 'FRP_7_days_ago',\n>        'Predicted_FRP'],\n>       dtype='object')\n492a493,536\n> Prediction results are saved to /groups/ESS3/zsun/firecasting/data/output/output_tabnet_window_7_days_forecasting_with_new_yunyao_window_time_series_landuse_vhi_latlon//20210701/firedata_20210706_predicted.txt\n> ['Mean Absolute Error (MAE): 21.968528418722748', 'Mean Squared Error (MSE): 22237.57250446588', 'Root Mean Squared Error (RMSE): 149.12267602368823', 'R-squared (R2) Score: -0.0217257122650365', 'Explained Variance Score: 2.84587337695541e-06', 'Median Absolute Error (MedAE): 0.0', 'Max Error: 7547.461402141784', 'Mean: -21.746309589547433', 'Median: 0.0', 'Standard Deviation: 147.52917421844327', 'Minimum: -999.0', 'Maximum: 7547.473145', 'Count: 156861']\n> Metrics saved to /groups/ESS3/zsun/firecasting/data/output/output_tabnet_window_7_days_forecasting_with_new_yunyao_window_time_series_landuse_vhi_latlon//20210701/metrics_20210706_predicted.txt\n> predicting:  20210707\n> Read from original folder for current date: 20210707\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210707.txt\n> reading past files for 2021-07-06 00:00:00\n> reading from predicted folder\n> current final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n> 0 -999.0 -999.0  0.0  ...  101329.468750          -999.0            0.0\n> 1 -999.0 -999.0  0.0  ...  101329.468750          -999.0            0.0\n> 2 -999.0 -999.0  0.0  ...  101317.062500          -999.0            0.0\n> 3 -999.0 -999.0  0.0  ...  101317.062500          -999.0            0.0\n> 4 -999.0 -999.0  0.0  ...  101301.859375          -999.0            0.0\n> \n> [5 rows x 72 columns]\n> renaming Predicted_FRP to FRP\n> remove the current predicted_frp\n> reading past files for 2021-07-05 00:00:00\n> reading from predicted folder\n> current final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n> 0 -999.0 -999.0  0.0  ...  101352.601562          -999.0            0.0\n> 1 -999.0 -999.0  0.0  ...  101352.601562          -999.0            0.0\n> 2 -999.0 -999.0  0.0  ...  101336.601562          -999.0            0.0\n> 3 -999.0 -999.0  0.0  ...  101336.601562          -999.0            0.0\n> 4 -999.0 -999.0  0.0  ...  101320.203125          -999.0            0.0\n> \n> [5 rows x 72 columns]\n> renaming Predicted_FRP to FRP\n> remove the current predicted_frp\n> reading past files for 2021-07-04 00:00:00\n> reading from predicted folder\n> current final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n> 0 -999.0 -999.0  0.0  ...  101521.437500          -999.0            0.0\n> 1 -999.0 -999.0  0.0  ...  101521.437500          -999.0            0.0\n> 2 -999.0 -999.0  0.0  ...  101507.437500          -999.0            0.0\n> 3 -999.0 -999.0  0.0  ...  101507.437500          -999.0            0.0\n> 4 -999.0 -999.0  0.0  ...  101494.640625          -999.0            0.0\n> \n> [5 rows x 72 columns]\n> renaming Predicted_FRP to FRP\n> remove the current predicted_frp\n> reading past files for 2021-07-03 00:00:00\n> reading from predicted folder\n536a537,586\n> current final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n> 0 -999.0 -999.0  0.0  ...  101701.023438          -999.0            0.0\n> 1 -999.0 -999.0  0.0  ...  101701.023438          -999.0            0.0\n> 2 -999.0 -999.0  0.0  ...  101689.023438          -999.0            0.0\n> 3 -999.0 -999.0  0.0  ...  101689.023438          -999.0            0.0\n> 4 -999.0 -999.0  0.0  ...  101676.625000          -999.0            0.0\n> \n> [5 rows x 72 columns]\n> renaming Predicted_FRP to FRP\n> remove the current predicted_frp\n> reading past files for 2021-07-02 00:00:00\n> reading from predicted folder\n> current final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n> 0 -999.0 -999.0  0.0  ...  101861.375000          -999.0            0.0\n> 1 -999.0 -999.0  0.0  ...  101861.375000          -999.0            0.0\n> 2 -999.0 -999.0  0.0  ...  101853.773438          -999.0            0.0\n> 3 -999.0 -999.0  0.0  ...  101853.773438          -999.0            0.0\n> 4 -999.0 -999.0  0.0  ...  101844.171875          -999.0            0.0\n> \n> [5 rows x 72 columns]\n> renaming Predicted_FRP to FRP\n> remove the current predicted_frp\n> reading past files for 2021-07-01 00:00:00\n> reading from predicted folder\n> current final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n> 0 -999.0 -999.0  0.0  ...  101879.484375          -999.0            0.0\n> 1 -999.0 -999.0  0.0  ...  101879.484375          -999.0            0.0\n> 2 -999.0 -999.0  0.0  ...  101873.890625          -999.0            0.0\n> 3 -999.0 -999.0  0.0  ...  101873.890625          -999.0            0.0\n> 4 -999.0 -999.0  0.0  ...  101867.890625          -999.0            0.0\n> \n> [5 rows x 72 columns]\n> renaming Predicted_FRP to FRP\n> remove the current predicted_frp\n> reading past files for 2021-06-30 00:00:00\n> reading from original folder\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210630.txt\n> New time series dataframe:      LAT         LON    FRP  ...  VPD_7_days_ago   P_7_days_ago  FRP_7_days_ago\n> 0  24.5 -126.000000 -999.0  ...          -999.0  101381.734375          -999.0\n> 1  24.5 -125.899994 -999.0  ...          -999.0  101381.734375          -999.0\n> 2  24.5 -125.800003 -999.0  ...          -999.0  101376.140625          -999.0\n> 3  24.5 -125.699997 -999.0  ...          -999.0  101376.140625          -999.0\n> 4  24.5 -125.599998 -999.0  ...          -999.0  101371.742188          -999.0\n> \n> [5 rows x 74 columns]\n> Original df is created:  (156861, 74)\n> Original df filled the na with -9999 \n> X and y are loaded into memory for 20210707\n> the loaded model is:  TabNetRegressor(n_d=17, n_a=41, n_steps=4, gamma=1.1546672563068268, cat_idxs=[], cat_dims=[], cat_emb_dim=[], n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.00042602006758391, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=71, output_dim=1, device_name='auto', n_shared_decoder=1, n_indep_decoder=1, grouped_features=[])\n> Loaded model is a TabNet model.\n586a587,604\n> Prediction for 20210707 of start day 20210701 is finished\n> new columns to check:  ['FRP_1_days_ago', 'Nearest_1', 'Nearest_2', 'Nearest_3', 'Nearest_4', 'Nearest_5', 'Nearest_6', 'Nearest_7', 'Nearest_8']\n> current merged_df columns:  Index(['FWI', 'VPD', 'HT', 'T', 'RH', 'U', 'V', 'P', 'RAIN', 'CAPE', 'ST',\n>        'SM', 'Nearest_1', 'Nearest_2', 'Nearest_3', 'Nearest_4', 'Nearest_5',\n>        'Nearest_6', 'Nearest_7', 'Nearest_8', 'Nearest_9', 'Nearest_10',\n>        'Nearest_11', 'Nearest_12', 'Nearest_13', 'Nearest_14', 'Nearest_15',\n>        'Nearest_16', 'Nearest_17', 'Nearest_18', 'Nearest_19', 'Nearest_20',\n>        'Nearest_21', 'Nearest_22', 'Nearest_23', 'Nearest_24', 'Land_Use',\n>        'VCI_AVE', 'TCI_AVE', 'VHI_AVE', 'VCI_TOT', 'TCI_TOT', 'VHI_TOT',\n>        'FWI_1_days_ago', 'VPD_1_days_ago', 'P_1_days_ago', 'FRP_1_days_ago',\n>        'FWI_2_days_ago', 'VPD_2_days_ago', 'P_2_days_ago', 'FRP_2_days_ago',\n>        'FWI_3_days_ago', 'VPD_3_days_ago', 'P_3_days_ago', 'FRP_3_days_ago',\n>        'FWI_4_days_ago', 'VPD_4_days_ago', 'P_4_days_ago', 'FRP_4_days_ago',\n>        'FWI_5_days_ago', 'VPD_5_days_ago', 'P_5_days_ago', 'FRP_5_days_ago',\n>        'FWI_6_days_ago', 'VPD_6_days_ago', 'P_6_days_ago', 'FRP_6_days_ago',\n>        'FWI_7_days_ago', 'VPD_7_days_ago', 'P_7_days_ago', 'FRP_7_days_ago',\n>        'Predicted_FRP'],\n>       dtype='object')\n604a605,647\n> Prediction results are saved to /groups/ESS3/zsun/firecasting/data/output/output_tabnet_window_7_days_forecasting_with_new_yunyao_window_time_series_landuse_vhi_latlon//20210701/firedata_20210707_predicted.txt\n> ['Mean Absolute Error (MAE): 22.085140908310738', 'Mean Squared Error (MSE): 23056.245571015115', 'Root Mean Squared Error (RMSE): 151.84283180649365', 'R-squared (R2) Score: -0.02071760349906504', 'Explained Variance Score: -1.4140111772587005e-06', 'Median Absolute Error (MedAE): 0.0', 'Max Error: 11733.888392616063', 'Mean: -21.630771051147192', 'Median: 0.0', 'Standard Deviation: 150.29442683250224', 'Minimum: -999.0', 'Maximum: 11733.90625', 'Count: 156861']\n> Metrics saved to /groups/ESS3/zsun/firecasting/data/output/output_tabnet_window_7_days_forecasting_with_new_yunyao_window_time_series_landuse_vhi_latlon//20210701/metrics_20210707_predicted.txt\n> current date:  2021-07-02 00:00:00\n> single_day_current_date =  2021-07-02 00:00:00\n> single_day_predict_end_date =  2021-07-09 00:00:00\n> predicting:  20210702\n> Read from original folder for current date: 20210702\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210702.txt\n> reading past files for 2021-07-01 00:00:00\n> reading from original folder\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210701.txt\n> reading past files for 2021-06-30 00:00:00\n> reading from original folder\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210630.txt\n> reading past files for 2021-06-29 00:00:00\n> reading from original folder\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210629.txt\n> reading past files for 2021-06-28 00:00:00\n> reading from original folder\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210628.txt\n> reading past files for 2021-06-27 00:00:00\n> reading from original folder\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210627.txt\n> reading past files for 2021-06-26 00:00:00\n> reading from original folder\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210626.txt\n> reading past files for 2021-06-25 00:00:00\n> reading from original folder\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210625.txt\n> New time series dataframe:      LAT         LON    FRP  ...  VPD_7_days_ago   P_7_days_ago  FRP_7_days_ago\n> 0  24.5 -126.000000 -999.0  ...          -999.0  101861.375000          -999.0\n> 1  24.5 -125.899994 -999.0  ...          -999.0  101861.375000          -999.0\n> 2  24.5 -125.800003 -999.0  ...          -999.0  101853.773438          -999.0\n> 3  24.5 -125.699997 -999.0  ...          -999.0  101853.773438          -999.0\n> 4  24.5 -125.599998 -999.0  ...          -999.0  101844.171875          -999.0\n> \n> [5 rows x 74 columns]\n> Original df is created:  (156861, 74)\n> Original df filled the na with -9999 \n> X and y are loaded into memory for 20210702\n> the loaded model is:  TabNetRegressor(n_d=17, n_a=41, n_steps=4, gamma=1.1546672563068268, cat_idxs=[], cat_dims=[], cat_emb_dim=[], n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.00042602006758391, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=71, output_dim=1, device_name='auto', n_shared_decoder=1, n_indep_decoder=1, grouped_features=[])\n> Loaded model is a TabNet model.\n647a648,665\n> Prediction for 20210702 of start day 20210702 is finished\n> new columns to check:  ['FRP_1_days_ago', 'Nearest_1', 'Nearest_2', 'Nearest_3', 'Nearest_4', 'Nearest_5', 'Nearest_6', 'Nearest_7', 'Nearest_8']\n> current merged_df columns:  Index(['FWI', 'VPD', 'HT', 'T', 'RH', 'U', 'V', 'P', 'RAIN', 'CAPE', 'ST',\n>        'SM', 'Nearest_1', 'Nearest_2', 'Nearest_3', 'Nearest_4', 'Nearest_5',\n>        'Nearest_6', 'Nearest_7', 'Nearest_8', 'Nearest_9', 'Nearest_10',\n>        'Nearest_11', 'Nearest_12', 'Nearest_13', 'Nearest_14', 'Nearest_15',\n>        'Nearest_16', 'Nearest_17', 'Nearest_18', 'Nearest_19', 'Nearest_20',\n>        'Nearest_21', 'Nearest_22', 'Nearest_23', 'Nearest_24', 'Land_Use',\n>        'VCI_AVE', 'TCI_AVE', 'VHI_AVE', 'VCI_TOT', 'TCI_TOT', 'VHI_TOT',\n>        'FWI_1_days_ago', 'VPD_1_days_ago', 'P_1_days_ago', 'FRP_1_days_ago',\n>        'FWI_2_days_ago', 'VPD_2_days_ago', 'P_2_days_ago', 'FRP_2_days_ago',\n>        'FWI_3_days_ago', 'VPD_3_days_ago', 'P_3_days_ago', 'FRP_3_days_ago',\n>        'FWI_4_days_ago', 'VPD_4_days_ago', 'P_4_days_ago', 'FRP_4_days_ago',\n>        'FWI_5_days_ago', 'VPD_5_days_ago', 'P_5_days_ago', 'FRP_5_days_ago',\n>        'FWI_6_days_ago', 'VPD_6_days_ago', 'P_6_days_ago', 'FRP_6_days_ago',\n>        'FWI_7_days_ago', 'VPD_7_days_ago', 'P_7_days_ago', 'FRP_7_days_ago',\n>        'Predicted_FRP'],\n>       dtype='object')\n665a666,701\n> Prediction results are saved to /groups/ESS3/zsun/firecasting/data/output/output_tabnet_window_7_days_forecasting_with_new_yunyao_window_time_series_landuse_vhi_latlon//20210702/firedata_20210702_predicted.txt\n> ['Mean Absolute Error (MAE): 21.878354667289614', 'Mean Squared Error (MSE): 21840.907473561892', 'Root Mean Squared Error (RMSE): 147.78669586116976', 'R-squared (R2) Score: -0.02231897231295732', 'Explained Variance Score: 2.269364342000202e-07', 'Median Absolute Error (MedAE): 0.0', 'Max Error: 999.0', 'Mean: -21.836369149265913', 'Median: 0.0', 'Standard Deviation: 146.16504128154463', 'Minimum: -999.0', 'Maximum: 639.787903', 'Count: 156861']\n> Metrics saved to /groups/ESS3/zsun/firecasting/data/output/output_tabnet_window_7_days_forecasting_with_new_yunyao_window_time_series_landuse_vhi_latlon//20210702/metrics_20210702_predicted.txt\n> predicting:  20210703\n> Read from original folder for current date: 20210703\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210703.txt\n> reading past files for 2021-07-02 00:00:00\n> reading from predicted folder\n> current final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n> 0 -999.0 -999.0  0.0  ...  101861.375000          -999.0            0.0\n> 1 -999.0 -999.0  0.0  ...  101861.375000          -999.0            0.0\n> 2 -999.0 -999.0  0.0  ...  101853.773438          -999.0            0.0\n> 3 -999.0 -999.0  0.0  ...  101853.773438          -999.0            0.0\n> 4 -999.0 -999.0  0.0  ...  101844.171875          -999.0            0.0\n> \n> [5 rows x 72 columns]\n> renaming Predicted_FRP to FRP\n> remove the current predicted_frp\n> reading past files for 2021-07-01 00:00:00\n> reading from original folder\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210701.txt\n> reading past files for 2021-06-30 00:00:00\n> reading from original folder\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210630.txt\n> reading past files for 2021-06-29 00:00:00\n> reading from original folder\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210629.txt\n> reading past files for 2021-06-28 00:00:00\n> reading from original folder\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210628.txt\n> reading past files for 2021-06-27 00:00:00\n> reading from original folder\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210627.txt\n> reading past files for 2021-06-26 00:00:00\n> reading from original folder\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210626.txt\n701a702,732\n> New time series dataframe:      LAT         LON    FRP  ...  VPD_7_days_ago   P_7_days_ago  FRP_7_days_ago\n> 0  24.5 -126.000000 -999.0  ...          -999.0  101701.023438          -999.0\n> 1  24.5 -125.899994 -999.0  ...          -999.0  101701.023438          -999.0\n> 2  24.5 -125.800003 -999.0  ...          -999.0  101689.023438          -999.0\n> 3  24.5 -125.699997 -999.0  ...          -999.0  101689.023438          -999.0\n> 4  24.5 -125.599998 -999.0  ...          -999.0  101676.625000          -999.0\n> \n> [5 rows x 74 columns]\n> Original df is created:  (156861, 74)\n> Original df filled the na with -9999 \n> X and y are loaded into memory for 20210703\n> the loaded model is:  TabNetRegressor(n_d=17, n_a=41, n_steps=4, gamma=1.1546672563068268, cat_idxs=[], cat_dims=[], cat_emb_dim=[], n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.00042602006758391, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=71, output_dim=1, device_name='auto', n_shared_decoder=1, n_indep_decoder=1, grouped_features=[])\n> Loaded model is a TabNet model.\n> Prediction for 20210703 of start day 20210702 is finished\n> new columns to check:  ['FRP_1_days_ago', 'Nearest_1', 'Nearest_2', 'Nearest_3', 'Nearest_4', 'Nearest_5', 'Nearest_6', 'Nearest_7', 'Nearest_8']\n> current merged_df columns:  Index(['FWI', 'VPD', 'HT', 'T', 'RH', 'U', 'V', 'P', 'RAIN', 'CAPE', 'ST',\n>        'SM', 'Nearest_1', 'Nearest_2', 'Nearest_3', 'Nearest_4', 'Nearest_5',\n>        'Nearest_6', 'Nearest_7', 'Nearest_8', 'Nearest_9', 'Nearest_10',\n>        'Nearest_11', 'Nearest_12', 'Nearest_13', 'Nearest_14', 'Nearest_15',\n>        'Nearest_16', 'Nearest_17', 'Nearest_18', 'Nearest_19', 'Nearest_20',\n>        'Nearest_21', 'Nearest_22', 'Nearest_23', 'Nearest_24', 'Land_Use',\n>        'VCI_AVE', 'TCI_AVE', 'VHI_AVE', 'VCI_TOT', 'TCI_TOT', 'VHI_TOT',\n>        'FWI_1_days_ago', 'VPD_1_days_ago', 'P_1_days_ago', 'FRP_1_days_ago',\n>        'FWI_2_days_ago', 'VPD_2_days_ago', 'P_2_days_ago', 'FRP_2_days_ago',\n>        'FWI_3_days_ago', 'VPD_3_days_ago', 'P_3_days_ago', 'FRP_3_days_ago',\n>        'FWI_4_days_ago', 'VPD_4_days_ago', 'P_4_days_ago', 'FRP_4_days_ago',\n>        'FWI_5_days_ago', 'VPD_5_days_ago', 'P_5_days_ago', 'FRP_5_days_ago',\n>        'FWI_6_days_ago', 'VPD_6_days_ago', 'P_6_days_ago', 'FRP_6_days_ago',\n>        'FWI_7_days_ago', 'VPD_7_days_ago', 'P_7_days_ago', 'FRP_7_days_ago',\n>        'Predicted_FRP'],\n>       dtype='object')\n732a733,790\n> Prediction results are saved to /groups/ESS3/zsun/firecasting/data/output/output_tabnet_window_7_days_forecasting_with_new_yunyao_window_time_series_landuse_vhi_latlon//20210702/firedata_20210703_predicted.txt\n> ['Mean Absolute Error (MAE): 21.893988559134687', 'Mean Squared Error (MSE): 21850.512089859996', 'Root Mean Squared Error (RMSE): 147.8191871505861', 'R-squared (R2) Score: -0.022276143393517023', 'Explained Variance Score: 5.471206367957393e-07', 'Median Absolute Error (MedAE): 0.0', 'Max Error: 1241.735596', 'Mean: -21.820777627262355', 'Median: 0.0', 'Standard Deviation: 146.20023852683786', 'Minimum: -999.0', 'Maximum: 1241.735596', 'Count: 156861']\n> Metrics saved to /groups/ESS3/zsun/firecasting/data/output/output_tabnet_window_7_days_forecasting_with_new_yunyao_window_time_series_landuse_vhi_latlon//20210702/metrics_20210703_predicted.txt\n> predicting:  20210704\n> Read from original folder for current date: 20210704\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210704.txt\n> reading past files for 2021-07-03 00:00:00\n> reading from predicted folder\n> current final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n> 0 -999.0 -999.0  0.0  ...  101701.023438          -999.0            0.0\n> 1 -999.0 -999.0  0.0  ...  101701.023438          -999.0            0.0\n> 2 -999.0 -999.0  0.0  ...  101689.023438          -999.0            0.0\n> 3 -999.0 -999.0  0.0  ...  101689.023438          -999.0            0.0\n> 4 -999.0 -999.0  0.0  ...  101676.625000          -999.0            0.0\n> \n> [5 rows x 72 columns]\n> renaming Predicted_FRP to FRP\n> remove the current predicted_frp\n> reading past files for 2021-07-02 00:00:00\n> reading from predicted folder\n> current final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n> 0 -999.0 -999.0  0.0  ...  101861.375000          -999.0            0.0\n> 1 -999.0 -999.0  0.0  ...  101861.375000          -999.0            0.0\n> 2 -999.0 -999.0  0.0  ...  101853.773438          -999.0            0.0\n> 3 -999.0 -999.0  0.0  ...  101853.773438          -999.0            0.0\n> 4 -999.0 -999.0  0.0  ...  101844.171875          -999.0            0.0\n> \n> [5 rows x 72 columns]\n> renaming Predicted_FRP to FRP\n> remove the current predicted_frp\n> reading past files for 2021-07-01 00:00:00\n> reading from original folder\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210701.txt\n> reading past files for 2021-06-30 00:00:00\n> reading from original folder\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210630.txt\n> reading past files for 2021-06-29 00:00:00\n> reading from original folder\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210629.txt\n> reading past files for 2021-06-28 00:00:00\n> reading from original folder\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210628.txt\n> reading past files for 2021-06-27 00:00:00\n> reading from original folder\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210627.txt\n> New time series dataframe:      LAT         LON    FRP  ...  VPD_7_days_ago   P_7_days_ago  FRP_7_days_ago\n> 0  24.5 -126.000000 -999.0  ...          -999.0  101521.437500          -999.0\n> 1  24.5 -125.899994 -999.0  ...          -999.0  101521.437500          -999.0\n> 2  24.5 -125.800003 -999.0  ...          -999.0  101507.437500          -999.0\n> 3  24.5 -125.699997 -999.0  ...          -999.0  101507.437500          -999.0\n> 4  24.5 -125.599998 -999.0  ...          -999.0  101494.640625          -999.0\n> \n> [5 rows x 74 columns]\n> Original df is created:  (156861, 74)\n> Original df filled the na with -9999 \n> X and y are loaded into memory for 20210704\n> the loaded model is:  TabNetRegressor(n_d=17, n_a=41, n_steps=4, gamma=1.1546672563068268, cat_idxs=[], cat_dims=[], cat_emb_dim=[], n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.00042602006758391, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=71, output_dim=1, device_name='auto', n_shared_decoder=1, n_indep_decoder=1, grouped_features=[])\n> Loaded model is a TabNet model.\n790a791,808\n> Prediction for 20210704 of start day 20210702 is finished\n> new columns to check:  ['FRP_1_days_ago', 'Nearest_1', 'Nearest_2', 'Nearest_3', 'Nearest_4', 'Nearest_5', 'Nearest_6', 'Nearest_7', 'Nearest_8']\n> current merged_df columns:  Index(['FWI', 'VPD', 'HT', 'T', 'RH', 'U', 'V', 'P', 'RAIN', 'CAPE', 'ST',\n>        'SM', 'Nearest_1', 'Nearest_2', 'Nearest_3', 'Nearest_4', 'Nearest_5',\n>        'Nearest_6', 'Nearest_7', 'Nearest_8', 'Nearest_9', 'Nearest_10',\n>        'Nearest_11', 'Nearest_12', 'Nearest_13', 'Nearest_14', 'Nearest_15',\n>        'Nearest_16', 'Nearest_17', 'Nearest_18', 'Nearest_19', 'Nearest_20',\n>        'Nearest_21', 'Nearest_22', 'Nearest_23', 'Nearest_24', 'Land_Use',\n>        'VCI_AVE', 'TCI_AVE', 'VHI_AVE', 'VCI_TOT', 'TCI_TOT', 'VHI_TOT',\n>        'FWI_1_days_ago', 'VPD_1_days_ago', 'P_1_days_ago', 'FRP_1_days_ago',\n>        'FWI_2_days_ago', 'VPD_2_days_ago', 'P_2_days_ago', 'FRP_2_days_ago',\n>        'FWI_3_days_ago', 'VPD_3_days_ago', 'P_3_days_ago', 'FRP_3_days_ago',\n>        'FWI_4_days_ago', 'VPD_4_days_ago', 'P_4_days_ago', 'FRP_4_days_ago',\n>        'FWI_5_days_ago', 'VPD_5_days_ago', 'P_5_days_ago', 'FRP_5_days_ago',\n>        'FWI_6_days_ago', 'VPD_6_days_ago', 'P_6_days_ago', 'FRP_6_days_ago',\n>        'FWI_7_days_ago', 'VPD_7_days_ago', 'P_7_days_ago', 'FRP_7_days_ago',\n>        'Predicted_FRP'],\n>       dtype='object')\n808a809,875\n> Prediction results are saved to /groups/ESS3/zsun/firecasting/data/output/output_tabnet_window_7_days_forecasting_with_new_yunyao_window_time_series_landuse_vhi_latlon//20210702/firedata_20210704_predicted.txt\n> ['Mean Absolute Error (MAE): 21.896785569938064', 'Mean Squared Error (MSE): 21857.454357670424', 'Root Mean Squared Error (RMSE): 147.84266758169113', 'R-squared (R2) Score: -0.022263341794956704', 'Explained Variance Score: 3.8081718989335656e-07', 'Median Absolute Error (MedAE): 0.0', 'Max Error: 1181.0887269852824', 'Mean: -21.818007558577342', 'Median: 0.0', 'Standard Deviation: 146.2243773555253', 'Minimum: -999.0', 'Maximum: 1181.141357', 'Count: 156861']\n> Metrics saved to /groups/ESS3/zsun/firecasting/data/output/output_tabnet_window_7_days_forecasting_with_new_yunyao_window_time_series_landuse_vhi_latlon//20210702/metrics_20210704_predicted.txt\n> predicting:  20210705\n> Read from original folder for current date: 20210705\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210705.txt\n> reading past files for 2021-07-04 00:00:00\n> reading from predicted folder\n> current final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n> 0 -999.0 -999.0  0.0  ...  101521.437500          -999.0            0.0\n> 1 -999.0 -999.0  0.0  ...  101521.437500          -999.0            0.0\n> 2 -999.0 -999.0  0.0  ...  101507.437500          -999.0            0.0\n> 3 -999.0 -999.0  0.0  ...  101507.437500          -999.0            0.0\n> 4 -999.0 -999.0  0.0  ...  101494.640625          -999.0            0.0\n> \n> [5 rows x 72 columns]\n> renaming Predicted_FRP to FRP\n> remove the current predicted_frp\n> reading past files for 2021-07-03 00:00:00\n> reading from predicted folder\n> current final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n> 0 -999.0 -999.0  0.0  ...  101701.023438          -999.0            0.0\n> 1 -999.0 -999.0  0.0  ...  101701.023438          -999.0            0.0\n> 2 -999.0 -999.0  0.0  ...  101689.023438          -999.0            0.0\n> 3 -999.0 -999.0  0.0  ...  101689.023438          -999.0            0.0\n> 4 -999.0 -999.0  0.0  ...  101676.625000          -999.0            0.0\n> \n> [5 rows x 72 columns]\n> renaming Predicted_FRP to FRP\n> remove the current predicted_frp\n> reading past files for 2021-07-02 00:00:00\n> reading from predicted folder\n> current final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n> 0 -999.0 -999.0  0.0  ...  101861.375000          -999.0            0.0\n> 1 -999.0 -999.0  0.0  ...  101861.375000          -999.0            0.0\n> 2 -999.0 -999.0  0.0  ...  101853.773438          -999.0            0.0\n> 3 -999.0 -999.0  0.0  ...  101853.773438          -999.0            0.0\n> 4 -999.0 -999.0  0.0  ...  101844.171875          -999.0            0.0\n> \n> [5 rows x 72 columns]\n> renaming Predicted_FRP to FRP\n> remove the current predicted_frp\n> reading past files for 2021-07-01 00:00:00\n> reading from original folder\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210701.txt\n> reading past files for 2021-06-30 00:00:00\n> reading from original folder\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210630.txt\n> reading past files for 2021-06-29 00:00:00\n> reading from original folder\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210629.txt\n> reading past files for 2021-06-28 00:00:00\n> reading from original folder\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210628.txt\n> New time series dataframe:      LAT         LON    FRP  ...  VPD_7_days_ago   P_7_days_ago  FRP_7_days_ago\n> 0  24.5 -126.000000 -999.0  ...          -999.0  101352.601562          -999.0\n> 1  24.5 -125.899994 -999.0  ...          -999.0  101352.601562          -999.0\n> 2  24.5 -125.800003 -999.0  ...          -999.0  101336.601562          -999.0\n> 3  24.5 -125.699997 -999.0  ...          -999.0  101336.601562          -999.0\n> 4  24.5 -125.599998 -999.0  ...          -999.0  101320.203125          -999.0\n> \n> [5 rows x 74 columns]\n> Original df is created:  (156861, 74)\n> Original df filled the na with -9999 \n> X and y are loaded into memory for 20210705\n> the loaded model is:  TabNetRegressor(n_d=17, n_a=41, n_steps=4, gamma=1.1546672563068268, cat_idxs=[], cat_dims=[], cat_emb_dim=[], n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.00042602006758391, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=71, output_dim=1, device_name='auto', n_shared_decoder=1, n_indep_decoder=1, grouped_features=[])\n> Loaded model is a TabNet model.\n875a876,893\n> Prediction for 20210705 of start day 20210702 is finished\n> new columns to check:  ['FRP_1_days_ago', 'Nearest_1', 'Nearest_2', 'Nearest_3', 'Nearest_4', 'Nearest_5', 'Nearest_6', 'Nearest_7', 'Nearest_8']\n> current merged_df columns:  Index(['FWI', 'VPD', 'HT', 'T', 'RH', 'U', 'V', 'P', 'RAIN', 'CAPE', 'ST',\n>        'SM', 'Nearest_1', 'Nearest_2', 'Nearest_3', 'Nearest_4', 'Nearest_5',\n>        'Nearest_6', 'Nearest_7', 'Nearest_8', 'Nearest_9', 'Nearest_10',\n>        'Nearest_11', 'Nearest_12', 'Nearest_13', 'Nearest_14', 'Nearest_15',\n>        'Nearest_16', 'Nearest_17', 'Nearest_18', 'Nearest_19', 'Nearest_20',\n>        'Nearest_21', 'Nearest_22', 'Nearest_23', 'Nearest_24', 'Land_Use',\n>        'VCI_AVE', 'TCI_AVE', 'VHI_AVE', 'VCI_TOT', 'TCI_TOT', 'VHI_TOT',\n>        'FWI_1_days_ago', 'VPD_1_days_ago', 'P_1_days_ago', 'FRP_1_days_ago',\n>        'FWI_2_days_ago', 'VPD_2_days_ago', 'P_2_days_ago', 'FRP_2_days_ago',\n>        'FWI_3_days_ago', 'VPD_3_days_ago', 'P_3_days_ago', 'FRP_3_days_ago',\n>        'FWI_4_days_ago', 'VPD_4_days_ago', 'P_4_days_ago', 'FRP_4_days_ago',\n>        'FWI_5_days_ago', 'VPD_5_days_ago', 'P_5_days_ago', 'FRP_5_days_ago',\n>        'FWI_6_days_ago', 'VPD_6_days_ago', 'P_6_days_ago', 'FRP_6_days_ago',\n>        'FWI_7_days_ago', 'VPD_7_days_ago', 'P_7_days_ago', 'FRP_7_days_ago',\n>        'Predicted_FRP'],\n>       dtype='object')\n893a894,953\n> Prediction results are saved to /groups/ESS3/zsun/firecasting/data/output/output_tabnet_window_7_days_forecasting_with_new_yunyao_window_time_series_landuse_vhi_latlon//20210702/firedata_20210705_predicted.txt\n> ['Mean Absolute Error (MAE): 21.899747337168673', 'Mean Squared Error (MSE): 21849.950398958197', 'Root Mean Squared Error (RMSE): 147.81728721282298', 'R-squared (R2) Score: -0.022265188179332318', 'Explained Variance Score: 3.5433999800993377e-07', 'Median Absolute Error (MedAE): 0.0', 'Max Error: 1216.9396944375744', 'Mean: -21.81510091978249', 'Median: 0.0', 'Standard Deviation: 146.19914277086232', 'Minimum: -999.0', 'Maximum: 1216.946899', 'Count: 156861']\n> Metrics saved to /groups/ESS3/zsun/firecasting/data/output/output_tabnet_window_7_days_forecasting_with_new_yunyao_window_time_series_landuse_vhi_latlon//20210702/metrics_20210705_predicted.txt\n> predicting:  20210706\n> Read from original folder for current date: 20210706\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210706.txt\n> reading past files for 2021-07-05 00:00:00\n> reading from predicted folder\n> current final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n> 0 -999.0 -999.0  0.0  ...  101352.601562          -999.0            0.0\n> 1 -999.0 -999.0  0.0  ...  101352.601562          -999.0            0.0\n> 2 -999.0 -999.0  0.0  ...  101336.601562          -999.0            0.0\n> 3 -999.0 -999.0  0.0  ...  101336.601562          -999.0            0.0\n> 4 -999.0 -999.0  0.0  ...  101320.203125          -999.0            0.0\n> \n> [5 rows x 72 columns]\n> renaming Predicted_FRP to FRP\n> remove the current predicted_frp\n> reading past files for 2021-07-04 00:00:00\n> reading from predicted folder\n> current final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n> 0 -999.0 -999.0  0.0  ...  101521.437500          -999.0            0.0\n> 1 -999.0 -999.0  0.0  ...  101521.437500          -999.0            0.0\n> 2 -999.0 -999.0  0.0  ...  101507.437500          -999.0            0.0\n> 3 -999.0 -999.0  0.0  ...  101507.437500          -999.0            0.0\n> 4 -999.0 -999.0  0.0  ...  101494.640625          -999.0            0.0\n> \n> [5 rows x 72 columns]\n> renaming Predicted_FRP to FRP\n> remove the current predicted_frp\n> reading past files for 2021-07-03 00:00:00\n> reading from predicted folder\n> current final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n> 0 -999.0 -999.0  0.0  ...  101701.023438          -999.0            0.0\n> 1 -999.0 -999.0  0.0  ...  101701.023438          -999.0            0.0\n> 2 -999.0 -999.0  0.0  ...  101689.023438          -999.0            0.0\n> 3 -999.0 -999.0  0.0  ...  101689.023438          -999.0            0.0\n> 4 -999.0 -999.0  0.0  ...  101676.625000          -999.0            0.0\n> \n> [5 rows x 72 columns]\n> renaming Predicted_FRP to FRP\n> remove the current predicted_frp\n> reading past files for 2021-07-02 00:00:00\n> reading from predicted folder\n> current final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n> 0 -999.0 -999.0  0.0  ...  101861.375000          -999.0            0.0\n> 1 -999.0 -999.0  0.0  ...  101861.375000          -999.0            0.0\n> 2 -999.0 -999.0  0.0  ...  101853.773438          -999.0            0.0\n> 3 -999.0 -999.0  0.0  ...  101853.773438          -999.0            0.0\n> 4 -999.0 -999.0  0.0  ...  101844.171875          -999.0            0.0\n> \n> [5 rows x 72 columns]\n> renaming Predicted_FRP to FRP\n> remove the current predicted_frp\n> reading past files for 2021-07-01 00:00:00\n> reading from original folder\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210701.txt\n> reading past files for 2021-06-30 00:00:00\n> reading from original folder\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210630.txt\n953a954,987\n> reading past files for 2021-06-29 00:00:00\n> reading from original folder\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210629.txt\n> New time series dataframe:      LAT         LON    FRP  ...  VPD_7_days_ago   P_7_days_ago  FRP_7_days_ago\n> 0  24.5 -126.000000 -999.0  ...          -999.0  101329.468750          -999.0\n> 1  24.5 -125.899994 -999.0  ...          -999.0  101329.468750          -999.0\n> 2  24.5 -125.800003 -999.0  ...          -999.0  101317.062500          -999.0\n> 3  24.5 -125.699997 -999.0  ...          -999.0  101317.062500          -999.0\n> 4  24.5 -125.599998 -999.0  ...          -999.0  101301.859375          -999.0\n> \n> [5 rows x 74 columns]\n> Original df is created:  (156861, 74)\n> Original df filled the na with -9999 \n> X and y are loaded into memory for 20210706\n> the loaded model is:  TabNetRegressor(n_d=17, n_a=41, n_steps=4, gamma=1.1546672563068268, cat_idxs=[], cat_dims=[], cat_emb_dim=[], n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.00042602006758391, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=71, output_dim=1, device_name='auto', n_shared_decoder=1, n_indep_decoder=1, grouped_features=[])\n> Loaded model is a TabNet model.\n> Prediction for 20210706 of start day 20210702 is finished\n> new columns to check:  ['FRP_1_days_ago', 'Nearest_1', 'Nearest_2', 'Nearest_3', 'Nearest_4', 'Nearest_5', 'Nearest_6', 'Nearest_7', 'Nearest_8']\n> current merged_df columns:  Index(['FWI', 'VPD', 'HT', 'T', 'RH', 'U', 'V', 'P', 'RAIN', 'CAPE', 'ST',\n>        'SM', 'Nearest_1', 'Nearest_2', 'Nearest_3', 'Nearest_4', 'Nearest_5',\n>        'Nearest_6', 'Nearest_7', 'Nearest_8', 'Nearest_9', 'Nearest_10',\n>        'Nearest_11', 'Nearest_12', 'Nearest_13', 'Nearest_14', 'Nearest_15',\n>        'Nearest_16', 'Nearest_17', 'Nearest_18', 'Nearest_19', 'Nearest_20',\n>        'Nearest_21', 'Nearest_22', 'Nearest_23', 'Nearest_24', 'Land_Use',\n>        'VCI_AVE', 'TCI_AVE', 'VHI_AVE', 'VCI_TOT', 'TCI_TOT', 'VHI_TOT',\n>        'FWI_1_days_ago', 'VPD_1_days_ago', 'P_1_days_ago', 'FRP_1_days_ago',\n>        'FWI_2_days_ago', 'VPD_2_days_ago', 'P_2_days_ago', 'FRP_2_days_ago',\n>        'FWI_3_days_ago', 'VPD_3_days_ago', 'P_3_days_ago', 'FRP_3_days_ago',\n>        'FWI_4_days_ago', 'VPD_4_days_ago', 'P_4_days_ago', 'FRP_4_days_ago',\n>        'FWI_5_days_ago', 'VPD_5_days_ago', 'P_5_days_ago', 'FRP_5_days_ago',\n>        'FWI_6_days_ago', 'VPD_6_days_ago', 'P_6_days_ago', 'FRP_6_days_ago',\n>        'FWI_7_days_ago', 'VPD_7_days_ago', 'P_7_days_ago', 'FRP_7_days_ago',\n>        'Predicted_FRP'],\n>       dtype='object')\n987a988,1007\n> Prediction results are saved to /groups/ESS3/zsun/firecasting/data/output/output_tabnet_window_7_days_forecasting_with_new_yunyao_window_time_series_landuse_vhi_latlon//20210702/firedata_20210706_predicted.txt\n> ['Mean Absolute Error (MAE): 21.968498413678347', 'Mean Squared Error (MSE): 22237.57255327088', 'Root Mean Squared Error (RMSE): 149.12267618732866', 'R-squared (R2) Score: -0.021725714507426996', 'Explained Variance Score: 2.7832653392012574e-06', 'Median Absolute Error (MedAE): 0.0', 'Max Error: 7547.461402141784', 'Mean: -21.746309589547433', 'Median: 0.0', 'Standard Deviation: 147.52917421844327', 'Minimum: -999.0', 'Maximum: 7547.473145', 'Count: 156861']\n> Metrics saved to /groups/ESS3/zsun/firecasting/data/output/output_tabnet_window_7_days_forecasting_with_new_yunyao_window_time_series_landuse_vhi_latlon//20210702/metrics_20210706_predicted.txt\n> predicting:  20210707\n> Read from original folder for current date: 20210707\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210707.txt\n> reading past files for 2021-07-06 00:00:00\n> reading from predicted folder\n> current final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n> 0 -999.0 -999.0  0.0  ...  101329.468750          -999.0            0.0\n> 1 -999.0 -999.0  0.0  ...  101329.468750          -999.0            0.0\n> 2 -999.0 -999.0  0.0  ...  101317.062500          -999.0            0.0\n> 3 -999.0 -999.0  0.0  ...  101317.062500          -999.0            0.0\n> 4 -999.0 -999.0  0.0  ...  101301.859375          -999.0            0.0\n> \n> [5 rows x 72 columns]\n> renaming Predicted_FRP to FRP\n> remove the current predicted_frp\n> reading past files for 2021-07-05 00:00:00\n> reading from predicted folder\n1007a1008,1072\n> current final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n> 0 -999.0 -999.0  0.0  ...  101352.601562          -999.0            0.0\n> 1 -999.0 -999.0  0.0  ...  101352.601562          -999.0            0.0\n> 2 -999.0 -999.0  0.0  ...  101336.601562          -999.0            0.0\n> 3 -999.0 -999.0  0.0  ...  101336.601562          -999.0            0.0\n> 4 -999.0 -999.0  0.0  ...  101320.203125          -999.0            0.0\n> \n> [5 rows x 72 columns]\n> renaming Predicted_FRP to FRP\n> remove the current predicted_frp\n> reading past files for 2021-07-04 00:00:00\n> reading from predicted folder\n> current final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n> 0 -999.0 -999.0  0.0  ...  101521.437500          -999.0            0.0\n> 1 -999.0 -999.0  0.0  ...  101521.437500          -999.0            0.0\n> 2 -999.0 -999.0  0.0  ...  101507.437500          -999.0            0.0\n> 3 -999.0 -999.0  0.0  ...  101507.437500          -999.0            0.0\n> 4 -999.0 -999.0  0.0  ...  101494.640625          -999.0            0.0\n> \n> [5 rows x 72 columns]\n> renaming Predicted_FRP to FRP\n> remove the current predicted_frp\n> reading past files for 2021-07-03 00:00:00\n> reading from predicted folder\n> current final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n> 0 -999.0 -999.0  0.0  ...  101701.023438          -999.0            0.0\n> 1 -999.0 -999.0  0.0  ...  101701.023438          -999.0            0.0\n> 2 -999.0 -999.0  0.0  ...  101689.023438          -999.0            0.0\n> 3 -999.0 -999.0  0.0  ...  101689.023438          -999.0            0.0\n> 4 -999.0 -999.0  0.0  ...  101676.625000          -999.0            0.0\n> \n> [5 rows x 72 columns]\n> renaming Predicted_FRP to FRP\n> remove the current predicted_frp\n> reading past files for 2021-07-02 00:00:00\n> reading from predicted folder\n> current final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n> 0 -999.0 -999.0  0.0  ...  101861.375000          -999.0            0.0\n> 1 -999.0 -999.0  0.0  ...  101861.375000          -999.0            0.0\n> 2 -999.0 -999.0  0.0  ...  101853.773438          -999.0            0.0\n> 3 -999.0 -999.0  0.0  ...  101853.773438          -999.0            0.0\n> 4 -999.0 -999.0  0.0  ...  101844.171875          -999.0            0.0\n> \n> [5 rows x 72 columns]\n> renaming Predicted_FRP to FRP\n> remove the current predicted_frp\n> reading past files for 2021-07-01 00:00:00\n> reading from original folder\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210701.txt\n> reading past files for 2021-06-30 00:00:00\n> reading from original folder\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210630.txt\n> New time series dataframe:      LAT         LON    FRP  ...  VPD_7_days_ago   P_7_days_ago  FRP_7_days_ago\n> 0  24.5 -126.000000 -999.0  ...          -999.0  101381.734375          -999.0\n> 1  24.5 -125.899994 -999.0  ...          -999.0  101381.734375          -999.0\n> 2  24.5 -125.800003 -999.0  ...          -999.0  101376.140625          -999.0\n> 3  24.5 -125.699997 -999.0  ...          -999.0  101376.140625          -999.0\n> 4  24.5 -125.599998 -999.0  ...          -999.0  101371.742188          -999.0\n> \n> [5 rows x 74 columns]\n> Original df is created:  (156861, 74)\n> Original df filled the na with -9999 \n> X and y are loaded into memory for 20210707\n> the loaded model is:  TabNetRegressor(n_d=17, n_a=41, n_steps=4, gamma=1.1546672563068268, cat_idxs=[], cat_dims=[], cat_emb_dim=[], n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.00042602006758391, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=71, output_dim=1, device_name='auto', n_shared_decoder=1, n_indep_decoder=1, grouped_features=[])\n> Loaded model is a TabNet model.\n1072a1073,1090\n> Prediction for 20210707 of start day 20210702 is finished\n> new columns to check:  ['FRP_1_days_ago', 'Nearest_1', 'Nearest_2', 'Nearest_3', 'Nearest_4', 'Nearest_5', 'Nearest_6', 'Nearest_7', 'Nearest_8']\n> current merged_df columns:  Index(['FWI', 'VPD', 'HT', 'T', 'RH', 'U', 'V', 'P', 'RAIN', 'CAPE', 'ST',\n>        'SM', 'Nearest_1', 'Nearest_2', 'Nearest_3', 'Nearest_4', 'Nearest_5',\n>        'Nearest_6', 'Nearest_7', 'Nearest_8', 'Nearest_9', 'Nearest_10',\n>        'Nearest_11', 'Nearest_12', 'Nearest_13', 'Nearest_14', 'Nearest_15',\n>        'Nearest_16', 'Nearest_17', 'Nearest_18', 'Nearest_19', 'Nearest_20',\n>        'Nearest_21', 'Nearest_22', 'Nearest_23', 'Nearest_24', 'Land_Use',\n>        'VCI_AVE', 'TCI_AVE', 'VHI_AVE', 'VCI_TOT', 'TCI_TOT', 'VHI_TOT',\n>        'FWI_1_days_ago', 'VPD_1_days_ago', 'P_1_days_ago', 'FRP_1_days_ago',\n>        'FWI_2_days_ago', 'VPD_2_days_ago', 'P_2_days_ago', 'FRP_2_days_ago',\n>        'FWI_3_days_ago', 'VPD_3_days_ago', 'P_3_days_ago', 'FRP_3_days_ago',\n>        'FWI_4_days_ago', 'VPD_4_days_ago', 'P_4_days_ago', 'FRP_4_days_ago',\n>        'FWI_5_days_ago', 'VPD_5_days_ago', 'P_5_days_ago', 'FRP_5_days_ago',\n>        'FWI_6_days_ago', 'VPD_6_days_ago', 'P_6_days_ago', 'FRP_6_days_ago',\n>        'FWI_7_days_ago', 'VPD_7_days_ago', 'P_7_days_ago', 'FRP_7_days_ago',\n>        'Predicted_FRP'],\n>       dtype='object')\n1090a1091,1146\n> Prediction results are saved to /groups/ESS3/zsun/firecasting/data/output/output_tabnet_window_7_days_forecasting_with_new_yunyao_window_time_series_landuse_vhi_latlon//20210702/firedata_20210707_predicted.txt\n> ['Mean Absolute Error (MAE): 22.085113353592085', 'Mean Squared Error (MSE): 23056.24558942548', 'Root Mean Squared Error (RMSE): 151.84283186711673', 'R-squared (R2) Score: -0.020717604314105964', 'Explained Variance Score: -1.4692334313615163e-06', 'Median Absolute Error (MedAE): 0.0', 'Max Error: 11733.88839543797', 'Mean: -21.630771051147192', 'Median: 0.0', 'Standard Deviation: 150.29442683250224', 'Minimum: -999.0', 'Maximum: 11733.90625', 'Count: 156861']\n> Metrics saved to /groups/ESS3/zsun/firecasting/data/output/output_tabnet_window_7_days_forecasting_with_new_yunyao_window_time_series_landuse_vhi_latlon//20210702/metrics_20210707_predicted.txt\n> predicting:  20210708\n> Read from original folder for current date: 20210708\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210708.txt\n> reading past files for 2021-07-07 00:00:00\n> reading from predicted folder\n> current final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n> 0 -999.0 -999.0  0.0  ...  101381.734375          -999.0            0.0\n> 1 -999.0 -999.0  0.0  ...  101381.734375          -999.0            0.0\n> 2 -999.0 -999.0  0.0  ...  101376.140625          -999.0            0.0\n> 3 -999.0 -999.0  0.0  ...  101376.140625          -999.0            0.0\n> 4 -999.0 -999.0  0.0  ...  101371.742188          -999.0            0.0\n> \n> [5 rows x 72 columns]\n> renaming Predicted_FRP to FRP\n> remove the current predicted_frp\n> reading past files for 2021-07-06 00:00:00\n> reading from predicted folder\n> current final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n> 0 -999.0 -999.0  0.0  ...  101329.468750          -999.0            0.0\n> 1 -999.0 -999.0  0.0  ...  101329.468750          -999.0            0.0\n> 2 -999.0 -999.0  0.0  ...  101317.062500          -999.0            0.0\n> 3 -999.0 -999.0  0.0  ...  101317.062500          -999.0            0.0\n> 4 -999.0 -999.0  0.0  ...  101301.859375          -999.0            0.0\n> \n> [5 rows x 72 columns]\n> renaming Predicted_FRP to FRP\n> remove the current predicted_frp\n> reading past files for 2021-07-05 00:00:00\n> reading from predicted folder\n> current final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n> 0 -999.0 -999.0  0.0  ...  101352.601562          -999.0            0.0\n> 1 -999.0 -999.0  0.0  ...  101352.601562          -999.0            0.0\n> 2 -999.0 -999.0  0.0  ...  101336.601562          -999.0            0.0\n> 3 -999.0 -999.0  0.0  ...  101336.601562          -999.0            0.0\n> 4 -999.0 -999.0  0.0  ...  101320.203125          -999.0            0.0\n> \n> [5 rows x 72 columns]\n> renaming Predicted_FRP to FRP\n> remove the current predicted_frp\n> reading past files for 2021-07-04 00:00:00\n> reading from predicted folder\n> current final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n> 0 -999.0 -999.0  0.0  ...  101521.437500          -999.0            0.0\n> 1 -999.0 -999.0  0.0  ...  101521.437500          -999.0            0.0\n> 2 -999.0 -999.0  0.0  ...  101507.437500          -999.0            0.0\n> 3 -999.0 -999.0  0.0  ...  101507.437500          -999.0            0.0\n> 4 -999.0 -999.0  0.0  ...  101494.640625          -999.0            0.0\n> \n> [5 rows x 72 columns]\n> renaming Predicted_FRP to FRP\n> remove the current predicted_frp\n> reading past files for 2021-07-03 00:00:00\n> reading from predicted folder\n1146a1147,1202\n> current final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n> 0 -999.0 -999.0  0.0  ...  101701.023438          -999.0            0.0\n> 1 -999.0 -999.0  0.0  ...  101701.023438          -999.0            0.0\n> 2 -999.0 -999.0  0.0  ...  101689.023438          -999.0            0.0\n> 3 -999.0 -999.0  0.0  ...  101689.023438          -999.0            0.0\n> 4 -999.0 -999.0  0.0  ...  101676.625000          -999.0            0.0\n> \n> [5 rows x 72 columns]\n> renaming Predicted_FRP to FRP\n> remove the current predicted_frp\n> reading past files for 2021-07-02 00:00:00\n> reading from predicted folder\n> current final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n> 0 -999.0 -999.0  0.0  ...  101861.375000          -999.0            0.0\n> 1 -999.0 -999.0  0.0  ...  101861.375000          -999.0            0.0\n> 2 -999.0 -999.0  0.0  ...  101853.773438          -999.0            0.0\n> 3 -999.0 -999.0  0.0  ...  101853.773438          -999.0            0.0\n> 4 -999.0 -999.0  0.0  ...  101844.171875          -999.0            0.0\n> \n> [5 rows x 72 columns]\n> renaming Predicted_FRP to FRP\n> remove the current predicted_frp\n> reading past files for 2021-07-01 00:00:00\n> reading from original folder\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210701.txt\n> New time series dataframe:      LAT         LON    FRP  ...  VPD_7_days_ago   P_7_days_ago  FRP_7_days_ago\n> 0  24.5 -126.000000 -999.0  ...          -999.0  101530.867188          -999.0\n> 1  24.5 -125.899994 -999.0  ...          -999.0  101530.867188          -999.0\n> 2  24.5 -125.800003 -999.0  ...          -999.0  101528.468750          -999.0\n> 3  24.5 -125.699997 -999.0  ...          -999.0  101528.468750          -999.0\n> 4  24.5 -125.599998 -999.0  ...          -999.0  101526.070312          -999.0\n> \n> [5 rows x 74 columns]\n> Original df is created:  (156861, 74)\n> Original df filled the na with -9999 \n> X and y are loaded into memory for 20210708\n> the loaded model is:  TabNetRegressor(n_d=17, n_a=41, n_steps=4, gamma=1.1546672563068268, cat_idxs=[], cat_dims=[], cat_emb_dim=[], n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.00042602006758391, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=71, output_dim=1, device_name='auto', n_shared_decoder=1, n_indep_decoder=1, grouped_features=[])\n> Loaded model is a TabNet model.\n> Prediction for 20210708 of start day 20210702 is finished\n> new columns to check:  ['FRP_1_days_ago', 'Nearest_1', 'Nearest_2', 'Nearest_3', 'Nearest_4', 'Nearest_5', 'Nearest_6', 'Nearest_7', 'Nearest_8']\n> current merged_df columns:  Index(['FWI', 'VPD', 'HT', 'T', 'RH', 'U', 'V', 'P', 'RAIN', 'CAPE', 'ST',\n>        'SM', 'Nearest_1', 'Nearest_2', 'Nearest_3', 'Nearest_4', 'Nearest_5',\n>        'Nearest_6', 'Nearest_7', 'Nearest_8', 'Nearest_9', 'Nearest_10',\n>        'Nearest_11', 'Nearest_12', 'Nearest_13', 'Nearest_14', 'Nearest_15',\n>        'Nearest_16', 'Nearest_17', 'Nearest_18', 'Nearest_19', 'Nearest_20',\n>        'Nearest_21', 'Nearest_22', 'Nearest_23', 'Nearest_24', 'Land_Use',\n>        'VCI_AVE', 'TCI_AVE', 'VHI_AVE', 'VCI_TOT', 'TCI_TOT', 'VHI_TOT',\n>        'FWI_1_days_ago', 'VPD_1_days_ago', 'P_1_days_ago', 'FRP_1_days_ago',\n>        'FWI_2_days_ago', 'VPD_2_days_ago', 'P_2_days_ago', 'FRP_2_days_ago',\n>        'FWI_3_days_ago', 'VPD_3_days_ago', 'P_3_days_ago', 'FRP_3_days_ago',\n>        'FWI_4_days_ago', 'VPD_4_days_ago', 'P_4_days_ago', 'FRP_4_days_ago',\n>        'FWI_5_days_ago', 'VPD_5_days_ago', 'P_5_days_ago', 'FRP_5_days_ago',\n>        'FWI_6_days_ago', 'VPD_6_days_ago', 'P_6_days_ago', 'FRP_6_days_ago',\n>        'FWI_7_days_ago', 'VPD_7_days_ago', 'P_7_days_ago', 'FRP_7_days_ago',\n>        'Predicted_FRP'],\n>       dtype='object')\n1202a1203,1245\n> Prediction results are saved to /groups/ESS3/zsun/firecasting/data/output/output_tabnet_window_7_days_forecasting_with_new_yunyao_window_time_series_landuse_vhi_latlon//20210702/firedata_20210708_predicted.txt\n> ['Mean Absolute Error (MAE): 22.020416623625227', 'Mean Squared Error (MSE): 22179.35521438712', 'Root Mean Squared Error (RMSE): 148.92734877915177', 'R-squared (R2) Score: -0.021675895021817215', 'Explained Variance Score: 4.955835205655568e-06', 'Median Absolute Error (MedAE): 0.0', 'Max Error: 5463.914419518793', 'Mean: -21.694544765945654', 'Median: 0.0', 'Standard Deviation: 147.33952624013253', 'Minimum: -999.0', 'Maximum: 5464.172363', 'Count: 156861']\n> Metrics saved to /groups/ESS3/zsun/firecasting/data/output/output_tabnet_window_7_days_forecasting_with_new_yunyao_window_time_series_landuse_vhi_latlon//20210702/metrics_20210708_predicted.txt\n> current date:  2021-07-03 00:00:00\n> single_day_current_date =  2021-07-03 00:00:00\n> single_day_predict_end_date =  2021-07-10 00:00:00\n> predicting:  20210703\n> Read from original folder for current date: 20210703\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210703.txt\n> reading past files for 2021-07-02 00:00:00\n> reading from original folder\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210702.txt\n> reading past files for 2021-07-01 00:00:00\n> reading from original folder\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210701.txt\n> reading past files for 2021-06-30 00:00:00\n> reading from original folder\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210630.txt\n> reading past files for 2021-06-29 00:00:00\n> reading from original folder\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210629.txt\n> reading past files for 2021-06-28 00:00:00\n> reading from original folder\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210628.txt\n> reading past files for 2021-06-27 00:00:00\n> reading from original folder\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210627.txt\n> reading past files for 2021-06-26 00:00:00\n> reading from original folder\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210626.txt\n> New time series dataframe:      LAT         LON    FRP  ...  VPD_7_days_ago   P_7_days_ago  FRP_7_days_ago\n> 0  24.5 -126.000000 -999.0  ...          -999.0  101701.023438          -999.0\n> 1  24.5 -125.899994 -999.0  ...          -999.0  101701.023438          -999.0\n> 2  24.5 -125.800003 -999.0  ...          -999.0  101689.023438          -999.0\n> 3  24.5 -125.699997 -999.0  ...          -999.0  101689.023438          -999.0\n> 4  24.5 -125.599998 -999.0  ...          -999.0  101676.625000          -999.0\n> \n> [5 rows x 74 columns]\n> Original df is created:  (156861, 74)\n> Original df filled the na with -9999 \n> X and y are loaded into memory for 20210703\n> the loaded model is:  TabNetRegressor(n_d=17, n_a=41, n_steps=4, gamma=1.1546672563068268, cat_idxs=[], cat_dims=[], cat_emb_dim=[], n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.00042602006758391, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=71, output_dim=1, device_name='auto', n_shared_decoder=1, n_indep_decoder=1, grouped_features=[])\n> Loaded model is a TabNet model.\n1245a1246,1263\n> Prediction for 20210703 of start day 20210703 is finished\n> new columns to check:  ['FRP_1_days_ago', 'Nearest_1', 'Nearest_2', 'Nearest_3', 'Nearest_4', 'Nearest_5', 'Nearest_6', 'Nearest_7', 'Nearest_8']\n> current merged_df columns:  Index(['FWI', 'VPD', 'HT', 'T', 'RH', 'U', 'V', 'P', 'RAIN', 'CAPE', 'ST',\n>        'SM', 'Nearest_1', 'Nearest_2', 'Nearest_3', 'Nearest_4', 'Nearest_5',\n>        'Nearest_6', 'Nearest_7', 'Nearest_8', 'Nearest_9', 'Nearest_10',\n>        'Nearest_11', 'Nearest_12', 'Nearest_13', 'Nearest_14', 'Nearest_15',\n>        'Nearest_16', 'Nearest_17', 'Nearest_18', 'Nearest_19', 'Nearest_20',\n>        'Nearest_21', 'Nearest_22', 'Nearest_23', 'Nearest_24', 'Land_Use',\n>        'VCI_AVE', 'TCI_AVE', 'VHI_AVE', 'VCI_TOT', 'TCI_TOT', 'VHI_TOT',\n>        'FWI_1_days_ago', 'VPD_1_days_ago', 'P_1_days_ago', 'FRP_1_days_ago',\n>        'FWI_2_days_ago', 'VPD_2_days_ago', 'P_2_days_ago', 'FRP_2_days_ago',\n>        'FWI_3_days_ago', 'VPD_3_days_ago', 'P_3_days_ago', 'FRP_3_days_ago',\n>        'FWI_4_days_ago', 'VPD_4_days_ago', 'P_4_days_ago', 'FRP_4_days_ago',\n>        'FWI_5_days_ago', 'VPD_5_days_ago', 'P_5_days_ago', 'FRP_5_days_ago',\n>        'FWI_6_days_ago', 'VPD_6_days_ago', 'P_6_days_ago', 'FRP_6_days_ago',\n>        'FWI_7_days_ago', 'VPD_7_days_ago', 'P_7_days_ago', 'FRP_7_days_ago',\n>        'Predicted_FRP'],\n>       dtype='object')\n1263a1264,1330\n> Prediction results are saved to /groups/ESS3/zsun/firecasting/data/output/output_tabnet_window_7_days_forecasting_with_new_yunyao_window_time_series_landuse_vhi_latlon//20210703/firedata_20210703_predicted.txt\n> ['Mean Absolute Error (MAE): 21.89396512070694', 'Mean Squared Error (MSE): 21850.510504113292', 'Root Mean Squared Error (RMSE): 147.8191817867806', 'R-squared (R2) Score: -0.022276069204362203', 'Explained Variance Score: 5.938897884583128e-07', 'Median Absolute Error (MedAE): 0.0', 'Max Error: 1241.735596', 'Mean: -21.820777627262355', 'Median: 0.0', 'Standard Deviation: 146.20023852683786', 'Minimum: -999.0', 'Maximum: 1241.735596', 'Count: 156861']\n> Metrics saved to /groups/ESS3/zsun/firecasting/data/output/output_tabnet_window_7_days_forecasting_with_new_yunyao_window_time_series_landuse_vhi_latlon//20210703/metrics_20210703_predicted.txt\n> predicting:  20210704\n> Read from original folder for current date: 20210704\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210704.txt\n> reading past files for 2021-07-03 00:00:00\n> reading from predicted folder\n> current final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n> 0 -999.0 -999.0  0.0  ...  101701.023438          -999.0            0.0\n> 1 -999.0 -999.0  0.0  ...  101701.023438          -999.0            0.0\n> 2 -999.0 -999.0  0.0  ...  101689.023438          -999.0            0.0\n> 3 -999.0 -999.0  0.0  ...  101689.023438          -999.0            0.0\n> 4 -999.0 -999.0  0.0  ...  101676.625000          -999.0            0.0\n> \n> [5 rows x 72 columns]\n> renaming Predicted_FRP to FRP\n> remove the current predicted_frp\n> reading past files for 2021-07-02 00:00:00\n> reading from original folder\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210702.txt\n> reading past files for 2021-07-01 00:00:00\n> reading from original folder\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210701.txt\n> reading past files for 2021-06-30 00:00:00\n> reading from original folder\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210630.txt\n> reading past files for 2021-06-29 00:00:00\n> reading from original folder\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210629.txt\n> reading past files for 2021-06-28 00:00:00\n> reading from original folder\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210628.txt\n> reading past files for 2021-06-27 00:00:00\n> reading from original folder\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210627.txt\n> New time series dataframe:      LAT         LON    FRP  ...  VPD_7_days_ago   P_7_days_ago  FRP_7_days_ago\n> 0  24.5 -126.000000 -999.0  ...          -999.0  101521.437500          -999.0\n> 1  24.5 -125.899994 -999.0  ...          -999.0  101521.437500          -999.0\n> 2  24.5 -125.800003 -999.0  ...          -999.0  101507.437500          -999.0\n> 3  24.5 -125.699997 -999.0  ...          -999.0  101507.437500          -999.0\n> 4  24.5 -125.599998 -999.0  ...          -999.0  101494.640625          -999.0\n> \n> [5 rows x 74 columns]\n> Original df is created:  (156861, 74)\n> Original df filled the na with -9999 \n> X and y are loaded into memory for 20210704\n> the loaded model is:  TabNetRegressor(n_d=17, n_a=41, n_steps=4, gamma=1.1546672563068268, cat_idxs=[], cat_dims=[], cat_emb_dim=[], n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.00042602006758391, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=71, output_dim=1, device_name='auto', n_shared_decoder=1, n_indep_decoder=1, grouped_features=[])\n> Loaded model is a TabNet model.\n> Prediction for 20210704 of start day 20210703 is finished\n> new columns to check:  ['FRP_1_days_ago', 'Nearest_1', 'Nearest_2', 'Nearest_3', 'Nearest_4', 'Nearest_5', 'Nearest_6', 'Nearest_7', 'Nearest_8']\n> current merged_df columns:  Index(['FWI', 'VPD', 'HT', 'T', 'RH', 'U', 'V', 'P', 'RAIN', 'CAPE', 'ST',\n>        'SM', 'Nearest_1', 'Nearest_2', 'Nearest_3', 'Nearest_4', 'Nearest_5',\n>        'Nearest_6', 'Nearest_7', 'Nearest_8', 'Nearest_9', 'Nearest_10',\n>        'Nearest_11', 'Nearest_12', 'Nearest_13', 'Nearest_14', 'Nearest_15',\n>        'Nearest_16', 'Nearest_17', 'Nearest_18', 'Nearest_19', 'Nearest_20',\n>        'Nearest_21', 'Nearest_22', 'Nearest_23', 'Nearest_24', 'Land_Use',\n>        'VCI_AVE', 'TCI_AVE', 'VHI_AVE', 'VCI_TOT', 'TCI_TOT', 'VHI_TOT',\n>        'FWI_1_days_ago', 'VPD_1_days_ago', 'P_1_days_ago', 'FRP_1_days_ago',\n>        'FWI_2_days_ago', 'VPD_2_days_ago', 'P_2_days_ago', 'FRP_2_days_ago',\n>        'FWI_3_days_ago', 'VPD_3_days_ago', 'P_3_days_ago', 'FRP_3_days_ago',\n>        'FWI_4_days_ago', 'VPD_4_days_ago', 'P_4_days_ago', 'FRP_4_days_ago',\n>        'FWI_5_days_ago', 'VPD_5_days_ago', 'P_5_days_ago', 'FRP_5_days_ago',\n>        'FWI_6_days_ago', 'VPD_6_days_ago', 'P_6_days_ago', 'FRP_6_days_ago',\n>        'FWI_7_days_ago', 'VPD_7_days_ago', 'P_7_days_ago', 'FRP_7_days_ago',\n>        'Predicted_FRP'],\n>       dtype='object')\n1330a1331,1375\n> Prediction results are saved to /groups/ESS3/zsun/firecasting/data/output/output_tabnet_window_7_days_forecasting_with_new_yunyao_window_time_series_landuse_vhi_latlon//20210703/firedata_20210704_predicted.txt\n> ['Mean Absolute Error (MAE): 21.8967634387741', 'Mean Squared Error (MSE): 21857.44508706759', 'Root Mean Squared Error (RMSE): 147.8426362287537', 'R-squared (R2) Score: -0.02226290821301813', 'Explained Variance Score: 7.901796119647031e-07', 'Median Absolute Error (MedAE): 0.0', 'Max Error: 1180.5074685169525', 'Mean: -21.818007558577342', 'Median: 0.0', 'Standard Deviation: 146.2243773555253', 'Minimum: -999.0', 'Maximum: 1181.141357', 'Count: 156861']\n> Metrics saved to /groups/ESS3/zsun/firecasting/data/output/output_tabnet_window_7_days_forecasting_with_new_yunyao_window_time_series_landuse_vhi_latlon//20210703/metrics_20210704_predicted.txt\n> predicting:  20210705\n> Read from original folder for current date: 20210705\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210705.txt\n> reading past files for 2021-07-04 00:00:00\n> reading from predicted folder\n> current final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n> 0 -999.0 -999.0  0.0  ...  101521.437500          -999.0            0.0\n> 1 -999.0 -999.0  0.0  ...  101521.437500          -999.0            0.0\n> 2 -999.0 -999.0  0.0  ...  101507.437500          -999.0            0.0\n> 3 -999.0 -999.0  0.0  ...  101507.437500          -999.0            0.0\n> 4 -999.0 -999.0  0.0  ...  101494.640625          -999.0            0.0\n> \n> [5 rows x 72 columns]\n> renaming Predicted_FRP to FRP\n> remove the current predicted_frp\n> reading past files for 2021-07-03 00:00:00\n> reading from predicted folder\n> current final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n> 0 -999.0 -999.0  0.0  ...  101701.023438          -999.0            0.0\n> 1 -999.0 -999.0  0.0  ...  101701.023438          -999.0            0.0\n> 2 -999.0 -999.0  0.0  ...  101689.023438          -999.0            0.0\n> 3 -999.0 -999.0  0.0  ...  101689.023438          -999.0            0.0\n> 4 -999.0 -999.0  0.0  ...  101676.625000          -999.0            0.0\n> \n> [5 rows x 72 columns]\n> renaming Predicted_FRP to FRP\n> remove the current predicted_frp\n> reading past files for 2021-07-02 00:00:00\n> reading from original folder\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210702.txt\n> reading past files for 2021-07-01 00:00:00\n> reading from original folder\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210701.txt\n> reading past files for 2021-06-30 00:00:00\n> reading from original folder\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210630.txt\n> reading past files for 2021-06-29 00:00:00\n> reading from original folder\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210629.txt\n> reading past files for 2021-06-28 00:00:00\n> reading from original folder\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210628.txt\n1375a1376,1406\n> New time series dataframe:      LAT         LON    FRP  ...  VPD_7_days_ago   P_7_days_ago  FRP_7_days_ago\n> 0  24.5 -126.000000 -999.0  ...          -999.0  101352.601562          -999.0\n> 1  24.5 -125.899994 -999.0  ...          -999.0  101352.601562          -999.0\n> 2  24.5 -125.800003 -999.0  ...          -999.0  101336.601562          -999.0\n> 3  24.5 -125.699997 -999.0  ...          -999.0  101336.601562          -999.0\n> 4  24.5 -125.599998 -999.0  ...          -999.0  101320.203125          -999.0\n> \n> [5 rows x 74 columns]\n> Original df is created:  (156861, 74)\n> Original df filled the na with -9999 \n> X and y are loaded into memory for 20210705\n> the loaded model is:  TabNetRegressor(n_d=17, n_a=41, n_steps=4, gamma=1.1546672563068268, cat_idxs=[], cat_dims=[], cat_emb_dim=[], n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.00042602006758391, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=71, output_dim=1, device_name='auto', n_shared_decoder=1, n_indep_decoder=1, grouped_features=[])\n> Loaded model is a TabNet model.\n> Prediction for 20210705 of start day 20210703 is finished\n> new columns to check:  ['FRP_1_days_ago', 'Nearest_1', 'Nearest_2', 'Nearest_3', 'Nearest_4', 'Nearest_5', 'Nearest_6', 'Nearest_7', 'Nearest_8']\n> current merged_df columns:  Index(['FWI', 'VPD', 'HT', 'T', 'RH', 'U', 'V', 'P', 'RAIN', 'CAPE', 'ST',\n>        'SM', 'Nearest_1', 'Nearest_2', 'Nearest_3', 'Nearest_4', 'Nearest_5',\n>        'Nearest_6', 'Nearest_7', 'Nearest_8', 'Nearest_9', 'Nearest_10',\n>        'Nearest_11', 'Nearest_12', 'Nearest_13', 'Nearest_14', 'Nearest_15',\n>        'Nearest_16', 'Nearest_17', 'Nearest_18', 'Nearest_19', 'Nearest_20',\n>        'Nearest_21', 'Nearest_22', 'Nearest_23', 'Nearest_24', 'Land_Use',\n>        'VCI_AVE', 'TCI_AVE', 'VHI_AVE', 'VCI_TOT', 'TCI_TOT', 'VHI_TOT',\n>        'FWI_1_days_ago', 'VPD_1_days_ago', 'P_1_days_ago', 'FRP_1_days_ago',\n>        'FWI_2_days_ago', 'VPD_2_days_ago', 'P_2_days_ago', 'FRP_2_days_ago',\n>        'FWI_3_days_ago', 'VPD_3_days_ago', 'P_3_days_ago', 'FRP_3_days_ago',\n>        'FWI_4_days_ago', 'VPD_4_days_ago', 'P_4_days_ago', 'FRP_4_days_ago',\n>        'FWI_5_days_ago', 'VPD_5_days_ago', 'P_5_days_ago', 'FRP_5_days_ago',\n>        'FWI_6_days_ago', 'VPD_6_days_ago', 'P_6_days_ago', 'FRP_6_days_ago',\n>        'FWI_7_days_ago', 'VPD_7_days_ago', 'P_7_days_ago', 'FRP_7_days_ago',\n>        'Predicted_FRP'],\n>       dtype='object')\n1406a1407,1491\n> Prediction results are saved to /groups/ESS3/zsun/firecasting/data/output/output_tabnet_window_7_days_forecasting_with_new_yunyao_window_time_series_landuse_vhi_latlon//20210703/firedata_20210705_predicted.txt\n> ['Mean Absolute Error (MAE): 21.89973134715256', 'Mean Squared Error (MSE): 21849.950401207054', 'Root Mean Squared Error (RMSE): 147.81728722042985', 'R-squared (R2) Score: -0.0222651882845466', 'Explained Variance Score: 3.2136119931802654e-07', 'Median Absolute Error (MedAE): 0.0', 'Max Error: 1216.9396944375744', 'Mean: -21.81510091978249', 'Median: 0.0', 'Standard Deviation: 146.19914277086232', 'Minimum: -999.0', 'Maximum: 1216.946899', 'Count: 156861']\n> Metrics saved to /groups/ESS3/zsun/firecasting/data/output/output_tabnet_window_7_days_forecasting_with_new_yunyao_window_time_series_landuse_vhi_latlon//20210703/metrics_20210705_predicted.txt\n> predicting:  20210706\n> Read from original folder for current date: 20210706\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210706.txt\n> reading past files for 2021-07-05 00:00:00\n> reading from predicted folder\n> current final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n> 0 -999.0 -999.0  0.0  ...  101352.601562          -999.0            0.0\n> 1 -999.0 -999.0  0.0  ...  101352.601562          -999.0            0.0\n> 2 -999.0 -999.0  0.0  ...  101336.601562          -999.0            0.0\n> 3 -999.0 -999.0  0.0  ...  101336.601562          -999.0            0.0\n> 4 -999.0 -999.0  0.0  ...  101320.203125          -999.0            0.0\n> \n> [5 rows x 72 columns]\n> renaming Predicted_FRP to FRP\n> remove the current predicted_frp\n> reading past files for 2021-07-04 00:00:00\n> reading from predicted folder\n> current final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n> 0 -999.0 -999.0  0.0  ...  101521.437500          -999.0            0.0\n> 1 -999.0 -999.0  0.0  ...  101521.437500          -999.0            0.0\n> 2 -999.0 -999.0  0.0  ...  101507.437500          -999.0            0.0\n> 3 -999.0 -999.0  0.0  ...  101507.437500          -999.0            0.0\n> 4 -999.0 -999.0  0.0  ...  101494.640625          -999.0            0.0\n> \n> [5 rows x 72 columns]\n> renaming Predicted_FRP to FRP\n> remove the current predicted_frp\n> reading past files for 2021-07-03 00:00:00\n> reading from predicted folder\n> current final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n> 0 -999.0 -999.0  0.0  ...  101701.023438          -999.0            0.0\n> 1 -999.0 -999.0  0.0  ...  101701.023438          -999.0            0.0\n> 2 -999.0 -999.0  0.0  ...  101689.023438          -999.0            0.0\n> 3 -999.0 -999.0  0.0  ...  101689.023438          -999.0            0.0\n> 4 -999.0 -999.0  0.0  ...  101676.625000          -999.0            0.0\n> \n> [5 rows x 72 columns]\n> renaming Predicted_FRP to FRP\n> remove the current predicted_frp\n> reading past files for 2021-07-02 00:00:00\n> reading from original folder\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210702.txt\n> reading past files for 2021-07-01 00:00:00\n> reading from original folder\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210701.txt\n> reading past files for 2021-06-30 00:00:00\n> reading from original folder\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210630.txt\n> reading past files for 2021-06-29 00:00:00\n> reading from original folder\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210629.txt\n> New time series dataframe:      LAT         LON    FRP  ...  VPD_7_days_ago   P_7_days_ago  FRP_7_days_ago\n> 0  24.5 -126.000000 -999.0  ...          -999.0  101329.468750          -999.0\n> 1  24.5 -125.899994 -999.0  ...          -999.0  101329.468750          -999.0\n> 2  24.5 -125.800003 -999.0  ...          -999.0  101317.062500          -999.0\n> 3  24.5 -125.699997 -999.0  ...          -999.0  101317.062500          -999.0\n> 4  24.5 -125.599998 -999.0  ...          -999.0  101301.859375          -999.0\n> \n> [5 rows x 74 columns]\n> Original df is created:  (156861, 74)\n> Original df filled the na with -9999 \n> X and y are loaded into memory for 20210706\n> the loaded model is:  TabNetRegressor(n_d=17, n_a=41, n_steps=4, gamma=1.1546672563068268, cat_idxs=[], cat_dims=[], cat_emb_dim=[], n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.00042602006758391, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=71, output_dim=1, device_name='auto', n_shared_decoder=1, n_indep_decoder=1, grouped_features=[])\n> Loaded model is a TabNet model.\n> Prediction for 20210706 of start day 20210703 is finished\n> new columns to check:  ['FRP_1_days_ago', 'Nearest_1', 'Nearest_2', 'Nearest_3', 'Nearest_4', 'Nearest_5', 'Nearest_6', 'Nearest_7', 'Nearest_8']\n> current merged_df columns:  Index(['FWI', 'VPD', 'HT', 'T', 'RH', 'U', 'V', 'P', 'RAIN', 'CAPE', 'ST',\n>        'SM', 'Nearest_1', 'Nearest_2', 'Nearest_3', 'Nearest_4', 'Nearest_5',\n>        'Nearest_6', 'Nearest_7', 'Nearest_8', 'Nearest_9', 'Nearest_10',\n>        'Nearest_11', 'Nearest_12', 'Nearest_13', 'Nearest_14', 'Nearest_15',\n>        'Nearest_16', 'Nearest_17', 'Nearest_18', 'Nearest_19', 'Nearest_20',\n>        'Nearest_21', 'Nearest_22', 'Nearest_23', 'Nearest_24', 'Land_Use',\n>        'VCI_AVE', 'TCI_AVE', 'VHI_AVE', 'VCI_TOT', 'TCI_TOT', 'VHI_TOT',\n>        'FWI_1_days_ago', 'VPD_1_days_ago', 'P_1_days_ago', 'FRP_1_days_ago',\n>        'FWI_2_days_ago', 'VPD_2_days_ago', 'P_2_days_ago', 'FRP_2_days_ago',\n>        'FWI_3_days_ago', 'VPD_3_days_ago', 'P_3_days_ago', 'FRP_3_days_ago',\n>        'FWI_4_days_ago', 'VPD_4_days_ago', 'P_4_days_ago', 'FRP_4_days_ago',\n>        'FWI_5_days_ago', 'VPD_5_days_ago', 'P_5_days_ago', 'FRP_5_days_ago',\n>        'FWI_6_days_ago', 'VPD_6_days_ago', 'P_6_days_ago', 'FRP_6_days_ago',\n>        'FWI_7_days_ago', 'VPD_7_days_ago', 'P_7_days_ago', 'FRP_7_days_ago',\n>        'Predicted_FRP'],\n>       dtype='object')\n1491a1492,1585\n> Prediction results are saved to /groups/ESS3/zsun/firecasting/data/output/output_tabnet_window_7_days_forecasting_with_new_yunyao_window_time_series_landuse_vhi_latlon//20210703/firedata_20210706_predicted.txt\n> ['Mean Absolute Error (MAE): 21.968484403817687', 'Mean Squared Error (MSE): 22237.57193841142', 'Root Mean Squared Error (RMSE): 149.12267412573925', 'R-squared (R2) Score: -0.021725686257143995', 'Explained Variance Score: 2.789044998063872e-06', 'Median Absolute Error (MedAE): 0.0', 'Max Error: 7547.461402141784', 'Mean: -21.746309589547433', 'Median: 0.0', 'Standard Deviation: 147.52917421844327', 'Minimum: -999.0', 'Maximum: 7547.473145', 'Count: 156861']\n> Metrics saved to /groups/ESS3/zsun/firecasting/data/output/output_tabnet_window_7_days_forecasting_with_new_yunyao_window_time_series_landuse_vhi_latlon//20210703/metrics_20210706_predicted.txt\n> predicting:  20210707\n> Read from original folder for current date: 20210707\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210707.txt\n> reading past files for 2021-07-06 00:00:00\n> reading from predicted folder\n> current final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n> 0 -999.0 -999.0  0.0  ...  101329.468750          -999.0            0.0\n> 1 -999.0 -999.0  0.0  ...  101329.468750          -999.0            0.0\n> 2 -999.0 -999.0  0.0  ...  101317.062500          -999.0            0.0\n> 3 -999.0 -999.0  0.0  ...  101317.062500          -999.0            0.0\n> 4 -999.0 -999.0  0.0  ...  101301.859375          -999.0            0.0\n> \n> [5 rows x 72 columns]\n> renaming Predicted_FRP to FRP\n> remove the current predicted_frp\n> reading past files for 2021-07-05 00:00:00\n> reading from predicted folder\n> current final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n> 0 -999.0 -999.0  0.0  ...  101352.601562          -999.0            0.0\n> 1 -999.0 -999.0  0.0  ...  101352.601562          -999.0            0.0\n> 2 -999.0 -999.0  0.0  ...  101336.601562          -999.0            0.0\n> 3 -999.0 -999.0  0.0  ...  101336.601562          -999.0            0.0\n> 4 -999.0 -999.0  0.0  ...  101320.203125          -999.0            0.0\n> \n> [5 rows x 72 columns]\n> renaming Predicted_FRP to FRP\n> remove the current predicted_frp\n> reading past files for 2021-07-04 00:00:00\n> reading from predicted folder\n> current final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n> 0 -999.0 -999.0  0.0  ...  101521.437500          -999.0            0.0\n> 1 -999.0 -999.0  0.0  ...  101521.437500          -999.0            0.0\n> 2 -999.0 -999.0  0.0  ...  101507.437500          -999.0            0.0\n> 3 -999.0 -999.0  0.0  ...  101507.437500          -999.0            0.0\n> 4 -999.0 -999.0  0.0  ...  101494.640625          -999.0            0.0\n> \n> [5 rows x 72 columns]\n> renaming Predicted_FRP to FRP\n> remove the current predicted_frp\n> reading past files for 2021-07-03 00:00:00\n> reading from predicted folder\n> current final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n> 0 -999.0 -999.0  0.0  ...  101701.023438          -999.0            0.0\n> 1 -999.0 -999.0  0.0  ...  101701.023438          -999.0            0.0\n> 2 -999.0 -999.0  0.0  ...  101689.023438          -999.0            0.0\n> 3 -999.0 -999.0  0.0  ...  101689.023438          -999.0            0.0\n> 4 -999.0 -999.0  0.0  ...  101676.625000          -999.0            0.0\n> \n> [5 rows x 72 columns]\n> renaming Predicted_FRP to FRP\n> remove the current predicted_frp\n> reading past files for 2021-07-02 00:00:00\n> reading from original folder\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210702.txt\n> reading past files for 2021-07-01 00:00:00\n> reading from original folder\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210701.txt\n> reading past files for 2021-06-30 00:00:00\n> reading from original folder\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210630.txt\n> New time series dataframe:      LAT         LON    FRP  ...  VPD_7_days_ago   P_7_days_ago  FRP_7_days_ago\n> 0  24.5 -126.000000 -999.0  ...          -999.0  101381.734375          -999.0\n> 1  24.5 -125.899994 -999.0  ...          -999.0  101381.734375          -999.0\n> 2  24.5 -125.800003 -999.0  ...          -999.0  101376.140625          -999.0\n> 3  24.5 -125.699997 -999.0  ...          -999.0  101376.140625          -999.0\n> 4  24.5 -125.599998 -999.0  ...          -999.0  101371.742188          -999.0\n> \n> [5 rows x 74 columns]\n> Original df is created:  (156861, 74)\n> Original df filled the na with -9999 \n> X and y are loaded into memory for 20210707\n> the loaded model is:  TabNetRegressor(n_d=17, n_a=41, n_steps=4, gamma=1.1546672563068268, cat_idxs=[], cat_dims=[], cat_emb_dim=[], n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.00042602006758391, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=71, output_dim=1, device_name='auto', n_shared_decoder=1, n_indep_decoder=1, grouped_features=[])\n> Loaded model is a TabNet model.\n> Prediction for 20210707 of start day 20210703 is finished\n> new columns to check:  ['FRP_1_days_ago', 'Nearest_1', 'Nearest_2', 'Nearest_3', 'Nearest_4', 'Nearest_5', 'Nearest_6', 'Nearest_7', 'Nearest_8']\n> current merged_df columns:  Index(['FWI', 'VPD', 'HT', 'T', 'RH', 'U', 'V', 'P', 'RAIN', 'CAPE', 'ST',\n>        'SM', 'Nearest_1', 'Nearest_2', 'Nearest_3', 'Nearest_4', 'Nearest_5',\n>        'Nearest_6', 'Nearest_7', 'Nearest_8', 'Nearest_9', 'Nearest_10',\n>        'Nearest_11', 'Nearest_12', 'Nearest_13', 'Nearest_14', 'Nearest_15',\n>        'Nearest_16', 'Nearest_17', 'Nearest_18', 'Nearest_19', 'Nearest_20',\n>        'Nearest_21', 'Nearest_22', 'Nearest_23', 'Nearest_24', 'Land_Use',\n>        'VCI_AVE', 'TCI_AVE', 'VHI_AVE', 'VCI_TOT', 'TCI_TOT', 'VHI_TOT',\n>        'FWI_1_days_ago', 'VPD_1_days_ago', 'P_1_days_ago', 'FRP_1_days_ago',\n>        'FWI_2_days_ago', 'VPD_2_days_ago', 'P_2_days_ago', 'FRP_2_days_ago',\n>        'FWI_3_days_ago', 'VPD_3_days_ago', 'P_3_days_ago', 'FRP_3_days_ago',\n>        'FWI_4_days_ago', 'VPD_4_days_ago', 'P_4_days_ago', 'FRP_4_days_ago',\n>        'FWI_5_days_ago', 'VPD_5_days_ago', 'P_5_days_ago', 'FRP_5_days_ago',\n>        'FWI_6_days_ago', 'VPD_6_days_ago', 'P_6_days_ago', 'FRP_6_days_ago',\n>        'FWI_7_days_ago', 'VPD_7_days_ago', 'P_7_days_ago', 'FRP_7_days_ago',\n>        'Predicted_FRP'],\n>       dtype='object')\n1585a1586,1641\n> Prediction results are saved to /groups/ESS3/zsun/firecasting/data/output/output_tabnet_window_7_days_forecasting_with_new_yunyao_window_time_series_landuse_vhi_latlon//20210703/firedata_20210707_predicted.txt\n> ['Mean Absolute Error (MAE): 22.085100226816856', 'Mean Squared Error (MSE): 23056.245399844316', 'Root Mean Squared Error (RMSE): 151.84283124284897', 'R-squared (R2) Score: -0.020717595921202925', 'Explained Variance Score: -1.4859548786994026e-06', 'Median Absolute Error (MedAE): 0.0', 'Max Error: 11733.887126589194', 'Mean: -21.630771051147192', 'Median: 0.0', 'Standard Deviation: 150.29442683250224', 'Minimum: -999.0', 'Maximum: 11733.90625', 'Count: 156861']\n> Metrics saved to /groups/ESS3/zsun/firecasting/data/output/output_tabnet_window_7_days_forecasting_with_new_yunyao_window_time_series_landuse_vhi_latlon//20210703/metrics_20210707_predicted.txt\n> predicting:  20210708\n> Read from original folder for current date: 20210708\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210708.txt\n> reading past files for 2021-07-07 00:00:00\n> reading from predicted folder\n> current final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n> 0 -999.0 -999.0  0.0  ...  101381.734375          -999.0            0.0\n> 1 -999.0 -999.0  0.0  ...  101381.734375          -999.0            0.0\n> 2 -999.0 -999.0  0.0  ...  101376.140625          -999.0            0.0\n> 3 -999.0 -999.0  0.0  ...  101376.140625          -999.0            0.0\n> 4 -999.0 -999.0  0.0  ...  101371.742188          -999.0            0.0\n> \n> [5 rows x 72 columns]\n> renaming Predicted_FRP to FRP\n> remove the current predicted_frp\n> reading past files for 2021-07-06 00:00:00\n> reading from predicted folder\n> current final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n> 0 -999.0 -999.0  0.0  ...  101329.468750          -999.0            0.0\n> 1 -999.0 -999.0  0.0  ...  101329.468750          -999.0            0.0\n> 2 -999.0 -999.0  0.0  ...  101317.062500          -999.0            0.0\n> 3 -999.0 -999.0  0.0  ...  101317.062500          -999.0            0.0\n> 4 -999.0 -999.0  0.0  ...  101301.859375          -999.0            0.0\n> \n> [5 rows x 72 columns]\n> renaming Predicted_FRP to FRP\n> remove the current predicted_frp\n> reading past files for 2021-07-05 00:00:00\n> reading from predicted folder\n> current final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n> 0 -999.0 -999.0  0.0  ...  101352.601562          -999.0            0.0\n> 1 -999.0 -999.0  0.0  ...  101352.601562          -999.0            0.0\n> 2 -999.0 -999.0  0.0  ...  101336.601562          -999.0            0.0\n> 3 -999.0 -999.0  0.0  ...  101336.601562          -999.0            0.0\n> 4 -999.0 -999.0  0.0  ...  101320.203125          -999.0            0.0\n> \n> [5 rows x 72 columns]\n> renaming Predicted_FRP to FRP\n> remove the current predicted_frp\n> reading past files for 2021-07-04 00:00:00\n> reading from predicted folder\n> current final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n> 0 -999.0 -999.0  0.0  ...  101521.437500          -999.0            0.0\n> 1 -999.0 -999.0  0.0  ...  101521.437500          -999.0            0.0\n> 2 -999.0 -999.0  0.0  ...  101507.437500          -999.0            0.0\n> 3 -999.0 -999.0  0.0  ...  101507.437500          -999.0            0.0\n> 4 -999.0 -999.0  0.0  ...  101494.640625          -999.0            0.0\n> \n> [5 rows x 72 columns]\n> renaming Predicted_FRP to FRP\n> remove the current predicted_frp\n> reading past files for 2021-07-03 00:00:00\n> reading from predicted folder\n1641a1642,1688\n> current final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n> 0 -999.0 -999.0  0.0  ...  101701.023438          -999.0            0.0\n> 1 -999.0 -999.0  0.0  ...  101701.023438          -999.0            0.0\n> 2 -999.0 -999.0  0.0  ...  101689.023438          -999.0            0.0\n> 3 -999.0 -999.0  0.0  ...  101689.023438          -999.0            0.0\n> 4 -999.0 -999.0  0.0  ...  101676.625000          -999.0            0.0\n> \n> [5 rows x 72 columns]\n> renaming Predicted_FRP to FRP\n> remove the current predicted_frp\n> reading past files for 2021-07-02 00:00:00\n> reading from original folder\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210702.txt\n> reading past files for 2021-07-01 00:00:00\n> reading from original folder\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210701.txt\n> New time series dataframe:      LAT         LON    FRP  ...  VPD_7_days_ago   P_7_days_ago  FRP_7_days_ago\n> 0  24.5 -126.000000 -999.0  ...          -999.0  101530.867188          -999.0\n> 1  24.5 -125.899994 -999.0  ...          -999.0  101530.867188          -999.0\n> 2  24.5 -125.800003 -999.0  ...          -999.0  101528.468750          -999.0\n> 3  24.5 -125.699997 -999.0  ...          -999.0  101528.468750          -999.0\n> 4  24.5 -125.599998 -999.0  ...          -999.0  101526.070312          -999.0\n> \n> [5 rows x 74 columns]\n> Original df is created:  (156861, 74)\n> Original df filled the na with -9999 \n> X and y are loaded into memory for 20210708\n> the loaded model is:  TabNetRegressor(n_d=17, n_a=41, n_steps=4, gamma=1.1546672563068268, cat_idxs=[], cat_dims=[], cat_emb_dim=[], n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.00042602006758391, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=71, output_dim=1, device_name='auto', n_shared_decoder=1, n_indep_decoder=1, grouped_features=[])\n> Loaded model is a TabNet model.\n> Prediction for 20210708 of start day 20210703 is finished\n> new columns to check:  ['FRP_1_days_ago', 'Nearest_1', 'Nearest_2', 'Nearest_3', 'Nearest_4', 'Nearest_5', 'Nearest_6', 'Nearest_7', 'Nearest_8']\n> current merged_df columns:  Index(['FWI', 'VPD', 'HT', 'T', 'RH', 'U', 'V', 'P', 'RAIN', 'CAPE', 'ST',\n>        'SM', 'Nearest_1', 'Nearest_2', 'Nearest_3', 'Nearest_4', 'Nearest_5',\n>        'Nearest_6', 'Nearest_7', 'Nearest_8', 'Nearest_9', 'Nearest_10',\n>        'Nearest_11', 'Nearest_12', 'Nearest_13', 'Nearest_14', 'Nearest_15',\n>        'Nearest_16', 'Nearest_17', 'Nearest_18', 'Nearest_19', 'Nearest_20',\n>        'Nearest_21', 'Nearest_22', 'Nearest_23', 'Nearest_24', 'Land_Use',\n>        'VCI_AVE', 'TCI_AVE', 'VHI_AVE', 'VCI_TOT', 'TCI_TOT', 'VHI_TOT',\n>        'FWI_1_days_ago', 'VPD_1_days_ago', 'P_1_days_ago', 'FRP_1_days_ago',\n>        'FWI_2_days_ago', 'VPD_2_days_ago', 'P_2_days_ago', 'FRP_2_days_ago',\n>        'FWI_3_days_ago', 'VPD_3_days_ago', 'P_3_days_ago', 'FRP_3_days_ago',\n>        'FWI_4_days_ago', 'VPD_4_days_ago', 'P_4_days_ago', 'FRP_4_days_ago',\n>        'FWI_5_days_ago', 'VPD_5_days_ago', 'P_5_days_ago', 'FRP_5_days_ago',\n>        'FWI_6_days_ago', 'VPD_6_days_ago', 'P_6_days_ago', 'FRP_6_days_ago',\n>        'FWI_7_days_ago', 'VPD_7_days_ago', 'P_7_days_ago', 'FRP_7_days_ago',\n>        'Predicted_FRP'],\n>       dtype='object')\n1688a1689,1782\n> Prediction results are saved to /groups/ESS3/zsun/firecasting/data/output/output_tabnet_window_7_days_forecasting_with_new_yunyao_window_time_series_landuse_vhi_latlon//20210703/firedata_20210708_predicted.txt\n> ['Mean Absolute Error (MAE): 22.020403985167842', 'Mean Squared Error (MSE): 22179.355211159796', 'Root Mean Squared Error (RMSE): 148.92734876831653', 'R-squared (R2) Score: -0.0216758948731528', 'Explained Variance Score: 4.93107632826284e-06', 'Median Absolute Error (MedAE): 0.0', 'Max Error: 5463.914419518793', 'Mean: -21.694544765945654', 'Median: 0.0', 'Standard Deviation: 147.33952624013253', 'Minimum: -999.0', 'Maximum: 5464.172363', 'Count: 156861']\n> Metrics saved to /groups/ESS3/zsun/firecasting/data/output/output_tabnet_window_7_days_forecasting_with_new_yunyao_window_time_series_landuse_vhi_latlon//20210703/metrics_20210708_predicted.txt\n> predicting:  20210709\n> Read from original folder for current date: 20210709\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210709.txt\n> reading past files for 2021-07-08 00:00:00\n> reading from predicted folder\n> current final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n> 0 -999.0 -999.0  0.0  ...  101530.867188          -999.0            0.0\n> 1 -999.0 -999.0  0.0  ...  101530.867188          -999.0            0.0\n> 2 -999.0 -999.0  0.0  ...  101528.468750          -999.0            0.0\n> 3 -999.0 -999.0  0.0  ...  101528.468750          -999.0            0.0\n> 4 -999.0 -999.0  0.0  ...  101526.070312          -999.0            0.0\n> \n> [5 rows x 72 columns]\n> renaming Predicted_FRP to FRP\n> remove the current predicted_frp\n> reading past files for 2021-07-07 00:00:00\n> reading from predicted folder\n> current final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n> 0 -999.0 -999.0  0.0  ...  101381.734375          -999.0            0.0\n> 1 -999.0 -999.0  0.0  ...  101381.734375          -999.0            0.0\n> 2 -999.0 -999.0  0.0  ...  101376.140625          -999.0            0.0\n> 3 -999.0 -999.0  0.0  ...  101376.140625          -999.0            0.0\n> 4 -999.0 -999.0  0.0  ...  101371.742188          -999.0            0.0\n> \n> [5 rows x 72 columns]\n> renaming Predicted_FRP to FRP\n> remove the current predicted_frp\n> reading past files for 2021-07-06 00:00:00\n> reading from predicted folder\n> current final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n> 0 -999.0 -999.0  0.0  ...  101329.468750          -999.0            0.0\n> 1 -999.0 -999.0  0.0  ...  101329.468750          -999.0            0.0\n> 2 -999.0 -999.0  0.0  ...  101317.062500          -999.0            0.0\n> 3 -999.0 -999.0  0.0  ...  101317.062500          -999.0            0.0\n> 4 -999.0 -999.0  0.0  ...  101301.859375          -999.0            0.0\n> \n> [5 rows x 72 columns]\n> renaming Predicted_FRP to FRP\n> remove the current predicted_frp\n> reading past files for 2021-07-05 00:00:00\n> reading from predicted folder\n> current final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n> 0 -999.0 -999.0  0.0  ...  101352.601562          -999.0            0.0\n> 1 -999.0 -999.0  0.0  ...  101352.601562          -999.0            0.0\n> 2 -999.0 -999.0  0.0  ...  101336.601562          -999.0            0.0\n> 3 -999.0 -999.0  0.0  ...  101336.601562          -999.0            0.0\n> 4 -999.0 -999.0  0.0  ...  101320.203125          -999.0            0.0\n> \n> [5 rows x 72 columns]\n> renaming Predicted_FRP to FRP\n> remove the current predicted_frp\n> reading past files for 2021-07-04 00:00:00\n> reading from predicted folder\n> current final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n> 0 -999.0 -999.0  0.0  ...  101521.437500          -999.0            0.0\n> 1 -999.0 -999.0  0.0  ...  101521.437500          -999.0            0.0\n> 2 -999.0 -999.0  0.0  ...  101507.437500          -999.0            0.0\n> 3 -999.0 -999.0  0.0  ...  101507.437500          -999.0            0.0\n> 4 -999.0 -999.0  0.0  ...  101494.640625          -999.0            0.0\n> \n> [5 rows x 72 columns]\n> renaming Predicted_FRP to FRP\n> remove the current predicted_frp\n> reading past files for 2021-07-03 00:00:00\n> reading from predicted folder\n> current final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n> 0 -999.0 -999.0  0.0  ...  101701.023438          -999.0            0.0\n> 1 -999.0 -999.0  0.0  ...  101701.023438          -999.0            0.0\n> 2 -999.0 -999.0  0.0  ...  101689.023438          -999.0            0.0\n> 3 -999.0 -999.0  0.0  ...  101689.023438          -999.0            0.0\n> 4 -999.0 -999.0  0.0  ...  101676.625000          -999.0            0.0\n> \n> [5 rows x 72 columns]\n> renaming Predicted_FRP to FRP\n> remove the current predicted_frp\n> reading past files for 2021-07-02 00:00:00\n> reading from original folder\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210702.txt\n> New time series dataframe:      LAT         LON    FRP  ...  VPD_7_days_ago   P_7_days_ago  FRP_7_days_ago\n> 0  24.5 -126.000000 -999.0  ...          -999.0  101617.460938          -999.0\n> 1  24.5 -125.899994 -999.0  ...          -999.0  101617.460938          -999.0\n> 2  24.5 -125.800003 -999.0  ...          -999.0  101612.257812          -999.0\n> 3  24.5 -125.699997 -999.0  ...          -999.0  101612.257812          -999.0\n> 4  24.5 -125.599998 -999.0  ...          -999.0  101606.257812          -999.0\n> \n> [5 rows x 74 columns]\n> Original df is created:  (156861, 74)\n> Original df filled the na with -9999 \n> X and y are loaded into memory for 20210709\n> the loaded model is:  TabNetRegressor(n_d=17, n_a=41, n_steps=4, gamma=1.1546672563068268, cat_idxs=[], cat_dims=[], cat_emb_dim=[], n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.00042602006758391, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=71, output_dim=1, device_name='auto', n_shared_decoder=1, n_indep_decoder=1, grouped_features=[])\n> Loaded model is a TabNet model.\n1782a1783,1800\n> Prediction for 20210709 of start day 20210703 is finished\n> new columns to check:  ['FRP_1_days_ago', 'Nearest_1', 'Nearest_2', 'Nearest_3', 'Nearest_4', 'Nearest_5', 'Nearest_6', 'Nearest_7', 'Nearest_8']\n> current merged_df columns:  Index(['FWI', 'VPD', 'HT', 'T', 'RH', 'U', 'V', 'P', 'RAIN', 'CAPE', 'ST',\n>        'SM', 'Nearest_1', 'Nearest_2', 'Nearest_3', 'Nearest_4', 'Nearest_5',\n>        'Nearest_6', 'Nearest_7', 'Nearest_8', 'Nearest_9', 'Nearest_10',\n>        'Nearest_11', 'Nearest_12', 'Nearest_13', 'Nearest_14', 'Nearest_15',\n>        'Nearest_16', 'Nearest_17', 'Nearest_18', 'Nearest_19', 'Nearest_20',\n>        'Nearest_21', 'Nearest_22', 'Nearest_23', 'Nearest_24', 'Land_Use',\n>        'VCI_AVE', 'TCI_AVE', 'VHI_AVE', 'VCI_TOT', 'TCI_TOT', 'VHI_TOT',\n>        'FWI_1_days_ago', 'VPD_1_days_ago', 'P_1_days_ago', 'FRP_1_days_ago',\n>        'FWI_2_days_ago', 'VPD_2_days_ago', 'P_2_days_ago', 'FRP_2_days_ago',\n>        'FWI_3_days_ago', 'VPD_3_days_ago', 'P_3_days_ago', 'FRP_3_days_ago',\n>        'FWI_4_days_ago', 'VPD_4_days_ago', 'P_4_days_ago', 'FRP_4_days_ago',\n>        'FWI_5_days_ago', 'VPD_5_days_ago', 'P_5_days_ago', 'FRP_5_days_ago',\n>        'FWI_6_days_ago', 'VPD_6_days_ago', 'P_6_days_ago', 'FRP_6_days_ago',\n>        'FWI_7_days_ago', 'VPD_7_days_ago', 'P_7_days_ago', 'FRP_7_days_ago',\n>        'Predicted_FRP'],\n>       dtype='object')\n1800a1801,1843\n> Prediction results are saved to /groups/ESS3/zsun/firecasting/data/output/output_tabnet_window_7_days_forecasting_with_new_yunyao_window_time_series_landuse_vhi_latlon//20210703/firedata_20210709_predicted.txt\n> ['Mean Absolute Error (MAE): 22.44045001956146', 'Mean Squared Error (MSE): 27325.401618392185', 'Root Mean Squared Error (RMSE): 165.3039673401464', 'R-squared (R2) Score: -0.01682856863512816', 'Explained Variance Score: 2.1548523245651374e-05', 'Median Absolute Error (MedAE): 0.0', 'Max Error: 19604.529801375353', 'Mean: -21.276627506582255', 'Median: 0.0', 'Standard Deviation: 163.93088800132404', 'Minimum: -999.0', 'Maximum: 19605.007812', 'Count: 156861']\n> Metrics saved to /groups/ESS3/zsun/firecasting/data/output/output_tabnet_window_7_days_forecasting_with_new_yunyao_window_time_series_landuse_vhi_latlon//20210703/metrics_20210709_predicted.txt\n> current date:  2021-07-04 00:00:00\n> single_day_current_date =  2021-07-04 00:00:00\n> single_day_predict_end_date =  2021-07-11 00:00:00\n> predicting:  20210704\n> Read from original folder for current date: 20210704\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210704.txt\n> reading past files for 2021-07-03 00:00:00\n> reading from original folder\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210703.txt\n> reading past files for 2021-07-02 00:00:00\n> reading from original folder\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210702.txt\n> reading past files for 2021-07-01 00:00:00\n> reading from original folder\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210701.txt\n> reading past files for 2021-06-30 00:00:00\n> reading from original folder\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210630.txt\n> reading past files for 2021-06-29 00:00:00\n> reading from original folder\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210629.txt\n> reading past files for 2021-06-28 00:00:00\n> reading from original folder\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210628.txt\n> reading past files for 2021-06-27 00:00:00\n> reading from original folder\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210627.txt\n> New time series dataframe:      LAT         LON    FRP  ...  VPD_7_days_ago   P_7_days_ago  FRP_7_days_ago\n> 0  24.5 -126.000000 -999.0  ...          -999.0  101521.437500          -999.0\n> 1  24.5 -125.899994 -999.0  ...          -999.0  101521.437500          -999.0\n> 2  24.5 -125.800003 -999.0  ...          -999.0  101507.437500          -999.0\n> 3  24.5 -125.699997 -999.0  ...          -999.0  101507.437500          -999.0\n> 4  24.5 -125.599998 -999.0  ...          -999.0  101494.640625          -999.0\n> \n> [5 rows x 74 columns]\n> Original df is created:  (156861, 74)\n> Original df filled the na with -9999 \n> X and y are loaded into memory for 20210704\n> the loaded model is:  TabNetRegressor(n_d=17, n_a=41, n_steps=4, gamma=1.1546672563068268, cat_idxs=[], cat_dims=[], cat_emb_dim=[], n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.00042602006758391, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=71, output_dim=1, device_name='auto', n_shared_decoder=1, n_indep_decoder=1, grouped_features=[])\n> Loaded model is a TabNet model.\n1843a1844,1861\n> Prediction for 20210704 of start day 20210704 is finished\n> new columns to check:  ['FRP_1_days_ago', 'Nearest_1', 'Nearest_2', 'Nearest_3', 'Nearest_4', 'Nearest_5', 'Nearest_6', 'Nearest_7', 'Nearest_8']\n> current merged_df columns:  Index(['FWI', 'VPD', 'HT', 'T', 'RH', 'U', 'V', 'P', 'RAIN', 'CAPE', 'ST',\n>        'SM', 'Nearest_1', 'Nearest_2', 'Nearest_3', 'Nearest_4', 'Nearest_5',\n>        'Nearest_6', 'Nearest_7', 'Nearest_8', 'Nearest_9', 'Nearest_10',\n>        'Nearest_11', 'Nearest_12', 'Nearest_13', 'Nearest_14', 'Nearest_15',\n>        'Nearest_16', 'Nearest_17', 'Nearest_18', 'Nearest_19', 'Nearest_20',\n>        'Nearest_21', 'Nearest_22', 'Nearest_23', 'Nearest_24', 'Land_Use',\n>        'VCI_AVE', 'TCI_AVE', 'VHI_AVE', 'VCI_TOT', 'TCI_TOT', 'VHI_TOT',\n>        'FWI_1_days_ago', 'VPD_1_days_ago', 'P_1_days_ago', 'FRP_1_days_ago',\n>        'FWI_2_days_ago', 'VPD_2_days_ago', 'P_2_days_ago', 'FRP_2_days_ago',\n>        'FWI_3_days_ago', 'VPD_3_days_ago', 'P_3_days_ago', 'FRP_3_days_ago',\n>        'FWI_4_days_ago', 'VPD_4_days_ago', 'P_4_days_ago', 'FRP_4_days_ago',\n>        'FWI_5_days_ago', 'VPD_5_days_ago', 'P_5_days_ago', 'FRP_5_days_ago',\n>        'FWI_6_days_ago', 'VPD_6_days_ago', 'P_6_days_ago', 'FRP_6_days_ago',\n>        'FWI_7_days_ago', 'VPD_7_days_ago', 'P_7_days_ago', 'FRP_7_days_ago',\n>        'Predicted_FRP'],\n>       dtype='object')\n1861a1862,1897\n> Prediction results are saved to /groups/ESS3/zsun/firecasting/data/output/output_tabnet_window_7_days_forecasting_with_new_yunyao_window_time_series_landuse_vhi_latlon//20210704/firedata_20210704_predicted.txt\n> ['Mean Absolute Error (MAE): 21.89673228118895', 'Mean Squared Error (MSE): 21857.441893899984', 'Root Mean Squared Error (RMSE): 147.84262542954244', 'R-squared (R2) Score: -0.02226275887000062', 'Explained Variance Score: 9.021714351131749e-07', 'Median Absolute Error (MedAE): 0.0', 'Max Error: 1180.5074685169525', 'Mean: -21.818007558577342', 'Median: 0.0', 'Standard Deviation: 146.2243773555253', 'Minimum: -999.0', 'Maximum: 1181.141357', 'Count: 156861']\n> Metrics saved to /groups/ESS3/zsun/firecasting/data/output/output_tabnet_window_7_days_forecasting_with_new_yunyao_window_time_series_landuse_vhi_latlon//20210704/metrics_20210704_predicted.txt\n> predicting:  20210705\n> Read from original folder for current date: 20210705\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210705.txt\n> reading past files for 2021-07-04 00:00:00\n> reading from predicted folder\n> current final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n> 0 -999.0 -999.0  0.0  ...  101521.437500          -999.0            0.0\n> 1 -999.0 -999.0  0.0  ...  101521.437500          -999.0            0.0\n> 2 -999.0 -999.0  0.0  ...  101507.437500          -999.0            0.0\n> 3 -999.0 -999.0  0.0  ...  101507.437500          -999.0            0.0\n> 4 -999.0 -999.0  0.0  ...  101494.640625          -999.0            0.0\n> \n> [5 rows x 72 columns]\n> renaming Predicted_FRP to FRP\n> remove the current predicted_frp\n> reading past files for 2021-07-03 00:00:00\n> reading from original folder\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210703.txt\n> reading past files for 2021-07-02 00:00:00\n> reading from original folder\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210702.txt\n> reading past files for 2021-07-01 00:00:00\n> reading from original folder\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210701.txt\n> reading past files for 2021-06-30 00:00:00\n> reading from original folder\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210630.txt\n> reading past files for 2021-06-29 00:00:00\n> reading from original folder\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210629.txt\n> reading past files for 2021-06-28 00:00:00\n> reading from original folder\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210628.txt\n1897a1898,1928\n> New time series dataframe:      LAT         LON    FRP  ...  VPD_7_days_ago   P_7_days_ago  FRP_7_days_ago\n> 0  24.5 -126.000000 -999.0  ...          -999.0  101352.601562          -999.0\n> 1  24.5 -125.899994 -999.0  ...          -999.0  101352.601562          -999.0\n> 2  24.5 -125.800003 -999.0  ...          -999.0  101336.601562          -999.0\n> 3  24.5 -125.699997 -999.0  ...          -999.0  101336.601562          -999.0\n> 4  24.5 -125.599998 -999.0  ...          -999.0  101320.203125          -999.0\n> \n> [5 rows x 74 columns]\n> Original df is created:  (156861, 74)\n> Original df filled the na with -9999 \n> X and y are loaded into memory for 20210705\n> the loaded model is:  TabNetRegressor(n_d=17, n_a=41, n_steps=4, gamma=1.1546672563068268, cat_idxs=[], cat_dims=[], cat_emb_dim=[], n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.00042602006758391, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=71, output_dim=1, device_name='auto', n_shared_decoder=1, n_indep_decoder=1, grouped_features=[])\n> Loaded model is a TabNet model.\n> Prediction for 20210705 of start day 20210704 is finished\n> new columns to check:  ['FRP_1_days_ago', 'Nearest_1', 'Nearest_2', 'Nearest_3', 'Nearest_4', 'Nearest_5', 'Nearest_6', 'Nearest_7', 'Nearest_8']\n> current merged_df columns:  Index(['FWI', 'VPD', 'HT', 'T', 'RH', 'U', 'V', 'P', 'RAIN', 'CAPE', 'ST',\n>        'SM', 'Nearest_1', 'Nearest_2', 'Nearest_3', 'Nearest_4', 'Nearest_5',\n>        'Nearest_6', 'Nearest_7', 'Nearest_8', 'Nearest_9', 'Nearest_10',\n>        'Nearest_11', 'Nearest_12', 'Nearest_13', 'Nearest_14', 'Nearest_15',\n>        'Nearest_16', 'Nearest_17', 'Nearest_18', 'Nearest_19', 'Nearest_20',\n>        'Nearest_21', 'Nearest_22', 'Nearest_23', 'Nearest_24', 'Land_Use',\n>        'VCI_AVE', 'TCI_AVE', 'VHI_AVE', 'VCI_TOT', 'TCI_TOT', 'VHI_TOT',\n>        'FWI_1_days_ago', 'VPD_1_days_ago', 'P_1_days_ago', 'FRP_1_days_ago',\n>        'FWI_2_days_ago', 'VPD_2_days_ago', 'P_2_days_ago', 'FRP_2_days_ago',\n>        'FWI_3_days_ago', 'VPD_3_days_ago', 'P_3_days_ago', 'FRP_3_days_ago',\n>        'FWI_4_days_ago', 'VPD_4_days_ago', 'P_4_days_ago', 'FRP_4_days_ago',\n>        'FWI_5_days_ago', 'VPD_5_days_ago', 'P_5_days_ago', 'FRP_5_days_ago',\n>        'FWI_6_days_ago', 'VPD_6_days_ago', 'P_6_days_ago', 'FRP_6_days_ago',\n>        'FWI_7_days_ago', 'VPD_7_days_ago', 'P_7_days_ago', 'FRP_7_days_ago',\n>        'Predicted_FRP'],\n>       dtype='object')\n1928a1929,2004\n> Prediction results are saved to /groups/ESS3/zsun/firecasting/data/output/output_tabnet_window_7_days_forecasting_with_new_yunyao_window_time_series_landuse_vhi_latlon//20210704/firedata_20210705_predicted.txt\n> ['Mean Absolute Error (MAE): 21.899699610343653', 'Mean Squared Error (MSE): 21849.94517977188', 'Root Mean Squared Error (RMSE): 147.81726955864082', 'R-squared (R2) Score: -0.02226494399605561', 'Explained Variance Score: 5.520281386450776e-07', 'Median Absolute Error (MedAE): 0.0', 'Max Error: 1216.9396944375744', 'Mean: -21.81510091978249', 'Median: 0.0', 'Standard Deviation: 146.19914277086232', 'Minimum: -999.0', 'Maximum: 1216.946899', 'Count: 156861']\n> Metrics saved to /groups/ESS3/zsun/firecasting/data/output/output_tabnet_window_7_days_forecasting_with_new_yunyao_window_time_series_landuse_vhi_latlon//20210704/metrics_20210705_predicted.txt\n> predicting:  20210706\n> Read from original folder for current date: 20210706\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210706.txt\n> reading past files for 2021-07-05 00:00:00\n> reading from predicted folder\n> current final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n> 0 -999.0 -999.0  0.0  ...  101352.601562          -999.0            0.0\n> 1 -999.0 -999.0  0.0  ...  101352.601562          -999.0            0.0\n> 2 -999.0 -999.0  0.0  ...  101336.601562          -999.0            0.0\n> 3 -999.0 -999.0  0.0  ...  101336.601562          -999.0            0.0\n> 4 -999.0 -999.0  0.0  ...  101320.203125          -999.0            0.0\n> \n> [5 rows x 72 columns]\n> renaming Predicted_FRP to FRP\n> remove the current predicted_frp\n> reading past files for 2021-07-04 00:00:00\n> reading from predicted folder\n> current final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n> 0 -999.0 -999.0  0.0  ...  101521.437500          -999.0            0.0\n> 1 -999.0 -999.0  0.0  ...  101521.437500          -999.0            0.0\n> 2 -999.0 -999.0  0.0  ...  101507.437500          -999.0            0.0\n> 3 -999.0 -999.0  0.0  ...  101507.437500          -999.0            0.0\n> 4 -999.0 -999.0  0.0  ...  101494.640625          -999.0            0.0\n> \n> [5 rows x 72 columns]\n> renaming Predicted_FRP to FRP\n> remove the current predicted_frp\n> reading past files for 2021-07-03 00:00:00\n> reading from original folder\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210703.txt\n> reading past files for 2021-07-02 00:00:00\n> reading from original folder\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210702.txt\n> reading past files for 2021-07-01 00:00:00\n> reading from original folder\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210701.txt\n> reading past files for 2021-06-30 00:00:00\n> reading from original folder\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210630.txt\n> reading past files for 2021-06-29 00:00:00\n> reading from original folder\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210629.txt\n> New time series dataframe:      LAT         LON    FRP  ...  VPD_7_days_ago   P_7_days_ago  FRP_7_days_ago\n> 0  24.5 -126.000000 -999.0  ...          -999.0  101329.468750          -999.0\n> 1  24.5 -125.899994 -999.0  ...          -999.0  101329.468750          -999.0\n> 2  24.5 -125.800003 -999.0  ...          -999.0  101317.062500          -999.0\n> 3  24.5 -125.699997 -999.0  ...          -999.0  101317.062500          -999.0\n> 4  24.5 -125.599998 -999.0  ...          -999.0  101301.859375          -999.0\n> \n> [5 rows x 74 columns]\n> Original df is created:  (156861, 74)\n> Original df filled the na with -9999 \n> X and y are loaded into memory for 20210706\n> the loaded model is:  TabNetRegressor(n_d=17, n_a=41, n_steps=4, gamma=1.1546672563068268, cat_idxs=[], cat_dims=[], cat_emb_dim=[], n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.00042602006758391, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=71, output_dim=1, device_name='auto', n_shared_decoder=1, n_indep_decoder=1, grouped_features=[])\n> Loaded model is a TabNet model.\n> Prediction for 20210706 of start day 20210704 is finished\n> new columns to check:  ['FRP_1_days_ago', 'Nearest_1', 'Nearest_2', 'Nearest_3', 'Nearest_4', 'Nearest_5', 'Nearest_6', 'Nearest_7', 'Nearest_8']\n> current merged_df columns:  Index(['FWI', 'VPD', 'HT', 'T', 'RH', 'U', 'V', 'P', 'RAIN', 'CAPE', 'ST',\n>        'SM', 'Nearest_1', 'Nearest_2', 'Nearest_3', 'Nearest_4', 'Nearest_5',\n>        'Nearest_6', 'Nearest_7', 'Nearest_8', 'Nearest_9', 'Nearest_10',\n>        'Nearest_11', 'Nearest_12', 'Nearest_13', 'Nearest_14', 'Nearest_15',\n>        'Nearest_16', 'Nearest_17', 'Nearest_18', 'Nearest_19', 'Nearest_20',\n>        'Nearest_21', 'Nearest_22', 'Nearest_23', 'Nearest_24', 'Land_Use',\n>        'VCI_AVE', 'TCI_AVE', 'VHI_AVE', 'VCI_TOT', 'TCI_TOT', 'VHI_TOT',\n>        'FWI_1_days_ago', 'VPD_1_days_ago', 'P_1_days_ago', 'FRP_1_days_ago',\n>        'FWI_2_days_ago', 'VPD_2_days_ago', 'P_2_days_ago', 'FRP_2_days_ago',\n>        'FWI_3_days_ago', 'VPD_3_days_ago', 'P_3_days_ago', 'FRP_3_days_ago',\n>        'FWI_4_days_ago', 'VPD_4_days_ago', 'P_4_days_ago', 'FRP_4_days_ago',\n>        'FWI_5_days_ago', 'VPD_5_days_ago', 'P_5_days_ago', 'FRP_5_days_ago',\n>        'FWI_6_days_ago', 'VPD_6_days_ago', 'P_6_days_ago', 'FRP_6_days_ago',\n>        'FWI_7_days_ago', 'VPD_7_days_ago', 'P_7_days_ago', 'FRP_7_days_ago',\n>        'Predicted_FRP'],\n>       dtype='object')\n2004a2005,2055\n> Prediction results are saved to /groups/ESS3/zsun/firecasting/data/output/output_tabnet_window_7_days_forecasting_with_new_yunyao_window_time_series_landuse_vhi_latlon//20210704/firedata_20210706_predicted.txt\n> ['Mean Absolute Error (MAE): 21.96846422918536', 'Mean Squared Error (MSE): 22237.571946209973', 'Root Mean Squared Error (RMSE): 149.12267415188737', 'R-squared (R2) Score: -0.02172568661545582', 'Explained Variance Score: 2.747054351104339e-06', 'Median Absolute Error (MedAE): 0.0', 'Max Error: 7547.461402141784', 'Mean: -21.746309589547433', 'Median: 0.0', 'Standard Deviation: 147.52917421844327', 'Minimum: -999.0', 'Maximum: 7547.473145', 'Count: 156861']\n> Metrics saved to /groups/ESS3/zsun/firecasting/data/output/output_tabnet_window_7_days_forecasting_with_new_yunyao_window_time_series_landuse_vhi_latlon//20210704/metrics_20210706_predicted.txt\n> predicting:  20210707\n> Read from original folder for current date: 20210707\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210707.txt\n> reading past files for 2021-07-06 00:00:00\n> reading from predicted folder\n> current final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n> 0 -999.0 -999.0  0.0  ...  101329.468750          -999.0            0.0\n> 1 -999.0 -999.0  0.0  ...  101329.468750          -999.0            0.0\n> 2 -999.0 -999.0  0.0  ...  101317.062500          -999.0            0.0\n> 3 -999.0 -999.0  0.0  ...  101317.062500          -999.0            0.0\n> 4 -999.0 -999.0  0.0  ...  101301.859375          -999.0            0.0\n> \n> [5 rows x 72 columns]\n> renaming Predicted_FRP to FRP\n> remove the current predicted_frp\n> reading past files for 2021-07-05 00:00:00\n> reading from predicted folder\n> current final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n> 0 -999.0 -999.0  0.0  ...  101352.601562          -999.0            0.0\n> 1 -999.0 -999.0  0.0  ...  101352.601562          -999.0            0.0\n> 2 -999.0 -999.0  0.0  ...  101336.601562          -999.0            0.0\n> 3 -999.0 -999.0  0.0  ...  101336.601562          -999.0            0.0\n> 4 -999.0 -999.0  0.0  ...  101320.203125          -999.0            0.0\n> \n> [5 rows x 72 columns]\n> renaming Predicted_FRP to FRP\n> remove the current predicted_frp\n> reading past files for 2021-07-04 00:00:00\n> reading from predicted folder\n> current final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n> 0 -999.0 -999.0  0.0  ...  101521.437500          -999.0            0.0\n> 1 -999.0 -999.0  0.0  ...  101521.437500          -999.0            0.0\n> 2 -999.0 -999.0  0.0  ...  101507.437500          -999.0            0.0\n> 3 -999.0 -999.0  0.0  ...  101507.437500          -999.0            0.0\n> 4 -999.0 -999.0  0.0  ...  101494.640625          -999.0            0.0\n> \n> [5 rows x 72 columns]\n> renaming Predicted_FRP to FRP\n> remove the current predicted_frp\n> reading past files for 2021-07-03 00:00:00\n> reading from original folder\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210703.txt\n> reading past files for 2021-07-02 00:00:00\n> reading from original folder\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210702.txt\n> reading past files for 2021-07-01 00:00:00\n> reading from original folder\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210701.txt\n2055a2056,2089\n> reading past files for 2021-06-30 00:00:00\n> reading from original folder\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210630.txt\n> New time series dataframe:      LAT         LON    FRP  ...  VPD_7_days_ago   P_7_days_ago  FRP_7_days_ago\n> 0  24.5 -126.000000 -999.0  ...          -999.0  101381.734375          -999.0\n> 1  24.5 -125.899994 -999.0  ...          -999.0  101381.734375          -999.0\n> 2  24.5 -125.800003 -999.0  ...          -999.0  101376.140625          -999.0\n> 3  24.5 -125.699997 -999.0  ...          -999.0  101376.140625          -999.0\n> 4  24.5 -125.599998 -999.0  ...          -999.0  101371.742188          -999.0\n> \n> [5 rows x 74 columns]\n> Original df is created:  (156861, 74)\n> Original df filled the na with -9999 \n> X and y are loaded into memory for 20210707\n> the loaded model is:  TabNetRegressor(n_d=17, n_a=41, n_steps=4, gamma=1.1546672563068268, cat_idxs=[], cat_dims=[], cat_emb_dim=[], n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.00042602006758391, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=71, output_dim=1, device_name='auto', n_shared_decoder=1, n_indep_decoder=1, grouped_features=[])\n> Loaded model is a TabNet model.\n> Prediction for 20210707 of start day 20210704 is finished\n> new columns to check:  ['FRP_1_days_ago', 'Nearest_1', 'Nearest_2', 'Nearest_3', 'Nearest_4', 'Nearest_5', 'Nearest_6', 'Nearest_7', 'Nearest_8']\n> current merged_df columns:  Index(['FWI', 'VPD', 'HT', 'T', 'RH', 'U', 'V', 'P', 'RAIN', 'CAPE', 'ST',\n>        'SM', 'Nearest_1', 'Nearest_2', 'Nearest_3', 'Nearest_4', 'Nearest_5',\n>        'Nearest_6', 'Nearest_7', 'Nearest_8', 'Nearest_9', 'Nearest_10',\n>        'Nearest_11', 'Nearest_12', 'Nearest_13', 'Nearest_14', 'Nearest_15',\n>        'Nearest_16', 'Nearest_17', 'Nearest_18', 'Nearest_19', 'Nearest_20',\n>        'Nearest_21', 'Nearest_22', 'Nearest_23', 'Nearest_24', 'Land_Use',\n>        'VCI_AVE', 'TCI_AVE', 'VHI_AVE', 'VCI_TOT', 'TCI_TOT', 'VHI_TOT',\n>        'FWI_1_days_ago', 'VPD_1_days_ago', 'P_1_days_ago', 'FRP_1_days_ago',\n>        'FWI_2_days_ago', 'VPD_2_days_ago', 'P_2_days_ago', 'FRP_2_days_ago',\n>        'FWI_3_days_ago', 'VPD_3_days_ago', 'P_3_days_ago', 'FRP_3_days_ago',\n>        'FWI_4_days_ago', 'VPD_4_days_ago', 'P_4_days_ago', 'FRP_4_days_ago',\n>        'FWI_5_days_ago', 'VPD_5_days_ago', 'P_5_days_ago', 'FRP_5_days_ago',\n>        'FWI_6_days_ago', 'VPD_6_days_ago', 'P_6_days_ago', 'FRP_6_days_ago',\n>        'FWI_7_days_ago', 'VPD_7_days_ago', 'P_7_days_ago', 'FRP_7_days_ago',\n>        'Predicted_FRP'],\n>       dtype='object')\n2089a2090,2149\n> Prediction results are saved to /groups/ESS3/zsun/firecasting/data/output/output_tabnet_window_7_days_forecasting_with_new_yunyao_window_time_series_landuse_vhi_latlon//20210704/firedata_20210707_predicted.txt\n> ['Mean Absolute Error (MAE): 22.085082743245557', 'Mean Squared Error (MSE): 23056.240163999955', 'Root Mean Squared Error (RMSE): 151.8428140018485', 'R-squared (R2) Score: -0.020717364126373594', 'Explained Variance Score: -1.2799496231785668e-06', 'Median Absolute Error (MedAE): 0.0', 'Max Error: 11733.883916275576', 'Mean: -21.630771051147192', 'Median: 0.0', 'Standard Deviation: 150.29442683250224', 'Minimum: -999.0', 'Maximum: 11733.90625', 'Count: 156861']\n> Metrics saved to /groups/ESS3/zsun/firecasting/data/output/output_tabnet_window_7_days_forecasting_with_new_yunyao_window_time_series_landuse_vhi_latlon//20210704/metrics_20210707_predicted.txt\n> predicting:  20210708\n> Read from original folder for current date: 20210708\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210708.txt\n> reading past files for 2021-07-07 00:00:00\n> reading from predicted folder\n> current final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n> 0 -999.0 -999.0  0.0  ...  101381.734375          -999.0            0.0\n> 1 -999.0 -999.0  0.0  ...  101381.734375          -999.0            0.0\n> 2 -999.0 -999.0  0.0  ...  101376.140625          -999.0            0.0\n> 3 -999.0 -999.0  0.0  ...  101376.140625          -999.0            0.0\n> 4 -999.0 -999.0  0.0  ...  101371.742188          -999.0            0.0\n> \n> [5 rows x 72 columns]\n> renaming Predicted_FRP to FRP\n> remove the current predicted_frp\n> reading past files for 2021-07-06 00:00:00\n> reading from predicted folder\n> current final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n> 0 -999.0 -999.0  0.0  ...  101329.468750          -999.0            0.0\n> 1 -999.0 -999.0  0.0  ...  101329.468750          -999.0            0.0\n> 2 -999.0 -999.0  0.0  ...  101317.062500          -999.0            0.0\n> 3 -999.0 -999.0  0.0  ...  101317.062500          -999.0            0.0\n> 4 -999.0 -999.0  0.0  ...  101301.859375          -999.0            0.0\n> \n> [5 rows x 72 columns]\n> renaming Predicted_FRP to FRP\n> remove the current predicted_frp\n> reading past files for 2021-07-05 00:00:00\n> reading from predicted folder\n> current final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n> 0 -999.0 -999.0  0.0  ...  101352.601562          -999.0            0.0\n> 1 -999.0 -999.0  0.0  ...  101352.601562          -999.0            0.0\n> 2 -999.0 -999.0  0.0  ...  101336.601562          -999.0            0.0\n> 3 -999.0 -999.0  0.0  ...  101336.601562          -999.0            0.0\n> 4 -999.0 -999.0  0.0  ...  101320.203125          -999.0            0.0\n> \n> [5 rows x 72 columns]\n> renaming Predicted_FRP to FRP\n> remove the current predicted_frp\n> reading past files for 2021-07-04 00:00:00\n> reading from predicted folder\n> current final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n> 0 -999.0 -999.0  0.0  ...  101521.437500          -999.0            0.0\n> 1 -999.0 -999.0  0.0  ...  101521.437500          -999.0            0.0\n> 2 -999.0 -999.0  0.0  ...  101507.437500          -999.0            0.0\n> 3 -999.0 -999.0  0.0  ...  101507.437500          -999.0            0.0\n> 4 -999.0 -999.0  0.0  ...  101494.640625          -999.0            0.0\n> \n> [5 rows x 72 columns]\n> renaming Predicted_FRP to FRP\n> remove the current predicted_frp\n> reading past files for 2021-07-03 00:00:00\n> reading from original folder\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210703.txt\n> reading past files for 2021-07-02 00:00:00\n> reading from original folder\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210702.txt\n2149a2150,2183\n> reading past files for 2021-07-01 00:00:00\n> reading from original folder\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210701.txt\n> New time series dataframe:      LAT         LON    FRP  ...  VPD_7_days_ago   P_7_days_ago  FRP_7_days_ago\n> 0  24.5 -126.000000 -999.0  ...          -999.0  101530.867188          -999.0\n> 1  24.5 -125.899994 -999.0  ...          -999.0  101530.867188          -999.0\n> 2  24.5 -125.800003 -999.0  ...          -999.0  101528.468750          -999.0\n> 3  24.5 -125.699997 -999.0  ...          -999.0  101528.468750          -999.0\n> 4  24.5 -125.599998 -999.0  ...          -999.0  101526.070312          -999.0\n> \n> [5 rows x 74 columns]\n> Original df is created:  (156861, 74)\n> Original df filled the na with -9999 \n> X and y are loaded into memory for 20210708\n> the loaded model is:  TabNetRegressor(n_d=17, n_a=41, n_steps=4, gamma=1.1546672563068268, cat_idxs=[], cat_dims=[], cat_emb_dim=[], n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.00042602006758391, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=71, output_dim=1, device_name='auto', n_shared_decoder=1, n_indep_decoder=1, grouped_features=[])\n> Loaded model is a TabNet model.\n> Prediction for 20210708 of start day 20210704 is finished\n> new columns to check:  ['FRP_1_days_ago', 'Nearest_1', 'Nearest_2', 'Nearest_3', 'Nearest_4', 'Nearest_5', 'Nearest_6', 'Nearest_7', 'Nearest_8']\n> current merged_df columns:  Index(['FWI', 'VPD', 'HT', 'T', 'RH', 'U', 'V', 'P', 'RAIN', 'CAPE', 'ST',\n>        'SM', 'Nearest_1', 'Nearest_2', 'Nearest_3', 'Nearest_4', 'Nearest_5',\n>        'Nearest_6', 'Nearest_7', 'Nearest_8', 'Nearest_9', 'Nearest_10',\n>        'Nearest_11', 'Nearest_12', 'Nearest_13', 'Nearest_14', 'Nearest_15',\n>        'Nearest_16', 'Nearest_17', 'Nearest_18', 'Nearest_19', 'Nearest_20',\n>        'Nearest_21', 'Nearest_22', 'Nearest_23', 'Nearest_24', 'Land_Use',\n>        'VCI_AVE', 'TCI_AVE', 'VHI_AVE', 'VCI_TOT', 'TCI_TOT', 'VHI_TOT',\n>        'FWI_1_days_ago', 'VPD_1_days_ago', 'P_1_days_ago', 'FRP_1_days_ago',\n>        'FWI_2_days_ago', 'VPD_2_days_ago', 'P_2_days_ago', 'FRP_2_days_ago',\n>        'FWI_3_days_ago', 'VPD_3_days_ago', 'P_3_days_ago', 'FRP_3_days_ago',\n>        'FWI_4_days_ago', 'VPD_4_days_ago', 'P_4_days_ago', 'FRP_4_days_ago',\n>        'FWI_5_days_ago', 'VPD_5_days_ago', 'P_5_days_ago', 'FRP_5_days_ago',\n>        'FWI_6_days_ago', 'VPD_6_days_ago', 'P_6_days_ago', 'FRP_6_days_ago',\n>        'FWI_7_days_ago', 'VPD_7_days_ago', 'P_7_days_ago', 'FRP_7_days_ago',\n>        'Predicted_FRP'],\n>       dtype='object')\n2183a2184,2268\n> Prediction results are saved to /groups/ESS3/zsun/firecasting/data/output/output_tabnet_window_7_days_forecasting_with_new_yunyao_window_time_series_landuse_vhi_latlon//20210704/firedata_20210708_predicted.txt\n> ['Mean Absolute Error (MAE): 22.020385719846548', 'Mean Squared Error (MSE): 22179.355214747575', 'Root Mean Squared Error (RMSE): 148.92734878036194', 'R-squared (R2) Score: -0.02167589503842149', 'Explained Variance Score: 4.893825620300163e-06', 'Median Absolute Error (MedAE): 0.0', 'Max Error: 5463.914419518793', 'Mean: -21.694544765945654', 'Median: 0.0', 'Standard Deviation: 147.33952624013253', 'Minimum: -999.0', 'Maximum: 5464.172363', 'Count: 156861']\n> Metrics saved to /groups/ESS3/zsun/firecasting/data/output/output_tabnet_window_7_days_forecasting_with_new_yunyao_window_time_series_landuse_vhi_latlon//20210704/metrics_20210708_predicted.txt\n> predicting:  20210709\n> Read from original folder for current date: 20210709\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210709.txt\n> reading past files for 2021-07-08 00:00:00\n> reading from predicted folder\n> current final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n> 0 -999.0 -999.0  0.0  ...  101530.867188          -999.0            0.0\n> 1 -999.0 -999.0  0.0  ...  101530.867188          -999.0            0.0\n> 2 -999.0 -999.0  0.0  ...  101528.468750          -999.0            0.0\n> 3 -999.0 -999.0  0.0  ...  101528.468750          -999.0            0.0\n> 4 -999.0 -999.0  0.0  ...  101526.070312          -999.0            0.0\n> \n> [5 rows x 72 columns]\n> renaming Predicted_FRP to FRP\n> remove the current predicted_frp\n> reading past files for 2021-07-07 00:00:00\n> reading from predicted folder\n> current final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n> 0 -999.0 -999.0  0.0  ...  101381.734375          -999.0            0.0\n> 1 -999.0 -999.0  0.0  ...  101381.734375          -999.0            0.0\n> 2 -999.0 -999.0  0.0  ...  101376.140625          -999.0            0.0\n> 3 -999.0 -999.0  0.0  ...  101376.140625          -999.0            0.0\n> 4 -999.0 -999.0  0.0  ...  101371.742188          -999.0            0.0\n> \n> [5 rows x 72 columns]\n> renaming Predicted_FRP to FRP\n> remove the current predicted_frp\n> reading past files for 2021-07-06 00:00:00\n> reading from predicted folder\n> current final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n> 0 -999.0 -999.0  0.0  ...  101329.468750          -999.0            0.0\n> 1 -999.0 -999.0  0.0  ...  101329.468750          -999.0            0.0\n> 2 -999.0 -999.0  0.0  ...  101317.062500          -999.0            0.0\n> 3 -999.0 -999.0  0.0  ...  101317.062500          -999.0            0.0\n> 4 -999.0 -999.0  0.0  ...  101301.859375          -999.0            0.0\n> \n> [5 rows x 72 columns]\n> renaming Predicted_FRP to FRP\n> remove the current predicted_frp\n> reading past files for 2021-07-05 00:00:00\n> reading from predicted folder\n> current final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n> 0 -999.0 -999.0  0.0  ...  101352.601562          -999.0            0.0\n> 1 -999.0 -999.0  0.0  ...  101352.601562          -999.0            0.0\n> 2 -999.0 -999.0  0.0  ...  101336.601562          -999.0            0.0\n> 3 -999.0 -999.0  0.0  ...  101336.601562          -999.0            0.0\n> 4 -999.0 -999.0  0.0  ...  101320.203125          -999.0            0.0\n> \n> [5 rows x 72 columns]\n> renaming Predicted_FRP to FRP\n> remove the current predicted_frp\n> reading past files for 2021-07-04 00:00:00\n> reading from predicted folder\n> current final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n> 0 -999.0 -999.0  0.0  ...  101521.437500          -999.0            0.0\n> 1 -999.0 -999.0  0.0  ...  101521.437500          -999.0            0.0\n> 2 -999.0 -999.0  0.0  ...  101507.437500          -999.0            0.0\n> 3 -999.0 -999.0  0.0  ...  101507.437500          -999.0            0.0\n> 4 -999.0 -999.0  0.0  ...  101494.640625          -999.0            0.0\n> \n> [5 rows x 72 columns]\n> renaming Predicted_FRP to FRP\n> remove the current predicted_frp\n> reading past files for 2021-07-03 00:00:00\n> reading from original folder\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210703.txt\n> reading past files for 2021-07-02 00:00:00\n> reading from original folder\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210702.txt\n> New time series dataframe:      LAT         LON    FRP  ...  VPD_7_days_ago   P_7_days_ago  FRP_7_days_ago\n> 0  24.5 -126.000000 -999.0  ...          -999.0  101617.460938          -999.0\n> 1  24.5 -125.899994 -999.0  ...          -999.0  101617.460938          -999.0\n> 2  24.5 -125.800003 -999.0  ...          -999.0  101612.257812          -999.0\n> 3  24.5 -125.699997 -999.0  ...          -999.0  101612.257812          -999.0\n> 4  24.5 -125.599998 -999.0  ...          -999.0  101606.257812          -999.0\n> \n> [5 rows x 74 columns]\n> Original df is created:  (156861, 74)\n> Original df filled the na with -9999 \n> X and y are loaded into memory for 20210709\n> the loaded model is:  TabNetRegressor(n_d=17, n_a=41, n_steps=4, gamma=1.1546672563068268, cat_idxs=[], cat_dims=[], cat_emb_dim=[], n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.00042602006758391, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=71, output_dim=1, device_name='auto', n_shared_decoder=1, n_indep_decoder=1, grouped_features=[])\n> Loaded model is a TabNet model.\n2268a2269,2286\n> Prediction for 20210709 of start day 20210704 is finished\n> new columns to check:  ['FRP_1_days_ago', 'Nearest_1', 'Nearest_2', 'Nearest_3', 'Nearest_4', 'Nearest_5', 'Nearest_6', 'Nearest_7', 'Nearest_8']\n> current merged_df columns:  Index(['FWI', 'VPD', 'HT', 'T', 'RH', 'U', 'V', 'P', 'RAIN', 'CAPE', 'ST',\n>        'SM', 'Nearest_1', 'Nearest_2', 'Nearest_3', 'Nearest_4', 'Nearest_5',\n>        'Nearest_6', 'Nearest_7', 'Nearest_8', 'Nearest_9', 'Nearest_10',\n>        'Nearest_11', 'Nearest_12', 'Nearest_13', 'Nearest_14', 'Nearest_15',\n>        'Nearest_16', 'Nearest_17', 'Nearest_18', 'Nearest_19', 'Nearest_20',\n>        'Nearest_21', 'Nearest_22', 'Nearest_23', 'Nearest_24', 'Land_Use',\n>        'VCI_AVE', 'TCI_AVE', 'VHI_AVE', 'VCI_TOT', 'TCI_TOT', 'VHI_TOT',\n>        'FWI_1_days_ago', 'VPD_1_days_ago', 'P_1_days_ago', 'FRP_1_days_ago',\n>        'FWI_2_days_ago', 'VPD_2_days_ago', 'P_2_days_ago', 'FRP_2_days_ago',\n>        'FWI_3_days_ago', 'VPD_3_days_ago', 'P_3_days_ago', 'FRP_3_days_ago',\n>        'FWI_4_days_ago', 'VPD_4_days_ago', 'P_4_days_ago', 'FRP_4_days_ago',\n>        'FWI_5_days_ago', 'VPD_5_days_ago', 'P_5_days_ago', 'FRP_5_days_ago',\n>        'FWI_6_days_ago', 'VPD_6_days_ago', 'P_6_days_ago', 'FRP_6_days_ago',\n>        'FWI_7_days_ago', 'VPD_7_days_ago', 'P_7_days_ago', 'FRP_7_days_ago',\n>        'Predicted_FRP'],\n>       dtype='object')\n2286a2287,2342\n> Prediction results are saved to /groups/ESS3/zsun/firecasting/data/output/output_tabnet_window_7_days_forecasting_with_new_yunyao_window_time_series_landuse_vhi_latlon//20210704/firedata_20210709_predicted.txt\n> ['Mean Absolute Error (MAE): 22.440432919858303', 'Mean Squared Error (MSE): 27325.40163029674', 'Root Mean Squared Error (RMSE): 165.30396737615447', 'R-squared (R2) Score: -0.01682856907811847', 'Explained Variance Score: 2.1520659967078082e-05', 'Median Absolute Error (MedAE): 0.0', 'Max Error: 19604.529801375353', 'Mean: -21.276627506582255', 'Median: 0.0', 'Standard Deviation: 163.93088800132404', 'Minimum: -999.0', 'Maximum: 19605.007812', 'Count: 156861']\n> Metrics saved to /groups/ESS3/zsun/firecasting/data/output/output_tabnet_window_7_days_forecasting_with_new_yunyao_window_time_series_landuse_vhi_latlon//20210704/metrics_20210709_predicted.txt\n> predicting:  20210710\n> Read from original folder for current date: 20210710\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210710.txt\n> reading past files for 2021-07-09 00:00:00\n> reading from predicted folder\n> current final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n> 0 -999.0 -999.0  0.0  ...  101617.460938          -999.0            0.0\n> 1 -999.0 -999.0  0.0  ...  101617.460938          -999.0            0.0\n> 2 -999.0 -999.0  0.0  ...  101612.257812          -999.0            0.0\n> 3 -999.0 -999.0  0.0  ...  101612.257812          -999.0            0.0\n> 4 -999.0 -999.0  0.0  ...  101606.257812          -999.0            0.0\n> \n> [5 rows x 72 columns]\n> renaming Predicted_FRP to FRP\n> remove the current predicted_frp\n> reading past files for 2021-07-08 00:00:00\n> reading from predicted folder\n> current final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n> 0 -999.0 -999.0  0.0  ...  101530.867188          -999.0            0.0\n> 1 -999.0 -999.0  0.0  ...  101530.867188          -999.0            0.0\n> 2 -999.0 -999.0  0.0  ...  101528.468750          -999.0            0.0\n> 3 -999.0 -999.0  0.0  ...  101528.468750          -999.0            0.0\n> 4 -999.0 -999.0  0.0  ...  101526.070312          -999.0            0.0\n> \n> [5 rows x 72 columns]\n> renaming Predicted_FRP to FRP\n> remove the current predicted_frp\n> reading past files for 2021-07-07 00:00:00\n> reading from predicted folder\n> current final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n> 0 -999.0 -999.0  0.0  ...  101381.734375          -999.0            0.0\n> 1 -999.0 -999.0  0.0  ...  101381.734375          -999.0            0.0\n> 2 -999.0 -999.0  0.0  ...  101376.140625          -999.0            0.0\n> 3 -999.0 -999.0  0.0  ...  101376.140625          -999.0            0.0\n> 4 -999.0 -999.0  0.0  ...  101371.742188          -999.0            0.0\n> \n> [5 rows x 72 columns]\n> renaming Predicted_FRP to FRP\n> remove the current predicted_frp\n> reading past files for 2021-07-06 00:00:00\n> reading from predicted folder\n> current final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n> 0 -999.0 -999.0  0.0  ...  101329.468750          -999.0            0.0\n> 1 -999.0 -999.0  0.0  ...  101329.468750          -999.0            0.0\n> 2 -999.0 -999.0  0.0  ...  101317.062500          -999.0            0.0\n> 3 -999.0 -999.0  0.0  ...  101317.062500          -999.0            0.0\n> 4 -999.0 -999.0  0.0  ...  101301.859375          -999.0            0.0\n> \n> [5 rows x 72 columns]\n> renaming Predicted_FRP to FRP\n> remove the current predicted_frp\n> reading past files for 2021-07-05 00:00:00\n> reading from predicted folder\n2342a2343,2398\n> current final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n> 0 -999.0 -999.0  0.0  ...  101352.601562          -999.0            0.0\n> 1 -999.0 -999.0  0.0  ...  101352.601562          -999.0            0.0\n> 2 -999.0 -999.0  0.0  ...  101336.601562          -999.0            0.0\n> 3 -999.0 -999.0  0.0  ...  101336.601562          -999.0            0.0\n> 4 -999.0 -999.0  0.0  ...  101320.203125          -999.0            0.0\n> \n> [5 rows x 72 columns]\n> renaming Predicted_FRP to FRP\n> remove the current predicted_frp\n> reading past files for 2021-07-04 00:00:00\n> reading from predicted folder\n> current final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n> 0 -999.0 -999.0  0.0  ...  101521.437500          -999.0            0.0\n> 1 -999.0 -999.0  0.0  ...  101521.437500          -999.0            0.0\n> 2 -999.0 -999.0  0.0  ...  101507.437500          -999.0            0.0\n> 3 -999.0 -999.0  0.0  ...  101507.437500          -999.0            0.0\n> 4 -999.0 -999.0  0.0  ...  101494.640625          -999.0            0.0\n> \n> [5 rows x 72 columns]\n> renaming Predicted_FRP to FRP\n> remove the current predicted_frp\n> reading past files for 2021-07-03 00:00:00\n> reading from original folder\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210703.txt\n> New time series dataframe:      LAT         LON    FRP  ...  VPD_7_days_ago   P_7_days_ago  FRP_7_days_ago\n> 0  24.5 -126.000000 -999.0  ...          -999.0  101664.703125          -999.0\n> 1  24.5 -125.899994 -999.0  ...          -999.0  101664.703125          -999.0\n> 2  24.5 -125.800003 -999.0  ...          -999.0  101656.296875          -999.0\n> 3  24.5 -125.699997 -999.0  ...          -999.0  101656.296875          -999.0\n> 4  24.5 -125.599998 -999.0  ...          -999.0  101647.101562          -999.0\n> \n> [5 rows x 74 columns]\n> Original df is created:  (156861, 74)\n> Original df filled the na with -9999 \n> X and y are loaded into memory for 20210710\n> the loaded model is:  TabNetRegressor(n_d=17, n_a=41, n_steps=4, gamma=1.1546672563068268, cat_idxs=[], cat_dims=[], cat_emb_dim=[], n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.00042602006758391, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=71, output_dim=1, device_name='auto', n_shared_decoder=1, n_indep_decoder=1, grouped_features=[])\n> Loaded model is a TabNet model.\n> Prediction for 20210710 of start day 20210704 is finished\n> new columns to check:  ['FRP_1_days_ago', 'Nearest_1', 'Nearest_2', 'Nearest_3', 'Nearest_4', 'Nearest_5', 'Nearest_6', 'Nearest_7', 'Nearest_8']\n> current merged_df columns:  Index(['FWI', 'VPD', 'HT', 'T', 'RH', 'U', 'V', 'P', 'RAIN', 'CAPE', 'ST',\n>        'SM', 'Nearest_1', 'Nearest_2', 'Nearest_3', 'Nearest_4', 'Nearest_5',\n>        'Nearest_6', 'Nearest_7', 'Nearest_8', 'Nearest_9', 'Nearest_10',\n>        'Nearest_11', 'Nearest_12', 'Nearest_13', 'Nearest_14', 'Nearest_15',\n>        'Nearest_16', 'Nearest_17', 'Nearest_18', 'Nearest_19', 'Nearest_20',\n>        'Nearest_21', 'Nearest_22', 'Nearest_23', 'Nearest_24', 'Land_Use',\n>        'VCI_AVE', 'TCI_AVE', 'VHI_AVE', 'VCI_TOT', 'TCI_TOT', 'VHI_TOT',\n>        'FWI_1_days_ago', 'VPD_1_days_ago', 'P_1_days_ago', 'FRP_1_days_ago',\n>        'FWI_2_days_ago', 'VPD_2_days_ago', 'P_2_days_ago', 'FRP_2_days_ago',\n>        'FWI_3_days_ago', 'VPD_3_days_ago', 'P_3_days_ago', 'FRP_3_days_ago',\n>        'FWI_4_days_ago', 'VPD_4_days_ago', 'P_4_days_ago', 'FRP_4_days_ago',\n>        'FWI_5_days_ago', 'VPD_5_days_ago', 'P_5_days_ago', 'FRP_5_days_ago',\n>        'FWI_6_days_ago', 'VPD_6_days_ago', 'P_6_days_ago', 'FRP_6_days_ago',\n>        'FWI_7_days_ago', 'VPD_7_days_ago', 'P_7_days_ago', 'FRP_7_days_ago',\n>        'Predicted_FRP'],\n>       dtype='object')\n2398a2399,2459\n> Prediction results are saved to /groups/ESS3/zsun/firecasting/data/output/output_tabnet_window_7_days_forecasting_with_new_yunyao_window_time_series_landuse_vhi_latlon//20210704/firedata_20210710_predicted.txt\n> ['Mean Absolute Error (MAE): 22.548021310127837', 'Mean Squared Error (MSE): 29426.035618749615', 'Root Mean Squared Error (RMSE): 171.54018659996152', 'R-squared (R2) Score: -0.023609442641569833', 'Explained Variance Score: -0.0078091901539010244', 'Median Absolute Error (MedAE): 0.0', 'Max Error: 23213.004525149645', 'Mean: -21.179196243725322', 'Median: 0.0', 'Standard Deviation: 169.55090832070005', 'Minimum: -999.0', 'Maximum: 23213.011719', 'Count: 156861']\n> Metrics saved to /groups/ESS3/zsun/firecasting/data/output/output_tabnet_window_7_days_forecasting_with_new_yunyao_window_time_series_landuse_vhi_latlon//20210704/metrics_20210710_predicted.txt\n> current date:  2021-07-05 00:00:00\n> single_day_current_date =  2021-07-05 00:00:00\n> single_day_predict_end_date =  2021-07-12 00:00:00\n> predicting:  20210705\n> Read from original folder for current date: 20210705\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210705.txt\n> reading past files for 2021-07-04 00:00:00\n> reading from original folder\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210704.txt\n> reading past files for 2021-07-03 00:00:00\n> reading from original folder\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210703.txt\n> reading past files for 2021-07-02 00:00:00\n> reading from original folder\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210702.txt\n> reading past files for 2021-07-01 00:00:00\n> reading from original folder\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210701.txt\n> reading past files for 2021-06-30 00:00:00\n> reading from original folder\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210630.txt\n> reading past files for 2021-06-29 00:00:00\n> reading from original folder\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210629.txt\n> reading past files for 2021-06-28 00:00:00\n> reading from original folder\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210628.txt\n> New time series dataframe:      LAT         LON    FRP  ...  VPD_7_days_ago   P_7_days_ago  FRP_7_days_ago\n> 0  24.5 -126.000000 -999.0  ...          -999.0  101352.601562          -999.0\n> 1  24.5 -125.899994 -999.0  ...          -999.0  101352.601562          -999.0\n> 2  24.5 -125.800003 -999.0  ...          -999.0  101336.601562          -999.0\n> 3  24.5 -125.699997 -999.0  ...          -999.0  101336.601562          -999.0\n> 4  24.5 -125.599998 -999.0  ...          -999.0  101320.203125          -999.0\n> \n> [5 rows x 74 columns]\n> Original df is created:  (156861, 74)\n> Original df filled the na with -9999 \n> X and y are loaded into memory for 20210705\n> the loaded model is:  TabNetRegressor(n_d=17, n_a=41, n_steps=4, gamma=1.1546672563068268, cat_idxs=[], cat_dims=[], cat_emb_dim=[], n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.00042602006758391, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=71, output_dim=1, device_name='auto', n_shared_decoder=1, n_indep_decoder=1, grouped_features=[])\n> Loaded model is a TabNet model.\n> Prediction for 20210705 of start day 20210705 is finished\n> new columns to check:  ['FRP_1_days_ago', 'Nearest_1', 'Nearest_2', 'Nearest_3', 'Nearest_4', 'Nearest_5', 'Nearest_6', 'Nearest_7', 'Nearest_8']\n> current merged_df columns:  Index(['FWI', 'VPD', 'HT', 'T', 'RH', 'U', 'V', 'P', 'RAIN', 'CAPE', 'ST',\n>        'SM', 'Nearest_1', 'Nearest_2', 'Nearest_3', 'Nearest_4', 'Nearest_5',\n>        'Nearest_6', 'Nearest_7', 'Nearest_8', 'Nearest_9', 'Nearest_10',\n>        'Nearest_11', 'Nearest_12', 'Nearest_13', 'Nearest_14', 'Nearest_15',\n>        'Nearest_16', 'Nearest_17', 'Nearest_18', 'Nearest_19', 'Nearest_20',\n>        'Nearest_21', 'Nearest_22', 'Nearest_23', 'Nearest_24', 'Land_Use',\n>        'VCI_AVE', 'TCI_AVE', 'VHI_AVE', 'VCI_TOT', 'TCI_TOT', 'VHI_TOT',\n>        'FWI_1_days_ago', 'VPD_1_days_ago', 'P_1_days_ago', 'FRP_1_days_ago',\n>        'FWI_2_days_ago', 'VPD_2_days_ago', 'P_2_days_ago', 'FRP_2_days_ago',\n>        'FWI_3_days_ago', 'VPD_3_days_ago', 'P_3_days_ago', 'FRP_3_days_ago',\n>        'FWI_4_days_ago', 'VPD_4_days_ago', 'P_4_days_ago', 'FRP_4_days_ago',\n>        'FWI_5_days_ago', 'VPD_5_days_ago', 'P_5_days_ago', 'FRP_5_days_ago',\n>        'FWI_6_days_ago', 'VPD_6_days_ago', 'P_6_days_ago', 'FRP_6_days_ago',\n>        'FWI_7_days_ago', 'VPD_7_days_ago', 'P_7_days_ago', 'FRP_7_days_ago',\n>        'Predicted_FRP'],\n>       dtype='object')\n2459a2460,2526\n> Prediction results are saved to /groups/ESS3/zsun/firecasting/data/output/output_tabnet_window_7_days_forecasting_with_new_yunyao_window_time_series_landuse_vhi_latlon//20210705/firedata_20210705_predicted.txt\n> ['Mean Absolute Error (MAE): 21.899653917612167', 'Mean Squared Error (MSE): 21849.942123667675', 'Root Mean Squared Error (RMSE): 147.8172592212008', 'R-squared (R2) Score: -0.022264801014086233', 'Explained Variance Score: 6.663320127886507e-07', 'Median Absolute Error (MedAE): 0.0', 'Max Error: 1216.7894160183182', 'Mean: -21.81510091978249', 'Median: 0.0', 'Standard Deviation: 146.19914277086232', 'Minimum: -999.0', 'Maximum: 1216.946899', 'Count: 156861']\n> Metrics saved to /groups/ESS3/zsun/firecasting/data/output/output_tabnet_window_7_days_forecasting_with_new_yunyao_window_time_series_landuse_vhi_latlon//20210705/metrics_20210705_predicted.txt\n> predicting:  20210706\n> Read from original folder for current date: 20210706\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210706.txt\n> reading past files for 2021-07-05 00:00:00\n> reading from predicted folder\n> current final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n> 0 -999.0 -999.0  0.0  ...  101352.601562          -999.0            0.0\n> 1 -999.0 -999.0  0.0  ...  101352.601562          -999.0            0.0\n> 2 -999.0 -999.0  0.0  ...  101336.601562          -999.0            0.0\n> 3 -999.0 -999.0  0.0  ...  101336.601562          -999.0            0.0\n> 4 -999.0 -999.0  0.0  ...  101320.203125          -999.0            0.0\n> \n> [5 rows x 72 columns]\n> renaming Predicted_FRP to FRP\n> remove the current predicted_frp\n> reading past files for 2021-07-04 00:00:00\n> reading from original folder\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210704.txt\n> reading past files for 2021-07-03 00:00:00\n> reading from original folder\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210703.txt\n> reading past files for 2021-07-02 00:00:00\n> reading from original folder\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210702.txt\n> reading past files for 2021-07-01 00:00:00\n> reading from original folder\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210701.txt\n> reading past files for 2021-06-30 00:00:00\n> reading from original folder\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210630.txt\n> reading past files for 2021-06-29 00:00:00\n> reading from original folder\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210629.txt\n> New time series dataframe:      LAT         LON    FRP  ...  VPD_7_days_ago   P_7_days_ago  FRP_7_days_ago\n> 0  24.5 -126.000000 -999.0  ...          -999.0  101329.468750          -999.0\n> 1  24.5 -125.899994 -999.0  ...          -999.0  101329.468750          -999.0\n> 2  24.5 -125.800003 -999.0  ...          -999.0  101317.062500          -999.0\n> 3  24.5 -125.699997 -999.0  ...          -999.0  101317.062500          -999.0\n> 4  24.5 -125.599998 -999.0  ...          -999.0  101301.859375          -999.0\n> \n> [5 rows x 74 columns]\n> Original df is created:  (156861, 74)\n> Original df filled the na with -9999 \n> X and y are loaded into memory for 20210706\n> the loaded model is:  TabNetRegressor(n_d=17, n_a=41, n_steps=4, gamma=1.1546672563068268, cat_idxs=[], cat_dims=[], cat_emb_dim=[], n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.00042602006758391, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=71, output_dim=1, device_name='auto', n_shared_decoder=1, n_indep_decoder=1, grouped_features=[])\n> Loaded model is a TabNet model.\n> Prediction for 20210706 of start day 20210705 is finished\n> new columns to check:  ['FRP_1_days_ago', 'Nearest_1', 'Nearest_2', 'Nearest_3', 'Nearest_4', 'Nearest_5', 'Nearest_6', 'Nearest_7', 'Nearest_8']\n> current merged_df columns:  Index(['FWI', 'VPD', 'HT', 'T', 'RH', 'U', 'V', 'P', 'RAIN', 'CAPE', 'ST',\n>        'SM', 'Nearest_1', 'Nearest_2', 'Nearest_3', 'Nearest_4', 'Nearest_5',\n>        'Nearest_6', 'Nearest_7', 'Nearest_8', 'Nearest_9', 'Nearest_10',\n>        'Nearest_11', 'Nearest_12', 'Nearest_13', 'Nearest_14', 'Nearest_15',\n>        'Nearest_16', 'Nearest_17', 'Nearest_18', 'Nearest_19', 'Nearest_20',\n>        'Nearest_21', 'Nearest_22', 'Nearest_23', 'Nearest_24', 'Land_Use',\n>        'VCI_AVE', 'TCI_AVE', 'VHI_AVE', 'VCI_TOT', 'TCI_TOT', 'VHI_TOT',\n>        'FWI_1_days_ago', 'VPD_1_days_ago', 'P_1_days_ago', 'FRP_1_days_ago',\n>        'FWI_2_days_ago', 'VPD_2_days_ago', 'P_2_days_ago', 'FRP_2_days_ago',\n>        'FWI_3_days_ago', 'VPD_3_days_ago', 'P_3_days_ago', 'FRP_3_days_ago',\n>        'FWI_4_days_ago', 'VPD_4_days_ago', 'P_4_days_ago', 'FRP_4_days_ago',\n>        'FWI_5_days_ago', 'VPD_5_days_ago', 'P_5_days_ago', 'FRP_5_days_ago',\n>        'FWI_6_days_ago', 'VPD_6_days_ago', 'P_6_days_ago', 'FRP_6_days_ago',\n>        'FWI_7_days_ago', 'VPD_7_days_ago', 'P_7_days_ago', 'FRP_7_days_ago',\n>        'Predicted_FRP'],\n>       dtype='object')\n2526a2527,2571\n> Prediction results are saved to /groups/ESS3/zsun/firecasting/data/output/output_tabnet_window_7_days_forecasting_with_new_yunyao_window_time_series_landuse_vhi_latlon//20210705/firedata_20210706_predicted.txt\n> ['Mean Absolute Error (MAE): 21.96844126434875', 'Mean Squared Error (MSE): 22237.571842753303', 'Root Mean Squared Error (RMSE): 149.1226738050029', 'R-squared (R2) Score: -0.021725681862043933', 'Explained Variance Score: 2.73175715370666e-06', 'Median Absolute Error (MedAE): 0.0', 'Max Error: 7547.461402141784', 'Mean: -21.746309589547433', 'Median: 0.0', 'Standard Deviation: 147.52917421844327', 'Minimum: -999.0', 'Maximum: 7547.473145', 'Count: 156861']\n> Metrics saved to /groups/ESS3/zsun/firecasting/data/output/output_tabnet_window_7_days_forecasting_with_new_yunyao_window_time_series_landuse_vhi_latlon//20210705/metrics_20210706_predicted.txt\n> predicting:  20210707\n> Read from original folder for current date: 20210707\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210707.txt\n> reading past files for 2021-07-06 00:00:00\n> reading from predicted folder\n> current final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n> 0 -999.0 -999.0  0.0  ...  101329.468750          -999.0            0.0\n> 1 -999.0 -999.0  0.0  ...  101329.468750          -999.0            0.0\n> 2 -999.0 -999.0  0.0  ...  101317.062500          -999.0            0.0\n> 3 -999.0 -999.0  0.0  ...  101317.062500          -999.0            0.0\n> 4 -999.0 -999.0  0.0  ...  101301.859375          -999.0            0.0\n> \n> [5 rows x 72 columns]\n> renaming Predicted_FRP to FRP\n> remove the current predicted_frp\n> reading past files for 2021-07-05 00:00:00\n> reading from predicted folder\n> current final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n> 0 -999.0 -999.0  0.0  ...  101352.601562          -999.0            0.0\n> 1 -999.0 -999.0  0.0  ...  101352.601562          -999.0            0.0\n> 2 -999.0 -999.0  0.0  ...  101336.601562          -999.0            0.0\n> 3 -999.0 -999.0  0.0  ...  101336.601562          -999.0            0.0\n> 4 -999.0 -999.0  0.0  ...  101320.203125          -999.0            0.0\n> \n> [5 rows x 72 columns]\n> renaming Predicted_FRP to FRP\n> remove the current predicted_frp\n> reading past files for 2021-07-04 00:00:00\n> reading from original folder\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210704.txt\n> reading past files for 2021-07-03 00:00:00\n> reading from original folder\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210703.txt\n> reading past files for 2021-07-02 00:00:00\n> reading from original folder\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210702.txt\n> reading past files for 2021-07-01 00:00:00\n> reading from original folder\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210701.txt\n> reading past files for 2021-06-30 00:00:00\n> reading from original folder\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210630.txt\n2571a2572,2602\n> New time series dataframe:      LAT         LON    FRP  ...  VPD_7_days_ago   P_7_days_ago  FRP_7_days_ago\n> 0  24.5 -126.000000 -999.0  ...          -999.0  101381.734375          -999.0\n> 1  24.5 -125.899994 -999.0  ...          -999.0  101381.734375          -999.0\n> 2  24.5 -125.800003 -999.0  ...          -999.0  101376.140625          -999.0\n> 3  24.5 -125.699997 -999.0  ...          -999.0  101376.140625          -999.0\n> 4  24.5 -125.599998 -999.0  ...          -999.0  101371.742188          -999.0\n> \n> [5 rows x 74 columns]\n> Original df is created:  (156861, 74)\n> Original df filled the na with -9999 \n> X and y are loaded into memory for 20210707\n> the loaded model is:  TabNetRegressor(n_d=17, n_a=41, n_steps=4, gamma=1.1546672563068268, cat_idxs=[], cat_dims=[], cat_emb_dim=[], n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.00042602006758391, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=71, output_dim=1, device_name='auto', n_shared_decoder=1, n_indep_decoder=1, grouped_features=[])\n> Loaded model is a TabNet model.\n> Prediction for 20210707 of start day 20210705 is finished\n> new columns to check:  ['FRP_1_days_ago', 'Nearest_1', 'Nearest_2', 'Nearest_3', 'Nearest_4', 'Nearest_5', 'Nearest_6', 'Nearest_7', 'Nearest_8']\n> current merged_df columns:  Index(['FWI', 'VPD', 'HT', 'T', 'RH', 'U', 'V', 'P', 'RAIN', 'CAPE', 'ST',\n>        'SM', 'Nearest_1', 'Nearest_2', 'Nearest_3', 'Nearest_4', 'Nearest_5',\n>        'Nearest_6', 'Nearest_7', 'Nearest_8', 'Nearest_9', 'Nearest_10',\n>        'Nearest_11', 'Nearest_12', 'Nearest_13', 'Nearest_14', 'Nearest_15',\n>        'Nearest_16', 'Nearest_17', 'Nearest_18', 'Nearest_19', 'Nearest_20',\n>        'Nearest_21', 'Nearest_22', 'Nearest_23', 'Nearest_24', 'Land_Use',\n>        'VCI_AVE', 'TCI_AVE', 'VHI_AVE', 'VCI_TOT', 'TCI_TOT', 'VHI_TOT',\n>        'FWI_1_days_ago', 'VPD_1_days_ago', 'P_1_days_ago', 'FRP_1_days_ago',\n>        'FWI_2_days_ago', 'VPD_2_days_ago', 'P_2_days_ago', 'FRP_2_days_ago',\n>        'FWI_3_days_ago', 'VPD_3_days_ago', 'P_3_days_ago', 'FRP_3_days_ago',\n>        'FWI_4_days_ago', 'VPD_4_days_ago', 'P_4_days_ago', 'FRP_4_days_ago',\n>        'FWI_5_days_ago', 'VPD_5_days_ago', 'P_5_days_ago', 'FRP_5_days_ago',\n>        'FWI_6_days_ago', 'VPD_6_days_ago', 'P_6_days_ago', 'FRP_6_days_ago',\n>        'FWI_7_days_ago', 'VPD_7_days_ago', 'P_7_days_ago', 'FRP_7_days_ago',\n>        'Predicted_FRP'],\n>       dtype='object')\n2602a2603,2653\n> Prediction results are saved to /groups/ESS3/zsun/firecasting/data/output/output_tabnet_window_7_days_forecasting_with_new_yunyao_window_time_series_landuse_vhi_latlon//20210705/firedata_20210707_predicted.txt\n> ['Mean Absolute Error (MAE): 22.085057620031762', 'Mean Squared Error (MSE): 23056.240177608146', 'Root Mean Squared Error (RMSE): 151.84281404665862', 'R-squared (R2) Score: -0.020717364728818577', 'Explained Variance Score: -1.3288390667831607e-06', 'Median Absolute Error (MedAE): 0.0', 'Max Error: 11733.88396489434', 'Mean: -21.630771051147192', 'Median: 0.0', 'Standard Deviation: 150.29442683250224', 'Minimum: -999.0', 'Maximum: 11733.90625', 'Count: 156861']\n> Metrics saved to /groups/ESS3/zsun/firecasting/data/output/output_tabnet_window_7_days_forecasting_with_new_yunyao_window_time_series_landuse_vhi_latlon//20210705/metrics_20210707_predicted.txt\n> predicting:  20210708\n> Read from original folder for current date: 20210708\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210708.txt\n> reading past files for 2021-07-07 00:00:00\n> reading from predicted folder\n> current final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n> 0 -999.0 -999.0  0.0  ...  101381.734375          -999.0            0.0\n> 1 -999.0 -999.0  0.0  ...  101381.734375          -999.0            0.0\n> 2 -999.0 -999.0  0.0  ...  101376.140625          -999.0            0.0\n> 3 -999.0 -999.0  0.0  ...  101376.140625          -999.0            0.0\n> 4 -999.0 -999.0  0.0  ...  101371.742188          -999.0            0.0\n> \n> [5 rows x 72 columns]\n> renaming Predicted_FRP to FRP\n> remove the current predicted_frp\n> reading past files for 2021-07-06 00:00:00\n> reading from predicted folder\n> current final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n> 0 -999.0 -999.0  0.0  ...  101329.468750          -999.0            0.0\n> 1 -999.0 -999.0  0.0  ...  101329.468750          -999.0            0.0\n> 2 -999.0 -999.0  0.0  ...  101317.062500          -999.0            0.0\n> 3 -999.0 -999.0  0.0  ...  101317.062500          -999.0            0.0\n> 4 -999.0 -999.0  0.0  ...  101301.859375          -999.0            0.0\n> \n> [5 rows x 72 columns]\n> renaming Predicted_FRP to FRP\n> remove the current predicted_frp\n> reading past files for 2021-07-05 00:00:00\n> reading from predicted folder\n> current final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n> 0 -999.0 -999.0  0.0  ...  101352.601562          -999.0            0.0\n> 1 -999.0 -999.0  0.0  ...  101352.601562          -999.0            0.0\n> 2 -999.0 -999.0  0.0  ...  101336.601562          -999.0            0.0\n> 3 -999.0 -999.0  0.0  ...  101336.601562          -999.0            0.0\n> 4 -999.0 -999.0  0.0  ...  101320.203125          -999.0            0.0\n> \n> [5 rows x 72 columns]\n> renaming Predicted_FRP to FRP\n> remove the current predicted_frp\n> reading past files for 2021-07-04 00:00:00\n> reading from original folder\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210704.txt\n> reading past files for 2021-07-03 00:00:00\n> reading from original folder\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210703.txt\n> reading past files for 2021-07-02 00:00:00\n> reading from original folder\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210702.txt\n2653a2654,2687\n> reading past files for 2021-07-01 00:00:00\n> reading from original folder\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210701.txt\n> New time series dataframe:      LAT         LON    FRP  ...  VPD_7_days_ago   P_7_days_ago  FRP_7_days_ago\n> 0  24.5 -126.000000 -999.0  ...          -999.0  101530.867188          -999.0\n> 1  24.5 -125.899994 -999.0  ...          -999.0  101530.867188          -999.0\n> 2  24.5 -125.800003 -999.0  ...          -999.0  101528.468750          -999.0\n> 3  24.5 -125.699997 -999.0  ...          -999.0  101528.468750          -999.0\n> 4  24.5 -125.599998 -999.0  ...          -999.0  101526.070312          -999.0\n> \n> [5 rows x 74 columns]\n> Original df is created:  (156861, 74)\n> Original df filled the na with -9999 \n> X and y are loaded into memory for 20210708\n> the loaded model is:  TabNetRegressor(n_d=17, n_a=41, n_steps=4, gamma=1.1546672563068268, cat_idxs=[], cat_dims=[], cat_emb_dim=[], n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.00042602006758391, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=71, output_dim=1, device_name='auto', n_shared_decoder=1, n_indep_decoder=1, grouped_features=[])\n> Loaded model is a TabNet model.\n> Prediction for 20210708 of start day 20210705 is finished\n> new columns to check:  ['FRP_1_days_ago', 'Nearest_1', 'Nearest_2', 'Nearest_3', 'Nearest_4', 'Nearest_5', 'Nearest_6', 'Nearest_7', 'Nearest_8']\n> current merged_df columns:  Index(['FWI', 'VPD', 'HT', 'T', 'RH', 'U', 'V', 'P', 'RAIN', 'CAPE', 'ST',\n>        'SM', 'Nearest_1', 'Nearest_2', 'Nearest_3', 'Nearest_4', 'Nearest_5',\n>        'Nearest_6', 'Nearest_7', 'Nearest_8', 'Nearest_9', 'Nearest_10',\n>        'Nearest_11', 'Nearest_12', 'Nearest_13', 'Nearest_14', 'Nearest_15',\n>        'Nearest_16', 'Nearest_17', 'Nearest_18', 'Nearest_19', 'Nearest_20',\n>        'Nearest_21', 'Nearest_22', 'Nearest_23', 'Nearest_24', 'Land_Use',\n>        'VCI_AVE', 'TCI_AVE', 'VHI_AVE', 'VCI_TOT', 'TCI_TOT', 'VHI_TOT',\n>        'FWI_1_days_ago', 'VPD_1_days_ago', 'P_1_days_ago', 'FRP_1_days_ago',\n>        'FWI_2_days_ago', 'VPD_2_days_ago', 'P_2_days_ago', 'FRP_2_days_ago',\n>        'FWI_3_days_ago', 'VPD_3_days_ago', 'P_3_days_ago', 'FRP_3_days_ago',\n>        'FWI_4_days_ago', 'VPD_4_days_ago', 'P_4_days_ago', 'FRP_4_days_ago',\n>        'FWI_5_days_ago', 'VPD_5_days_ago', 'P_5_days_ago', 'FRP_5_days_ago',\n>        'FWI_6_days_ago', 'VPD_6_days_ago', 'P_6_days_ago', 'FRP_6_days_ago',\n>        'FWI_7_days_ago', 'VPD_7_days_ago', 'P_7_days_ago', 'FRP_7_days_ago',\n>        'Predicted_FRP'],\n>       dtype='object')\n2687a2688,2781\n> Prediction results are saved to /groups/ESS3/zsun/firecasting/data/output/output_tabnet_window_7_days_forecasting_with_new_yunyao_window_time_series_landuse_vhi_latlon//20210705/firedata_20210708_predicted.txt\n> ['Mean Absolute Error (MAE): 22.020365526157462', 'Mean Squared Error (MSE): 22179.355213667073', 'Root Mean Squared Error (RMSE): 148.92734877673433', 'R-squared (R2) Score: -0.02167589498864886', 'Explained Variance Score: 4.8534510974640455e-06', 'Median Absolute Error (MedAE): 0.0', 'Max Error: 5463.914419518793', 'Mean: -21.694544765945654', 'Median: 0.0', 'Standard Deviation: 147.33952624013253', 'Minimum: -999.0', 'Maximum: 5464.172363', 'Count: 156861']\n> Metrics saved to /groups/ESS3/zsun/firecasting/data/output/output_tabnet_window_7_days_forecasting_with_new_yunyao_window_time_series_landuse_vhi_latlon//20210705/metrics_20210708_predicted.txt\n> predicting:  20210709\n> Read from original folder for current date: 20210709\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210709.txt\n> reading past files for 2021-07-08 00:00:00\n> reading from predicted folder\n> current final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n> 0 -999.0 -999.0  0.0  ...  101530.867188          -999.0            0.0\n> 1 -999.0 -999.0  0.0  ...  101530.867188          -999.0            0.0\n> 2 -999.0 -999.0  0.0  ...  101528.468750          -999.0            0.0\n> 3 -999.0 -999.0  0.0  ...  101528.468750          -999.0            0.0\n> 4 -999.0 -999.0  0.0  ...  101526.070312          -999.0            0.0\n> \n> [5 rows x 72 columns]\n> renaming Predicted_FRP to FRP\n> remove the current predicted_frp\n> reading past files for 2021-07-07 00:00:00\n> reading from predicted folder\n> current final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n> 0 -999.0 -999.0  0.0  ...  101381.734375          -999.0            0.0\n> 1 -999.0 -999.0  0.0  ...  101381.734375          -999.0            0.0\n> 2 -999.0 -999.0  0.0  ...  101376.140625          -999.0            0.0\n> 3 -999.0 -999.0  0.0  ...  101376.140625          -999.0            0.0\n> 4 -999.0 -999.0  0.0  ...  101371.742188          -999.0            0.0\n> \n> [5 rows x 72 columns]\n> renaming Predicted_FRP to FRP\n> remove the current predicted_frp\n> reading past files for 2021-07-06 00:00:00\n> reading from predicted folder\n> current final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n> 0 -999.0 -999.0  0.0  ...  101329.468750          -999.0            0.0\n> 1 -999.0 -999.0  0.0  ...  101329.468750          -999.0            0.0\n> 2 -999.0 -999.0  0.0  ...  101317.062500          -999.0            0.0\n> 3 -999.0 -999.0  0.0  ...  101317.062500          -999.0            0.0\n> 4 -999.0 -999.0  0.0  ...  101301.859375          -999.0            0.0\n> \n> [5 rows x 72 columns]\n> renaming Predicted_FRP to FRP\n> remove the current predicted_frp\n> reading past files for 2021-07-05 00:00:00\n> reading from predicted folder\n> current final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n> 0 -999.0 -999.0  0.0  ...  101352.601562          -999.0            0.0\n> 1 -999.0 -999.0  0.0  ...  101352.601562          -999.0            0.0\n> 2 -999.0 -999.0  0.0  ...  101336.601562          -999.0            0.0\n> 3 -999.0 -999.0  0.0  ...  101336.601562          -999.0            0.0\n> 4 -999.0 -999.0  0.0  ...  101320.203125          -999.0            0.0\n> \n> [5 rows x 72 columns]\n> renaming Predicted_FRP to FRP\n> remove the current predicted_frp\n> reading past files for 2021-07-04 00:00:00\n> reading from original folder\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210704.txt\n> reading past files for 2021-07-03 00:00:00\n> reading from original folder\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210703.txt\n> reading past files for 2021-07-02 00:00:00\n> reading from original folder\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210702.txt\n> New time series dataframe:      LAT         LON    FRP  ...  VPD_7_days_ago   P_7_days_ago  FRP_7_days_ago\n> 0  24.5 -126.000000 -999.0  ...          -999.0  101617.460938          -999.0\n> 1  24.5 -125.899994 -999.0  ...          -999.0  101617.460938          -999.0\n> 2  24.5 -125.800003 -999.0  ...          -999.0  101612.257812          -999.0\n> 3  24.5 -125.699997 -999.0  ...          -999.0  101612.257812          -999.0\n> 4  24.5 -125.599998 -999.0  ...          -999.0  101606.257812          -999.0\n> \n> [5 rows x 74 columns]\n> Original df is created:  (156861, 74)\n> Original df filled the na with -9999 \n> X and y are loaded into memory for 20210709\n> the loaded model is:  TabNetRegressor(n_d=17, n_a=41, n_steps=4, gamma=1.1546672563068268, cat_idxs=[], cat_dims=[], cat_emb_dim=[], n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.00042602006758391, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=71, output_dim=1, device_name='auto', n_shared_decoder=1, n_indep_decoder=1, grouped_features=[])\n> Loaded model is a TabNet model.\n> Prediction for 20210709 of start day 20210705 is finished\n> new columns to check:  ['FRP_1_days_ago', 'Nearest_1', 'Nearest_2', 'Nearest_3', 'Nearest_4', 'Nearest_5', 'Nearest_6', 'Nearest_7', 'Nearest_8']\n> current merged_df columns:  Index(['FWI', 'VPD', 'HT', 'T', 'RH', 'U', 'V', 'P', 'RAIN', 'CAPE', 'ST',\n>        'SM', 'Nearest_1', 'Nearest_2', 'Nearest_3', 'Nearest_4', 'Nearest_5',\n>        'Nearest_6', 'Nearest_7', 'Nearest_8', 'Nearest_9', 'Nearest_10',\n>        'Nearest_11', 'Nearest_12', 'Nearest_13', 'Nearest_14', 'Nearest_15',\n>        'Nearest_16', 'Nearest_17', 'Nearest_18', 'Nearest_19', 'Nearest_20',\n>        'Nearest_21', 'Nearest_22', 'Nearest_23', 'Nearest_24', 'Land_Use',\n>        'VCI_AVE', 'TCI_AVE', 'VHI_AVE', 'VCI_TOT', 'TCI_TOT', 'VHI_TOT',\n>        'FWI_1_days_ago', 'VPD_1_days_ago', 'P_1_days_ago', 'FRP_1_days_ago',\n>        'FWI_2_days_ago', 'VPD_2_days_ago', 'P_2_days_ago', 'FRP_2_days_ago',\n>        'FWI_3_days_ago', 'VPD_3_days_ago', 'P_3_days_ago', 'FRP_3_days_ago',\n>        'FWI_4_days_ago', 'VPD_4_days_ago', 'P_4_days_ago', 'FRP_4_days_ago',\n>        'FWI_5_days_ago', 'VPD_5_days_ago', 'P_5_days_ago', 'FRP_5_days_ago',\n>        'FWI_6_days_ago', 'VPD_6_days_ago', 'P_6_days_ago', 'FRP_6_days_ago',\n>        'FWI_7_days_ago', 'VPD_7_days_ago', 'P_7_days_ago', 'FRP_7_days_ago',\n>        'Predicted_FRP'],\n>       dtype='object')\n2781a2782,2847\n> Prediction results are saved to /groups/ESS3/zsun/firecasting/data/output/output_tabnet_window_7_days_forecasting_with_new_yunyao_window_time_series_landuse_vhi_latlon//20210705/firedata_20210709_predicted.txt\n> ['Mean Absolute Error (MAE): 22.44040970785812', 'Mean Squared Error (MSE): 27325.40162973838', 'Root Mean Squared Error (RMSE): 165.30396737446557', 'R-squared (R2) Score: -0.01682856905734087', 'Explained Variance Score: 2.148406774149514e-05', 'Median Absolute Error (MedAE): 0.0', 'Max Error: 19604.529801375353', 'Mean: -21.276627506582255', 'Median: 0.0', 'Standard Deviation: 163.93088800132404', 'Minimum: -999.0', 'Maximum: 19605.007812', 'Count: 156861']\n> Metrics saved to /groups/ESS3/zsun/firecasting/data/output/output_tabnet_window_7_days_forecasting_with_new_yunyao_window_time_series_landuse_vhi_latlon//20210705/metrics_20210709_predicted.txt\n> predicting:  20210710\n> Read from original folder for current date: 20210710\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210710.txt\n> reading past files for 2021-07-09 00:00:00\n> reading from predicted folder\n> current final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n> 0 -999.0 -999.0  0.0  ...  101617.460938          -999.0            0.0\n> 1 -999.0 -999.0  0.0  ...  101617.460938          -999.0            0.0\n> 2 -999.0 -999.0  0.0  ...  101612.257812          -999.0            0.0\n> 3 -999.0 -999.0  0.0  ...  101612.257812          -999.0            0.0\n> 4 -999.0 -999.0  0.0  ...  101606.257812          -999.0            0.0\n> \n> [5 rows x 72 columns]\n> renaming Predicted_FRP to FRP\n> remove the current predicted_frp\n> reading past files for 2021-07-08 00:00:00\n> reading from predicted folder\n> current final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n> 0 -999.0 -999.0  0.0  ...  101530.867188          -999.0            0.0\n> 1 -999.0 -999.0  0.0  ...  101530.867188          -999.0            0.0\n> 2 -999.0 -999.0  0.0  ...  101528.468750          -999.0            0.0\n> 3 -999.0 -999.0  0.0  ...  101528.468750          -999.0            0.0\n> 4 -999.0 -999.0  0.0  ...  101526.070312          -999.0            0.0\n> \n> [5 rows x 72 columns]\n> renaming Predicted_FRP to FRP\n> remove the current predicted_frp\n> reading past files for 2021-07-07 00:00:00\n> reading from predicted folder\n> current final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n> 0 -999.0 -999.0  0.0  ...  101381.734375          -999.0            0.0\n> 1 -999.0 -999.0  0.0  ...  101381.734375          -999.0            0.0\n> 2 -999.0 -999.0  0.0  ...  101376.140625          -999.0            0.0\n> 3 -999.0 -999.0  0.0  ...  101376.140625          -999.0            0.0\n> 4 -999.0 -999.0  0.0  ...  101371.742188          -999.0            0.0\n> \n> [5 rows x 72 columns]\n> renaming Predicted_FRP to FRP\n> remove the current predicted_frp\n> reading past files for 2021-07-06 00:00:00\n> reading from predicted folder\n> current final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n> 0 -999.0 -999.0  0.0  ...  101329.468750          -999.0            0.0\n> 1 -999.0 -999.0  0.0  ...  101329.468750          -999.0            0.0\n> 2 -999.0 -999.0  0.0  ...  101317.062500          -999.0            0.0\n> 3 -999.0 -999.0  0.0  ...  101317.062500          -999.0            0.0\n> 4 -999.0 -999.0  0.0  ...  101301.859375          -999.0            0.0\n> \n> [5 rows x 72 columns]\n> renaming Predicted_FRP to FRP\n> remove the current predicted_frp\n> reading past files for 2021-07-05 00:00:00\n> reading from predicted folder\n> current final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n> 0 -999.0 -999.0  0.0  ...  101352.601562          -999.0            0.0\n> 1 -999.0 -999.0  0.0  ...  101352.601562          -999.0            0.0\n> 2 -999.0 -999.0  0.0  ...  101336.601562          -999.0            0.0\n> 3 -999.0 -999.0  0.0  ...  101336.601562          -999.0            0.0\n> 4 -999.0 -999.0  0.0  ...  101320.203125          -999.0            0.0\n> \n> [5 rows x 72 columns]\n> renaming Predicted_FRP to FRP\n> remove the current predicted_frp\n2847a2848,2884\n> reading past files for 2021-07-04 00:00:00\n> reading from original folder\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210704.txt\n> reading past files for 2021-07-03 00:00:00\n> reading from original folder\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210703.txt\n> New time series dataframe:      LAT         LON    FRP  ...  VPD_7_days_ago   P_7_days_ago  FRP_7_days_ago\n> 0  24.5 -126.000000 -999.0  ...          -999.0  101664.703125          -999.0\n> 1  24.5 -125.899994 -999.0  ...          -999.0  101664.703125          -999.0\n> 2  24.5 -125.800003 -999.0  ...          -999.0  101656.296875          -999.0\n> 3  24.5 -125.699997 -999.0  ...          -999.0  101656.296875          -999.0\n> 4  24.5 -125.599998 -999.0  ...          -999.0  101647.101562          -999.0\n> \n> [5 rows x 74 columns]\n> Original df is created:  (156861, 74)\n> Original df filled the na with -9999 \n> X and y are loaded into memory for 20210710\n> the loaded model is:  TabNetRegressor(n_d=17, n_a=41, n_steps=4, gamma=1.1546672563068268, cat_idxs=[], cat_dims=[], cat_emb_dim=[], n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.00042602006758391, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=71, output_dim=1, device_name='auto', n_shared_decoder=1, n_indep_decoder=1, grouped_features=[])\n> Loaded model is a TabNet model.\n> Prediction for 20210710 of start day 20210705 is finished\n> new columns to check:  ['FRP_1_days_ago', 'Nearest_1', 'Nearest_2', 'Nearest_3', 'Nearest_4', 'Nearest_5', 'Nearest_6', 'Nearest_7', 'Nearest_8']\n> current merged_df columns:  Index(['FWI', 'VPD', 'HT', 'T', 'RH', 'U', 'V', 'P', 'RAIN', 'CAPE', 'ST',\n>        'SM', 'Nearest_1', 'Nearest_2', 'Nearest_3', 'Nearest_4', 'Nearest_5',\n>        'Nearest_6', 'Nearest_7', 'Nearest_8', 'Nearest_9', 'Nearest_10',\n>        'Nearest_11', 'Nearest_12', 'Nearest_13', 'Nearest_14', 'Nearest_15',\n>        'Nearest_16', 'Nearest_17', 'Nearest_18', 'Nearest_19', 'Nearest_20',\n>        'Nearest_21', 'Nearest_22', 'Nearest_23', 'Nearest_24', 'Land_Use',\n>        'VCI_AVE', 'TCI_AVE', 'VHI_AVE', 'VCI_TOT', 'TCI_TOT', 'VHI_TOT',\n>        'FWI_1_days_ago', 'VPD_1_days_ago', 'P_1_days_ago', 'FRP_1_days_ago',\n>        'FWI_2_days_ago', 'VPD_2_days_ago', 'P_2_days_ago', 'FRP_2_days_ago',\n>        'FWI_3_days_ago', 'VPD_3_days_ago', 'P_3_days_ago', 'FRP_3_days_ago',\n>        'FWI_4_days_ago', 'VPD_4_days_ago', 'P_4_days_ago', 'FRP_4_days_ago',\n>        'FWI_5_days_ago', 'VPD_5_days_ago', 'P_5_days_ago', 'FRP_5_days_ago',\n>        'FWI_6_days_ago', 'VPD_6_days_ago', 'P_6_days_ago', 'FRP_6_days_ago',\n>        'FWI_7_days_ago', 'VPD_7_days_ago', 'P_7_days_ago', 'FRP_7_days_ago',\n>        'Predicted_FRP'],\n>       dtype='object')\n2884a2885,2928\n> Prediction results are saved to /groups/ESS3/zsun/firecasting/data/output/output_tabnet_window_7_days_forecasting_with_new_yunyao_window_time_series_landuse_vhi_latlon//20210705/firedata_20210710_predicted.txt\n> ['Mean Absolute Error (MAE): 22.547998933762166', 'Mean Squared Error (MSE): 29426.03562287616', 'Root Mean Squared Error (RMSE): 171.54018661198944', 'R-squared (R2) Score: -0.02360944278511523', 'Explained Variance Score: -0.007809223880369975', 'Median Absolute Error (MedAE): 0.0', 'Max Error: 23213.004525149645', 'Mean: -21.179196243725322', 'Median: 0.0', 'Standard Deviation: 169.55090832070005', 'Minimum: -999.0', 'Maximum: 23213.011719', 'Count: 156861']\n> Metrics saved to /groups/ESS3/zsun/firecasting/data/output/output_tabnet_window_7_days_forecasting_with_new_yunyao_window_time_series_landuse_vhi_latlon//20210705/metrics_20210710_predicted.txt\n> predicting:  20210711\n> Read from original folder for current date: 20210711\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210711.txt\n> reading past files for 2021-07-10 00:00:00\n> reading from predicted folder\n> current final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n> 0 -999.0 -999.0  0.0  ...  101664.703125          -999.0            0.0\n> 1 -999.0 -999.0  0.0  ...  101664.703125          -999.0            0.0\n> 2 -999.0 -999.0  0.0  ...  101656.296875          -999.0            0.0\n> 3 -999.0 -999.0  0.0  ...  101656.296875          -999.0            0.0\n> 4 -999.0 -999.0  0.0  ...  101647.101562          -999.0            0.0\n> \n> [5 rows x 72 columns]\n> renaming Predicted_FRP to FRP\n> remove the current predicted_frp\n> reading past files for 2021-07-09 00:00:00\n> reading from predicted folder\n> current final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n> 0 -999.0 -999.0  0.0  ...  101617.460938          -999.0            0.0\n> 1 -999.0 -999.0  0.0  ...  101617.460938          -999.0            0.0\n> 2 -999.0 -999.0  0.0  ...  101612.257812          -999.0            0.0\n> 3 -999.0 -999.0  0.0  ...  101612.257812          -999.0            0.0\n> 4 -999.0 -999.0  0.0  ...  101606.257812          -999.0            0.0\n> \n> [5 rows x 72 columns]\n> renaming Predicted_FRP to FRP\n> remove the current predicted_frp\n> reading past files for 2021-07-08 00:00:00\n> reading from predicted folder\n> current final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n> 0 -999.0 -999.0  0.0  ...  101530.867188          -999.0            0.0\n> 1 -999.0 -999.0  0.0  ...  101530.867188          -999.0            0.0\n> 2 -999.0 -999.0  0.0  ...  101528.468750          -999.0            0.0\n> 3 -999.0 -999.0  0.0  ...  101528.468750          -999.0            0.0\n> 4 -999.0 -999.0  0.0  ...  101526.070312          -999.0            0.0\n> \n> [5 rows x 72 columns]\n> renaming Predicted_FRP to FRP\n> remove the current predicted_frp\n> reading past files for 2021-07-07 00:00:00\n> reading from predicted folder\n2928a2929,2978\n> current final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n> 0 -999.0 -999.0  0.0  ...  101381.734375          -999.0            0.0\n> 1 -999.0 -999.0  0.0  ...  101381.734375          -999.0            0.0\n> 2 -999.0 -999.0  0.0  ...  101376.140625          -999.0            0.0\n> 3 -999.0 -999.0  0.0  ...  101376.140625          -999.0            0.0\n> 4 -999.0 -999.0  0.0  ...  101371.742188          -999.0            0.0\n> \n> [5 rows x 72 columns]\n> renaming Predicted_FRP to FRP\n> remove the current predicted_frp\n> reading past files for 2021-07-06 00:00:00\n> reading from predicted folder\n> current final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n> 0 -999.0 -999.0  0.0  ...  101329.468750          -999.0            0.0\n> 1 -999.0 -999.0  0.0  ...  101329.468750          -999.0            0.0\n> 2 -999.0 -999.0  0.0  ...  101317.062500          -999.0            0.0\n> 3 -999.0 -999.0  0.0  ...  101317.062500          -999.0            0.0\n> 4 -999.0 -999.0  0.0  ...  101301.859375          -999.0            0.0\n> \n> [5 rows x 72 columns]\n> renaming Predicted_FRP to FRP\n> remove the current predicted_frp\n> reading past files for 2021-07-05 00:00:00\n> reading from predicted folder\n> current final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n> 0 -999.0 -999.0  0.0  ...  101352.601562          -999.0            0.0\n> 1 -999.0 -999.0  0.0  ...  101352.601562          -999.0            0.0\n> 2 -999.0 -999.0  0.0  ...  101336.601562          -999.0            0.0\n> 3 -999.0 -999.0  0.0  ...  101336.601562          -999.0            0.0\n> 4 -999.0 -999.0  0.0  ...  101320.203125          -999.0            0.0\n> \n> [5 rows x 72 columns]\n> renaming Predicted_FRP to FRP\n> remove the current predicted_frp\n> reading past files for 2021-07-04 00:00:00\n> reading from original folder\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210704.txt\n> New time series dataframe:      LAT         LON    FRP  ...  VPD_7_days_ago   P_7_days_ago  FRP_7_days_ago\n> 0  24.5 -126.000000 -999.0  ...          -999.0  101734.710938          -999.0\n> 1  24.5 -125.899994 -999.0  ...          -999.0  101734.710938          -999.0\n> 2  24.5 -125.800003 -999.0  ...          -999.0  101727.906250          -999.0\n> 3  24.5 -125.699997 -999.0  ...          -999.0  101727.906250          -999.0\n> 4  24.5 -125.599998 -999.0  ...          -999.0  101720.710938          -999.0\n> \n> [5 rows x 74 columns]\n> Original df is created:  (156861, 74)\n> Original df filled the na with -9999 \n> X and y are loaded into memory for 20210711\n> the loaded model is:  TabNetRegressor(n_d=17, n_a=41, n_steps=4, gamma=1.1546672563068268, cat_idxs=[], cat_dims=[], cat_emb_dim=[], n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.00042602006758391, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=71, output_dim=1, device_name='auto', n_shared_decoder=1, n_indep_decoder=1, grouped_features=[])\n> Loaded model is a TabNet model.\n2978a2979,2996\n> Prediction for 20210711 of start day 20210705 is finished\n> new columns to check:  ['FRP_1_days_ago', 'Nearest_1', 'Nearest_2', 'Nearest_3', 'Nearest_4', 'Nearest_5', 'Nearest_6', 'Nearest_7', 'Nearest_8']\n> current merged_df columns:  Index(['FWI', 'VPD', 'HT', 'T', 'RH', 'U', 'V', 'P', 'RAIN', 'CAPE', 'ST',\n>        'SM', 'Nearest_1', 'Nearest_2', 'Nearest_3', 'Nearest_4', 'Nearest_5',\n>        'Nearest_6', 'Nearest_7', 'Nearest_8', 'Nearest_9', 'Nearest_10',\n>        'Nearest_11', 'Nearest_12', 'Nearest_13', 'Nearest_14', 'Nearest_15',\n>        'Nearest_16', 'Nearest_17', 'Nearest_18', 'Nearest_19', 'Nearest_20',\n>        'Nearest_21', 'Nearest_22', 'Nearest_23', 'Nearest_24', 'Land_Use',\n>        'VCI_AVE', 'TCI_AVE', 'VHI_AVE', 'VCI_TOT', 'TCI_TOT', 'VHI_TOT',\n>        'FWI_1_days_ago', 'VPD_1_days_ago', 'P_1_days_ago', 'FRP_1_days_ago',\n>        'FWI_2_days_ago', 'VPD_2_days_ago', 'P_2_days_ago', 'FRP_2_days_ago',\n>        'FWI_3_days_ago', 'VPD_3_days_ago', 'P_3_days_ago', 'FRP_3_days_ago',\n>        'FWI_4_days_ago', 'VPD_4_days_ago', 'P_4_days_ago', 'FRP_4_days_ago',\n>        'FWI_5_days_ago', 'VPD_5_days_ago', 'P_5_days_ago', 'FRP_5_days_ago',\n>        'FWI_6_days_ago', 'VPD_6_days_ago', 'P_6_days_ago', 'FRP_6_days_ago',\n>        'FWI_7_days_ago', 'VPD_7_days_ago', 'P_7_days_ago', 'FRP_7_days_ago',\n>        'Predicted_FRP'],\n>       dtype='object')\n2996a2997,3014\n> Prediction results are saved to /groups/ESS3/zsun/firecasting/data/output/output_tabnet_window_7_days_forecasting_with_new_yunyao_window_time_series_landuse_vhi_latlon//20210705/firedata_20210711_predicted.txt\n> Traceback (most recent call last):\n>   File \"<stdin>\", line 7, in <module>\n>   File \"/home/zsun/gw-workspace/50lutl24lgw/fc_model_predict_2weeks.py\", line 253, in predict_2weeks\n>     predict_2weeks_for_one_day(date_str, current_date, output_folder_full_path, loaded_model)\n>   File \"/home/zsun/gw-workspace/50lutl24lgw/fc_model_predict_2weeks.py\", line 206, in predict_2weeks_for_one_day\n>     predict_single_day_in_the_2weeks(single_day_current_date_str, date_str, specific_date_result_folder, loaded_model)\n>   File \"/home/zsun/gw-workspace/50lutl24lgw/fc_model_predict_2weeks.py\", line 151, in predict_single_day_in_the_2weeks\n>     mae = mean_absolute_error(y_test, y_pred)\n>   File \"/home/zsun/.local/lib/python3.8/site-packages/sklearn/metrics/_regression.py\", line 191, in mean_absolute_error\n>     y_type, y_true, y_pred, multioutput = _check_reg_targets(\n>   File \"/home/zsun/.local/lib/python3.8/site-packages/sklearn/metrics/_regression.py\", line 96, in _check_reg_targets\n>     y_pred = check_array(y_pred, ensure_2d=False, dtype=dtype)\n>   File \"/home/zsun/.local/lib/python3.8/site-packages/sklearn/utils/validation.py\", line 800, in check_array\n>     _assert_all_finite(array, allow_nan=force_all_finite == \"allow-nan\")\n>   File \"/home/zsun/.local/lib/python3.8/site-packages/sklearn/utils/validation.py\", line 114, in _assert_all_finite\n>     raise ValueError(\n> ValueError: Input contains NaN, infinity or a value too large for dtype('float64').\nJob 2042501 has finished with state: JobState=FAILED\nSlurm job (2042501) has finished.\nPrint the job's output logs\nJobID           JobName      State ExitCode     MaxRSS               Start                 End \n------------ ---------- ---------- -------- ---------- ------------------- ------------------- \n2042501      fc_model_+     FAILED      1:0            2024-07-12T15:32:40 2024-07-12T16:04:26 \n2042501.bat+      batch     FAILED      1:0    716432K 2024-07-12T15:32:40 2024-07-12T16:04:26 \n2042501.ext+     extern  COMPLETED      0:0          0 2024-07-12T15:32:40 2024-07-12T16:04:26 \n/home/zsun/anaconda3/lib/python3.8/site-packages/dask/dataframe/utils.py:367: FutureWarning: pandas.Int64Index is deprecated and will be removed from pandas in a future version. Use pandas.Index with the appropriate dtype instead.\n  _numeric_index_types = (pd.Int64Index, pd.Float64Index, pd.UInt64Index)\n/home/zsun/anaconda3/lib/python3.8/site-packages/dask/dataframe/utils.py:367: FutureWarning: pandas.Float64Index is deprecated and will be removed from pandas in a future version. Use pandas.Index with the appropriate dtype instead.\n  _numeric_index_types = (pd.Int64Index, pd.Float64Index, pd.UInt64Index)\n/home/zsun/anaconda3/lib/python3.8/site-packages/dask/dataframe/utils.py:367: FutureWarning: pandas.UInt64Index is deprecated and will be removed from pandas in a future version. Use pandas.Index with the appropriate dtype instead.\n  _numeric_index_types = (pd.Int64Index, pd.Float64Index, pd.UInt64Index)\nthe model in use is /groups/ESS3/zsun/firecasting/model/fc_tabnet_model_v1_latest.pkl.zip\n/home/zsun/anaconda3/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:82: UserWarning: Device used : cpu\n  warnings.warn(f\"Device used : {self.device}\")\ncurrent date:  2021-07-01 00:00:00\nsingle_day_current_date =  2021-07-01 00:00:00\nsingle_day_predict_end_date =  2021-07-08 00:00:00\npredicting:  20210701\nRead from original folder for current date: 20210701\nReading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210701.txt\nreading past files for 2021-06-30 00:00:00\nreading from original folder\nReading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210630.txt\nreading past files for 2021-06-29 00:00:00\nreading from original folder\nReading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210629.txt\nreading past files for 2021-06-28 00:00:00\nreading from original folder\nReading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210628.txt\nreading past files for 2021-06-27 00:00:00\nreading from original folder\nReading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210627.txt\nreading past files for 2021-06-26 00:00:00\nreading from original folder\nReading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210626.txt\nreading past files for 2021-06-25 00:00:00\nreading from original folder\nReading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210625.txt\nreading past files for 2021-06-24 00:00:00\nreading from original folder\nReading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210624.txt\nNew time series dataframe:      LAT         LON    FRP  ...  VPD_7_days_ago   P_7_days_ago  FRP_7_days_ago\n0  24.5 -126.000000 -999.0  ...          -999.0  101879.484375          -999.0\n1  24.5 -125.899994 -999.0  ...          -999.0  101879.484375          -999.0\n2  24.5 -125.800003 -999.0  ...          -999.0  101873.890625          -999.0\n3  24.5 -125.699997 -999.0  ...          -999.0  101873.890625          -999.0\n4  24.5 -125.599998 -999.0  ...          -999.0  101867.890625          -999.0\n[5 rows x 74 columns]\nOriginal df is created:  (156861, 74)\nOriginal df filled the na with -9999 \nX and y are loaded into memory for 20210701\nthe loaded model is:  TabNetRegressor(n_d=17, n_a=41, n_steps=4, gamma=1.1546672563068268, cat_idxs=[], cat_dims=[], cat_emb_dim=[], n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.00042602006758391, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=71, output_dim=1, device_name='auto', n_shared_decoder=1, n_indep_decoder=1, grouped_features=[])\nLoaded model is a TabNet model.\nPrediction for 20210701 of start day 20210701 is finished\nnew columns to check:  ['FRP_1_days_ago', 'Nearest_1', 'Nearest_2', 'Nearest_3', 'Nearest_4', 'Nearest_5', 'Nearest_6', 'Nearest_7', 'Nearest_8']\ncurrent merged_df columns:  Index(['FWI', 'VPD', 'HT', 'T', 'RH', 'U', 'V', 'P', 'RAIN', 'CAPE', 'ST',\n       'SM', 'Nearest_1', 'Nearest_2', 'Nearest_3', 'Nearest_4', 'Nearest_5',\n       'Nearest_6', 'Nearest_7', 'Nearest_8', 'Nearest_9', 'Nearest_10',\n       'Nearest_11', 'Nearest_12', 'Nearest_13', 'Nearest_14', 'Nearest_15',\n       'Nearest_16', 'Nearest_17', 'Nearest_18', 'Nearest_19', 'Nearest_20',\n       'Nearest_21', 'Nearest_22', 'Nearest_23', 'Nearest_24', 'Land_Use',\n       'VCI_AVE', 'TCI_AVE', 'VHI_AVE', 'VCI_TOT', 'TCI_TOT', 'VHI_TOT',\n       'FWI_1_days_ago', 'VPD_1_days_ago', 'P_1_days_ago', 'FRP_1_days_ago',\n       'FWI_2_days_ago', 'VPD_2_days_ago', 'P_2_days_ago', 'FRP_2_days_ago',\n       'FWI_3_days_ago', 'VPD_3_days_ago', 'P_3_days_ago', 'FRP_3_days_ago',\n       'FWI_4_days_ago', 'VPD_4_days_ago', 'P_4_days_ago', 'FRP_4_days_ago',\n       'FWI_5_days_ago', 'VPD_5_days_ago', 'P_5_days_ago', 'FRP_5_days_ago',\n       'FWI_6_days_ago', 'VPD_6_days_ago', 'P_6_days_ago', 'FRP_6_days_ago',\n       'FWI_7_days_ago', 'VPD_7_days_ago', 'P_7_days_ago', 'FRP_7_days_ago',\n       'Predicted_FRP'],\n      dtype='object')\nPrediction results are saved to /groups/ESS3/zsun/firecasting/data/output/output_tabnet_window_7_days_forecasting_with_new_yunyao_window_time_series_landuse_vhi_latlon//20210701/firedata_20210701_predicted.txt\n['Mean Absolute Error (MAE): 21.924801736676713', 'Mean Squared Error (MSE): 21908.046918238004', 'Root Mean Squared Error (RMSE): 148.01367138963212', 'R-squared (R2) Score: -0.022151944494863907', 'Explained Variance Score: 8.072396029401574e-07', 'Median Absolute Error (MedAE): 0.0', 'Max Error: 2366.392403045167', 'Mean: -21.78996688754375', 'Median: 0.0', 'Standard Deviation: 146.40148634334543', 'Minimum: -999.0', 'Maximum: 2366.637939', 'Count: 156861']\nMetrics saved to /groups/ESS3/zsun/firecasting/data/output/output_tabnet_window_7_days_forecasting_with_new_yunyao_window_time_series_landuse_vhi_latlon//20210701/metrics_20210701_predicted.txt\npredicting:  20210702\nRead from original folder for current date: 20210702\nReading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210702.txt\nreading past files for 2021-07-01 00:00:00\nreading from predicted folder\ncurrent final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n0 -999.0 -999.0  0.0  ...  101879.484375          -999.0            0.0\n1 -999.0 -999.0  0.0  ...  101879.484375          -999.0            0.0\n2 -999.0 -999.0  0.0  ...  101873.890625          -999.0            0.0\n3 -999.0 -999.0  0.0  ...  101873.890625          -999.0            0.0\n4 -999.0 -999.0  0.0  ...  101867.890625          -999.0            0.0\n[5 rows x 72 columns]\nrenaming Predicted_FRP to FRP\nremove the current predicted_frp\nreading past files for 2021-06-30 00:00:00\nreading from original folder\nReading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210630.txt\nreading past files for 2021-06-29 00:00:00\nreading from original folder\nReading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210629.txt\nreading past files for 2021-06-28 00:00:00\nreading from original folder\nReading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210628.txt\nreading past files for 2021-06-27 00:00:00\nreading from original folder\nReading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210627.txt\nreading past files for 2021-06-26 00:00:00\nreading from original folder\nReading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210626.txt\nreading past files for 2021-06-25 00:00:00\nreading from original folder\nReading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210625.txt\nNew time series dataframe:      LAT         LON    FRP  ...  VPD_7_days_ago   P_7_days_ago  FRP_7_days_ago\n0  24.5 -126.000000 -999.0  ...          -999.0  101861.375000          -999.0\n1  24.5 -125.899994 -999.0  ...          -999.0  101861.375000          -999.0\n2  24.5 -125.800003 -999.0  ...          -999.0  101853.773438          -999.0\n3  24.5 -125.699997 -999.0  ...          -999.0  101853.773438          -999.0\n4  24.5 -125.599998 -999.0  ...          -999.0  101844.171875          -999.0\n[5 rows x 74 columns]\nOriginal df is created:  (156861, 74)\nOriginal df filled the na with -9999 \nX and y are loaded into memory for 20210702\nthe loaded model is:  TabNetRegressor(n_d=17, n_a=41, n_steps=4, gamma=1.1546672563068268, cat_idxs=[], cat_dims=[], cat_emb_dim=[], n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.00042602006758391, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=71, output_dim=1, device_name='auto', n_shared_decoder=1, n_indep_decoder=1, grouped_features=[])\nLoaded model is a TabNet model.\nPrediction for 20210702 of start day 20210701 is finished\nnew columns to check:  ['FRP_1_days_ago', 'Nearest_1', 'Nearest_2', 'Nearest_3', 'Nearest_4', 'Nearest_5', 'Nearest_6', 'Nearest_7', 'Nearest_8']\ncurrent merged_df columns:  Index(['FWI', 'VPD', 'HT', 'T', 'RH', 'U', 'V', 'P', 'RAIN', 'CAPE', 'ST',\n       'SM', 'Nearest_1', 'Nearest_2', 'Nearest_3', 'Nearest_4', 'Nearest_5',\n       'Nearest_6', 'Nearest_7', 'Nearest_8', 'Nearest_9', 'Nearest_10',\n       'Nearest_11', 'Nearest_12', 'Nearest_13', 'Nearest_14', 'Nearest_15',\n       'Nearest_16', 'Nearest_17', 'Nearest_18', 'Nearest_19', 'Nearest_20',\n       'Nearest_21', 'Nearest_22', 'Nearest_23', 'Nearest_24', 'Land_Use',\n       'VCI_AVE', 'TCI_AVE', 'VHI_AVE', 'VCI_TOT', 'TCI_TOT', 'VHI_TOT',\n       'FWI_1_days_ago', 'VPD_1_days_ago', 'P_1_days_ago', 'FRP_1_days_ago',\n       'FWI_2_days_ago', 'VPD_2_days_ago', 'P_2_days_ago', 'FRP_2_days_ago',\n       'FWI_3_days_ago', 'VPD_3_days_ago', 'P_3_days_ago', 'FRP_3_days_ago',\n       'FWI_4_days_ago', 'VPD_4_days_ago', 'P_4_days_ago', 'FRP_4_days_ago',\n       'FWI_5_days_ago', 'VPD_5_days_ago', 'P_5_days_ago', 'FRP_5_days_ago',\n       'FWI_6_days_ago', 'VPD_6_days_ago', 'P_6_days_ago', 'FRP_6_days_ago',\n       'FWI_7_days_ago', 'VPD_7_days_ago', 'P_7_days_ago', 'FRP_7_days_ago',\n       'Predicted_FRP'],\n      dtype='object')\nPrediction results are saved to /groups/ESS3/zsun/firecasting/data/output/output_tabnet_window_7_days_forecasting_with_new_yunyao_window_time_series_landuse_vhi_latlon//20210701/firedata_20210702_predicted.txt\n['Mean Absolute Error (MAE): 21.878395609157476', 'Mean Squared Error (MSE): 21840.908165086676', 'Root Mean Squared Error (RMSE): 147.78669820077405', 'R-squared (R2) Score: -0.02231900468152559', 'Explained Variance Score: 2.648734451771162e-07', 'Median Absolute Error (MedAE): 0.0', 'Max Error: 999.0', 'Mean: -21.836369149265913', 'Median: 0.0', 'Standard Deviation: 146.16504128154463', 'Minimum: -999.0', 'Maximum: 639.787903', 'Count: 156861']\nMetrics saved to /groups/ESS3/zsun/firecasting/data/output/output_tabnet_window_7_days_forecasting_with_new_yunyao_window_time_series_landuse_vhi_latlon//20210701/metrics_20210702_predicted.txt\npredicting:  20210703\nRead from original folder for current date: 20210703\nReading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210703.txt\nreading past files for 2021-07-02 00:00:00\nreading from predicted folder\ncurrent final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n0 -999.0 -999.0  0.0  ...  101861.375000          -999.0            0.0\n1 -999.0 -999.0  0.0  ...  101861.375000          -999.0            0.0\n2 -999.0 -999.0  0.0  ...  101853.773438          -999.0            0.0\n3 -999.0 -999.0  0.0  ...  101853.773438          -999.0            0.0\n4 -999.0 -999.0  0.0  ...  101844.171875          -999.0            0.0\n[5 rows x 72 columns]\nrenaming Predicted_FRP to FRP\nremove the current predicted_frp\nreading past files for 2021-07-01 00:00:00\nreading from predicted folder\ncurrent final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n0 -999.0 -999.0  0.0  ...  101879.484375          -999.0            0.0\n1 -999.0 -999.0  0.0  ...  101879.484375          -999.0            0.0\n2 -999.0 -999.0  0.0  ...  101873.890625          -999.0            0.0\n3 -999.0 -999.0  0.0  ...  101873.890625          -999.0            0.0\n4 -999.0 -999.0  0.0  ...  101867.890625          -999.0            0.0\n[5 rows x 72 columns]\nrenaming Predicted_FRP to FRP\nremove the current predicted_frp\nreading past files for 2021-06-30 00:00:00\nreading from original folder\nReading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210630.txt\nreading past files for 2021-06-29 00:00:00\nreading from original folder\nReading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210629.txt\nreading past files for 2021-06-28 00:00:00\nreading from original folder\nReading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210628.txt\nreading past files for 2021-06-27 00:00:00\nreading from original folder\nReading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210627.txt\nreading past files for 2021-06-26 00:00:00\nreading from original folder\nReading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210626.txt\nNew time series dataframe:      LAT         LON    FRP  ...  VPD_7_days_ago   P_7_days_ago  FRP_7_days_ago\n0  24.5 -126.000000 -999.0  ...          -999.0  101701.023438          -999.0\n1  24.5 -125.899994 -999.0  ...          -999.0  101701.023438          -999.0\n2  24.5 -125.800003 -999.0  ...          -999.0  101689.023438          -999.0\n3  24.5 -125.699997 -999.0  ...          -999.0  101689.023438          -999.0\n4  24.5 -125.599998 -999.0  ...          -999.0  101676.625000          -999.0\n[5 rows x 74 columns]\nOriginal df is created:  (156861, 74)\nOriginal df filled the na with -9999 \nX and y are loaded into memory for 20210703\nthe loaded model is:  TabNetRegressor(n_d=17, n_a=41, n_steps=4, gamma=1.1546672563068268, cat_idxs=[], cat_dims=[], cat_emb_dim=[], n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.00042602006758391, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=71, output_dim=1, device_name='auto', n_shared_decoder=1, n_indep_decoder=1, grouped_features=[])\nLoaded model is a TabNet model.\nPrediction for 20210703 of start day 20210701 is finished\nnew columns to check:  ['FRP_1_days_ago', 'Nearest_1', 'Nearest_2', 'Nearest_3', 'Nearest_4', 'Nearest_5', 'Nearest_6', 'Nearest_7', 'Nearest_8']\ncurrent merged_df columns:  Index(['FWI', 'VPD', 'HT', 'T', 'RH', 'U', 'V', 'P', 'RAIN', 'CAPE', 'ST',\n       'SM', 'Nearest_1', 'Nearest_2', 'Nearest_3', 'Nearest_4', 'Nearest_5',\n       'Nearest_6', 'Nearest_7', 'Nearest_8', 'Nearest_9', 'Nearest_10',\n       'Nearest_11', 'Nearest_12', 'Nearest_13', 'Nearest_14', 'Nearest_15',\n       'Nearest_16', 'Nearest_17', 'Nearest_18', 'Nearest_19', 'Nearest_20',\n       'Nearest_21', 'Nearest_22', 'Nearest_23', 'Nearest_24', 'Land_Use',\n       'VCI_AVE', 'TCI_AVE', 'VHI_AVE', 'VCI_TOT', 'TCI_TOT', 'VHI_TOT',\n       'FWI_1_days_ago', 'VPD_1_days_ago', 'P_1_days_ago', 'FRP_1_days_ago',\n       'FWI_2_days_ago', 'VPD_2_days_ago', 'P_2_days_ago', 'FRP_2_days_ago',\n       'FWI_3_days_ago', 'VPD_3_days_ago', 'P_3_days_ago', 'FRP_3_days_ago',\n       'FWI_4_days_ago', 'VPD_4_days_ago', 'P_4_days_ago', 'FRP_4_days_ago',\n       'FWI_5_days_ago', 'VPD_5_days_ago', 'P_5_days_ago', 'FRP_5_days_ago',\n       'FWI_6_days_ago', 'VPD_6_days_ago', 'P_6_days_ago', 'FRP_6_days_ago',\n       'FWI_7_days_ago', 'VPD_7_days_ago', 'P_7_days_ago', 'FRP_7_days_ago',\n       'Predicted_FRP'],\n      dtype='object')\nPrediction results are saved to /groups/ESS3/zsun/firecasting/data/output/output_tabnet_window_7_days_forecasting_with_new_yunyao_window_time_series_landuse_vhi_latlon//20210701/firedata_20210703_predicted.txt\n['Mean Absolute Error (MAE): 21.894034137598595', 'Mean Squared Error (MSE): 21850.512678440944', 'Root Mean Squared Error (RMSE): 147.8191891414675', 'R-squared (R2) Score: -0.022276170930274786', 'Explained Variance Score: 5.933651832101816e-07', 'Median Absolute Error (MedAE): 0.0', 'Max Error: 1241.735596', 'Mean: -21.820777627262355', 'Median: 0.0', 'Standard Deviation: 146.20023852683786', 'Minimum: -999.0', 'Maximum: 1241.735596', 'Count: 156861']\nMetrics saved to /groups/ESS3/zsun/firecasting/data/output/output_tabnet_window_7_days_forecasting_with_new_yunyao_window_time_series_landuse_vhi_latlon//20210701/metrics_20210703_predicted.txt\npredicting:  20210704\nRead from original folder for current date: 20210704\nReading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210704.txt\nreading past files for 2021-07-03 00:00:00\nreading from predicted folder\ncurrent final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n0 -999.0 -999.0  0.0  ...  101701.023438          -999.0            0.0\n1 -999.0 -999.0  0.0  ...  101701.023438          -999.0            0.0\n2 -999.0 -999.0  0.0  ...  101689.023438          -999.0            0.0\n3 -999.0 -999.0  0.0  ...  101689.023438          -999.0            0.0\n4 -999.0 -999.0  0.0  ...  101676.625000          -999.0            0.0\n[5 rows x 72 columns]\nrenaming Predicted_FRP to FRP\nremove the current predicted_frp\nreading past files for 2021-07-02 00:00:00\nreading from predicted folder\ncurrent final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n0 -999.0 -999.0  0.0  ...  101861.375000          -999.0            0.0\n1 -999.0 -999.0  0.0  ...  101861.375000          -999.0            0.0\n2 -999.0 -999.0  0.0  ...  101853.773438          -999.0            0.0\n3 -999.0 -999.0  0.0  ...  101853.773438          -999.0            0.0\n4 -999.0 -999.0  0.0  ...  101844.171875          -999.0            0.0\n[5 rows x 72 columns]\nrenaming Predicted_FRP to FRP\nremove the current predicted_frp\nreading past files for 2021-07-01 00:00:00\nreading from predicted folder\ncurrent final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n0 -999.0 -999.0  0.0  ...  101879.484375          -999.0            0.0\n1 -999.0 -999.0  0.0  ...  101879.484375          -999.0            0.0\n2 -999.0 -999.0  0.0  ...  101873.890625          -999.0            0.0\n3 -999.0 -999.0  0.0  ...  101873.890625          -999.0            0.0\n4 -999.0 -999.0  0.0  ...  101867.890625          -999.0            0.0\n[5 rows x 72 columns]\nrenaming Predicted_FRP to FRP\nremove the current predicted_frp\nreading past files for 2021-06-30 00:00:00\nreading from original folder\nReading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210630.txt\nreading past files for 2021-06-29 00:00:00\nreading from original folder\nReading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210629.txt\nreading past files for 2021-06-28 00:00:00\nreading from original folder\nReading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210628.txt\nreading past files for 2021-06-27 00:00:00\nreading from original folder\nReading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210627.txt\nNew time series dataframe:      LAT         LON    FRP  ...  VPD_7_days_ago   P_7_days_ago  FRP_7_days_ago\n0  24.5 -126.000000 -999.0  ...          -999.0  101521.437500          -999.0\n1  24.5 -125.899994 -999.0  ...          -999.0  101521.437500          -999.0\n2  24.5 -125.800003 -999.0  ...          -999.0  101507.437500          -999.0\n3  24.5 -125.699997 -999.0  ...          -999.0  101507.437500          -999.0\n4  24.5 -125.599998 -999.0  ...          -999.0  101494.640625          -999.0\n[5 rows x 74 columns]\nOriginal df is created:  (156861, 74)\nOriginal df filled the na with -9999 \nX and y are loaded into memory for 20210704\nthe loaded model is:  TabNetRegressor(n_d=17, n_a=41, n_steps=4, gamma=1.1546672563068268, cat_idxs=[], cat_dims=[], cat_emb_dim=[], n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.00042602006758391, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=71, output_dim=1, device_name='auto', n_shared_decoder=1, n_indep_decoder=1, grouped_features=[])\nLoaded model is a TabNet model.\nPrediction for 20210704 of start day 20210701 is finished\nnew columns to check:  ['FRP_1_days_ago', 'Nearest_1', 'Nearest_2', 'Nearest_3', 'Nearest_4', 'Nearest_5', 'Nearest_6', 'Nearest_7', 'Nearest_8']\ncurrent merged_df columns:  Index(['FWI', 'VPD', 'HT', 'T', 'RH', 'U', 'V', 'P', 'RAIN', 'CAPE', 'ST',\n       'SM', 'Nearest_1', 'Nearest_2', 'Nearest_3', 'Nearest_4', 'Nearest_5',\n       'Nearest_6', 'Nearest_7', 'Nearest_8', 'Nearest_9', 'Nearest_10',\n       'Nearest_11', 'Nearest_12', 'Nearest_13', 'Nearest_14', 'Nearest_15',\n       'Nearest_16', 'Nearest_17', 'Nearest_18', 'Nearest_19', 'Nearest_20',\n       'Nearest_21', 'Nearest_22', 'Nearest_23', 'Nearest_24', 'Land_Use',\n       'VCI_AVE', 'TCI_AVE', 'VHI_AVE', 'VCI_TOT', 'TCI_TOT', 'VHI_TOT',\n       'FWI_1_days_ago', 'VPD_1_days_ago', 'P_1_days_ago', 'FRP_1_days_ago',\n       'FWI_2_days_ago', 'VPD_2_days_ago', 'P_2_days_ago', 'FRP_2_days_ago',\n       'FWI_3_days_ago', 'VPD_3_days_ago', 'P_3_days_ago', 'FRP_3_days_ago',\n       'FWI_4_days_ago', 'VPD_4_days_ago', 'P_4_days_ago', 'FRP_4_days_ago',\n       'FWI_5_days_ago', 'VPD_5_days_ago', 'P_5_days_ago', 'FRP_5_days_ago',\n       'FWI_6_days_ago', 'VPD_6_days_ago', 'P_6_days_ago', 'FRP_6_days_ago',\n       'FWI_7_days_ago', 'VPD_7_days_ago', 'P_7_days_ago', 'FRP_7_days_ago',\n       'Predicted_FRP'],\n      dtype='object')\nPrediction results are saved to /groups/ESS3/zsun/firecasting/data/output/output_tabnet_window_7_days_forecasting_with_new_yunyao_window_time_series_landuse_vhi_latlon//20210701/firedata_20210704_predicted.txt\n['Mean Absolute Error (MAE): 21.89682939741859', 'Mean Squared Error (MSE): 21857.45495846014', 'Root Mean Squared Error (RMSE): 147.84266961354606', 'R-squared (R2) Score: -0.02226336989362232', 'Explained Variance Score: 4.1125496874627743e-07', 'Median Absolute Error (MedAE): 0.0', 'Max Error: 1181.0896852640576', 'Mean: -21.818007558577342', 'Median: 0.0', 'Standard Deviation: 146.2243773555253', 'Minimum: -999.0', 'Maximum: 1181.141357', 'Count: 156861']\nMetrics saved to /groups/ESS3/zsun/firecasting/data/output/output_tabnet_window_7_days_forecasting_with_new_yunyao_window_time_series_landuse_vhi_latlon//20210701/metrics_20210704_predicted.txt\npredicting:  20210705\nRead from original folder for current date: 20210705\nReading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210705.txt\nreading past files for 2021-07-04 00:00:00\nreading from predicted folder\ncurrent final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n0 -999.0 -999.0  0.0  ...  101521.437500          -999.0            0.0\n1 -999.0 -999.0  0.0  ...  101521.437500          -999.0            0.0\n2 -999.0 -999.0  0.0  ...  101507.437500          -999.0            0.0\n3 -999.0 -999.0  0.0  ...  101507.437500          -999.0            0.0\n4 -999.0 -999.0  0.0  ...  101494.640625          -999.0            0.0\n[5 rows x 72 columns]\nrenaming Predicted_FRP to FRP\nremove the current predicted_frp\nreading past files for 2021-07-03 00:00:00\nreading from predicted folder\ncurrent final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n0 -999.0 -999.0  0.0  ...  101701.023438          -999.0            0.0\n1 -999.0 -999.0  0.0  ...  101701.023438          -999.0            0.0\n2 -999.0 -999.0  0.0  ...  101689.023438          -999.0            0.0\n3 -999.0 -999.0  0.0  ...  101689.023438          -999.0            0.0\n4 -999.0 -999.0  0.0  ...  101676.625000          -999.0            0.0\n[5 rows x 72 columns]\nrenaming Predicted_FRP to FRP\nremove the current predicted_frp\nreading past files for 2021-07-02 00:00:00\nreading from predicted folder\ncurrent final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n0 -999.0 -999.0  0.0  ...  101861.375000          -999.0            0.0\n1 -999.0 -999.0  0.0  ...  101861.375000          -999.0            0.0\n2 -999.0 -999.0  0.0  ...  101853.773438          -999.0            0.0\n3 -999.0 -999.0  0.0  ...  101853.773438          -999.0            0.0\n4 -999.0 -999.0  0.0  ...  101844.171875          -999.0            0.0\n[5 rows x 72 columns]\nrenaming Predicted_FRP to FRP\nremove the current predicted_frp\nreading past files for 2021-07-01 00:00:00\nreading from predicted folder\ncurrent final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n0 -999.0 -999.0  0.0  ...  101879.484375          -999.0            0.0\n1 -999.0 -999.0  0.0  ...  101879.484375          -999.0            0.0\n2 -999.0 -999.0  0.0  ...  101873.890625          -999.0            0.0\n3 -999.0 -999.0  0.0  ...  101873.890625          -999.0            0.0\n4 -999.0 -999.0  0.0  ...  101867.890625          -999.0            0.0\n[5 rows x 72 columns]\nrenaming Predicted_FRP to FRP\nremove the current predicted_frp\nreading past files for 2021-06-30 00:00:00\nreading from original folder\nReading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210630.txt\nreading past files for 2021-06-29 00:00:00\nreading from original folder\nReading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210629.txt\nreading past files for 2021-06-28 00:00:00\nreading from original folder\nReading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210628.txt\nNew time series dataframe:      LAT         LON    FRP  ...  VPD_7_days_ago   P_7_days_ago  FRP_7_days_ago\n0  24.5 -126.000000 -999.0  ...          -999.0  101352.601562          -999.0\n1  24.5 -125.899994 -999.0  ...          -999.0  101352.601562          -999.0\n2  24.5 -125.800003 -999.0  ...          -999.0  101336.601562          -999.0\n3  24.5 -125.699997 -999.0  ...          -999.0  101336.601562          -999.0\n4  24.5 -125.599998 -999.0  ...          -999.0  101320.203125          -999.0\n[5 rows x 74 columns]\nOriginal df is created:  (156861, 74)\nOriginal df filled the na with -9999 \nX and y are loaded into memory for 20210705\nthe loaded model is:  TabNetRegressor(n_d=17, n_a=41, n_steps=4, gamma=1.1546672563068268, cat_idxs=[], cat_dims=[], cat_emb_dim=[], n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.00042602006758391, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=71, output_dim=1, device_name='auto', n_shared_decoder=1, n_indep_decoder=1, grouped_features=[])\nLoaded model is a TabNet model.\nPrediction for 20210705 of start day 20210701 is finished\nnew columns to check:  ['FRP_1_days_ago', 'Nearest_1', 'Nearest_2', 'Nearest_3', 'Nearest_4', 'Nearest_5', 'Nearest_6', 'Nearest_7', 'Nearest_8']\ncurrent merged_df columns:  Index(['FWI', 'VPD', 'HT', 'T', 'RH', 'U', 'V', 'P', 'RAIN', 'CAPE', 'ST',\n       'SM', 'Nearest_1', 'Nearest_2', 'Nearest_3', 'Nearest_4', 'Nearest_5',\n       'Nearest_6', 'Nearest_7', 'Nearest_8', 'Nearest_9', 'Nearest_10',\n       'Nearest_11', 'Nearest_12', 'Nearest_13', 'Nearest_14', 'Nearest_15',\n       'Nearest_16', 'Nearest_17', 'Nearest_18', 'Nearest_19', 'Nearest_20',\n       'Nearest_21', 'Nearest_22', 'Nearest_23', 'Nearest_24', 'Land_Use',\n       'VCI_AVE', 'TCI_AVE', 'VHI_AVE', 'VCI_TOT', 'TCI_TOT', 'VHI_TOT',\n       'FWI_1_days_ago', 'VPD_1_days_ago', 'P_1_days_ago', 'FRP_1_days_ago',\n       'FWI_2_days_ago', 'VPD_2_days_ago', 'P_2_days_ago', 'FRP_2_days_ago',\n       'FWI_3_days_ago', 'VPD_3_days_ago', 'P_3_days_ago', 'FRP_3_days_ago',\n       'FWI_4_days_ago', 'VPD_4_days_ago', 'P_4_days_ago', 'FRP_4_days_ago',\n       'FWI_5_days_ago', 'VPD_5_days_ago', 'P_5_days_ago', 'FRP_5_days_ago',\n       'FWI_6_days_ago', 'VPD_6_days_ago', 'P_6_days_ago', 'FRP_6_days_ago',\n       'FWI_7_days_ago', 'VPD_7_days_ago', 'P_7_days_ago', 'FRP_7_days_ago',\n       'Predicted_FRP'],\n      dtype='object')\nPrediction results are saved to /groups/ESS3/zsun/firecasting/data/output/output_tabnet_window_7_days_forecasting_with_new_yunyao_window_time_series_landuse_vhi_latlon//20210701/firedata_20210705_predicted.txt\n['Mean Absolute Error (MAE): 21.89977847352078', 'Mean Squared Error (MSE): 21849.950923035296', 'Root Mean Squared Error (RMSE): 147.8172889855422', 'R-squared (R2) Score: -0.022265212698645342', 'Explained Variance Score: 3.631281273452913e-07', 'Median Absolute Error (MedAE): 0.0', 'Max Error: 1216.9396944375744', 'Mean: -21.81510091978249', 'Median: 0.0', 'Standard Deviation: 146.19914277086232', 'Minimum: -999.0', 'Maximum: 1216.946899', 'Count: 156861']\nMetrics saved to /groups/ESS3/zsun/firecasting/data/output/output_tabnet_window_7_days_forecasting_with_new_yunyao_window_time_series_landuse_vhi_latlon//20210701/metrics_20210705_predicted.txt\npredicting:  20210706\nRead from original folder for current date: 20210706\nReading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210706.txt\nreading past files for 2021-07-05 00:00:00\nreading from predicted folder\ncurrent final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n0 -999.0 -999.0  0.0  ...  101352.601562          -999.0            0.0\n1 -999.0 -999.0  0.0  ...  101352.601562          -999.0            0.0\n2 -999.0 -999.0  0.0  ...  101336.601562          -999.0            0.0\n3 -999.0 -999.0  0.0  ...  101336.601562          -999.0            0.0\n4 -999.0 -999.0  0.0  ...  101320.203125          -999.0            0.0\n[5 rows x 72 columns]\nrenaming Predicted_FRP to FRP\nremove the current predicted_frp\nreading past files for 2021-07-04 00:00:00\nreading from predicted folder\ncurrent final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n0 -999.0 -999.0  0.0  ...  101521.437500          -999.0            0.0\n1 -999.0 -999.0  0.0  ...  101521.437500          -999.0            0.0\n2 -999.0 -999.0  0.0  ...  101507.437500          -999.0            0.0\n3 -999.0 -999.0  0.0  ...  101507.437500          -999.0            0.0\n4 -999.0 -999.0  0.0  ...  101494.640625          -999.0            0.0\n[5 rows x 72 columns]\nrenaming Predicted_FRP to FRP\nremove the current predicted_frp\nreading past files for 2021-07-03 00:00:00\nreading from predicted folder\ncurrent final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n0 -999.0 -999.0  0.0  ...  101701.023438          -999.0            0.0\n1 -999.0 -999.0  0.0  ...  101701.023438          -999.0            0.0\n2 -999.0 -999.0  0.0  ...  101689.023438          -999.0            0.0\n3 -999.0 -999.0  0.0  ...  101689.023438          -999.0            0.0\n4 -999.0 -999.0  0.0  ...  101676.625000          -999.0            0.0\n[5 rows x 72 columns]\nrenaming Predicted_FRP to FRP\nremove the current predicted_frp\nreading past files for 2021-07-02 00:00:00\nreading from predicted folder\ncurrent final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n0 -999.0 -999.0  0.0  ...  101861.375000          -999.0            0.0\n1 -999.0 -999.0  0.0  ...  101861.375000          -999.0            0.0\n2 -999.0 -999.0  0.0  ...  101853.773438          -999.0            0.0\n3 -999.0 -999.0  0.0  ...  101853.773438          -999.0            0.0\n4 -999.0 -999.0  0.0  ...  101844.171875          -999.0            0.0\n[5 rows x 72 columns]\nrenaming Predicted_FRP to FRP\nremove the current predicted_frp\nreading past files for 2021-07-01 00:00:00\nreading from predicted folder\ncurrent final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n0 -999.0 -999.0  0.0  ...  101879.484375          -999.0            0.0\n1 -999.0 -999.0  0.0  ...  101879.484375          -999.0            0.0\n2 -999.0 -999.0  0.0  ...  101873.890625          -999.0            0.0\n3 -999.0 -999.0  0.0  ...  101873.890625          -999.0            0.0\n4 -999.0 -999.0  0.0  ...  101867.890625          -999.0            0.0\n[5 rows x 72 columns]\nrenaming Predicted_FRP to FRP\nremove the current predicted_frp\nreading past files for 2021-06-30 00:00:00\nreading from original folder\nReading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210630.txt\nreading past files for 2021-06-29 00:00:00\nreading from original folder\nReading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210629.txt\nNew time series dataframe:      LAT         LON    FRP  ...  VPD_7_days_ago   P_7_days_ago  FRP_7_days_ago\n0  24.5 -126.000000 -999.0  ...          -999.0  101329.468750          -999.0\n1  24.5 -125.899994 -999.0  ...          -999.0  101329.468750          -999.0\n2  24.5 -125.800003 -999.0  ...          -999.0  101317.062500          -999.0\n3  24.5 -125.699997 -999.0  ...          -999.0  101317.062500          -999.0\n4  24.5 -125.599998 -999.0  ...          -999.0  101301.859375          -999.0\n[5 rows x 74 columns]\nOriginal df is created:  (156861, 74)\nOriginal df filled the na with -9999 \nX and y are loaded into memory for 20210706\nthe loaded model is:  TabNetRegressor(n_d=17, n_a=41, n_steps=4, gamma=1.1546672563068268, cat_idxs=[], cat_dims=[], cat_emb_dim=[], n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.00042602006758391, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=71, output_dim=1, device_name='auto', n_shared_decoder=1, n_indep_decoder=1, grouped_features=[])\nLoaded model is a TabNet model.\nPrediction for 20210706 of start day 20210701 is finished\nnew columns to check:  ['FRP_1_days_ago', 'Nearest_1', 'Nearest_2', 'Nearest_3', 'Nearest_4', 'Nearest_5', 'Nearest_6', 'Nearest_7', 'Nearest_8']\ncurrent merged_df columns:  Index(['FWI', 'VPD', 'HT', 'T', 'RH', 'U', 'V', 'P', 'RAIN', 'CAPE', 'ST',\n       'SM', 'Nearest_1', 'Nearest_2', 'Nearest_3', 'Nearest_4', 'Nearest_5',\n       'Nearest_6', 'Nearest_7', 'Nearest_8', 'Nearest_9', 'Nearest_10',\n       'Nearest_11', 'Nearest_12', 'Nearest_13', 'Nearest_14', 'Nearest_15',\n       'Nearest_16', 'Nearest_17', 'Nearest_18', 'Nearest_19', 'Nearest_20',\n       'Nearest_21', 'Nearest_22', 'Nearest_23', 'Nearest_24', 'Land_Use',\n       'VCI_AVE', 'TCI_AVE', 'VHI_AVE', 'VCI_TOT', 'TCI_TOT', 'VHI_TOT',\n       'FWI_1_days_ago', 'VPD_1_days_ago', 'P_1_days_ago', 'FRP_1_days_ago',\n       'FWI_2_days_ago', 'VPD_2_days_ago', 'P_2_days_ago', 'FRP_2_days_ago',\n       'FWI_3_days_ago', 'VPD_3_days_ago', 'P_3_days_ago', 'FRP_3_days_ago',\n       'FWI_4_days_ago', 'VPD_4_days_ago', 'P_4_days_ago', 'FRP_4_days_ago',\n       'FWI_5_days_ago', 'VPD_5_days_ago', 'P_5_days_ago', 'FRP_5_days_ago',\n       'FWI_6_days_ago', 'VPD_6_days_ago', 'P_6_days_ago', 'FRP_6_days_ago',\n       'FWI_7_days_ago', 'VPD_7_days_ago', 'P_7_days_ago', 'FRP_7_days_ago',\n       'Predicted_FRP'],\n      dtype='object')\nPrediction results are saved to /groups/ESS3/zsun/firecasting/data/output/output_tabnet_window_7_days_forecasting_with_new_yunyao_window_time_series_landuse_vhi_latlon//20210701/firedata_20210706_predicted.txt\n['Mean Absolute Error (MAE): 21.968528418722748', 'Mean Squared Error (MSE): 22237.57250446588', 'Root Mean Squared Error (RMSE): 149.12267602368823', 'R-squared (R2) Score: -0.0217257122650365', 'Explained Variance Score: 2.84587337695541e-06', 'Median Absolute Error (MedAE): 0.0', 'Max Error: 7547.461402141784', 'Mean: -21.746309589547433', 'Median: 0.0', 'Standard Deviation: 147.52917421844327', 'Minimum: -999.0', 'Maximum: 7547.473145', 'Count: 156861']\nMetrics saved to /groups/ESS3/zsun/firecasting/data/output/output_tabnet_window_7_days_forecasting_with_new_yunyao_window_time_series_landuse_vhi_latlon//20210701/metrics_20210706_predicted.txt\npredicting:  20210707\nRead from original folder for current date: 20210707\nReading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210707.txt\nreading past files for 2021-07-06 00:00:00\nreading from predicted folder\ncurrent final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n0 -999.0 -999.0  0.0  ...  101329.468750          -999.0            0.0\n1 -999.0 -999.0  0.0  ...  101329.468750          -999.0            0.0\n2 -999.0 -999.0  0.0  ...  101317.062500          -999.0            0.0\n3 -999.0 -999.0  0.0  ...  101317.062500          -999.0            0.0\n4 -999.0 -999.0  0.0  ...  101301.859375          -999.0            0.0\n[5 rows x 72 columns]\nrenaming Predicted_FRP to FRP\nremove the current predicted_frp\nreading past files for 2021-07-05 00:00:00\nreading from predicted folder\ncurrent final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n0 -999.0 -999.0  0.0  ...  101352.601562          -999.0            0.0\n1 -999.0 -999.0  0.0  ...  101352.601562          -999.0            0.0\n2 -999.0 -999.0  0.0  ...  101336.601562          -999.0            0.0\n3 -999.0 -999.0  0.0  ...  101336.601562          -999.0            0.0\n4 -999.0 -999.0  0.0  ...  101320.203125          -999.0            0.0\n[5 rows x 72 columns]\nrenaming Predicted_FRP to FRP\nremove the current predicted_frp\nreading past files for 2021-07-04 00:00:00\nreading from predicted folder\ncurrent final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n0 -999.0 -999.0  0.0  ...  101521.437500          -999.0            0.0\n1 -999.0 -999.0  0.0  ...  101521.437500          -999.0            0.0\n2 -999.0 -999.0  0.0  ...  101507.437500          -999.0            0.0\n3 -999.0 -999.0  0.0  ...  101507.437500          -999.0            0.0\n4 -999.0 -999.0  0.0  ...  101494.640625          -999.0            0.0\n[5 rows x 72 columns]\nrenaming Predicted_FRP to FRP\nremove the current predicted_frp\nreading past files for 2021-07-03 00:00:00\nreading from predicted folder\ncurrent final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n0 -999.0 -999.0  0.0  ...  101701.023438          -999.0            0.0\n1 -999.0 -999.0  0.0  ...  101701.023438          -999.0            0.0\n2 -999.0 -999.0  0.0  ...  101689.023438          -999.0            0.0\n3 -999.0 -999.0  0.0  ...  101689.023438          -999.0            0.0\n4 -999.0 -999.0  0.0  ...  101676.625000          -999.0            0.0\n[5 rows x 72 columns]\nrenaming Predicted_FRP to FRP\nremove the current predicted_frp\nreading past files for 2021-07-02 00:00:00\nreading from predicted folder\ncurrent final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n0 -999.0 -999.0  0.0  ...  101861.375000          -999.0            0.0\n1 -999.0 -999.0  0.0  ...  101861.375000          -999.0            0.0\n2 -999.0 -999.0  0.0  ...  101853.773438          -999.0            0.0\n3 -999.0 -999.0  0.0  ...  101853.773438          -999.0            0.0\n4 -999.0 -999.0  0.0  ...  101844.171875          -999.0            0.0\n[5 rows x 72 columns]\nrenaming Predicted_FRP to FRP\nremove the current predicted_frp\nreading past files for 2021-07-01 00:00:00\nreading from predicted folder\ncurrent final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n0 -999.0 -999.0  0.0  ...  101879.484375          -999.0            0.0\n1 -999.0 -999.0  0.0  ...  101879.484375          -999.0            0.0\n2 -999.0 -999.0  0.0  ...  101873.890625          -999.0            0.0\n3 -999.0 -999.0  0.0  ...  101873.890625          -999.0            0.0\n4 -999.0 -999.0  0.0  ...  101867.890625          -999.0            0.0\n[5 rows x 72 columns]\nrenaming Predicted_FRP to FRP\nremove the current predicted_frp\nreading past files for 2021-06-30 00:00:00\nreading from original folder\nReading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210630.txt\nNew time series dataframe:      LAT         LON    FRP  ...  VPD_7_days_ago   P_7_days_ago  FRP_7_days_ago\n0  24.5 -126.000000 -999.0  ...          -999.0  101381.734375          -999.0\n1  24.5 -125.899994 -999.0  ...          -999.0  101381.734375          -999.0\n2  24.5 -125.800003 -999.0  ...          -999.0  101376.140625          -999.0\n3  24.5 -125.699997 -999.0  ...          -999.0  101376.140625          -999.0\n4  24.5 -125.599998 -999.0  ...          -999.0  101371.742188          -999.0\n[5 rows x 74 columns]\nOriginal df is created:  (156861, 74)\nOriginal df filled the na with -9999 \nX and y are loaded into memory for 20210707\nthe loaded model is:  TabNetRegressor(n_d=17, n_a=41, n_steps=4, gamma=1.1546672563068268, cat_idxs=[], cat_dims=[], cat_emb_dim=[], n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.00042602006758391, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=71, output_dim=1, device_name='auto', n_shared_decoder=1, n_indep_decoder=1, grouped_features=[])\nLoaded model is a TabNet model.\nPrediction for 20210707 of start day 20210701 is finished\nnew columns to check:  ['FRP_1_days_ago', 'Nearest_1', 'Nearest_2', 'Nearest_3', 'Nearest_4', 'Nearest_5', 'Nearest_6', 'Nearest_7', 'Nearest_8']\ncurrent merged_df columns:  Index(['FWI', 'VPD', 'HT', 'T', 'RH', 'U', 'V', 'P', 'RAIN', 'CAPE', 'ST',\n       'SM', 'Nearest_1', 'Nearest_2', 'Nearest_3', 'Nearest_4', 'Nearest_5',\n       'Nearest_6', 'Nearest_7', 'Nearest_8', 'Nearest_9', 'Nearest_10',\n       'Nearest_11', 'Nearest_12', 'Nearest_13', 'Nearest_14', 'Nearest_15',\n       'Nearest_16', 'Nearest_17', 'Nearest_18', 'Nearest_19', 'Nearest_20',\n       'Nearest_21', 'Nearest_22', 'Nearest_23', 'Nearest_24', 'Land_Use',\n       'VCI_AVE', 'TCI_AVE', 'VHI_AVE', 'VCI_TOT', 'TCI_TOT', 'VHI_TOT',\n       'FWI_1_days_ago', 'VPD_1_days_ago', 'P_1_days_ago', 'FRP_1_days_ago',\n       'FWI_2_days_ago', 'VPD_2_days_ago', 'P_2_days_ago', 'FRP_2_days_ago',\n       'FWI_3_days_ago', 'VPD_3_days_ago', 'P_3_days_ago', 'FRP_3_days_ago',\n       'FWI_4_days_ago', 'VPD_4_days_ago', 'P_4_days_ago', 'FRP_4_days_ago',\n       'FWI_5_days_ago', 'VPD_5_days_ago', 'P_5_days_ago', 'FRP_5_days_ago',\n       'FWI_6_days_ago', 'VPD_6_days_ago', 'P_6_days_ago', 'FRP_6_days_ago',\n       'FWI_7_days_ago', 'VPD_7_days_ago', 'P_7_days_ago', 'FRP_7_days_ago',\n       'Predicted_FRP'],\n      dtype='object')\nPrediction results are saved to /groups/ESS3/zsun/firecasting/data/output/output_tabnet_window_7_days_forecasting_with_new_yunyao_window_time_series_landuse_vhi_latlon//20210701/firedata_20210707_predicted.txt\n['Mean Absolute Error (MAE): 22.085140908310738', 'Mean Squared Error (MSE): 23056.245571015115', 'Root Mean Squared Error (RMSE): 151.84283180649365', 'R-squared (R2) Score: -0.02071760349906504', 'Explained Variance Score: -1.4140111772587005e-06', 'Median Absolute Error (MedAE): 0.0', 'Max Error: 11733.888392616063', 'Mean: -21.630771051147192', 'Median: 0.0', 'Standard Deviation: 150.29442683250224', 'Minimum: -999.0', 'Maximum: 11733.90625', 'Count: 156861']\nMetrics saved to /groups/ESS3/zsun/firecasting/data/output/output_tabnet_window_7_days_forecasting_with_new_yunyao_window_time_series_landuse_vhi_latlon//20210701/metrics_20210707_predicted.txt\ncurrent date:  2021-07-02 00:00:00\nsingle_day_current_date =  2021-07-02 00:00:00\nsingle_day_predict_end_date =  2021-07-09 00:00:00\npredicting:  20210702\nRead from original folder for current date: 20210702\nReading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210702.txt\nreading past files for 2021-07-01 00:00:00\nreading from original folder\nReading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210701.txt\nreading past files for 2021-06-30 00:00:00\nreading from original folder\nReading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210630.txt\nreading past files for 2021-06-29 00:00:00\nreading from original folder\nReading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210629.txt\nreading past files for 2021-06-28 00:00:00\nreading from original folder\nReading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210628.txt\nreading past files for 2021-06-27 00:00:00\nreading from original folder\nReading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210627.txt\nreading past files for 2021-06-26 00:00:00\nreading from original folder\nReading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210626.txt\nreading past files for 2021-06-25 00:00:00\nreading from original folder\nReading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210625.txt\nNew time series dataframe:      LAT         LON    FRP  ...  VPD_7_days_ago   P_7_days_ago  FRP_7_days_ago\n0  24.5 -126.000000 -999.0  ...          -999.0  101861.375000          -999.0\n1  24.5 -125.899994 -999.0  ...          -999.0  101861.375000          -999.0\n2  24.5 -125.800003 -999.0  ...          -999.0  101853.773438          -999.0\n3  24.5 -125.699997 -999.0  ...          -999.0  101853.773438          -999.0\n4  24.5 -125.599998 -999.0  ...          -999.0  101844.171875          -999.0\n[5 rows x 74 columns]\nOriginal df is created:  (156861, 74)\nOriginal df filled the na with -9999 \nX and y are loaded into memory for 20210702\nthe loaded model is:  TabNetRegressor(n_d=17, n_a=41, n_steps=4, gamma=1.1546672563068268, cat_idxs=[], cat_dims=[], cat_emb_dim=[], n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.00042602006758391, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=71, output_dim=1, device_name='auto', n_shared_decoder=1, n_indep_decoder=1, grouped_features=[])\nLoaded model is a TabNet model.\nPrediction for 20210702 of start day 20210702 is finished\nnew columns to check:  ['FRP_1_days_ago', 'Nearest_1', 'Nearest_2', 'Nearest_3', 'Nearest_4', 'Nearest_5', 'Nearest_6', 'Nearest_7', 'Nearest_8']\ncurrent merged_df columns:  Index(['FWI', 'VPD', 'HT', 'T', 'RH', 'U', 'V', 'P', 'RAIN', 'CAPE', 'ST',\n       'SM', 'Nearest_1', 'Nearest_2', 'Nearest_3', 'Nearest_4', 'Nearest_5',\n       'Nearest_6', 'Nearest_7', 'Nearest_8', 'Nearest_9', 'Nearest_10',\n       'Nearest_11', 'Nearest_12', 'Nearest_13', 'Nearest_14', 'Nearest_15',\n       'Nearest_16', 'Nearest_17', 'Nearest_18', 'Nearest_19', 'Nearest_20',\n       'Nearest_21', 'Nearest_22', 'Nearest_23', 'Nearest_24', 'Land_Use',\n       'VCI_AVE', 'TCI_AVE', 'VHI_AVE', 'VCI_TOT', 'TCI_TOT', 'VHI_TOT',\n       'FWI_1_days_ago', 'VPD_1_days_ago', 'P_1_days_ago', 'FRP_1_days_ago',\n       'FWI_2_days_ago', 'VPD_2_days_ago', 'P_2_days_ago', 'FRP_2_days_ago',\n       'FWI_3_days_ago', 'VPD_3_days_ago', 'P_3_days_ago', 'FRP_3_days_ago',\n       'FWI_4_days_ago', 'VPD_4_days_ago', 'P_4_days_ago', 'FRP_4_days_ago',\n       'FWI_5_days_ago', 'VPD_5_days_ago', 'P_5_days_ago', 'FRP_5_days_ago',\n       'FWI_6_days_ago', 'VPD_6_days_ago', 'P_6_days_ago', 'FRP_6_days_ago',\n       'FWI_7_days_ago', 'VPD_7_days_ago', 'P_7_days_ago', 'FRP_7_days_ago',\n       'Predicted_FRP'],\n      dtype='object')\nPrediction results are saved to /groups/ESS3/zsun/firecasting/data/output/output_tabnet_window_7_days_forecasting_with_new_yunyao_window_time_series_landuse_vhi_latlon//20210702/firedata_20210702_predicted.txt\n['Mean Absolute Error (MAE): 21.878354667289614', 'Mean Squared Error (MSE): 21840.907473561892', 'Root Mean Squared Error (RMSE): 147.78669586116976', 'R-squared (R2) Score: -0.02231897231295732', 'Explained Variance Score: 2.269364342000202e-07', 'Median Absolute Error (MedAE): 0.0', 'Max Error: 999.0', 'Mean: -21.836369149265913', 'Median: 0.0', 'Standard Deviation: 146.16504128154463', 'Minimum: -999.0', 'Maximum: 639.787903', 'Count: 156861']\nMetrics saved to /groups/ESS3/zsun/firecasting/data/output/output_tabnet_window_7_days_forecasting_with_new_yunyao_window_time_series_landuse_vhi_latlon//20210702/metrics_20210702_predicted.txt\npredicting:  20210703\nRead from original folder for current date: 20210703\nReading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210703.txt\nreading past files for 2021-07-02 00:00:00\nreading from predicted folder\ncurrent final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n0 -999.0 -999.0  0.0  ...  101861.375000          -999.0            0.0\n1 -999.0 -999.0  0.0  ...  101861.375000          -999.0            0.0\n2 -999.0 -999.0  0.0  ...  101853.773438          -999.0            0.0\n3 -999.0 -999.0  0.0  ...  101853.773438          -999.0            0.0\n4 -999.0 -999.0  0.0  ...  101844.171875          -999.0            0.0\n[5 rows x 72 columns]\nrenaming Predicted_FRP to FRP\nremove the current predicted_frp\nreading past files for 2021-07-01 00:00:00\nreading from original folder\nReading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210701.txt\nreading past files for 2021-06-30 00:00:00\nreading from original folder\nReading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210630.txt\nreading past files for 2021-06-29 00:00:00\nreading from original folder\nReading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210629.txt\nreading past files for 2021-06-28 00:00:00\nreading from original folder\nReading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210628.txt\nreading past files for 2021-06-27 00:00:00\nreading from original folder\nReading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210627.txt\nreading past files for 2021-06-26 00:00:00\nreading from original folder\nReading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210626.txt\nNew time series dataframe:      LAT         LON    FRP  ...  VPD_7_days_ago   P_7_days_ago  FRP_7_days_ago\n0  24.5 -126.000000 -999.0  ...          -999.0  101701.023438          -999.0\n1  24.5 -125.899994 -999.0  ...          -999.0  101701.023438          -999.0\n2  24.5 -125.800003 -999.0  ...          -999.0  101689.023438          -999.0\n3  24.5 -125.699997 -999.0  ...          -999.0  101689.023438          -999.0\n4  24.5 -125.599998 -999.0  ...          -999.0  101676.625000          -999.0\n[5 rows x 74 columns]\nOriginal df is created:  (156861, 74)\nOriginal df filled the na with -9999 \nX and y are loaded into memory for 20210703\nthe loaded model is:  TabNetRegressor(n_d=17, n_a=41, n_steps=4, gamma=1.1546672563068268, cat_idxs=[], cat_dims=[], cat_emb_dim=[], n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.00042602006758391, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=71, output_dim=1, device_name='auto', n_shared_decoder=1, n_indep_decoder=1, grouped_features=[])\nLoaded model is a TabNet model.\nPrediction for 20210703 of start day 20210702 is finished\nnew columns to check:  ['FRP_1_days_ago', 'Nearest_1', 'Nearest_2', 'Nearest_3', 'Nearest_4', 'Nearest_5', 'Nearest_6', 'Nearest_7', 'Nearest_8']\ncurrent merged_df columns:  Index(['FWI', 'VPD', 'HT', 'T', 'RH', 'U', 'V', 'P', 'RAIN', 'CAPE', 'ST',\n       'SM', 'Nearest_1', 'Nearest_2', 'Nearest_3', 'Nearest_4', 'Nearest_5',\n       'Nearest_6', 'Nearest_7', 'Nearest_8', 'Nearest_9', 'Nearest_10',\n       'Nearest_11', 'Nearest_12', 'Nearest_13', 'Nearest_14', 'Nearest_15',\n       'Nearest_16', 'Nearest_17', 'Nearest_18', 'Nearest_19', 'Nearest_20',\n       'Nearest_21', 'Nearest_22', 'Nearest_23', 'Nearest_24', 'Land_Use',\n       'VCI_AVE', 'TCI_AVE', 'VHI_AVE', 'VCI_TOT', 'TCI_TOT', 'VHI_TOT',\n       'FWI_1_days_ago', 'VPD_1_days_ago', 'P_1_days_ago', 'FRP_1_days_ago',\n       'FWI_2_days_ago', 'VPD_2_days_ago', 'P_2_days_ago', 'FRP_2_days_ago',\n       'FWI_3_days_ago', 'VPD_3_days_ago', 'P_3_days_ago', 'FRP_3_days_ago',\n       'FWI_4_days_ago', 'VPD_4_days_ago', 'P_4_days_ago', 'FRP_4_days_ago',\n       'FWI_5_days_ago', 'VPD_5_days_ago', 'P_5_days_ago', 'FRP_5_days_ago',\n       'FWI_6_days_ago', 'VPD_6_days_ago', 'P_6_days_ago', 'FRP_6_days_ago',\n       'FWI_7_days_ago', 'VPD_7_days_ago', 'P_7_days_ago', 'FRP_7_days_ago',\n       'Predicted_FRP'],\n      dtype='object')\nPrediction results are saved to /groups/ESS3/zsun/firecasting/data/output/output_tabnet_window_7_days_forecasting_with_new_yunyao_window_time_series_landuse_vhi_latlon//20210702/firedata_20210703_predicted.txt\n['Mean Absolute Error (MAE): 21.893988559134687', 'Mean Squared Error (MSE): 21850.512089859996', 'Root Mean Squared Error (RMSE): 147.8191871505861', 'R-squared (R2) Score: -0.022276143393517023', 'Explained Variance Score: 5.471206367957393e-07', 'Median Absolute Error (MedAE): 0.0', 'Max Error: 1241.735596', 'Mean: -21.820777627262355', 'Median: 0.0', 'Standard Deviation: 146.20023852683786', 'Minimum: -999.0', 'Maximum: 1241.735596', 'Count: 156861']\nMetrics saved to /groups/ESS3/zsun/firecasting/data/output/output_tabnet_window_7_days_forecasting_with_new_yunyao_window_time_series_landuse_vhi_latlon//20210702/metrics_20210703_predicted.txt\npredicting:  20210704\nRead from original folder for current date: 20210704\nReading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210704.txt\nreading past files for 2021-07-03 00:00:00\nreading from predicted folder\ncurrent final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n0 -999.0 -999.0  0.0  ...  101701.023438          -999.0            0.0\n1 -999.0 -999.0  0.0  ...  101701.023438          -999.0            0.0\n2 -999.0 -999.0  0.0  ...  101689.023438          -999.0            0.0\n3 -999.0 -999.0  0.0  ...  101689.023438          -999.0            0.0\n4 -999.0 -999.0  0.0  ...  101676.625000          -999.0            0.0\n[5 rows x 72 columns]\nrenaming Predicted_FRP to FRP\nremove the current predicted_frp\nreading past files for 2021-07-02 00:00:00\nreading from predicted folder\ncurrent final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n0 -999.0 -999.0  0.0  ...  101861.375000          -999.0            0.0\n1 -999.0 -999.0  0.0  ...  101861.375000          -999.0            0.0\n2 -999.0 -999.0  0.0  ...  101853.773438          -999.0            0.0\n3 -999.0 -999.0  0.0  ...  101853.773438          -999.0            0.0\n4 -999.0 -999.0  0.0  ...  101844.171875          -999.0            0.0\n[5 rows x 72 columns]\nrenaming Predicted_FRP to FRP\nremove the current predicted_frp\nreading past files for 2021-07-01 00:00:00\nreading from original folder\nReading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210701.txt\nreading past files for 2021-06-30 00:00:00\nreading from original folder\nReading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210630.txt\nreading past files for 2021-06-29 00:00:00\nreading from original folder\nReading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210629.txt\nreading past files for 2021-06-28 00:00:00\nreading from original folder\nReading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210628.txt\nreading past files for 2021-06-27 00:00:00\nreading from original folder\nReading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210627.txt\nNew time series dataframe:      LAT         LON    FRP  ...  VPD_7_days_ago   P_7_days_ago  FRP_7_days_ago\n0  24.5 -126.000000 -999.0  ...          -999.0  101521.437500          -999.0\n1  24.5 -125.899994 -999.0  ...          -999.0  101521.437500          -999.0\n2  24.5 -125.800003 -999.0  ...          -999.0  101507.437500          -999.0\n3  24.5 -125.699997 -999.0  ...          -999.0  101507.437500          -999.0\n4  24.5 -125.599998 -999.0  ...          -999.0  101494.640625          -999.0\n[5 rows x 74 columns]\nOriginal df is created:  (156861, 74)\nOriginal df filled the na with -9999 \nX and y are loaded into memory for 20210704\nthe loaded model is:  TabNetRegressor(n_d=17, n_a=41, n_steps=4, gamma=1.1546672563068268, cat_idxs=[], cat_dims=[], cat_emb_dim=[], n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.00042602006758391, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=71, output_dim=1, device_name='auto', n_shared_decoder=1, n_indep_decoder=1, grouped_features=[])\nLoaded model is a TabNet model.\nPrediction for 20210704 of start day 20210702 is finished\nnew columns to check:  ['FRP_1_days_ago', 'Nearest_1', 'Nearest_2', 'Nearest_3', 'Nearest_4', 'Nearest_5', 'Nearest_6', 'Nearest_7', 'Nearest_8']\ncurrent merged_df columns:  Index(['FWI', 'VPD', 'HT', 'T', 'RH', 'U', 'V', 'P', 'RAIN', 'CAPE', 'ST',\n       'SM', 'Nearest_1', 'Nearest_2', 'Nearest_3', 'Nearest_4', 'Nearest_5',\n       'Nearest_6', 'Nearest_7', 'Nearest_8', 'Nearest_9', 'Nearest_10',\n       'Nearest_11', 'Nearest_12', 'Nearest_13', 'Nearest_14', 'Nearest_15',\n       'Nearest_16', 'Nearest_17', 'Nearest_18', 'Nearest_19', 'Nearest_20',\n       'Nearest_21', 'Nearest_22', 'Nearest_23', 'Nearest_24', 'Land_Use',\n       'VCI_AVE', 'TCI_AVE', 'VHI_AVE', 'VCI_TOT', 'TCI_TOT', 'VHI_TOT',\n       'FWI_1_days_ago', 'VPD_1_days_ago', 'P_1_days_ago', 'FRP_1_days_ago',\n       'FWI_2_days_ago', 'VPD_2_days_ago', 'P_2_days_ago', 'FRP_2_days_ago',\n       'FWI_3_days_ago', 'VPD_3_days_ago', 'P_3_days_ago', 'FRP_3_days_ago',\n       'FWI_4_days_ago', 'VPD_4_days_ago', 'P_4_days_ago', 'FRP_4_days_ago',\n       'FWI_5_days_ago', 'VPD_5_days_ago', 'P_5_days_ago', 'FRP_5_days_ago',\n       'FWI_6_days_ago', 'VPD_6_days_ago', 'P_6_days_ago', 'FRP_6_days_ago',\n       'FWI_7_days_ago', 'VPD_7_days_ago', 'P_7_days_ago', 'FRP_7_days_ago',\n       'Predicted_FRP'],\n      dtype='object')\nPrediction results are saved to /groups/ESS3/zsun/firecasting/data/output/output_tabnet_window_7_days_forecasting_with_new_yunyao_window_time_series_landuse_vhi_latlon//20210702/firedata_20210704_predicted.txt\n['Mean Absolute Error (MAE): 21.896785569938064', 'Mean Squared Error (MSE): 21857.454357670424', 'Root Mean Squared Error (RMSE): 147.84266758169113', 'R-squared (R2) Score: -0.022263341794956704', 'Explained Variance Score: 3.8081718989335656e-07', 'Median Absolute Error (MedAE): 0.0', 'Max Error: 1181.0887269852824', 'Mean: -21.818007558577342', 'Median: 0.0', 'Standard Deviation: 146.2243773555253', 'Minimum: -999.0', 'Maximum: 1181.141357', 'Count: 156861']\nMetrics saved to /groups/ESS3/zsun/firecasting/data/output/output_tabnet_window_7_days_forecasting_with_new_yunyao_window_time_series_landuse_vhi_latlon//20210702/metrics_20210704_predicted.txt\npredicting:  20210705\nRead from original folder for current date: 20210705\nReading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210705.txt\nreading past files for 2021-07-04 00:00:00\nreading from predicted folder\ncurrent final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n0 -999.0 -999.0  0.0  ...  101521.437500          -999.0            0.0\n1 -999.0 -999.0  0.0  ...  101521.437500          -999.0            0.0\n2 -999.0 -999.0  0.0  ...  101507.437500          -999.0            0.0\n3 -999.0 -999.0  0.0  ...  101507.437500          -999.0            0.0\n4 -999.0 -999.0  0.0  ...  101494.640625          -999.0            0.0\n[5 rows x 72 columns]\nrenaming Predicted_FRP to FRP\nremove the current predicted_frp\nreading past files for 2021-07-03 00:00:00\nreading from predicted folder\ncurrent final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n0 -999.0 -999.0  0.0  ...  101701.023438          -999.0            0.0\n1 -999.0 -999.0  0.0  ...  101701.023438          -999.0            0.0\n2 -999.0 -999.0  0.0  ...  101689.023438          -999.0            0.0\n3 -999.0 -999.0  0.0  ...  101689.023438          -999.0            0.0\n4 -999.0 -999.0  0.0  ...  101676.625000          -999.0            0.0\n[5 rows x 72 columns]\nrenaming Predicted_FRP to FRP\nremove the current predicted_frp\nreading past files for 2021-07-02 00:00:00\nreading from predicted folder\ncurrent final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n0 -999.0 -999.0  0.0  ...  101861.375000          -999.0            0.0\n1 -999.0 -999.0  0.0  ...  101861.375000          -999.0            0.0\n2 -999.0 -999.0  0.0  ...  101853.773438          -999.0            0.0\n3 -999.0 -999.0  0.0  ...  101853.773438          -999.0            0.0\n4 -999.0 -999.0  0.0  ...  101844.171875          -999.0            0.0\n[5 rows x 72 columns]\nrenaming Predicted_FRP to FRP\nremove the current predicted_frp\nreading past files for 2021-07-01 00:00:00\nreading from original folder\nReading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210701.txt\nreading past files for 2021-06-30 00:00:00\nreading from original folder\nReading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210630.txt\nreading past files for 2021-06-29 00:00:00\nreading from original folder\nReading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210629.txt\nreading past files for 2021-06-28 00:00:00\nreading from original folder\nReading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210628.txt\nNew time series dataframe:      LAT         LON    FRP  ...  VPD_7_days_ago   P_7_days_ago  FRP_7_days_ago\n0  24.5 -126.000000 -999.0  ...          -999.0  101352.601562          -999.0\n1  24.5 -125.899994 -999.0  ...          -999.0  101352.601562          -999.0\n2  24.5 -125.800003 -999.0  ...          -999.0  101336.601562          -999.0\n3  24.5 -125.699997 -999.0  ...          -999.0  101336.601562          -999.0\n4  24.5 -125.599998 -999.0  ...          -999.0  101320.203125          -999.0\n[5 rows x 74 columns]\nOriginal df is created:  (156861, 74)\nOriginal df filled the na with -9999 \nX and y are loaded into memory for 20210705\nthe loaded model is:  TabNetRegressor(n_d=17, n_a=41, n_steps=4, gamma=1.1546672563068268, cat_idxs=[], cat_dims=[], cat_emb_dim=[], n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.00042602006758391, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=71, output_dim=1, device_name='auto', n_shared_decoder=1, n_indep_decoder=1, grouped_features=[])\nLoaded model is a TabNet model.\nPrediction for 20210705 of start day 20210702 is finished\nnew columns to check:  ['FRP_1_days_ago', 'Nearest_1', 'Nearest_2', 'Nearest_3', 'Nearest_4', 'Nearest_5', 'Nearest_6', 'Nearest_7', 'Nearest_8']\ncurrent merged_df columns:  Index(['FWI', 'VPD', 'HT', 'T', 'RH', 'U', 'V', 'P', 'RAIN', 'CAPE', 'ST',\n       'SM', 'Nearest_1', 'Nearest_2', 'Nearest_3', 'Nearest_4', 'Nearest_5',\n       'Nearest_6', 'Nearest_7', 'Nearest_8', 'Nearest_9', 'Nearest_10',\n       'Nearest_11', 'Nearest_12', 'Nearest_13', 'Nearest_14', 'Nearest_15',\n       'Nearest_16', 'Nearest_17', 'Nearest_18', 'Nearest_19', 'Nearest_20',\n       'Nearest_21', 'Nearest_22', 'Nearest_23', 'Nearest_24', 'Land_Use',\n       'VCI_AVE', 'TCI_AVE', 'VHI_AVE', 'VCI_TOT', 'TCI_TOT', 'VHI_TOT',\n       'FWI_1_days_ago', 'VPD_1_days_ago', 'P_1_days_ago', 'FRP_1_days_ago',\n       'FWI_2_days_ago', 'VPD_2_days_ago', 'P_2_days_ago', 'FRP_2_days_ago',\n       'FWI_3_days_ago', 'VPD_3_days_ago', 'P_3_days_ago', 'FRP_3_days_ago',\n       'FWI_4_days_ago', 'VPD_4_days_ago', 'P_4_days_ago', 'FRP_4_days_ago',\n       'FWI_5_days_ago', 'VPD_5_days_ago', 'P_5_days_ago', 'FRP_5_days_ago',\n       'FWI_6_days_ago', 'VPD_6_days_ago', 'P_6_days_ago', 'FRP_6_days_ago',\n       'FWI_7_days_ago', 'VPD_7_days_ago', 'P_7_days_ago', 'FRP_7_days_ago',\n       'Predicted_FRP'],\n      dtype='object')\nPrediction results are saved to /groups/ESS3/zsun/firecasting/data/output/output_tabnet_window_7_days_forecasting_with_new_yunyao_window_time_series_landuse_vhi_latlon//20210702/firedata_20210705_predicted.txt\n['Mean Absolute Error (MAE): 21.899747337168673', 'Mean Squared Error (MSE): 21849.950398958197', 'Root Mean Squared Error (RMSE): 147.81728721282298', 'R-squared (R2) Score: -0.022265188179332318', 'Explained Variance Score: 3.5433999800993377e-07', 'Median Absolute Error (MedAE): 0.0', 'Max Error: 1216.9396944375744', 'Mean: -21.81510091978249', 'Median: 0.0', 'Standard Deviation: 146.19914277086232', 'Minimum: -999.0', 'Maximum: 1216.946899', 'Count: 156861']\nMetrics saved to /groups/ESS3/zsun/firecasting/data/output/output_tabnet_window_7_days_forecasting_with_new_yunyao_window_time_series_landuse_vhi_latlon//20210702/metrics_20210705_predicted.txt\npredicting:  20210706\nRead from original folder for current date: 20210706\nReading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210706.txt\nreading past files for 2021-07-05 00:00:00\nreading from predicted folder\ncurrent final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n0 -999.0 -999.0  0.0  ...  101352.601562          -999.0            0.0\n1 -999.0 -999.0  0.0  ...  101352.601562          -999.0            0.0\n2 -999.0 -999.0  0.0  ...  101336.601562          -999.0            0.0\n3 -999.0 -999.0  0.0  ...  101336.601562          -999.0            0.0\n4 -999.0 -999.0  0.0  ...  101320.203125          -999.0            0.0\n[5 rows x 72 columns]\nrenaming Predicted_FRP to FRP\nremove the current predicted_frp\nreading past files for 2021-07-04 00:00:00\nreading from predicted folder\ncurrent final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n0 -999.0 -999.0  0.0  ...  101521.437500          -999.0            0.0\n1 -999.0 -999.0  0.0  ...  101521.437500          -999.0            0.0\n2 -999.0 -999.0  0.0  ...  101507.437500          -999.0            0.0\n3 -999.0 -999.0  0.0  ...  101507.437500          -999.0            0.0\n4 -999.0 -999.0  0.0  ...  101494.640625          -999.0            0.0\n[5 rows x 72 columns]\nrenaming Predicted_FRP to FRP\nremove the current predicted_frp\nreading past files for 2021-07-03 00:00:00\nreading from predicted folder\ncurrent final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n0 -999.0 -999.0  0.0  ...  101701.023438          -999.0            0.0\n1 -999.0 -999.0  0.0  ...  101701.023438          -999.0            0.0\n2 -999.0 -999.0  0.0  ...  101689.023438          -999.0            0.0\n3 -999.0 -999.0  0.0  ...  101689.023438          -999.0            0.0\n4 -999.0 -999.0  0.0  ...  101676.625000          -999.0            0.0\n[5 rows x 72 columns]\nrenaming Predicted_FRP to FRP\nremove the current predicted_frp\nreading past files for 2021-07-02 00:00:00\nreading from predicted folder\ncurrent final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n0 -999.0 -999.0  0.0  ...  101861.375000          -999.0            0.0\n1 -999.0 -999.0  0.0  ...  101861.375000          -999.0            0.0\n2 -999.0 -999.0  0.0  ...  101853.773438          -999.0            0.0\n3 -999.0 -999.0  0.0  ...  101853.773438          -999.0            0.0\n4 -999.0 -999.0  0.0  ...  101844.171875          -999.0            0.0\n[5 rows x 72 columns]\nrenaming Predicted_FRP to FRP\nremove the current predicted_frp\nreading past files for 2021-07-01 00:00:00\nreading from original folder\nReading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210701.txt\nreading past files for 2021-06-30 00:00:00\nreading from original folder\nReading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210630.txt\nreading past files for 2021-06-29 00:00:00\nreading from original folder\nReading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210629.txt\nNew time series dataframe:      LAT         LON    FRP  ...  VPD_7_days_ago   P_7_days_ago  FRP_7_days_ago\n0  24.5 -126.000000 -999.0  ...          -999.0  101329.468750          -999.0\n1  24.5 -125.899994 -999.0  ...          -999.0  101329.468750          -999.0\n2  24.5 -125.800003 -999.0  ...          -999.0  101317.062500          -999.0\n3  24.5 -125.699997 -999.0  ...          -999.0  101317.062500          -999.0\n4  24.5 -125.599998 -999.0  ...          -999.0  101301.859375          -999.0\n[5 rows x 74 columns]\nOriginal df is created:  (156861, 74)\nOriginal df filled the na with -9999 \nX and y are loaded into memory for 20210706\nthe loaded model is:  TabNetRegressor(n_d=17, n_a=41, n_steps=4, gamma=1.1546672563068268, cat_idxs=[], cat_dims=[], cat_emb_dim=[], n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.00042602006758391, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=71, output_dim=1, device_name='auto', n_shared_decoder=1, n_indep_decoder=1, grouped_features=[])\nLoaded model is a TabNet model.\nPrediction for 20210706 of start day 20210702 is finished\nnew columns to check:  ['FRP_1_days_ago', 'Nearest_1', 'Nearest_2', 'Nearest_3', 'Nearest_4', 'Nearest_5', 'Nearest_6', 'Nearest_7', 'Nearest_8']\ncurrent merged_df columns:  Index(['FWI', 'VPD', 'HT', 'T', 'RH', 'U', 'V', 'P', 'RAIN', 'CAPE', 'ST',\n       'SM', 'Nearest_1', 'Nearest_2', 'Nearest_3', 'Nearest_4', 'Nearest_5',\n       'Nearest_6', 'Nearest_7', 'Nearest_8', 'Nearest_9', 'Nearest_10',\n       'Nearest_11', 'Nearest_12', 'Nearest_13', 'Nearest_14', 'Nearest_15',\n       'Nearest_16', 'Nearest_17', 'Nearest_18', 'Nearest_19', 'Nearest_20',\n       'Nearest_21', 'Nearest_22', 'Nearest_23', 'Nearest_24', 'Land_Use',\n       'VCI_AVE', 'TCI_AVE', 'VHI_AVE', 'VCI_TOT', 'TCI_TOT', 'VHI_TOT',\n       'FWI_1_days_ago', 'VPD_1_days_ago', 'P_1_days_ago', 'FRP_1_days_ago',\n       'FWI_2_days_ago', 'VPD_2_days_ago', 'P_2_days_ago', 'FRP_2_days_ago',\n       'FWI_3_days_ago', 'VPD_3_days_ago', 'P_3_days_ago', 'FRP_3_days_ago',\n       'FWI_4_days_ago', 'VPD_4_days_ago', 'P_4_days_ago', 'FRP_4_days_ago',\n       'FWI_5_days_ago', 'VPD_5_days_ago', 'P_5_days_ago', 'FRP_5_days_ago',\n       'FWI_6_days_ago', 'VPD_6_days_ago', 'P_6_days_ago', 'FRP_6_days_ago',\n       'FWI_7_days_ago', 'VPD_7_days_ago', 'P_7_days_ago', 'FRP_7_days_ago',\n       'Predicted_FRP'],\n      dtype='object')\nPrediction results are saved to /groups/ESS3/zsun/firecasting/data/output/output_tabnet_window_7_days_forecasting_with_new_yunyao_window_time_series_landuse_vhi_latlon//20210702/firedata_20210706_predicted.txt\n['Mean Absolute Error (MAE): 21.968498413678347', 'Mean Squared Error (MSE): 22237.57255327088', 'Root Mean Squared Error (RMSE): 149.12267618732866', 'R-squared (R2) Score: -0.021725714507426996', 'Explained Variance Score: 2.7832653392012574e-06', 'Median Absolute Error (MedAE): 0.0', 'Max Error: 7547.461402141784', 'Mean: -21.746309589547433', 'Median: 0.0', 'Standard Deviation: 147.52917421844327', 'Minimum: -999.0', 'Maximum: 7547.473145', 'Count: 156861']\nMetrics saved to /groups/ESS3/zsun/firecasting/data/output/output_tabnet_window_7_days_forecasting_with_new_yunyao_window_time_series_landuse_vhi_latlon//20210702/metrics_20210706_predicted.txt\npredicting:  20210707\nRead from original folder for current date: 20210707\nReading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210707.txt\nreading past files for 2021-07-06 00:00:00\nreading from predicted folder\ncurrent final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n0 -999.0 -999.0  0.0  ...  101329.468750          -999.0            0.0\n1 -999.0 -999.0  0.0  ...  101329.468750          -999.0            0.0\n2 -999.0 -999.0  0.0  ...  101317.062500          -999.0            0.0\n3 -999.0 -999.0  0.0  ...  101317.062500          -999.0            0.0\n4 -999.0 -999.0  0.0  ...  101301.859375          -999.0            0.0\n[5 rows x 72 columns]\nrenaming Predicted_FRP to FRP\nremove the current predicted_frp\nreading past files for 2021-07-05 00:00:00\nreading from predicted folder\ncurrent final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n0 -999.0 -999.0  0.0  ...  101352.601562          -999.0            0.0\n1 -999.0 -999.0  0.0  ...  101352.601562          -999.0            0.0\n2 -999.0 -999.0  0.0  ...  101336.601562          -999.0            0.0\n3 -999.0 -999.0  0.0  ...  101336.601562          -999.0            0.0\n4 -999.0 -999.0  0.0  ...  101320.203125          -999.0            0.0\n[5 rows x 72 columns]\nrenaming Predicted_FRP to FRP\nremove the current predicted_frp\nreading past files for 2021-07-04 00:00:00\nreading from predicted folder\ncurrent final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n0 -999.0 -999.0  0.0  ...  101521.437500          -999.0            0.0\n1 -999.0 -999.0  0.0  ...  101521.437500          -999.0            0.0\n2 -999.0 -999.0  0.0  ...  101507.437500          -999.0            0.0\n3 -999.0 -999.0  0.0  ...  101507.437500          -999.0            0.0\n4 -999.0 -999.0  0.0  ...  101494.640625          -999.0            0.0\n[5 rows x 72 columns]\nrenaming Predicted_FRP to FRP\nremove the current predicted_frp\nreading past files for 2021-07-03 00:00:00\nreading from predicted folder\ncurrent final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n0 -999.0 -999.0  0.0  ...  101701.023438          -999.0            0.0\n1 -999.0 -999.0  0.0  ...  101701.023438          -999.0            0.0\n2 -999.0 -999.0  0.0  ...  101689.023438          -999.0            0.0\n3 -999.0 -999.0  0.0  ...  101689.023438          -999.0            0.0\n4 -999.0 -999.0  0.0  ...  101676.625000          -999.0            0.0\n[5 rows x 72 columns]\nrenaming Predicted_FRP to FRP\nremove the current predicted_frp\nreading past files for 2021-07-02 00:00:00\nreading from predicted folder\ncurrent final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n0 -999.0 -999.0  0.0  ...  101861.375000          -999.0            0.0\n1 -999.0 -999.0  0.0  ...  101861.375000          -999.0            0.0\n2 -999.0 -999.0  0.0  ...  101853.773438          -999.0            0.0\n3 -999.0 -999.0  0.0  ...  101853.773438          -999.0            0.0\n4 -999.0 -999.0  0.0  ...  101844.171875          -999.0            0.0\n[5 rows x 72 columns]\nrenaming Predicted_FRP to FRP\nremove the current predicted_frp\nreading past files for 2021-07-01 00:00:00\nreading from original folder\nReading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210701.txt\nreading past files for 2021-06-30 00:00:00\nreading from original folder\nReading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210630.txt\nNew time series dataframe:      LAT         LON    FRP  ...  VPD_7_days_ago   P_7_days_ago  FRP_7_days_ago\n0  24.5 -126.000000 -999.0  ...          -999.0  101381.734375          -999.0\n1  24.5 -125.899994 -999.0  ...          -999.0  101381.734375          -999.0\n2  24.5 -125.800003 -999.0  ...          -999.0  101376.140625          -999.0\n3  24.5 -125.699997 -999.0  ...          -999.0  101376.140625          -999.0\n4  24.5 -125.599998 -999.0  ...          -999.0  101371.742188          -999.0\n[5 rows x 74 columns]\nOriginal df is created:  (156861, 74)\nOriginal df filled the na with -9999 \nX and y are loaded into memory for 20210707\nthe loaded model is:  TabNetRegressor(n_d=17, n_a=41, n_steps=4, gamma=1.1546672563068268, cat_idxs=[], cat_dims=[], cat_emb_dim=[], n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.00042602006758391, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=71, output_dim=1, device_name='auto', n_shared_decoder=1, n_indep_decoder=1, grouped_features=[])\nLoaded model is a TabNet model.\nPrediction for 20210707 of start day 20210702 is finished\nnew columns to check:  ['FRP_1_days_ago', 'Nearest_1', 'Nearest_2', 'Nearest_3', 'Nearest_4', 'Nearest_5', 'Nearest_6', 'Nearest_7', 'Nearest_8']\ncurrent merged_df columns:  Index(['FWI', 'VPD', 'HT', 'T', 'RH', 'U', 'V', 'P', 'RAIN', 'CAPE', 'ST',\n       'SM', 'Nearest_1', 'Nearest_2', 'Nearest_3', 'Nearest_4', 'Nearest_5',\n       'Nearest_6', 'Nearest_7', 'Nearest_8', 'Nearest_9', 'Nearest_10',\n       'Nearest_11', 'Nearest_12', 'Nearest_13', 'Nearest_14', 'Nearest_15',\n       'Nearest_16', 'Nearest_17', 'Nearest_18', 'Nearest_19', 'Nearest_20',\n       'Nearest_21', 'Nearest_22', 'Nearest_23', 'Nearest_24', 'Land_Use',\n       'VCI_AVE', 'TCI_AVE', 'VHI_AVE', 'VCI_TOT', 'TCI_TOT', 'VHI_TOT',\n       'FWI_1_days_ago', 'VPD_1_days_ago', 'P_1_days_ago', 'FRP_1_days_ago',\n       'FWI_2_days_ago', 'VPD_2_days_ago', 'P_2_days_ago', 'FRP_2_days_ago',\n       'FWI_3_days_ago', 'VPD_3_days_ago', 'P_3_days_ago', 'FRP_3_days_ago',\n       'FWI_4_days_ago', 'VPD_4_days_ago', 'P_4_days_ago', 'FRP_4_days_ago',\n       'FWI_5_days_ago', 'VPD_5_days_ago', 'P_5_days_ago', 'FRP_5_days_ago',\n       'FWI_6_days_ago', 'VPD_6_days_ago', 'P_6_days_ago', 'FRP_6_days_ago',\n       'FWI_7_days_ago', 'VPD_7_days_ago', 'P_7_days_ago', 'FRP_7_days_ago',\n       'Predicted_FRP'],\n      dtype='object')\nPrediction results are saved to /groups/ESS3/zsun/firecasting/data/output/output_tabnet_window_7_days_forecasting_with_new_yunyao_window_time_series_landuse_vhi_latlon//20210702/firedata_20210707_predicted.txt\n['Mean Absolute Error (MAE): 22.085113353592085', 'Mean Squared Error (MSE): 23056.24558942548', 'Root Mean Squared Error (RMSE): 151.84283186711673', 'R-squared (R2) Score: -0.020717604314105964', 'Explained Variance Score: -1.4692334313615163e-06', 'Median Absolute Error (MedAE): 0.0', 'Max Error: 11733.88839543797', 'Mean: -21.630771051147192', 'Median: 0.0', 'Standard Deviation: 150.29442683250224', 'Minimum: -999.0', 'Maximum: 11733.90625', 'Count: 156861']\nMetrics saved to /groups/ESS3/zsun/firecasting/data/output/output_tabnet_window_7_days_forecasting_with_new_yunyao_window_time_series_landuse_vhi_latlon//20210702/metrics_20210707_predicted.txt\npredicting:  20210708\nRead from original folder for current date: 20210708\nReading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210708.txt\nreading past files for 2021-07-07 00:00:00\nreading from predicted folder\ncurrent final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n0 -999.0 -999.0  0.0  ...  101381.734375          -999.0            0.0\n1 -999.0 -999.0  0.0  ...  101381.734375          -999.0            0.0\n2 -999.0 -999.0  0.0  ...  101376.140625          -999.0            0.0\n3 -999.0 -999.0  0.0  ...  101376.140625          -999.0            0.0\n4 -999.0 -999.0  0.0  ...  101371.742188          -999.0            0.0\n[5 rows x 72 columns]\nrenaming Predicted_FRP to FRP\nremove the current predicted_frp\nreading past files for 2021-07-06 00:00:00\nreading from predicted folder\ncurrent final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n0 -999.0 -999.0  0.0  ...  101329.468750          -999.0            0.0\n1 -999.0 -999.0  0.0  ...  101329.468750          -999.0            0.0\n2 -999.0 -999.0  0.0  ...  101317.062500          -999.0            0.0\n3 -999.0 -999.0  0.0  ...  101317.062500          -999.0            0.0\n4 -999.0 -999.0  0.0  ...  101301.859375          -999.0            0.0\n[5 rows x 72 columns]\nrenaming Predicted_FRP to FRP\nremove the current predicted_frp\nreading past files for 2021-07-05 00:00:00\nreading from predicted folder\ncurrent final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n0 -999.0 -999.0  0.0  ...  101352.601562          -999.0            0.0\n1 -999.0 -999.0  0.0  ...  101352.601562          -999.0            0.0\n2 -999.0 -999.0  0.0  ...  101336.601562          -999.0            0.0\n3 -999.0 -999.0  0.0  ...  101336.601562          -999.0            0.0\n4 -999.0 -999.0  0.0  ...  101320.203125          -999.0            0.0\n[5 rows x 72 columns]\nrenaming Predicted_FRP to FRP\nremove the current predicted_frp\nreading past files for 2021-07-04 00:00:00\nreading from predicted folder\ncurrent final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n0 -999.0 -999.0  0.0  ...  101521.437500          -999.0            0.0\n1 -999.0 -999.0  0.0  ...  101521.437500          -999.0            0.0\n2 -999.0 -999.0  0.0  ...  101507.437500          -999.0            0.0\n3 -999.0 -999.0  0.0  ...  101507.437500          -999.0            0.0\n4 -999.0 -999.0  0.0  ...  101494.640625          -999.0            0.0\n[5 rows x 72 columns]\nrenaming Predicted_FRP to FRP\nremove the current predicted_frp\nreading past files for 2021-07-03 00:00:00\nreading from predicted folder\ncurrent final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n0 -999.0 -999.0  0.0  ...  101701.023438          -999.0            0.0\n1 -999.0 -999.0  0.0  ...  101701.023438          -999.0            0.0\n2 -999.0 -999.0  0.0  ...  101689.023438          -999.0            0.0\n3 -999.0 -999.0  0.0  ...  101689.023438          -999.0            0.0\n4 -999.0 -999.0  0.0  ...  101676.625000          -999.0            0.0\n[5 rows x 72 columns]\nrenaming Predicted_FRP to FRP\nremove the current predicted_frp\nreading past files for 2021-07-02 00:00:00\nreading from predicted folder\ncurrent final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n0 -999.0 -999.0  0.0  ...  101861.375000          -999.0            0.0\n1 -999.0 -999.0  0.0  ...  101861.375000          -999.0            0.0\n2 -999.0 -999.0  0.0  ...  101853.773438          -999.0            0.0\n3 -999.0 -999.0  0.0  ...  101853.773438          -999.0            0.0\n4 -999.0 -999.0  0.0  ...  101844.171875          -999.0            0.0\n[5 rows x 72 columns]\nrenaming Predicted_FRP to FRP\nremove the current predicted_frp\nreading past files for 2021-07-01 00:00:00\nreading from original folder\nReading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210701.txt\nNew time series dataframe:      LAT         LON    FRP  ...  VPD_7_days_ago   P_7_days_ago  FRP_7_days_ago\n0  24.5 -126.000000 -999.0  ...          -999.0  101530.867188          -999.0\n1  24.5 -125.899994 -999.0  ...          -999.0  101530.867188          -999.0\n2  24.5 -125.800003 -999.0  ...          -999.0  101528.468750          -999.0\n3  24.5 -125.699997 -999.0  ...          -999.0  101528.468750          -999.0\n4  24.5 -125.599998 -999.0  ...          -999.0  101526.070312          -999.0\n[5 rows x 74 columns]\nOriginal df is created:  (156861, 74)\nOriginal df filled the na with -9999 \nX and y are loaded into memory for 20210708\nthe loaded model is:  TabNetRegressor(n_d=17, n_a=41, n_steps=4, gamma=1.1546672563068268, cat_idxs=[], cat_dims=[], cat_emb_dim=[], n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.00042602006758391, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=71, output_dim=1, device_name='auto', n_shared_decoder=1, n_indep_decoder=1, grouped_features=[])\nLoaded model is a TabNet model.\nPrediction for 20210708 of start day 20210702 is finished\nnew columns to check:  ['FRP_1_days_ago', 'Nearest_1', 'Nearest_2', 'Nearest_3', 'Nearest_4', 'Nearest_5', 'Nearest_6', 'Nearest_7', 'Nearest_8']\ncurrent merged_df columns:  Index(['FWI', 'VPD', 'HT', 'T', 'RH', 'U', 'V', 'P', 'RAIN', 'CAPE', 'ST',\n       'SM', 'Nearest_1', 'Nearest_2', 'Nearest_3', 'Nearest_4', 'Nearest_5',\n       'Nearest_6', 'Nearest_7', 'Nearest_8', 'Nearest_9', 'Nearest_10',\n       'Nearest_11', 'Nearest_12', 'Nearest_13', 'Nearest_14', 'Nearest_15',\n       'Nearest_16', 'Nearest_17', 'Nearest_18', 'Nearest_19', 'Nearest_20',\n       'Nearest_21', 'Nearest_22', 'Nearest_23', 'Nearest_24', 'Land_Use',\n       'VCI_AVE', 'TCI_AVE', 'VHI_AVE', 'VCI_TOT', 'TCI_TOT', 'VHI_TOT',\n       'FWI_1_days_ago', 'VPD_1_days_ago', 'P_1_days_ago', 'FRP_1_days_ago',\n       'FWI_2_days_ago', 'VPD_2_days_ago', 'P_2_days_ago', 'FRP_2_days_ago',\n       'FWI_3_days_ago', 'VPD_3_days_ago', 'P_3_days_ago', 'FRP_3_days_ago',\n       'FWI_4_days_ago', 'VPD_4_days_ago', 'P_4_days_ago', 'FRP_4_days_ago',\n       'FWI_5_days_ago', 'VPD_5_days_ago', 'P_5_days_ago', 'FRP_5_days_ago',\n       'FWI_6_days_ago', 'VPD_6_days_ago', 'P_6_days_ago', 'FRP_6_days_ago',\n       'FWI_7_days_ago', 'VPD_7_days_ago', 'P_7_days_ago', 'FRP_7_days_ago',\n       'Predicted_FRP'],\n      dtype='object')\nPrediction results are saved to /groups/ESS3/zsun/firecasting/data/output/output_tabnet_window_7_days_forecasting_with_new_yunyao_window_time_series_landuse_vhi_latlon//20210702/firedata_20210708_predicted.txt\n['Mean Absolute Error (MAE): 22.020416623625227', 'Mean Squared Error (MSE): 22179.35521438712', 'Root Mean Squared Error (RMSE): 148.92734877915177', 'R-squared (R2) Score: -0.021675895021817215', 'Explained Variance Score: 4.955835205655568e-06', 'Median Absolute Error (MedAE): 0.0', 'Max Error: 5463.914419518793', 'Mean: -21.694544765945654', 'Median: 0.0', 'Standard Deviation: 147.33952624013253', 'Minimum: -999.0', 'Maximum: 5464.172363', 'Count: 156861']\nMetrics saved to /groups/ESS3/zsun/firecasting/data/output/output_tabnet_window_7_days_forecasting_with_new_yunyao_window_time_series_landuse_vhi_latlon//20210702/metrics_20210708_predicted.txt\ncurrent date:  2021-07-03 00:00:00\nsingle_day_current_date =  2021-07-03 00:00:00\nsingle_day_predict_end_date =  2021-07-10 00:00:00\npredicting:  20210703\nRead from original folder for current date: 20210703\nReading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210703.txt\nreading past files for 2021-07-02 00:00:00\nreading from original folder\nReading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210702.txt\nreading past files for 2021-07-01 00:00:00\nreading from original folder\nReading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210701.txt\nreading past files for 2021-06-30 00:00:00\nreading from original folder\nReading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210630.txt\nreading past files for 2021-06-29 00:00:00\nreading from original folder\nReading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210629.txt\nreading past files for 2021-06-28 00:00:00\nreading from original folder\nReading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210628.txt\nreading past files for 2021-06-27 00:00:00\nreading from original folder\nReading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210627.txt\nreading past files for 2021-06-26 00:00:00\nreading from original folder\nReading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210626.txt\nNew time series dataframe:      LAT         LON    FRP  ...  VPD_7_days_ago   P_7_days_ago  FRP_7_days_ago\n0  24.5 -126.000000 -999.0  ...          -999.0  101701.023438          -999.0\n1  24.5 -125.899994 -999.0  ...          -999.0  101701.023438          -999.0\n2  24.5 -125.800003 -999.0  ...          -999.0  101689.023438          -999.0\n3  24.5 -125.699997 -999.0  ...          -999.0  101689.023438          -999.0\n4  24.5 -125.599998 -999.0  ...          -999.0  101676.625000          -999.0\n[5 rows x 74 columns]\nOriginal df is created:  (156861, 74)\nOriginal df filled the na with -9999 \nX and y are loaded into memory for 20210703\nthe loaded model is:  TabNetRegressor(n_d=17, n_a=41, n_steps=4, gamma=1.1546672563068268, cat_idxs=[], cat_dims=[], cat_emb_dim=[], n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.00042602006758391, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=71, output_dim=1, device_name='auto', n_shared_decoder=1, n_indep_decoder=1, grouped_features=[])\nLoaded model is a TabNet model.\nPrediction for 20210703 of start day 20210703 is finished\nnew columns to check:  ['FRP_1_days_ago', 'Nearest_1', 'Nearest_2', 'Nearest_3', 'Nearest_4', 'Nearest_5', 'Nearest_6', 'Nearest_7', 'Nearest_8']\ncurrent merged_df columns:  Index(['FWI', 'VPD', 'HT', 'T', 'RH', 'U', 'V', 'P', 'RAIN', 'CAPE', 'ST',\n       'SM', 'Nearest_1', 'Nearest_2', 'Nearest_3', 'Nearest_4', 'Nearest_5',\n       'Nearest_6', 'Nearest_7', 'Nearest_8', 'Nearest_9', 'Nearest_10',\n       'Nearest_11', 'Nearest_12', 'Nearest_13', 'Nearest_14', 'Nearest_15',\n       'Nearest_16', 'Nearest_17', 'Nearest_18', 'Nearest_19', 'Nearest_20',\n       'Nearest_21', 'Nearest_22', 'Nearest_23', 'Nearest_24', 'Land_Use',\n       'VCI_AVE', 'TCI_AVE', 'VHI_AVE', 'VCI_TOT', 'TCI_TOT', 'VHI_TOT',\n       'FWI_1_days_ago', 'VPD_1_days_ago', 'P_1_days_ago', 'FRP_1_days_ago',\n       'FWI_2_days_ago', 'VPD_2_days_ago', 'P_2_days_ago', 'FRP_2_days_ago',\n       'FWI_3_days_ago', 'VPD_3_days_ago', 'P_3_days_ago', 'FRP_3_days_ago',\n       'FWI_4_days_ago', 'VPD_4_days_ago', 'P_4_days_ago', 'FRP_4_days_ago',\n       'FWI_5_days_ago', 'VPD_5_days_ago', 'P_5_days_ago', 'FRP_5_days_ago',\n       'FWI_6_days_ago', 'VPD_6_days_ago', 'P_6_days_ago', 'FRP_6_days_ago',\n       'FWI_7_days_ago', 'VPD_7_days_ago', 'P_7_days_ago', 'FRP_7_days_ago',\n       'Predicted_FRP'],\n      dtype='object')\nPrediction results are saved to /groups/ESS3/zsun/firecasting/data/output/output_tabnet_window_7_days_forecasting_with_new_yunyao_window_time_series_landuse_vhi_latlon//20210703/firedata_20210703_predicted.txt\n['Mean Absolute Error (MAE): 21.89396512070694', 'Mean Squared Error (MSE): 21850.510504113292', 'Root Mean Squared Error (RMSE): 147.8191817867806', 'R-squared (R2) Score: -0.022276069204362203', 'Explained Variance Score: 5.938897884583128e-07', 'Median Absolute Error (MedAE): 0.0', 'Max Error: 1241.735596', 'Mean: -21.820777627262355', 'Median: 0.0', 'Standard Deviation: 146.20023852683786', 'Minimum: -999.0', 'Maximum: 1241.735596', 'Count: 156861']\nMetrics saved to /groups/ESS3/zsun/firecasting/data/output/output_tabnet_window_7_days_forecasting_with_new_yunyao_window_time_series_landuse_vhi_latlon//20210703/metrics_20210703_predicted.txt\npredicting:  20210704\nRead from original folder for current date: 20210704\nReading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210704.txt\nreading past files for 2021-07-03 00:00:00\nreading from predicted folder\ncurrent final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n0 -999.0 -999.0  0.0  ...  101701.023438          -999.0            0.0\n1 -999.0 -999.0  0.0  ...  101701.023438          -999.0            0.0\n2 -999.0 -999.0  0.0  ...  101689.023438          -999.0            0.0\n3 -999.0 -999.0  0.0  ...  101689.023438          -999.0            0.0\n4 -999.0 -999.0  0.0  ...  101676.625000          -999.0            0.0\n[5 rows x 72 columns]\nrenaming Predicted_FRP to FRP\nremove the current predicted_frp\nreading past files for 2021-07-02 00:00:00\nreading from original folder\nReading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210702.txt\nreading past files for 2021-07-01 00:00:00\nreading from original folder\nReading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210701.txt\nreading past files for 2021-06-30 00:00:00\nreading from original folder\nReading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210630.txt\nreading past files for 2021-06-29 00:00:00\nreading from original folder\nReading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210629.txt\nreading past files for 2021-06-28 00:00:00\nreading from original folder\nReading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210628.txt\nreading past files for 2021-06-27 00:00:00\nreading from original folder\nReading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210627.txt\nNew time series dataframe:      LAT         LON    FRP  ...  VPD_7_days_ago   P_7_days_ago  FRP_7_days_ago\n0  24.5 -126.000000 -999.0  ...          -999.0  101521.437500          -999.0\n1  24.5 -125.899994 -999.0  ...          -999.0  101521.437500          -999.0\n2  24.5 -125.800003 -999.0  ...          -999.0  101507.437500          -999.0\n3  24.5 -125.699997 -999.0  ...          -999.0  101507.437500          -999.0\n4  24.5 -125.599998 -999.0  ...          -999.0  101494.640625          -999.0\n[5 rows x 74 columns]\nOriginal df is created:  (156861, 74)\nOriginal df filled the na with -9999 \nX and y are loaded into memory for 20210704\nthe loaded model is:  TabNetRegressor(n_d=17, n_a=41, n_steps=4, gamma=1.1546672563068268, cat_idxs=[], cat_dims=[], cat_emb_dim=[], n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.00042602006758391, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=71, output_dim=1, device_name='auto', n_shared_decoder=1, n_indep_decoder=1, grouped_features=[])\nLoaded model is a TabNet model.\nPrediction for 20210704 of start day 20210703 is finished\nnew columns to check:  ['FRP_1_days_ago', 'Nearest_1', 'Nearest_2', 'Nearest_3', 'Nearest_4', 'Nearest_5', 'Nearest_6', 'Nearest_7', 'Nearest_8']\ncurrent merged_df columns:  Index(['FWI', 'VPD', 'HT', 'T', 'RH', 'U', 'V', 'P', 'RAIN', 'CAPE', 'ST',\n       'SM', 'Nearest_1', 'Nearest_2', 'Nearest_3', 'Nearest_4', 'Nearest_5',\n       'Nearest_6', 'Nearest_7', 'Nearest_8', 'Nearest_9', 'Nearest_10',\n       'Nearest_11', 'Nearest_12', 'Nearest_13', 'Nearest_14', 'Nearest_15',\n       'Nearest_16', 'Nearest_17', 'Nearest_18', 'Nearest_19', 'Nearest_20',\n       'Nearest_21', 'Nearest_22', 'Nearest_23', 'Nearest_24', 'Land_Use',\n       'VCI_AVE', 'TCI_AVE', 'VHI_AVE', 'VCI_TOT', 'TCI_TOT', 'VHI_TOT',\n       'FWI_1_days_ago', 'VPD_1_days_ago', 'P_1_days_ago', 'FRP_1_days_ago',\n       'FWI_2_days_ago', 'VPD_2_days_ago', 'P_2_days_ago', 'FRP_2_days_ago',\n       'FWI_3_days_ago', 'VPD_3_days_ago', 'P_3_days_ago', 'FRP_3_days_ago',\n       'FWI_4_days_ago', 'VPD_4_days_ago', 'P_4_days_ago', 'FRP_4_days_ago',\n       'FWI_5_days_ago', 'VPD_5_days_ago', 'P_5_days_ago', 'FRP_5_days_ago',\n       'FWI_6_days_ago', 'VPD_6_days_ago', 'P_6_days_ago', 'FRP_6_days_ago',\n       'FWI_7_days_ago', 'VPD_7_days_ago', 'P_7_days_ago', 'FRP_7_days_ago',\n       'Predicted_FRP'],\n      dtype='object')\nPrediction results are saved to /groups/ESS3/zsun/firecasting/data/output/output_tabnet_window_7_days_forecasting_with_new_yunyao_window_time_series_landuse_vhi_latlon//20210703/firedata_20210704_predicted.txt\n['Mean Absolute Error (MAE): 21.8967634387741', 'Mean Squared Error (MSE): 21857.44508706759', 'Root Mean Squared Error (RMSE): 147.8426362287537', 'R-squared (R2) Score: -0.02226290821301813', 'Explained Variance Score: 7.901796119647031e-07', 'Median Absolute Error (MedAE): 0.0', 'Max Error: 1180.5074685169525', 'Mean: -21.818007558577342', 'Median: 0.0', 'Standard Deviation: 146.2243773555253', 'Minimum: -999.0', 'Maximum: 1181.141357', 'Count: 156861']\nMetrics saved to /groups/ESS3/zsun/firecasting/data/output/output_tabnet_window_7_days_forecasting_with_new_yunyao_window_time_series_landuse_vhi_latlon//20210703/metrics_20210704_predicted.txt\npredicting:  20210705\nRead from original folder for current date: 20210705\nReading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210705.txt\nreading past files for 2021-07-04 00:00:00\nreading from predicted folder\ncurrent final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n0 -999.0 -999.0  0.0  ...  101521.437500          -999.0            0.0\n1 -999.0 -999.0  0.0  ...  101521.437500          -999.0            0.0\n2 -999.0 -999.0  0.0  ...  101507.437500          -999.0            0.0\n3 -999.0 -999.0  0.0  ...  101507.437500          -999.0            0.0\n4 -999.0 -999.0  0.0  ...  101494.640625          -999.0            0.0\n[5 rows x 72 columns]\nrenaming Predicted_FRP to FRP\nremove the current predicted_frp\nreading past files for 2021-07-03 00:00:00\nreading from predicted folder\ncurrent final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n0 -999.0 -999.0  0.0  ...  101701.023438          -999.0            0.0\n1 -999.0 -999.0  0.0  ...  101701.023438          -999.0            0.0\n2 -999.0 -999.0  0.0  ...  101689.023438          -999.0            0.0\n3 -999.0 -999.0  0.0  ...  101689.023438          -999.0            0.0\n4 -999.0 -999.0  0.0  ...  101676.625000          -999.0            0.0\n[5 rows x 72 columns]\nrenaming Predicted_FRP to FRP\nremove the current predicted_frp\nreading past files for 2021-07-02 00:00:00\nreading from original folder\nReading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210702.txt\nreading past files for 2021-07-01 00:00:00\nreading from original folder\nReading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210701.txt\nreading past files for 2021-06-30 00:00:00\nreading from original folder\nReading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210630.txt\nreading past files for 2021-06-29 00:00:00\nreading from original folder\nReading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210629.txt\nreading past files for 2021-06-28 00:00:00\nreading from original folder\nReading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210628.txt\nNew time series dataframe:      LAT         LON    FRP  ...  VPD_7_days_ago   P_7_days_ago  FRP_7_days_ago\n0  24.5 -126.000000 -999.0  ...          -999.0  101352.601562          -999.0\n1  24.5 -125.899994 -999.0  ...          -999.0  101352.601562          -999.0\n2  24.5 -125.800003 -999.0  ...          -999.0  101336.601562          -999.0\n3  24.5 -125.699997 -999.0  ...          -999.0  101336.601562          -999.0\n4  24.5 -125.599998 -999.0  ...          -999.0  101320.203125          -999.0\n[5 rows x 74 columns]\nOriginal df is created:  (156861, 74)\nOriginal df filled the na with -9999 \nX and y are loaded into memory for 20210705\nthe loaded model is:  TabNetRegressor(n_d=17, n_a=41, n_steps=4, gamma=1.1546672563068268, cat_idxs=[], cat_dims=[], cat_emb_dim=[], n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.00042602006758391, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=71, output_dim=1, device_name='auto', n_shared_decoder=1, n_indep_decoder=1, grouped_features=[])\nLoaded model is a TabNet model.\nPrediction for 20210705 of start day 20210703 is finished\nnew columns to check:  ['FRP_1_days_ago', 'Nearest_1', 'Nearest_2', 'Nearest_3', 'Nearest_4', 'Nearest_5', 'Nearest_6', 'Nearest_7', 'Nearest_8']\ncurrent merged_df columns:  Index(['FWI', 'VPD', 'HT', 'T', 'RH', 'U', 'V', 'P', 'RAIN', 'CAPE', 'ST',\n       'SM', 'Nearest_1', 'Nearest_2', 'Nearest_3', 'Nearest_4', 'Nearest_5',\n       'Nearest_6', 'Nearest_7', 'Nearest_8', 'Nearest_9', 'Nearest_10',\n       'Nearest_11', 'Nearest_12', 'Nearest_13', 'Nearest_14', 'Nearest_15',\n       'Nearest_16', 'Nearest_17', 'Nearest_18', 'Nearest_19', 'Nearest_20',\n       'Nearest_21', 'Nearest_22', 'Nearest_23', 'Nearest_24', 'Land_Use',\n       'VCI_AVE', 'TCI_AVE', 'VHI_AVE', 'VCI_TOT', 'TCI_TOT', 'VHI_TOT',\n       'FWI_1_days_ago', 'VPD_1_days_ago', 'P_1_days_ago', 'FRP_1_days_ago',\n       'FWI_2_days_ago', 'VPD_2_days_ago', 'P_2_days_ago', 'FRP_2_days_ago',\n       'FWI_3_days_ago', 'VPD_3_days_ago', 'P_3_days_ago', 'FRP_3_days_ago',\n       'FWI_4_days_ago', 'VPD_4_days_ago', 'P_4_days_ago', 'FRP_4_days_ago',\n       'FWI_5_days_ago', 'VPD_5_days_ago', 'P_5_days_ago', 'FRP_5_days_ago',\n       'FWI_6_days_ago', 'VPD_6_days_ago', 'P_6_days_ago', 'FRP_6_days_ago',\n       'FWI_7_days_ago', 'VPD_7_days_ago', 'P_7_days_ago', 'FRP_7_days_ago',\n       'Predicted_FRP'],\n      dtype='object')\nPrediction results are saved to /groups/ESS3/zsun/firecasting/data/output/output_tabnet_window_7_days_forecasting_with_new_yunyao_window_time_series_landuse_vhi_latlon//20210703/firedata_20210705_predicted.txt\n['Mean Absolute Error (MAE): 21.89973134715256', 'Mean Squared Error (MSE): 21849.950401207054', 'Root Mean Squared Error (RMSE): 147.81728722042985', 'R-squared (R2) Score: -0.0222651882845466', 'Explained Variance Score: 3.2136119931802654e-07', 'Median Absolute Error (MedAE): 0.0', 'Max Error: 1216.9396944375744', 'Mean: -21.81510091978249', 'Median: 0.0', 'Standard Deviation: 146.19914277086232', 'Minimum: -999.0', 'Maximum: 1216.946899', 'Count: 156861']\nMetrics saved to /groups/ESS3/zsun/firecasting/data/output/output_tabnet_window_7_days_forecasting_with_new_yunyao_window_time_series_landuse_vhi_latlon//20210703/metrics_20210705_predicted.txt\npredicting:  20210706\nRead from original folder for current date: 20210706\nReading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210706.txt\nreading past files for 2021-07-05 00:00:00\nreading from predicted folder\ncurrent final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n0 -999.0 -999.0  0.0  ...  101352.601562          -999.0            0.0\n1 -999.0 -999.0  0.0  ...  101352.601562          -999.0            0.0\n2 -999.0 -999.0  0.0  ...  101336.601562          -999.0            0.0\n3 -999.0 -999.0  0.0  ...  101336.601562          -999.0            0.0\n4 -999.0 -999.0  0.0  ...  101320.203125          -999.0            0.0\n[5 rows x 72 columns]\nrenaming Predicted_FRP to FRP\nremove the current predicted_frp\nreading past files for 2021-07-04 00:00:00\nreading from predicted folder\ncurrent final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n0 -999.0 -999.0  0.0  ...  101521.437500          -999.0            0.0\n1 -999.0 -999.0  0.0  ...  101521.437500          -999.0            0.0\n2 -999.0 -999.0  0.0  ...  101507.437500          -999.0            0.0\n3 -999.0 -999.0  0.0  ...  101507.437500          -999.0            0.0\n4 -999.0 -999.0  0.0  ...  101494.640625          -999.0            0.0\n[5 rows x 72 columns]\nrenaming Predicted_FRP to FRP\nremove the current predicted_frp\nreading past files for 2021-07-03 00:00:00\nreading from predicted folder\ncurrent final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n0 -999.0 -999.0  0.0  ...  101701.023438          -999.0            0.0\n1 -999.0 -999.0  0.0  ...  101701.023438          -999.0            0.0\n2 -999.0 -999.0  0.0  ...  101689.023438          -999.0            0.0\n3 -999.0 -999.0  0.0  ...  101689.023438          -999.0            0.0\n4 -999.0 -999.0  0.0  ...  101676.625000          -999.0            0.0\n[5 rows x 72 columns]\nrenaming Predicted_FRP to FRP\nremove the current predicted_frp\nreading past files for 2021-07-02 00:00:00\nreading from original folder\nReading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210702.txt\nreading past files for 2021-07-01 00:00:00\nreading from original folder\nReading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210701.txt\nreading past files for 2021-06-30 00:00:00\nreading from original folder\nReading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210630.txt\nreading past files for 2021-06-29 00:00:00\nreading from original folder\nReading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210629.txt\nNew time series dataframe:      LAT         LON    FRP  ...  VPD_7_days_ago   P_7_days_ago  FRP_7_days_ago\n0  24.5 -126.000000 -999.0  ...          -999.0  101329.468750          -999.0\n1  24.5 -125.899994 -999.0  ...          -999.0  101329.468750          -999.0\n2  24.5 -125.800003 -999.0  ...          -999.0  101317.062500          -999.0\n3  24.5 -125.699997 -999.0  ...          -999.0  101317.062500          -999.0\n4  24.5 -125.599998 -999.0  ...          -999.0  101301.859375          -999.0\n[5 rows x 74 columns]\nOriginal df is created:  (156861, 74)\nOriginal df filled the na with -9999 \nX and y are loaded into memory for 20210706\nthe loaded model is:  TabNetRegressor(n_d=17, n_a=41, n_steps=4, gamma=1.1546672563068268, cat_idxs=[], cat_dims=[], cat_emb_dim=[], n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.00042602006758391, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=71, output_dim=1, device_name='auto', n_shared_decoder=1, n_indep_decoder=1, grouped_features=[])\nLoaded model is a TabNet model.\nPrediction for 20210706 of start day 20210703 is finished\nnew columns to check:  ['FRP_1_days_ago', 'Nearest_1', 'Nearest_2', 'Nearest_3', 'Nearest_4', 'Nearest_5', 'Nearest_6', 'Nearest_7', 'Nearest_8']\ncurrent merged_df columns:  Index(['FWI', 'VPD', 'HT', 'T', 'RH', 'U', 'V', 'P', 'RAIN', 'CAPE', 'ST',\n       'SM', 'Nearest_1', 'Nearest_2', 'Nearest_3', 'Nearest_4', 'Nearest_5',\n       'Nearest_6', 'Nearest_7', 'Nearest_8', 'Nearest_9', 'Nearest_10',\n       'Nearest_11', 'Nearest_12', 'Nearest_13', 'Nearest_14', 'Nearest_15',\n       'Nearest_16', 'Nearest_17', 'Nearest_18', 'Nearest_19', 'Nearest_20',\n       'Nearest_21', 'Nearest_22', 'Nearest_23', 'Nearest_24', 'Land_Use',\n       'VCI_AVE', 'TCI_AVE', 'VHI_AVE', 'VCI_TOT', 'TCI_TOT', 'VHI_TOT',\n       'FWI_1_days_ago', 'VPD_1_days_ago', 'P_1_days_ago', 'FRP_1_days_ago',\n       'FWI_2_days_ago', 'VPD_2_days_ago', 'P_2_days_ago', 'FRP_2_days_ago',\n       'FWI_3_days_ago', 'VPD_3_days_ago', 'P_3_days_ago', 'FRP_3_days_ago',\n       'FWI_4_days_ago', 'VPD_4_days_ago', 'P_4_days_ago', 'FRP_4_days_ago',\n       'FWI_5_days_ago', 'VPD_5_days_ago', 'P_5_days_ago', 'FRP_5_days_ago',\n       'FWI_6_days_ago', 'VPD_6_days_ago', 'P_6_days_ago', 'FRP_6_days_ago',\n       'FWI_7_days_ago', 'VPD_7_days_ago', 'P_7_days_ago', 'FRP_7_days_ago',\n       'Predicted_FRP'],\n      dtype='object')\nPrediction results are saved to /groups/ESS3/zsun/firecasting/data/output/output_tabnet_window_7_days_forecasting_with_new_yunyao_window_time_series_landuse_vhi_latlon//20210703/firedata_20210706_predicted.txt\n['Mean Absolute Error (MAE): 21.968484403817687', 'Mean Squared Error (MSE): 22237.57193841142', 'Root Mean Squared Error (RMSE): 149.12267412573925', 'R-squared (R2) Score: -0.021725686257143995', 'Explained Variance Score: 2.789044998063872e-06', 'Median Absolute Error (MedAE): 0.0', 'Max Error: 7547.461402141784', 'Mean: -21.746309589547433', 'Median: 0.0', 'Standard Deviation: 147.52917421844327', 'Minimum: -999.0', 'Maximum: 7547.473145', 'Count: 156861']\nMetrics saved to /groups/ESS3/zsun/firecasting/data/output/output_tabnet_window_7_days_forecasting_with_new_yunyao_window_time_series_landuse_vhi_latlon//20210703/metrics_20210706_predicted.txt\npredicting:  20210707\nRead from original folder for current date: 20210707\nReading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210707.txt\nreading past files for 2021-07-06 00:00:00\nreading from predicted folder\ncurrent final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n0 -999.0 -999.0  0.0  ...  101329.468750          -999.0            0.0\n1 -999.0 -999.0  0.0  ...  101329.468750          -999.0            0.0\n2 -999.0 -999.0  0.0  ...  101317.062500          -999.0            0.0\n3 -999.0 -999.0  0.0  ...  101317.062500          -999.0            0.0\n4 -999.0 -999.0  0.0  ...  101301.859375          -999.0            0.0\n[5 rows x 72 columns]\nrenaming Predicted_FRP to FRP\nremove the current predicted_frp\nreading past files for 2021-07-05 00:00:00\nreading from predicted folder\ncurrent final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n0 -999.0 -999.0  0.0  ...  101352.601562          -999.0            0.0\n1 -999.0 -999.0  0.0  ...  101352.601562          -999.0            0.0\n2 -999.0 -999.0  0.0  ...  101336.601562          -999.0            0.0\n3 -999.0 -999.0  0.0  ...  101336.601562          -999.0            0.0\n4 -999.0 -999.0  0.0  ...  101320.203125          -999.0            0.0\n[5 rows x 72 columns]\nrenaming Predicted_FRP to FRP\nremove the current predicted_frp\nreading past files for 2021-07-04 00:00:00\nreading from predicted folder\ncurrent final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n0 -999.0 -999.0  0.0  ...  101521.437500          -999.0            0.0\n1 -999.0 -999.0  0.0  ...  101521.437500          -999.0            0.0\n2 -999.0 -999.0  0.0  ...  101507.437500          -999.0            0.0\n3 -999.0 -999.0  0.0  ...  101507.437500          -999.0            0.0\n4 -999.0 -999.0  0.0  ...  101494.640625          -999.0            0.0\n[5 rows x 72 columns]\nrenaming Predicted_FRP to FRP\nremove the current predicted_frp\nreading past files for 2021-07-03 00:00:00\nreading from predicted folder\ncurrent final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n0 -999.0 -999.0  0.0  ...  101701.023438          -999.0            0.0\n1 -999.0 -999.0  0.0  ...  101701.023438          -999.0            0.0\n2 -999.0 -999.0  0.0  ...  101689.023438          -999.0            0.0\n3 -999.0 -999.0  0.0  ...  101689.023438          -999.0            0.0\n4 -999.0 -999.0  0.0  ...  101676.625000          -999.0            0.0\n[5 rows x 72 columns]\nrenaming Predicted_FRP to FRP\nremove the current predicted_frp\nreading past files for 2021-07-02 00:00:00\nreading from original folder\nReading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210702.txt\nreading past files for 2021-07-01 00:00:00\nreading from original folder\nReading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210701.txt\nreading past files for 2021-06-30 00:00:00\nreading from original folder\nReading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210630.txt\nNew time series dataframe:      LAT         LON    FRP  ...  VPD_7_days_ago   P_7_days_ago  FRP_7_days_ago\n0  24.5 -126.000000 -999.0  ...          -999.0  101381.734375          -999.0\n1  24.5 -125.899994 -999.0  ...          -999.0  101381.734375          -999.0\n2  24.5 -125.800003 -999.0  ...          -999.0  101376.140625          -999.0\n3  24.5 -125.699997 -999.0  ...          -999.0  101376.140625          -999.0\n4  24.5 -125.599998 -999.0  ...          -999.0  101371.742188          -999.0\n[5 rows x 74 columns]\nOriginal df is created:  (156861, 74)\nOriginal df filled the na with -9999 \nX and y are loaded into memory for 20210707\nthe loaded model is:  TabNetRegressor(n_d=17, n_a=41, n_steps=4, gamma=1.1546672563068268, cat_idxs=[], cat_dims=[], cat_emb_dim=[], n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.00042602006758391, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=71, output_dim=1, device_name='auto', n_shared_decoder=1, n_indep_decoder=1, grouped_features=[])\nLoaded model is a TabNet model.\nPrediction for 20210707 of start day 20210703 is finished\nnew columns to check:  ['FRP_1_days_ago', 'Nearest_1', 'Nearest_2', 'Nearest_3', 'Nearest_4', 'Nearest_5', 'Nearest_6', 'Nearest_7', 'Nearest_8']\ncurrent merged_df columns:  Index(['FWI', 'VPD', 'HT', 'T', 'RH', 'U', 'V', 'P', 'RAIN', 'CAPE', 'ST',\n       'SM', 'Nearest_1', 'Nearest_2', 'Nearest_3', 'Nearest_4', 'Nearest_5',\n       'Nearest_6', 'Nearest_7', 'Nearest_8', 'Nearest_9', 'Nearest_10',\n       'Nearest_11', 'Nearest_12', 'Nearest_13', 'Nearest_14', 'Nearest_15',\n       'Nearest_16', 'Nearest_17', 'Nearest_18', 'Nearest_19', 'Nearest_20',\n       'Nearest_21', 'Nearest_22', 'Nearest_23', 'Nearest_24', 'Land_Use',\n       'VCI_AVE', 'TCI_AVE', 'VHI_AVE', 'VCI_TOT', 'TCI_TOT', 'VHI_TOT',\n       'FWI_1_days_ago', 'VPD_1_days_ago', 'P_1_days_ago', 'FRP_1_days_ago',\n       'FWI_2_days_ago', 'VPD_2_days_ago', 'P_2_days_ago', 'FRP_2_days_ago',\n       'FWI_3_days_ago', 'VPD_3_days_ago', 'P_3_days_ago', 'FRP_3_days_ago',\n       'FWI_4_days_ago', 'VPD_4_days_ago', 'P_4_days_ago', 'FRP_4_days_ago',\n       'FWI_5_days_ago', 'VPD_5_days_ago', 'P_5_days_ago', 'FRP_5_days_ago',\n       'FWI_6_days_ago', 'VPD_6_days_ago', 'P_6_days_ago', 'FRP_6_days_ago',\n       'FWI_7_days_ago', 'VPD_7_days_ago', 'P_7_days_ago', 'FRP_7_days_ago',\n       'Predicted_FRP'],\n      dtype='object')\nPrediction results are saved to /groups/ESS3/zsun/firecasting/data/output/output_tabnet_window_7_days_forecasting_with_new_yunyao_window_time_series_landuse_vhi_latlon//20210703/firedata_20210707_predicted.txt\n['Mean Absolute Error (MAE): 22.085100226816856', 'Mean Squared Error (MSE): 23056.245399844316', 'Root Mean Squared Error (RMSE): 151.84283124284897', 'R-squared (R2) Score: -0.020717595921202925', 'Explained Variance Score: -1.4859548786994026e-06', 'Median Absolute Error (MedAE): 0.0', 'Max Error: 11733.887126589194', 'Mean: -21.630771051147192', 'Median: 0.0', 'Standard Deviation: 150.29442683250224', 'Minimum: -999.0', 'Maximum: 11733.90625', 'Count: 156861']\nMetrics saved to /groups/ESS3/zsun/firecasting/data/output/output_tabnet_window_7_days_forecasting_with_new_yunyao_window_time_series_landuse_vhi_latlon//20210703/metrics_20210707_predicted.txt\npredicting:  20210708\nRead from original folder for current date: 20210708\nReading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210708.txt\nreading past files for 2021-07-07 00:00:00\nreading from predicted folder\ncurrent final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n0 -999.0 -999.0  0.0  ...  101381.734375          -999.0            0.0\n1 -999.0 -999.0  0.0  ...  101381.734375          -999.0            0.0\n2 -999.0 -999.0  0.0  ...  101376.140625          -999.0            0.0\n3 -999.0 -999.0  0.0  ...  101376.140625          -999.0            0.0\n4 -999.0 -999.0  0.0  ...  101371.742188          -999.0            0.0\n[5 rows x 72 columns]\nrenaming Predicted_FRP to FRP\nremove the current predicted_frp\nreading past files for 2021-07-06 00:00:00\nreading from predicted folder\ncurrent final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n0 -999.0 -999.0  0.0  ...  101329.468750          -999.0            0.0\n1 -999.0 -999.0  0.0  ...  101329.468750          -999.0            0.0\n2 -999.0 -999.0  0.0  ...  101317.062500          -999.0            0.0\n3 -999.0 -999.0  0.0  ...  101317.062500          -999.0            0.0\n4 -999.0 -999.0  0.0  ...  101301.859375          -999.0            0.0\n[5 rows x 72 columns]\nrenaming Predicted_FRP to FRP\nremove the current predicted_frp\nreading past files for 2021-07-05 00:00:00\nreading from predicted folder\ncurrent final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n0 -999.0 -999.0  0.0  ...  101352.601562          -999.0            0.0\n1 -999.0 -999.0  0.0  ...  101352.601562          -999.0            0.0\n2 -999.0 -999.0  0.0  ...  101336.601562          -999.0            0.0\n3 -999.0 -999.0  0.0  ...  101336.601562          -999.0            0.0\n4 -999.0 -999.0  0.0  ...  101320.203125          -999.0            0.0\n[5 rows x 72 columns]\nrenaming Predicted_FRP to FRP\nremove the current predicted_frp\nreading past files for 2021-07-04 00:00:00\nreading from predicted folder\ncurrent final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n0 -999.0 -999.0  0.0  ...  101521.437500          -999.0            0.0\n1 -999.0 -999.0  0.0  ...  101521.437500          -999.0            0.0\n2 -999.0 -999.0  0.0  ...  101507.437500          -999.0            0.0\n3 -999.0 -999.0  0.0  ...  101507.437500          -999.0            0.0\n4 -999.0 -999.0  0.0  ...  101494.640625          -999.0            0.0\n[5 rows x 72 columns]\nrenaming Predicted_FRP to FRP\nremove the current predicted_frp\nreading past files for 2021-07-03 00:00:00\nreading from predicted folder\ncurrent final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n0 -999.0 -999.0  0.0  ...  101701.023438          -999.0            0.0\n1 -999.0 -999.0  0.0  ...  101701.023438          -999.0            0.0\n2 -999.0 -999.0  0.0  ...  101689.023438          -999.0            0.0\n3 -999.0 -999.0  0.0  ...  101689.023438          -999.0            0.0\n4 -999.0 -999.0  0.0  ...  101676.625000          -999.0            0.0\n[5 rows x 72 columns]\nrenaming Predicted_FRP to FRP\nremove the current predicted_frp\nreading past files for 2021-07-02 00:00:00\nreading from original folder\nReading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210702.txt\nreading past files for 2021-07-01 00:00:00\nreading from original folder\nReading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210701.txt\nNew time series dataframe:      LAT         LON    FRP  ...  VPD_7_days_ago   P_7_days_ago  FRP_7_days_ago\n0  24.5 -126.000000 -999.0  ...          -999.0  101530.867188          -999.0\n1  24.5 -125.899994 -999.0  ...          -999.0  101530.867188          -999.0\n2  24.5 -125.800003 -999.0  ...          -999.0  101528.468750          -999.0\n3  24.5 -125.699997 -999.0  ...          -999.0  101528.468750          -999.0\n4  24.5 -125.599998 -999.0  ...          -999.0  101526.070312          -999.0\n[5 rows x 74 columns]\nOriginal df is created:  (156861, 74)\nOriginal df filled the na with -9999 \nX and y are loaded into memory for 20210708\nthe loaded model is:  TabNetRegressor(n_d=17, n_a=41, n_steps=4, gamma=1.1546672563068268, cat_idxs=[], cat_dims=[], cat_emb_dim=[], n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.00042602006758391, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=71, output_dim=1, device_name='auto', n_shared_decoder=1, n_indep_decoder=1, grouped_features=[])\nLoaded model is a TabNet model.\nPrediction for 20210708 of start day 20210703 is finished\nnew columns to check:  ['FRP_1_days_ago', 'Nearest_1', 'Nearest_2', 'Nearest_3', 'Nearest_4', 'Nearest_5', 'Nearest_6', 'Nearest_7', 'Nearest_8']\ncurrent merged_df columns:  Index(['FWI', 'VPD', 'HT', 'T', 'RH', 'U', 'V', 'P', 'RAIN', 'CAPE', 'ST',\n       'SM', 'Nearest_1', 'Nearest_2', 'Nearest_3', 'Nearest_4', 'Nearest_5',\n       'Nearest_6', 'Nearest_7', 'Nearest_8', 'Nearest_9', 'Nearest_10',\n       'Nearest_11', 'Nearest_12', 'Nearest_13', 'Nearest_14', 'Nearest_15',\n       'Nearest_16', 'Nearest_17', 'Nearest_18', 'Nearest_19', 'Nearest_20',\n       'Nearest_21', 'Nearest_22', 'Nearest_23', 'Nearest_24', 'Land_Use',\n       'VCI_AVE', 'TCI_AVE', 'VHI_AVE', 'VCI_TOT', 'TCI_TOT', 'VHI_TOT',\n       'FWI_1_days_ago', 'VPD_1_days_ago', 'P_1_days_ago', 'FRP_1_days_ago',\n       'FWI_2_days_ago', 'VPD_2_days_ago', 'P_2_days_ago', 'FRP_2_days_ago',\n       'FWI_3_days_ago', 'VPD_3_days_ago', 'P_3_days_ago', 'FRP_3_days_ago',\n       'FWI_4_days_ago', 'VPD_4_days_ago', 'P_4_days_ago', 'FRP_4_days_ago',\n       'FWI_5_days_ago', 'VPD_5_days_ago', 'P_5_days_ago', 'FRP_5_days_ago',\n       'FWI_6_days_ago', 'VPD_6_days_ago', 'P_6_days_ago', 'FRP_6_days_ago',\n       'FWI_7_days_ago', 'VPD_7_days_ago', 'P_7_days_ago', 'FRP_7_days_ago',\n       'Predicted_FRP'],\n      dtype='object')\nPrediction results are saved to /groups/ESS3/zsun/firecasting/data/output/output_tabnet_window_7_days_forecasting_with_new_yunyao_window_time_series_landuse_vhi_latlon//20210703/firedata_20210708_predicted.txt\n['Mean Absolute Error (MAE): 22.020403985167842', 'Mean Squared Error (MSE): 22179.355211159796', 'Root Mean Squared Error (RMSE): 148.92734876831653', 'R-squared (R2) Score: -0.0216758948731528', 'Explained Variance Score: 4.93107632826284e-06', 'Median Absolute Error (MedAE): 0.0', 'Max Error: 5463.914419518793', 'Mean: -21.694544765945654', 'Median: 0.0', 'Standard Deviation: 147.33952624013253', 'Minimum: -999.0', 'Maximum: 5464.172363', 'Count: 156861']\nMetrics saved to /groups/ESS3/zsun/firecasting/data/output/output_tabnet_window_7_days_forecasting_with_new_yunyao_window_time_series_landuse_vhi_latlon//20210703/metrics_20210708_predicted.txt\npredicting:  20210709\nRead from original folder for current date: 20210709\nReading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210709.txt\nreading past files for 2021-07-08 00:00:00\nreading from predicted folder\ncurrent final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n0 -999.0 -999.0  0.0  ...  101530.867188          -999.0            0.0\n1 -999.0 -999.0  0.0  ...  101530.867188          -999.0            0.0\n2 -999.0 -999.0  0.0  ...  101528.468750          -999.0            0.0\n3 -999.0 -999.0  0.0  ...  101528.468750          -999.0            0.0\n4 -999.0 -999.0  0.0  ...  101526.070312          -999.0            0.0\n[5 rows x 72 columns]\nrenaming Predicted_FRP to FRP\nremove the current predicted_frp\nreading past files for 2021-07-07 00:00:00\nreading from predicted folder\ncurrent final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n0 -999.0 -999.0  0.0  ...  101381.734375          -999.0            0.0\n1 -999.0 -999.0  0.0  ...  101381.734375          -999.0            0.0\n2 -999.0 -999.0  0.0  ...  101376.140625          -999.0            0.0\n3 -999.0 -999.0  0.0  ...  101376.140625          -999.0            0.0\n4 -999.0 -999.0  0.0  ...  101371.742188          -999.0            0.0\n[5 rows x 72 columns]\nrenaming Predicted_FRP to FRP\nremove the current predicted_frp\nreading past files for 2021-07-06 00:00:00\nreading from predicted folder\ncurrent final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n0 -999.0 -999.0  0.0  ...  101329.468750          -999.0            0.0\n1 -999.0 -999.0  0.0  ...  101329.468750          -999.0            0.0\n2 -999.0 -999.0  0.0  ...  101317.062500          -999.0            0.0\n3 -999.0 -999.0  0.0  ...  101317.062500          -999.0            0.0\n4 -999.0 -999.0  0.0  ...  101301.859375          -999.0            0.0\n[5 rows x 72 columns]\nrenaming Predicted_FRP to FRP\nremove the current predicted_frp\nreading past files for 2021-07-05 00:00:00\nreading from predicted folder\ncurrent final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n0 -999.0 -999.0  0.0  ...  101352.601562          -999.0            0.0\n1 -999.0 -999.0  0.0  ...  101352.601562          -999.0            0.0\n2 -999.0 -999.0  0.0  ...  101336.601562          -999.0            0.0\n3 -999.0 -999.0  0.0  ...  101336.601562          -999.0            0.0\n4 -999.0 -999.0  0.0  ...  101320.203125          -999.0            0.0\n[5 rows x 72 columns]\nrenaming Predicted_FRP to FRP\nremove the current predicted_frp\nreading past files for 2021-07-04 00:00:00\nreading from predicted folder\ncurrent final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n0 -999.0 -999.0  0.0  ...  101521.437500          -999.0            0.0\n1 -999.0 -999.0  0.0  ...  101521.437500          -999.0            0.0\n2 -999.0 -999.0  0.0  ...  101507.437500          -999.0            0.0\n3 -999.0 -999.0  0.0  ...  101507.437500          -999.0            0.0\n4 -999.0 -999.0  0.0  ...  101494.640625          -999.0            0.0\n[5 rows x 72 columns]\nrenaming Predicted_FRP to FRP\nremove the current predicted_frp\nreading past files for 2021-07-03 00:00:00\nreading from predicted folder\ncurrent final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n0 -999.0 -999.0  0.0  ...  101701.023438          -999.0            0.0\n1 -999.0 -999.0  0.0  ...  101701.023438          -999.0            0.0\n2 -999.0 -999.0  0.0  ...  101689.023438          -999.0            0.0\n3 -999.0 -999.0  0.0  ...  101689.023438          -999.0            0.0\n4 -999.0 -999.0  0.0  ...  101676.625000          -999.0            0.0\n[5 rows x 72 columns]\nrenaming Predicted_FRP to FRP\nremove the current predicted_frp\nreading past files for 2021-07-02 00:00:00\nreading from original folder\nReading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210702.txt\nNew time series dataframe:      LAT         LON    FRP  ...  VPD_7_days_ago   P_7_days_ago  FRP_7_days_ago\n0  24.5 -126.000000 -999.0  ...          -999.0  101617.460938          -999.0\n1  24.5 -125.899994 -999.0  ...          -999.0  101617.460938          -999.0\n2  24.5 -125.800003 -999.0  ...          -999.0  101612.257812          -999.0\n3  24.5 -125.699997 -999.0  ...          -999.0  101612.257812          -999.0\n4  24.5 -125.599998 -999.0  ...          -999.0  101606.257812          -999.0\n[5 rows x 74 columns]\nOriginal df is created:  (156861, 74)\nOriginal df filled the na with -9999 \nX and y are loaded into memory for 20210709\nthe loaded model is:  TabNetRegressor(n_d=17, n_a=41, n_steps=4, gamma=1.1546672563068268, cat_idxs=[], cat_dims=[], cat_emb_dim=[], n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.00042602006758391, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=71, output_dim=1, device_name='auto', n_shared_decoder=1, n_indep_decoder=1, grouped_features=[])\nLoaded model is a TabNet model.\nPrediction for 20210709 of start day 20210703 is finished\nnew columns to check:  ['FRP_1_days_ago', 'Nearest_1', 'Nearest_2', 'Nearest_3', 'Nearest_4', 'Nearest_5', 'Nearest_6', 'Nearest_7', 'Nearest_8']\ncurrent merged_df columns:  Index(['FWI', 'VPD', 'HT', 'T', 'RH', 'U', 'V', 'P', 'RAIN', 'CAPE', 'ST',\n       'SM', 'Nearest_1', 'Nearest_2', 'Nearest_3', 'Nearest_4', 'Nearest_5',\n       'Nearest_6', 'Nearest_7', 'Nearest_8', 'Nearest_9', 'Nearest_10',\n       'Nearest_11', 'Nearest_12', 'Nearest_13', 'Nearest_14', 'Nearest_15',\n       'Nearest_16', 'Nearest_17', 'Nearest_18', 'Nearest_19', 'Nearest_20',\n       'Nearest_21', 'Nearest_22', 'Nearest_23', 'Nearest_24', 'Land_Use',\n       'VCI_AVE', 'TCI_AVE', 'VHI_AVE', 'VCI_TOT', 'TCI_TOT', 'VHI_TOT',\n       'FWI_1_days_ago', 'VPD_1_days_ago', 'P_1_days_ago', 'FRP_1_days_ago',\n       'FWI_2_days_ago', 'VPD_2_days_ago', 'P_2_days_ago', 'FRP_2_days_ago',\n       'FWI_3_days_ago', 'VPD_3_days_ago', 'P_3_days_ago', 'FRP_3_days_ago',\n       'FWI_4_days_ago', 'VPD_4_days_ago', 'P_4_days_ago', 'FRP_4_days_ago',\n       'FWI_5_days_ago', 'VPD_5_days_ago', 'P_5_days_ago', 'FRP_5_days_ago',\n       'FWI_6_days_ago', 'VPD_6_days_ago', 'P_6_days_ago', 'FRP_6_days_ago',\n       'FWI_7_days_ago', 'VPD_7_days_ago', 'P_7_days_ago', 'FRP_7_days_ago',\n       'Predicted_FRP'],\n      dtype='object')\nPrediction results are saved to /groups/ESS3/zsun/firecasting/data/output/output_tabnet_window_7_days_forecasting_with_new_yunyao_window_time_series_landuse_vhi_latlon//20210703/firedata_20210709_predicted.txt\n['Mean Absolute Error (MAE): 22.44045001956146', 'Mean Squared Error (MSE): 27325.401618392185', 'Root Mean Squared Error (RMSE): 165.3039673401464', 'R-squared (R2) Score: -0.01682856863512816', 'Explained Variance Score: 2.1548523245651374e-05', 'Median Absolute Error (MedAE): 0.0', 'Max Error: 19604.529801375353', 'Mean: -21.276627506582255', 'Median: 0.0', 'Standard Deviation: 163.93088800132404', 'Minimum: -999.0', 'Maximum: 19605.007812', 'Count: 156861']\nMetrics saved to /groups/ESS3/zsun/firecasting/data/output/output_tabnet_window_7_days_forecasting_with_new_yunyao_window_time_series_landuse_vhi_latlon//20210703/metrics_20210709_predicted.txt\ncurrent date:  2021-07-04 00:00:00\nsingle_day_current_date =  2021-07-04 00:00:00\nsingle_day_predict_end_date =  2021-07-11 00:00:00\npredicting:  20210704\nRead from original folder for current date: 20210704\nReading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210704.txt\nreading past files for 2021-07-03 00:00:00\nreading from original folder\nReading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210703.txt\nreading past files for 2021-07-02 00:00:00\nreading from original folder\nReading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210702.txt\nreading past files for 2021-07-01 00:00:00\nreading from original folder\nReading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210701.txt\nreading past files for 2021-06-30 00:00:00\nreading from original folder\nReading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210630.txt\nreading past files for 2021-06-29 00:00:00\nreading from original folder\nReading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210629.txt\nreading past files for 2021-06-28 00:00:00\nreading from original folder\nReading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210628.txt\nreading past files for 2021-06-27 00:00:00\nreading from original folder\nReading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210627.txt\nNew time series dataframe:      LAT         LON    FRP  ...  VPD_7_days_ago   P_7_days_ago  FRP_7_days_ago\n0  24.5 -126.000000 -999.0  ...          -999.0  101521.437500          -999.0\n1  24.5 -125.899994 -999.0  ...          -999.0  101521.437500          -999.0\n2  24.5 -125.800003 -999.0  ...          -999.0  101507.437500          -999.0\n3  24.5 -125.699997 -999.0  ...          -999.0  101507.437500          -999.0\n4  24.5 -125.599998 -999.0  ...          -999.0  101494.640625          -999.0\n[5 rows x 74 columns]\nOriginal df is created:  (156861, 74)\nOriginal df filled the na with -9999 \nX and y are loaded into memory for 20210704\nthe loaded model is:  TabNetRegressor(n_d=17, n_a=41, n_steps=4, gamma=1.1546672563068268, cat_idxs=[], cat_dims=[], cat_emb_dim=[], n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.00042602006758391, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=71, output_dim=1, device_name='auto', n_shared_decoder=1, n_indep_decoder=1, grouped_features=[])\nLoaded model is a TabNet model.\nPrediction for 20210704 of start day 20210704 is finished\nnew columns to check:  ['FRP_1_days_ago', 'Nearest_1', 'Nearest_2', 'Nearest_3', 'Nearest_4', 'Nearest_5', 'Nearest_6', 'Nearest_7', 'Nearest_8']\ncurrent merged_df columns:  Index(['FWI', 'VPD', 'HT', 'T', 'RH', 'U', 'V', 'P', 'RAIN', 'CAPE', 'ST',\n       'SM', 'Nearest_1', 'Nearest_2', 'Nearest_3', 'Nearest_4', 'Nearest_5',\n       'Nearest_6', 'Nearest_7', 'Nearest_8', 'Nearest_9', 'Nearest_10',\n       'Nearest_11', 'Nearest_12', 'Nearest_13', 'Nearest_14', 'Nearest_15',\n       'Nearest_16', 'Nearest_17', 'Nearest_18', 'Nearest_19', 'Nearest_20',\n       'Nearest_21', 'Nearest_22', 'Nearest_23', 'Nearest_24', 'Land_Use',\n       'VCI_AVE', 'TCI_AVE', 'VHI_AVE', 'VCI_TOT', 'TCI_TOT', 'VHI_TOT',\n       'FWI_1_days_ago', 'VPD_1_days_ago', 'P_1_days_ago', 'FRP_1_days_ago',\n       'FWI_2_days_ago', 'VPD_2_days_ago', 'P_2_days_ago', 'FRP_2_days_ago',\n       'FWI_3_days_ago', 'VPD_3_days_ago', 'P_3_days_ago', 'FRP_3_days_ago',\n       'FWI_4_days_ago', 'VPD_4_days_ago', 'P_4_days_ago', 'FRP_4_days_ago',\n       'FWI_5_days_ago', 'VPD_5_days_ago', 'P_5_days_ago', 'FRP_5_days_ago',\n       'FWI_6_days_ago', 'VPD_6_days_ago', 'P_6_days_ago', 'FRP_6_days_ago',\n       'FWI_7_days_ago', 'VPD_7_days_ago', 'P_7_days_ago', 'FRP_7_days_ago',\n       'Predicted_FRP'],\n      dtype='object')\nPrediction results are saved to /groups/ESS3/zsun/firecasting/data/output/output_tabnet_window_7_days_forecasting_with_new_yunyao_window_time_series_landuse_vhi_latlon//20210704/firedata_20210704_predicted.txt\n['Mean Absolute Error (MAE): 21.89673228118895', 'Mean Squared Error (MSE): 21857.441893899984', 'Root Mean Squared Error (RMSE): 147.84262542954244', 'R-squared (R2) Score: -0.02226275887000062', 'Explained Variance Score: 9.021714351131749e-07', 'Median Absolute Error (MedAE): 0.0', 'Max Error: 1180.5074685169525', 'Mean: -21.818007558577342', 'Median: 0.0', 'Standard Deviation: 146.2243773555253', 'Minimum: -999.0', 'Maximum: 1181.141357', 'Count: 156861']\nMetrics saved to /groups/ESS3/zsun/firecasting/data/output/output_tabnet_window_7_days_forecasting_with_new_yunyao_window_time_series_landuse_vhi_latlon//20210704/metrics_20210704_predicted.txt\npredicting:  20210705\nRead from original folder for current date: 20210705\nReading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210705.txt\nreading past files for 2021-07-04 00:00:00\nreading from predicted folder\ncurrent final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n0 -999.0 -999.0  0.0  ...  101521.437500          -999.0            0.0\n1 -999.0 -999.0  0.0  ...  101521.437500          -999.0            0.0\n2 -999.0 -999.0  0.0  ...  101507.437500          -999.0            0.0\n3 -999.0 -999.0  0.0  ...  101507.437500          -999.0            0.0\n4 -999.0 -999.0  0.0  ...  101494.640625          -999.0            0.0\n[5 rows x 72 columns]\nrenaming Predicted_FRP to FRP\nremove the current predicted_frp\nreading past files for 2021-07-03 00:00:00\nreading from original folder\nReading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210703.txt\nreading past files for 2021-07-02 00:00:00\nreading from original folder\nReading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210702.txt\nreading past files for 2021-07-01 00:00:00\nreading from original folder\nReading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210701.txt\nreading past files for 2021-06-30 00:00:00\nreading from original folder\nReading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210630.txt\nreading past files for 2021-06-29 00:00:00\nreading from original folder\nReading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210629.txt\nreading past files for 2021-06-28 00:00:00\nreading from original folder\nReading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210628.txt\nNew time series dataframe:      LAT         LON    FRP  ...  VPD_7_days_ago   P_7_days_ago  FRP_7_days_ago\n0  24.5 -126.000000 -999.0  ...          -999.0  101352.601562          -999.0\n1  24.5 -125.899994 -999.0  ...          -999.0  101352.601562          -999.0\n2  24.5 -125.800003 -999.0  ...          -999.0  101336.601562          -999.0\n3  24.5 -125.699997 -999.0  ...          -999.0  101336.601562          -999.0\n4  24.5 -125.599998 -999.0  ...          -999.0  101320.203125          -999.0\n[5 rows x 74 columns]\nOriginal df is created:  (156861, 74)\nOriginal df filled the na with -9999 \nX and y are loaded into memory for 20210705\nthe loaded model is:  TabNetRegressor(n_d=17, n_a=41, n_steps=4, gamma=1.1546672563068268, cat_idxs=[], cat_dims=[], cat_emb_dim=[], n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.00042602006758391, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=71, output_dim=1, device_name='auto', n_shared_decoder=1, n_indep_decoder=1, grouped_features=[])\nLoaded model is a TabNet model.\nPrediction for 20210705 of start day 20210704 is finished\nnew columns to check:  ['FRP_1_days_ago', 'Nearest_1', 'Nearest_2', 'Nearest_3', 'Nearest_4', 'Nearest_5', 'Nearest_6', 'Nearest_7', 'Nearest_8']\ncurrent merged_df columns:  Index(['FWI', 'VPD', 'HT', 'T', 'RH', 'U', 'V', 'P', 'RAIN', 'CAPE', 'ST',\n       'SM', 'Nearest_1', 'Nearest_2', 'Nearest_3', 'Nearest_4', 'Nearest_5',\n       'Nearest_6', 'Nearest_7', 'Nearest_8', 'Nearest_9', 'Nearest_10',\n       'Nearest_11', 'Nearest_12', 'Nearest_13', 'Nearest_14', 'Nearest_15',\n       'Nearest_16', 'Nearest_17', 'Nearest_18', 'Nearest_19', 'Nearest_20',\n       'Nearest_21', 'Nearest_22', 'Nearest_23', 'Nearest_24', 'Land_Use',\n       'VCI_AVE', 'TCI_AVE', 'VHI_AVE', 'VCI_TOT', 'TCI_TOT', 'VHI_TOT',\n       'FWI_1_days_ago', 'VPD_1_days_ago', 'P_1_days_ago', 'FRP_1_days_ago',\n       'FWI_2_days_ago', 'VPD_2_days_ago', 'P_2_days_ago', 'FRP_2_days_ago',\n       'FWI_3_days_ago', 'VPD_3_days_ago', 'P_3_days_ago', 'FRP_3_days_ago',\n       'FWI_4_days_ago', 'VPD_4_days_ago', 'P_4_days_ago', 'FRP_4_days_ago',\n       'FWI_5_days_ago', 'VPD_5_days_ago', 'P_5_days_ago', 'FRP_5_days_ago',\n       'FWI_6_days_ago', 'VPD_6_days_ago', 'P_6_days_ago', 'FRP_6_days_ago',\n       'FWI_7_days_ago', 'VPD_7_days_ago', 'P_7_days_ago', 'FRP_7_days_ago',\n       'Predicted_FRP'],\n      dtype='object')\nPrediction results are saved to /groups/ESS3/zsun/firecasting/data/output/output_tabnet_window_7_days_forecasting_with_new_yunyao_window_time_series_landuse_vhi_latlon//20210704/firedata_20210705_predicted.txt\n['Mean Absolute Error (MAE): 21.899699610343653', 'Mean Squared Error (MSE): 21849.94517977188', 'Root Mean Squared Error (RMSE): 147.81726955864082', 'R-squared (R2) Score: -0.02226494399605561', 'Explained Variance Score: 5.520281386450776e-07', 'Median Absolute Error (MedAE): 0.0', 'Max Error: 1216.9396944375744', 'Mean: -21.81510091978249', 'Median: 0.0', 'Standard Deviation: 146.19914277086232', 'Minimum: -999.0', 'Maximum: 1216.946899', 'Count: 156861']\nMetrics saved to /groups/ESS3/zsun/firecasting/data/output/output_tabnet_window_7_days_forecasting_with_new_yunyao_window_time_series_landuse_vhi_latlon//20210704/metrics_20210705_predicted.txt\npredicting:  20210706\nRead from original folder for current date: 20210706\nReading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210706.txt\nreading past files for 2021-07-05 00:00:00\nreading from predicted folder\ncurrent final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n0 -999.0 -999.0  0.0  ...  101352.601562          -999.0            0.0\n1 -999.0 -999.0  0.0  ...  101352.601562          -999.0            0.0\n2 -999.0 -999.0  0.0  ...  101336.601562          -999.0            0.0\n3 -999.0 -999.0  0.0  ...  101336.601562          -999.0            0.0\n4 -999.0 -999.0  0.0  ...  101320.203125          -999.0            0.0\n[5 rows x 72 columns]\nrenaming Predicted_FRP to FRP\nremove the current predicted_frp\nreading past files for 2021-07-04 00:00:00\nreading from predicted folder\ncurrent final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n0 -999.0 -999.0  0.0  ...  101521.437500          -999.0            0.0\n1 -999.0 -999.0  0.0  ...  101521.437500          -999.0            0.0\n2 -999.0 -999.0  0.0  ...  101507.437500          -999.0            0.0\n3 -999.0 -999.0  0.0  ...  101507.437500          -999.0            0.0\n4 -999.0 -999.0  0.0  ...  101494.640625          -999.0            0.0\n[5 rows x 72 columns]\nrenaming Predicted_FRP to FRP\nremove the current predicted_frp\nreading past files for 2021-07-03 00:00:00\nreading from original folder\nReading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210703.txt\nreading past files for 2021-07-02 00:00:00\nreading from original folder\nReading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210702.txt\nreading past files for 2021-07-01 00:00:00\nreading from original folder\nReading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210701.txt\nreading past files for 2021-06-30 00:00:00\nreading from original folder\nReading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210630.txt\nreading past files for 2021-06-29 00:00:00\nreading from original folder\nReading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210629.txt\nNew time series dataframe:      LAT         LON    FRP  ...  VPD_7_days_ago   P_7_days_ago  FRP_7_days_ago\n0  24.5 -126.000000 -999.0  ...          -999.0  101329.468750          -999.0\n1  24.5 -125.899994 -999.0  ...          -999.0  101329.468750          -999.0\n2  24.5 -125.800003 -999.0  ...          -999.0  101317.062500          -999.0\n3  24.5 -125.699997 -999.0  ...          -999.0  101317.062500          -999.0\n4  24.5 -125.599998 -999.0  ...          -999.0  101301.859375          -999.0\n[5 rows x 74 columns]\nOriginal df is created:  (156861, 74)\nOriginal df filled the na with -9999 \nX and y are loaded into memory for 20210706\nthe loaded model is:  TabNetRegressor(n_d=17, n_a=41, n_steps=4, gamma=1.1546672563068268, cat_idxs=[], cat_dims=[], cat_emb_dim=[], n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.00042602006758391, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=71, output_dim=1, device_name='auto', n_shared_decoder=1, n_indep_decoder=1, grouped_features=[])\nLoaded model is a TabNet model.\nPrediction for 20210706 of start day 20210704 is finished\nnew columns to check:  ['FRP_1_days_ago', 'Nearest_1', 'Nearest_2', 'Nearest_3', 'Nearest_4', 'Nearest_5', 'Nearest_6', 'Nearest_7', 'Nearest_8']\ncurrent merged_df columns:  Index(['FWI', 'VPD', 'HT', 'T', 'RH', 'U', 'V', 'P', 'RAIN', 'CAPE', 'ST',\n       'SM', 'Nearest_1', 'Nearest_2', 'Nearest_3', 'Nearest_4', 'Nearest_5',\n       'Nearest_6', 'Nearest_7', 'Nearest_8', 'Nearest_9', 'Nearest_10',\n       'Nearest_11', 'Nearest_12', 'Nearest_13', 'Nearest_14', 'Nearest_15',\n       'Nearest_16', 'Nearest_17', 'Nearest_18', 'Nearest_19', 'Nearest_20',\n       'Nearest_21', 'Nearest_22', 'Nearest_23', 'Nearest_24', 'Land_Use',\n       'VCI_AVE', 'TCI_AVE', 'VHI_AVE', 'VCI_TOT', 'TCI_TOT', 'VHI_TOT',\n       'FWI_1_days_ago', 'VPD_1_days_ago', 'P_1_days_ago', 'FRP_1_days_ago',\n       'FWI_2_days_ago', 'VPD_2_days_ago', 'P_2_days_ago', 'FRP_2_days_ago',\n       'FWI_3_days_ago', 'VPD_3_days_ago', 'P_3_days_ago', 'FRP_3_days_ago',\n       'FWI_4_days_ago', 'VPD_4_days_ago', 'P_4_days_ago', 'FRP_4_days_ago',\n       'FWI_5_days_ago', 'VPD_5_days_ago', 'P_5_days_ago', 'FRP_5_days_ago',\n       'FWI_6_days_ago', 'VPD_6_days_ago', 'P_6_days_ago', 'FRP_6_days_ago',\n       'FWI_7_days_ago', 'VPD_7_days_ago', 'P_7_days_ago', 'FRP_7_days_ago',\n       'Predicted_FRP'],\n      dtype='object')\nPrediction results are saved to /groups/ESS3/zsun/firecasting/data/output/output_tabnet_window_7_days_forecasting_with_new_yunyao_window_time_series_landuse_vhi_latlon//20210704/firedata_20210706_predicted.txt\n['Mean Absolute Error (MAE): 21.96846422918536', 'Mean Squared Error (MSE): 22237.571946209973', 'Root Mean Squared Error (RMSE): 149.12267415188737', 'R-squared (R2) Score: -0.02172568661545582', 'Explained Variance Score: 2.747054351104339e-06', 'Median Absolute Error (MedAE): 0.0', 'Max Error: 7547.461402141784', 'Mean: -21.746309589547433', 'Median: 0.0', 'Standard Deviation: 147.52917421844327', 'Minimum: -999.0', 'Maximum: 7547.473145', 'Count: 156861']\nMetrics saved to /groups/ESS3/zsun/firecasting/data/output/output_tabnet_window_7_days_forecasting_with_new_yunyao_window_time_series_landuse_vhi_latlon//20210704/metrics_20210706_predicted.txt\npredicting:  20210707\nRead from original folder for current date: 20210707\nReading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210707.txt\nreading past files for 2021-07-06 00:00:00\nreading from predicted folder\ncurrent final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n0 -999.0 -999.0  0.0  ...  101329.468750          -999.0            0.0\n1 -999.0 -999.0  0.0  ...  101329.468750          -999.0            0.0\n2 -999.0 -999.0  0.0  ...  101317.062500          -999.0            0.0\n3 -999.0 -999.0  0.0  ...  101317.062500          -999.0            0.0\n4 -999.0 -999.0  0.0  ...  101301.859375          -999.0            0.0\n[5 rows x 72 columns]\nrenaming Predicted_FRP to FRP\nremove the current predicted_frp\nreading past files for 2021-07-05 00:00:00\nreading from predicted folder\ncurrent final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n0 -999.0 -999.0  0.0  ...  101352.601562          -999.0            0.0\n1 -999.0 -999.0  0.0  ...  101352.601562          -999.0            0.0\n2 -999.0 -999.0  0.0  ...  101336.601562          -999.0            0.0\n3 -999.0 -999.0  0.0  ...  101336.601562          -999.0            0.0\n4 -999.0 -999.0  0.0  ...  101320.203125          -999.0            0.0\n[5 rows x 72 columns]\nrenaming Predicted_FRP to FRP\nremove the current predicted_frp\nreading past files for 2021-07-04 00:00:00\nreading from predicted folder\ncurrent final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n0 -999.0 -999.0  0.0  ...  101521.437500          -999.0            0.0\n1 -999.0 -999.0  0.0  ...  101521.437500          -999.0            0.0\n2 -999.0 -999.0  0.0  ...  101507.437500          -999.0            0.0\n3 -999.0 -999.0  0.0  ...  101507.437500          -999.0            0.0\n4 -999.0 -999.0  0.0  ...  101494.640625          -999.0            0.0\n[5 rows x 72 columns]\nrenaming Predicted_FRP to FRP\nremove the current predicted_frp\nreading past files for 2021-07-03 00:00:00\nreading from original folder\nReading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210703.txt\nreading past files for 2021-07-02 00:00:00\nreading from original folder\nReading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210702.txt\nreading past files for 2021-07-01 00:00:00\nreading from original folder\nReading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210701.txt\nreading past files for 2021-06-30 00:00:00\nreading from original folder\nReading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210630.txt\nNew time series dataframe:      LAT         LON    FRP  ...  VPD_7_days_ago   P_7_days_ago  FRP_7_days_ago\n0  24.5 -126.000000 -999.0  ...          -999.0  101381.734375          -999.0\n1  24.5 -125.899994 -999.0  ...          -999.0  101381.734375          -999.0\n2  24.5 -125.800003 -999.0  ...          -999.0  101376.140625          -999.0\n3  24.5 -125.699997 -999.0  ...          -999.0  101376.140625          -999.0\n4  24.5 -125.599998 -999.0  ...          -999.0  101371.742188          -999.0\n[5 rows x 74 columns]\nOriginal df is created:  (156861, 74)\nOriginal df filled the na with -9999 \nX and y are loaded into memory for 20210707\nthe loaded model is:  TabNetRegressor(n_d=17, n_a=41, n_steps=4, gamma=1.1546672563068268, cat_idxs=[], cat_dims=[], cat_emb_dim=[], n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.00042602006758391, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=71, output_dim=1, device_name='auto', n_shared_decoder=1, n_indep_decoder=1, grouped_features=[])\nLoaded model is a TabNet model.\nPrediction for 20210707 of start day 20210704 is finished\nnew columns to check:  ['FRP_1_days_ago', 'Nearest_1', 'Nearest_2', 'Nearest_3', 'Nearest_4', 'Nearest_5', 'Nearest_6', 'Nearest_7', 'Nearest_8']\ncurrent merged_df columns:  Index(['FWI', 'VPD', 'HT', 'T', 'RH', 'U', 'V', 'P', 'RAIN', 'CAPE', 'ST',\n       'SM', 'Nearest_1', 'Nearest_2', 'Nearest_3', 'Nearest_4', 'Nearest_5',\n       'Nearest_6', 'Nearest_7', 'Nearest_8', 'Nearest_9', 'Nearest_10',\n       'Nearest_11', 'Nearest_12', 'Nearest_13', 'Nearest_14', 'Nearest_15',\n       'Nearest_16', 'Nearest_17', 'Nearest_18', 'Nearest_19', 'Nearest_20',\n       'Nearest_21', 'Nearest_22', 'Nearest_23', 'Nearest_24', 'Land_Use',\n       'VCI_AVE', 'TCI_AVE', 'VHI_AVE', 'VCI_TOT', 'TCI_TOT', 'VHI_TOT',\n       'FWI_1_days_ago', 'VPD_1_days_ago', 'P_1_days_ago', 'FRP_1_days_ago',\n       'FWI_2_days_ago', 'VPD_2_days_ago', 'P_2_days_ago', 'FRP_2_days_ago',\n       'FWI_3_days_ago', 'VPD_3_days_ago', 'P_3_days_ago', 'FRP_3_days_ago',\n       'FWI_4_days_ago', 'VPD_4_days_ago', 'P_4_days_ago', 'FRP_4_days_ago',\n       'FWI_5_days_ago', 'VPD_5_days_ago', 'P_5_days_ago', 'FRP_5_days_ago',\n       'FWI_6_days_ago', 'VPD_6_days_ago', 'P_6_days_ago', 'FRP_6_days_ago',\n       'FWI_7_days_ago', 'VPD_7_days_ago', 'P_7_days_ago', 'FRP_7_days_ago',\n       'Predicted_FRP'],\n      dtype='object')\nPrediction results are saved to /groups/ESS3/zsun/firecasting/data/output/output_tabnet_window_7_days_forecasting_with_new_yunyao_window_time_series_landuse_vhi_latlon//20210704/firedata_20210707_predicted.txt\n['Mean Absolute Error (MAE): 22.085082743245557', 'Mean Squared Error (MSE): 23056.240163999955', 'Root Mean Squared Error (RMSE): 151.8428140018485', 'R-squared (R2) Score: -0.020717364126373594', 'Explained Variance Score: -1.2799496231785668e-06', 'Median Absolute Error (MedAE): 0.0', 'Max Error: 11733.883916275576', 'Mean: -21.630771051147192', 'Median: 0.0', 'Standard Deviation: 150.29442683250224', 'Minimum: -999.0', 'Maximum: 11733.90625', 'Count: 156861']\nMetrics saved to /groups/ESS3/zsun/firecasting/data/output/output_tabnet_window_7_days_forecasting_with_new_yunyao_window_time_series_landuse_vhi_latlon//20210704/metrics_20210707_predicted.txt\npredicting:  20210708\nRead from original folder for current date: 20210708\nReading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210708.txt\nreading past files for 2021-07-07 00:00:00\nreading from predicted folder\ncurrent final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n0 -999.0 -999.0  0.0  ...  101381.734375          -999.0            0.0\n1 -999.0 -999.0  0.0  ...  101381.734375          -999.0            0.0\n2 -999.0 -999.0  0.0  ...  101376.140625          -999.0            0.0\n3 -999.0 -999.0  0.0  ...  101376.140625          -999.0            0.0\n4 -999.0 -999.0  0.0  ...  101371.742188          -999.0            0.0\n[5 rows x 72 columns]\nrenaming Predicted_FRP to FRP\nremove the current predicted_frp\nreading past files for 2021-07-06 00:00:00\nreading from predicted folder\ncurrent final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n0 -999.0 -999.0  0.0  ...  101329.468750          -999.0            0.0\n1 -999.0 -999.0  0.0  ...  101329.468750          -999.0            0.0\n2 -999.0 -999.0  0.0  ...  101317.062500          -999.0            0.0\n3 -999.0 -999.0  0.0  ...  101317.062500          -999.0            0.0\n4 -999.0 -999.0  0.0  ...  101301.859375          -999.0            0.0\n[5 rows x 72 columns]\nrenaming Predicted_FRP to FRP\nremove the current predicted_frp\nreading past files for 2021-07-05 00:00:00\nreading from predicted folder\ncurrent final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n0 -999.0 -999.0  0.0  ...  101352.601562          -999.0            0.0\n1 -999.0 -999.0  0.0  ...  101352.601562          -999.0            0.0\n2 -999.0 -999.0  0.0  ...  101336.601562          -999.0            0.0\n3 -999.0 -999.0  0.0  ...  101336.601562          -999.0            0.0\n4 -999.0 -999.0  0.0  ...  101320.203125          -999.0            0.0\n[5 rows x 72 columns]\nrenaming Predicted_FRP to FRP\nremove the current predicted_frp\nreading past files for 2021-07-04 00:00:00\nreading from predicted folder\ncurrent final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n0 -999.0 -999.0  0.0  ...  101521.437500          -999.0            0.0\n1 -999.0 -999.0  0.0  ...  101521.437500          -999.0            0.0\n2 -999.0 -999.0  0.0  ...  101507.437500          -999.0            0.0\n3 -999.0 -999.0  0.0  ...  101507.437500          -999.0            0.0\n4 -999.0 -999.0  0.0  ...  101494.640625          -999.0            0.0\n[5 rows x 72 columns]\nrenaming Predicted_FRP to FRP\nremove the current predicted_frp\nreading past files for 2021-07-03 00:00:00\nreading from original folder\nReading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210703.txt\nreading past files for 2021-07-02 00:00:00\nreading from original folder\nReading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210702.txt\nreading past files for 2021-07-01 00:00:00\nreading from original folder\nReading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210701.txt\nNew time series dataframe:      LAT         LON    FRP  ...  VPD_7_days_ago   P_7_days_ago  FRP_7_days_ago\n0  24.5 -126.000000 -999.0  ...          -999.0  101530.867188          -999.0\n1  24.5 -125.899994 -999.0  ...          -999.0  101530.867188          -999.0\n2  24.5 -125.800003 -999.0  ...          -999.0  101528.468750          -999.0\n3  24.5 -125.699997 -999.0  ...          -999.0  101528.468750          -999.0\n4  24.5 -125.599998 -999.0  ...          -999.0  101526.070312          -999.0\n[5 rows x 74 columns]\nOriginal df is created:  (156861, 74)\nOriginal df filled the na with -9999 \nX and y are loaded into memory for 20210708\nthe loaded model is:  TabNetRegressor(n_d=17, n_a=41, n_steps=4, gamma=1.1546672563068268, cat_idxs=[], cat_dims=[], cat_emb_dim=[], n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.00042602006758391, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=71, output_dim=1, device_name='auto', n_shared_decoder=1, n_indep_decoder=1, grouped_features=[])\nLoaded model is a TabNet model.\nPrediction for 20210708 of start day 20210704 is finished\nnew columns to check:  ['FRP_1_days_ago', 'Nearest_1', 'Nearest_2', 'Nearest_3', 'Nearest_4', 'Nearest_5', 'Nearest_6', 'Nearest_7', 'Nearest_8']\ncurrent merged_df columns:  Index(['FWI', 'VPD', 'HT', 'T', 'RH', 'U', 'V', 'P', 'RAIN', 'CAPE', 'ST',\n       'SM', 'Nearest_1', 'Nearest_2', 'Nearest_3', 'Nearest_4', 'Nearest_5',\n       'Nearest_6', 'Nearest_7', 'Nearest_8', 'Nearest_9', 'Nearest_10',\n       'Nearest_11', 'Nearest_12', 'Nearest_13', 'Nearest_14', 'Nearest_15',\n       'Nearest_16', 'Nearest_17', 'Nearest_18', 'Nearest_19', 'Nearest_20',\n       'Nearest_21', 'Nearest_22', 'Nearest_23', 'Nearest_24', 'Land_Use',\n       'VCI_AVE', 'TCI_AVE', 'VHI_AVE', 'VCI_TOT', 'TCI_TOT', 'VHI_TOT',\n       'FWI_1_days_ago', 'VPD_1_days_ago', 'P_1_days_ago', 'FRP_1_days_ago',\n       'FWI_2_days_ago', 'VPD_2_days_ago', 'P_2_days_ago', 'FRP_2_days_ago',\n       'FWI_3_days_ago', 'VPD_3_days_ago', 'P_3_days_ago', 'FRP_3_days_ago',\n       'FWI_4_days_ago', 'VPD_4_days_ago', 'P_4_days_ago', 'FRP_4_days_ago',\n       'FWI_5_days_ago', 'VPD_5_days_ago', 'P_5_days_ago', 'FRP_5_days_ago',\n       'FWI_6_days_ago', 'VPD_6_days_ago', 'P_6_days_ago', 'FRP_6_days_ago',\n       'FWI_7_days_ago', 'VPD_7_days_ago', 'P_7_days_ago', 'FRP_7_days_ago',\n       'Predicted_FRP'],\n      dtype='object')\nPrediction results are saved to /groups/ESS3/zsun/firecasting/data/output/output_tabnet_window_7_days_forecasting_with_new_yunyao_window_time_series_landuse_vhi_latlon//20210704/firedata_20210708_predicted.txt\n['Mean Absolute Error (MAE): 22.020385719846548', 'Mean Squared Error (MSE): 22179.355214747575', 'Root Mean Squared Error (RMSE): 148.92734878036194', 'R-squared (R2) Score: -0.02167589503842149', 'Explained Variance Score: 4.893825620300163e-06', 'Median Absolute Error (MedAE): 0.0', 'Max Error: 5463.914419518793', 'Mean: -21.694544765945654', 'Median: 0.0', 'Standard Deviation: 147.33952624013253', 'Minimum: -999.0', 'Maximum: 5464.172363', 'Count: 156861']\nMetrics saved to /groups/ESS3/zsun/firecasting/data/output/output_tabnet_window_7_days_forecasting_with_new_yunyao_window_time_series_landuse_vhi_latlon//20210704/metrics_20210708_predicted.txt\npredicting:  20210709\nRead from original folder for current date: 20210709\nReading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210709.txt\nreading past files for 2021-07-08 00:00:00\nreading from predicted folder\ncurrent final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n0 -999.0 -999.0  0.0  ...  101530.867188          -999.0            0.0\n1 -999.0 -999.0  0.0  ...  101530.867188          -999.0            0.0\n2 -999.0 -999.0  0.0  ...  101528.468750          -999.0            0.0\n3 -999.0 -999.0  0.0  ...  101528.468750          -999.0            0.0\n4 -999.0 -999.0  0.0  ...  101526.070312          -999.0            0.0\n[5 rows x 72 columns]\nrenaming Predicted_FRP to FRP\nremove the current predicted_frp\nreading past files for 2021-07-07 00:00:00\nreading from predicted folder\ncurrent final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n0 -999.0 -999.0  0.0  ...  101381.734375          -999.0            0.0\n1 -999.0 -999.0  0.0  ...  101381.734375          -999.0            0.0\n2 -999.0 -999.0  0.0  ...  101376.140625          -999.0            0.0\n3 -999.0 -999.0  0.0  ...  101376.140625          -999.0            0.0\n4 -999.0 -999.0  0.0  ...  101371.742188          -999.0            0.0\n[5 rows x 72 columns]\nrenaming Predicted_FRP to FRP\nremove the current predicted_frp\nreading past files for 2021-07-06 00:00:00\nreading from predicted folder\ncurrent final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n0 -999.0 -999.0  0.0  ...  101329.468750          -999.0            0.0\n1 -999.0 -999.0  0.0  ...  101329.468750          -999.0            0.0\n2 -999.0 -999.0  0.0  ...  101317.062500          -999.0            0.0\n3 -999.0 -999.0  0.0  ...  101317.062500          -999.0            0.0\n4 -999.0 -999.0  0.0  ...  101301.859375          -999.0            0.0\n[5 rows x 72 columns]\nrenaming Predicted_FRP to FRP\nremove the current predicted_frp\nreading past files for 2021-07-05 00:00:00\nreading from predicted folder\ncurrent final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n0 -999.0 -999.0  0.0  ...  101352.601562          -999.0            0.0\n1 -999.0 -999.0  0.0  ...  101352.601562          -999.0            0.0\n2 -999.0 -999.0  0.0  ...  101336.601562          -999.0            0.0\n3 -999.0 -999.0  0.0  ...  101336.601562          -999.0            0.0\n4 -999.0 -999.0  0.0  ...  101320.203125          -999.0            0.0\n[5 rows x 72 columns]\nrenaming Predicted_FRP to FRP\nremove the current predicted_frp\nreading past files for 2021-07-04 00:00:00\nreading from predicted folder\ncurrent final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n0 -999.0 -999.0  0.0  ...  101521.437500          -999.0            0.0\n1 -999.0 -999.0  0.0  ...  101521.437500          -999.0            0.0\n2 -999.0 -999.0  0.0  ...  101507.437500          -999.0            0.0\n3 -999.0 -999.0  0.0  ...  101507.437500          -999.0            0.0\n4 -999.0 -999.0  0.0  ...  101494.640625          -999.0            0.0\n[5 rows x 72 columns]\nrenaming Predicted_FRP to FRP\nremove the current predicted_frp\nreading past files for 2021-07-03 00:00:00\nreading from original folder\nReading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210703.txt\nreading past files for 2021-07-02 00:00:00\nreading from original folder\nReading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210702.txt\nNew time series dataframe:      LAT         LON    FRP  ...  VPD_7_days_ago   P_7_days_ago  FRP_7_days_ago\n0  24.5 -126.000000 -999.0  ...          -999.0  101617.460938          -999.0\n1  24.5 -125.899994 -999.0  ...          -999.0  101617.460938          -999.0\n2  24.5 -125.800003 -999.0  ...          -999.0  101612.257812          -999.0\n3  24.5 -125.699997 -999.0  ...          -999.0  101612.257812          -999.0\n4  24.5 -125.599998 -999.0  ...          -999.0  101606.257812          -999.0\n[5 rows x 74 columns]\nOriginal df is created:  (156861, 74)\nOriginal df filled the na with -9999 \nX and y are loaded into memory for 20210709\nthe loaded model is:  TabNetRegressor(n_d=17, n_a=41, n_steps=4, gamma=1.1546672563068268, cat_idxs=[], cat_dims=[], cat_emb_dim=[], n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.00042602006758391, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=71, output_dim=1, device_name='auto', n_shared_decoder=1, n_indep_decoder=1, grouped_features=[])\nLoaded model is a TabNet model.\nPrediction for 20210709 of start day 20210704 is finished\nnew columns to check:  ['FRP_1_days_ago', 'Nearest_1', 'Nearest_2', 'Nearest_3', 'Nearest_4', 'Nearest_5', 'Nearest_6', 'Nearest_7', 'Nearest_8']\ncurrent merged_df columns:  Index(['FWI', 'VPD', 'HT', 'T', 'RH', 'U', 'V', 'P', 'RAIN', 'CAPE', 'ST',\n       'SM', 'Nearest_1', 'Nearest_2', 'Nearest_3', 'Nearest_4', 'Nearest_5',\n       'Nearest_6', 'Nearest_7', 'Nearest_8', 'Nearest_9', 'Nearest_10',\n       'Nearest_11', 'Nearest_12', 'Nearest_13', 'Nearest_14', 'Nearest_15',\n       'Nearest_16', 'Nearest_17', 'Nearest_18', 'Nearest_19', 'Nearest_20',\n       'Nearest_21', 'Nearest_22', 'Nearest_23', 'Nearest_24', 'Land_Use',\n       'VCI_AVE', 'TCI_AVE', 'VHI_AVE', 'VCI_TOT', 'TCI_TOT', 'VHI_TOT',\n       'FWI_1_days_ago', 'VPD_1_days_ago', 'P_1_days_ago', 'FRP_1_days_ago',\n       'FWI_2_days_ago', 'VPD_2_days_ago', 'P_2_days_ago', 'FRP_2_days_ago',\n       'FWI_3_days_ago', 'VPD_3_days_ago', 'P_3_days_ago', 'FRP_3_days_ago',\n       'FWI_4_days_ago', 'VPD_4_days_ago', 'P_4_days_ago', 'FRP_4_days_ago',\n       'FWI_5_days_ago', 'VPD_5_days_ago', 'P_5_days_ago', 'FRP_5_days_ago',\n       'FWI_6_days_ago', 'VPD_6_days_ago', 'P_6_days_ago', 'FRP_6_days_ago',\n       'FWI_7_days_ago', 'VPD_7_days_ago', 'P_7_days_ago', 'FRP_7_days_ago',\n       'Predicted_FRP'],\n      dtype='object')\nPrediction results are saved to /groups/ESS3/zsun/firecasting/data/output/output_tabnet_window_7_days_forecasting_with_new_yunyao_window_time_series_landuse_vhi_latlon//20210704/firedata_20210709_predicted.txt\n['Mean Absolute Error (MAE): 22.440432919858303', 'Mean Squared Error (MSE): 27325.40163029674', 'Root Mean Squared Error (RMSE): 165.30396737615447', 'R-squared (R2) Score: -0.01682856907811847', 'Explained Variance Score: 2.1520659967078082e-05', 'Median Absolute Error (MedAE): 0.0', 'Max Error: 19604.529801375353', 'Mean: -21.276627506582255', 'Median: 0.0', 'Standard Deviation: 163.93088800132404', 'Minimum: -999.0', 'Maximum: 19605.007812', 'Count: 156861']\nMetrics saved to /groups/ESS3/zsun/firecasting/data/output/output_tabnet_window_7_days_forecasting_with_new_yunyao_window_time_series_landuse_vhi_latlon//20210704/metrics_20210709_predicted.txt\npredicting:  20210710\nRead from original folder for current date: 20210710\nReading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210710.txt\nreading past files for 2021-07-09 00:00:00\nreading from predicted folder\ncurrent final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n0 -999.0 -999.0  0.0  ...  101617.460938          -999.0            0.0\n1 -999.0 -999.0  0.0  ...  101617.460938          -999.0            0.0\n2 -999.0 -999.0  0.0  ...  101612.257812          -999.0            0.0\n3 -999.0 -999.0  0.0  ...  101612.257812          -999.0            0.0\n4 -999.0 -999.0  0.0  ...  101606.257812          -999.0            0.0\n[5 rows x 72 columns]\nrenaming Predicted_FRP to FRP\nremove the current predicted_frp\nreading past files for 2021-07-08 00:00:00\nreading from predicted folder\ncurrent final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n0 -999.0 -999.0  0.0  ...  101530.867188          -999.0            0.0\n1 -999.0 -999.0  0.0  ...  101530.867188          -999.0            0.0\n2 -999.0 -999.0  0.0  ...  101528.468750          -999.0            0.0\n3 -999.0 -999.0  0.0  ...  101528.468750          -999.0            0.0\n4 -999.0 -999.0  0.0  ...  101526.070312          -999.0            0.0\n[5 rows x 72 columns]\nrenaming Predicted_FRP to FRP\nremove the current predicted_frp\nreading past files for 2021-07-07 00:00:00\nreading from predicted folder\ncurrent final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n0 -999.0 -999.0  0.0  ...  101381.734375          -999.0            0.0\n1 -999.0 -999.0  0.0  ...  101381.734375          -999.0            0.0\n2 -999.0 -999.0  0.0  ...  101376.140625          -999.0            0.0\n3 -999.0 -999.0  0.0  ...  101376.140625          -999.0            0.0\n4 -999.0 -999.0  0.0  ...  101371.742188          -999.0            0.0\n[5 rows x 72 columns]\nrenaming Predicted_FRP to FRP\nremove the current predicted_frp\nreading past files for 2021-07-06 00:00:00\nreading from predicted folder\ncurrent final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n0 -999.0 -999.0  0.0  ...  101329.468750          -999.0            0.0\n1 -999.0 -999.0  0.0  ...  101329.468750          -999.0            0.0\n2 -999.0 -999.0  0.0  ...  101317.062500          -999.0            0.0\n3 -999.0 -999.0  0.0  ...  101317.062500          -999.0            0.0\n4 -999.0 -999.0  0.0  ...  101301.859375          -999.0            0.0\n[5 rows x 72 columns]\nrenaming Predicted_FRP to FRP\nremove the current predicted_frp\nreading past files for 2021-07-05 00:00:00\nreading from predicted folder\ncurrent final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n0 -999.0 -999.0  0.0  ...  101352.601562          -999.0            0.0\n1 -999.0 -999.0  0.0  ...  101352.601562          -999.0            0.0\n2 -999.0 -999.0  0.0  ...  101336.601562          -999.0            0.0\n3 -999.0 -999.0  0.0  ...  101336.601562          -999.0            0.0\n4 -999.0 -999.0  0.0  ...  101320.203125          -999.0            0.0\n[5 rows x 72 columns]\nrenaming Predicted_FRP to FRP\nremove the current predicted_frp\nreading past files for 2021-07-04 00:00:00\nreading from predicted folder\ncurrent final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n0 -999.0 -999.0  0.0  ...  101521.437500          -999.0            0.0\n1 -999.0 -999.0  0.0  ...  101521.437500          -999.0            0.0\n2 -999.0 -999.0  0.0  ...  101507.437500          -999.0            0.0\n3 -999.0 -999.0  0.0  ...  101507.437500          -999.0            0.0\n4 -999.0 -999.0  0.0  ...  101494.640625          -999.0            0.0\n[5 rows x 72 columns]\nrenaming Predicted_FRP to FRP\nremove the current predicted_frp\nreading past files for 2021-07-03 00:00:00\nreading from original folder\nReading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210703.txt\nNew time series dataframe:      LAT         LON    FRP  ...  VPD_7_days_ago   P_7_days_ago  FRP_7_days_ago\n0  24.5 -126.000000 -999.0  ...          -999.0  101664.703125          -999.0\n1  24.5 -125.899994 -999.0  ...          -999.0  101664.703125          -999.0\n2  24.5 -125.800003 -999.0  ...          -999.0  101656.296875          -999.0\n3  24.5 -125.699997 -999.0  ...          -999.0  101656.296875          -999.0\n4  24.5 -125.599998 -999.0  ...          -999.0  101647.101562          -999.0\n[5 rows x 74 columns]\nOriginal df is created:  (156861, 74)\nOriginal df filled the na with -9999 \nX and y are loaded into memory for 20210710\nthe loaded model is:  TabNetRegressor(n_d=17, n_a=41, n_steps=4, gamma=1.1546672563068268, cat_idxs=[], cat_dims=[], cat_emb_dim=[], n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.00042602006758391, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=71, output_dim=1, device_name='auto', n_shared_decoder=1, n_indep_decoder=1, grouped_features=[])\nLoaded model is a TabNet model.\nPrediction for 20210710 of start day 20210704 is finished\nnew columns to check:  ['FRP_1_days_ago', 'Nearest_1', 'Nearest_2', 'Nearest_3', 'Nearest_4', 'Nearest_5', 'Nearest_6', 'Nearest_7', 'Nearest_8']\ncurrent merged_df columns:  Index(['FWI', 'VPD', 'HT', 'T', 'RH', 'U', 'V', 'P', 'RAIN', 'CAPE', 'ST',\n       'SM', 'Nearest_1', 'Nearest_2', 'Nearest_3', 'Nearest_4', 'Nearest_5',\n       'Nearest_6', 'Nearest_7', 'Nearest_8', 'Nearest_9', 'Nearest_10',\n       'Nearest_11', 'Nearest_12', 'Nearest_13', 'Nearest_14', 'Nearest_15',\n       'Nearest_16', 'Nearest_17', 'Nearest_18', 'Nearest_19', 'Nearest_20',\n       'Nearest_21', 'Nearest_22', 'Nearest_23', 'Nearest_24', 'Land_Use',\n       'VCI_AVE', 'TCI_AVE', 'VHI_AVE', 'VCI_TOT', 'TCI_TOT', 'VHI_TOT',\n       'FWI_1_days_ago', 'VPD_1_days_ago', 'P_1_days_ago', 'FRP_1_days_ago',\n       'FWI_2_days_ago', 'VPD_2_days_ago', 'P_2_days_ago', 'FRP_2_days_ago',\n       'FWI_3_days_ago', 'VPD_3_days_ago', 'P_3_days_ago', 'FRP_3_days_ago',\n       'FWI_4_days_ago', 'VPD_4_days_ago', 'P_4_days_ago', 'FRP_4_days_ago',\n       'FWI_5_days_ago', 'VPD_5_days_ago', 'P_5_days_ago', 'FRP_5_days_ago',\n       'FWI_6_days_ago', 'VPD_6_days_ago', 'P_6_days_ago', 'FRP_6_days_ago',\n       'FWI_7_days_ago', 'VPD_7_days_ago', 'P_7_days_ago', 'FRP_7_days_ago',\n       'Predicted_FRP'],\n      dtype='object')\nPrediction results are saved to /groups/ESS3/zsun/firecasting/data/output/output_tabnet_window_7_days_forecasting_with_new_yunyao_window_time_series_landuse_vhi_latlon//20210704/firedata_20210710_predicted.txt\n['Mean Absolute Error (MAE): 22.548021310127837', 'Mean Squared Error (MSE): 29426.035618749615', 'Root Mean Squared Error (RMSE): 171.54018659996152', 'R-squared (R2) Score: -0.023609442641569833', 'Explained Variance Score: -0.0078091901539010244', 'Median Absolute Error (MedAE): 0.0', 'Max Error: 23213.004525149645', 'Mean: -21.179196243725322', 'Median: 0.0', 'Standard Deviation: 169.55090832070005', 'Minimum: -999.0', 'Maximum: 23213.011719', 'Count: 156861']\nMetrics saved to /groups/ESS3/zsun/firecasting/data/output/output_tabnet_window_7_days_forecasting_with_new_yunyao_window_time_series_landuse_vhi_latlon//20210704/metrics_20210710_predicted.txt\ncurrent date:  2021-07-05 00:00:00\nsingle_day_current_date =  2021-07-05 00:00:00\nsingle_day_predict_end_date =  2021-07-12 00:00:00\npredicting:  20210705\nRead from original folder for current date: 20210705\nReading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210705.txt\nreading past files for 2021-07-04 00:00:00\nreading from original folder\nReading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210704.txt\nreading past files for 2021-07-03 00:00:00\nreading from original folder\nReading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210703.txt\nreading past files for 2021-07-02 00:00:00\nreading from original folder\nReading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210702.txt\nreading past files for 2021-07-01 00:00:00\nreading from original folder\nReading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210701.txt\nreading past files for 2021-06-30 00:00:00\nreading from original folder\nReading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210630.txt\nreading past files for 2021-06-29 00:00:00\nreading from original folder\nReading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210629.txt\nreading past files for 2021-06-28 00:00:00\nreading from original folder\nReading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210628.txt\nNew time series dataframe:      LAT         LON    FRP  ...  VPD_7_days_ago   P_7_days_ago  FRP_7_days_ago\n0  24.5 -126.000000 -999.0  ...          -999.0  101352.601562          -999.0\n1  24.5 -125.899994 -999.0  ...          -999.0  101352.601562          -999.0\n2  24.5 -125.800003 -999.0  ...          -999.0  101336.601562          -999.0\n3  24.5 -125.699997 -999.0  ...          -999.0  101336.601562          -999.0\n4  24.5 -125.599998 -999.0  ...          -999.0  101320.203125          -999.0\n[5 rows x 74 columns]\nOriginal df is created:  (156861, 74)\nOriginal df filled the na with -9999 \nX and y are loaded into memory for 20210705\nthe loaded model is:  TabNetRegressor(n_d=17, n_a=41, n_steps=4, gamma=1.1546672563068268, cat_idxs=[], cat_dims=[], cat_emb_dim=[], n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.00042602006758391, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=71, output_dim=1, device_name='auto', n_shared_decoder=1, n_indep_decoder=1, grouped_features=[])\nLoaded model is a TabNet model.\nPrediction for 20210705 of start day 20210705 is finished\nnew columns to check:  ['FRP_1_days_ago', 'Nearest_1', 'Nearest_2', 'Nearest_3', 'Nearest_4', 'Nearest_5', 'Nearest_6', 'Nearest_7', 'Nearest_8']\ncurrent merged_df columns:  Index(['FWI', 'VPD', 'HT', 'T', 'RH', 'U', 'V', 'P', 'RAIN', 'CAPE', 'ST',\n       'SM', 'Nearest_1', 'Nearest_2', 'Nearest_3', 'Nearest_4', 'Nearest_5',\n       'Nearest_6', 'Nearest_7', 'Nearest_8', 'Nearest_9', 'Nearest_10',\n       'Nearest_11', 'Nearest_12', 'Nearest_13', 'Nearest_14', 'Nearest_15',\n       'Nearest_16', 'Nearest_17', 'Nearest_18', 'Nearest_19', 'Nearest_20',\n       'Nearest_21', 'Nearest_22', 'Nearest_23', 'Nearest_24', 'Land_Use',\n       'VCI_AVE', 'TCI_AVE', 'VHI_AVE', 'VCI_TOT', 'TCI_TOT', 'VHI_TOT',\n       'FWI_1_days_ago', 'VPD_1_days_ago', 'P_1_days_ago', 'FRP_1_days_ago',\n       'FWI_2_days_ago', 'VPD_2_days_ago', 'P_2_days_ago', 'FRP_2_days_ago',\n       'FWI_3_days_ago', 'VPD_3_days_ago', 'P_3_days_ago', 'FRP_3_days_ago',\n       'FWI_4_days_ago', 'VPD_4_days_ago', 'P_4_days_ago', 'FRP_4_days_ago',\n       'FWI_5_days_ago', 'VPD_5_days_ago', 'P_5_days_ago', 'FRP_5_days_ago',\n       'FWI_6_days_ago', 'VPD_6_days_ago', 'P_6_days_ago', 'FRP_6_days_ago',\n       'FWI_7_days_ago', 'VPD_7_days_ago', 'P_7_days_ago', 'FRP_7_days_ago',\n       'Predicted_FRP'],\n      dtype='object')\nPrediction results are saved to /groups/ESS3/zsun/firecasting/data/output/output_tabnet_window_7_days_forecasting_with_new_yunyao_window_time_series_landuse_vhi_latlon//20210705/firedata_20210705_predicted.txt\n['Mean Absolute Error (MAE): 21.899653917612167', 'Mean Squared Error (MSE): 21849.942123667675', 'Root Mean Squared Error (RMSE): 147.8172592212008', 'R-squared (R2) Score: -0.022264801014086233', 'Explained Variance Score: 6.663320127886507e-07', 'Median Absolute Error (MedAE): 0.0', 'Max Error: 1216.7894160183182', 'Mean: -21.81510091978249', 'Median: 0.0', 'Standard Deviation: 146.19914277086232', 'Minimum: -999.0', 'Maximum: 1216.946899', 'Count: 156861']\nMetrics saved to /groups/ESS3/zsun/firecasting/data/output/output_tabnet_window_7_days_forecasting_with_new_yunyao_window_time_series_landuse_vhi_latlon//20210705/metrics_20210705_predicted.txt\npredicting:  20210706\nRead from original folder for current date: 20210706\nReading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210706.txt\nreading past files for 2021-07-05 00:00:00\nreading from predicted folder\ncurrent final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n0 -999.0 -999.0  0.0  ...  101352.601562          -999.0            0.0\n1 -999.0 -999.0  0.0  ...  101352.601562          -999.0            0.0\n2 -999.0 -999.0  0.0  ...  101336.601562          -999.0            0.0\n3 -999.0 -999.0  0.0  ...  101336.601562          -999.0            0.0\n4 -999.0 -999.0  0.0  ...  101320.203125          -999.0            0.0\n[5 rows x 72 columns]\nrenaming Predicted_FRP to FRP\nremove the current predicted_frp\nreading past files for 2021-07-04 00:00:00\nreading from original folder\nReading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210704.txt\nreading past files for 2021-07-03 00:00:00\nreading from original folder\nReading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210703.txt\nreading past files for 2021-07-02 00:00:00\nreading from original folder\nReading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210702.txt\nreading past files for 2021-07-01 00:00:00\nreading from original folder\nReading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210701.txt\nreading past files for 2021-06-30 00:00:00\nreading from original folder\nReading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210630.txt\nreading past files for 2021-06-29 00:00:00\nreading from original folder\nReading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210629.txt\nNew time series dataframe:      LAT         LON    FRP  ...  VPD_7_days_ago   P_7_days_ago  FRP_7_days_ago\n0  24.5 -126.000000 -999.0  ...          -999.0  101329.468750          -999.0\n1  24.5 -125.899994 -999.0  ...          -999.0  101329.468750          -999.0\n2  24.5 -125.800003 -999.0  ...          -999.0  101317.062500          -999.0\n3  24.5 -125.699997 -999.0  ...          -999.0  101317.062500          -999.0\n4  24.5 -125.599998 -999.0  ...          -999.0  101301.859375          -999.0\n[5 rows x 74 columns]\nOriginal df is created:  (156861, 74)\nOriginal df filled the na with -9999 \nX and y are loaded into memory for 20210706\nthe loaded model is:  TabNetRegressor(n_d=17, n_a=41, n_steps=4, gamma=1.1546672563068268, cat_idxs=[], cat_dims=[], cat_emb_dim=[], n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.00042602006758391, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=71, output_dim=1, device_name='auto', n_shared_decoder=1, n_indep_decoder=1, grouped_features=[])\nLoaded model is a TabNet model.\nPrediction for 20210706 of start day 20210705 is finished\nnew columns to check:  ['FRP_1_days_ago', 'Nearest_1', 'Nearest_2', 'Nearest_3', 'Nearest_4', 'Nearest_5', 'Nearest_6', 'Nearest_7', 'Nearest_8']\ncurrent merged_df columns:  Index(['FWI', 'VPD', 'HT', 'T', 'RH', 'U', 'V', 'P', 'RAIN', 'CAPE', 'ST',\n       'SM', 'Nearest_1', 'Nearest_2', 'Nearest_3', 'Nearest_4', 'Nearest_5',\n       'Nearest_6', 'Nearest_7', 'Nearest_8', 'Nearest_9', 'Nearest_10',\n       'Nearest_11', 'Nearest_12', 'Nearest_13', 'Nearest_14', 'Nearest_15',\n       'Nearest_16', 'Nearest_17', 'Nearest_18', 'Nearest_19', 'Nearest_20',\n       'Nearest_21', 'Nearest_22', 'Nearest_23', 'Nearest_24', 'Land_Use',\n       'VCI_AVE', 'TCI_AVE', 'VHI_AVE', 'VCI_TOT', 'TCI_TOT', 'VHI_TOT',\n       'FWI_1_days_ago', 'VPD_1_days_ago', 'P_1_days_ago', 'FRP_1_days_ago',\n       'FWI_2_days_ago', 'VPD_2_days_ago', 'P_2_days_ago', 'FRP_2_days_ago',\n       'FWI_3_days_ago', 'VPD_3_days_ago', 'P_3_days_ago', 'FRP_3_days_ago',\n       'FWI_4_days_ago', 'VPD_4_days_ago', 'P_4_days_ago', 'FRP_4_days_ago',\n       'FWI_5_days_ago', 'VPD_5_days_ago', 'P_5_days_ago', 'FRP_5_days_ago',\n       'FWI_6_days_ago', 'VPD_6_days_ago', 'P_6_days_ago', 'FRP_6_days_ago',\n       'FWI_7_days_ago', 'VPD_7_days_ago', 'P_7_days_ago', 'FRP_7_days_ago',\n       'Predicted_FRP'],\n      dtype='object')\nPrediction results are saved to /groups/ESS3/zsun/firecasting/data/output/output_tabnet_window_7_days_forecasting_with_new_yunyao_window_time_series_landuse_vhi_latlon//20210705/firedata_20210706_predicted.txt\n['Mean Absolute Error (MAE): 21.96844126434875', 'Mean Squared Error (MSE): 22237.571842753303', 'Root Mean Squared Error (RMSE): 149.1226738050029', 'R-squared (R2) Score: -0.021725681862043933', 'Explained Variance Score: 2.73175715370666e-06', 'Median Absolute Error (MedAE): 0.0', 'Max Error: 7547.461402141784', 'Mean: -21.746309589547433', 'Median: 0.0', 'Standard Deviation: 147.52917421844327', 'Minimum: -999.0', 'Maximum: 7547.473145', 'Count: 156861']\nMetrics saved to /groups/ESS3/zsun/firecasting/data/output/output_tabnet_window_7_days_forecasting_with_new_yunyao_window_time_series_landuse_vhi_latlon//20210705/metrics_20210706_predicted.txt\npredicting:  20210707\nRead from original folder for current date: 20210707\nReading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210707.txt\nreading past files for 2021-07-06 00:00:00\nreading from predicted folder\ncurrent final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n0 -999.0 -999.0  0.0  ...  101329.468750          -999.0            0.0\n1 -999.0 -999.0  0.0  ...  101329.468750          -999.0            0.0\n2 -999.0 -999.0  0.0  ...  101317.062500          -999.0            0.0\n3 -999.0 -999.0  0.0  ...  101317.062500          -999.0            0.0\n4 -999.0 -999.0  0.0  ...  101301.859375          -999.0            0.0\n[5 rows x 72 columns]\nrenaming Predicted_FRP to FRP\nremove the current predicted_frp\nreading past files for 2021-07-05 00:00:00\nreading from predicted folder\ncurrent final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n0 -999.0 -999.0  0.0  ...  101352.601562          -999.0            0.0\n1 -999.0 -999.0  0.0  ...  101352.601562          -999.0            0.0\n2 -999.0 -999.0  0.0  ...  101336.601562          -999.0            0.0\n3 -999.0 -999.0  0.0  ...  101336.601562          -999.0            0.0\n4 -999.0 -999.0  0.0  ...  101320.203125          -999.0            0.0\n[5 rows x 72 columns]\nrenaming Predicted_FRP to FRP\nremove the current predicted_frp\nreading past files for 2021-07-04 00:00:00\nreading from original folder\nReading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210704.txt\nreading past files for 2021-07-03 00:00:00\nreading from original folder\nReading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210703.txt\nreading past files for 2021-07-02 00:00:00\nreading from original folder\nReading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210702.txt\nreading past files for 2021-07-01 00:00:00\nreading from original folder\nReading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210701.txt\nreading past files for 2021-06-30 00:00:00\nreading from original folder\nReading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210630.txt\nNew time series dataframe:      LAT         LON    FRP  ...  VPD_7_days_ago   P_7_days_ago  FRP_7_days_ago\n0  24.5 -126.000000 -999.0  ...          -999.0  101381.734375          -999.0\n1  24.5 -125.899994 -999.0  ...          -999.0  101381.734375          -999.0\n2  24.5 -125.800003 -999.0  ...          -999.0  101376.140625          -999.0\n3  24.5 -125.699997 -999.0  ...          -999.0  101376.140625          -999.0\n4  24.5 -125.599998 -999.0  ...          -999.0  101371.742188          -999.0\n[5 rows x 74 columns]\nOriginal df is created:  (156861, 74)\nOriginal df filled the na with -9999 \nX and y are loaded into memory for 20210707\nthe loaded model is:  TabNetRegressor(n_d=17, n_a=41, n_steps=4, gamma=1.1546672563068268, cat_idxs=[], cat_dims=[], cat_emb_dim=[], n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.00042602006758391, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=71, output_dim=1, device_name='auto', n_shared_decoder=1, n_indep_decoder=1, grouped_features=[])\nLoaded model is a TabNet model.\nPrediction for 20210707 of start day 20210705 is finished\nnew columns to check:  ['FRP_1_days_ago', 'Nearest_1', 'Nearest_2', 'Nearest_3', 'Nearest_4', 'Nearest_5', 'Nearest_6', 'Nearest_7', 'Nearest_8']\ncurrent merged_df columns:  Index(['FWI', 'VPD', 'HT', 'T', 'RH', 'U', 'V', 'P', 'RAIN', 'CAPE', 'ST',\n       'SM', 'Nearest_1', 'Nearest_2', 'Nearest_3', 'Nearest_4', 'Nearest_5',\n       'Nearest_6', 'Nearest_7', 'Nearest_8', 'Nearest_9', 'Nearest_10',\n       'Nearest_11', 'Nearest_12', 'Nearest_13', 'Nearest_14', 'Nearest_15',\n       'Nearest_16', 'Nearest_17', 'Nearest_18', 'Nearest_19', 'Nearest_20',\n       'Nearest_21', 'Nearest_22', 'Nearest_23', 'Nearest_24', 'Land_Use',\n       'VCI_AVE', 'TCI_AVE', 'VHI_AVE', 'VCI_TOT', 'TCI_TOT', 'VHI_TOT',\n       'FWI_1_days_ago', 'VPD_1_days_ago', 'P_1_days_ago', 'FRP_1_days_ago',\n       'FWI_2_days_ago', 'VPD_2_days_ago', 'P_2_days_ago', 'FRP_2_days_ago',\n       'FWI_3_days_ago', 'VPD_3_days_ago', 'P_3_days_ago', 'FRP_3_days_ago',\n       'FWI_4_days_ago', 'VPD_4_days_ago', 'P_4_days_ago', 'FRP_4_days_ago',\n       'FWI_5_days_ago', 'VPD_5_days_ago', 'P_5_days_ago', 'FRP_5_days_ago',\n       'FWI_6_days_ago', 'VPD_6_days_ago', 'P_6_days_ago', 'FRP_6_days_ago',\n       'FWI_7_days_ago', 'VPD_7_days_ago', 'P_7_days_ago', 'FRP_7_days_ago',\n       'Predicted_FRP'],\n      dtype='object')\nPrediction results are saved to /groups/ESS3/zsun/firecasting/data/output/output_tabnet_window_7_days_forecasting_with_new_yunyao_window_time_series_landuse_vhi_latlon//20210705/firedata_20210707_predicted.txt\n['Mean Absolute Error (MAE): 22.085057620031762', 'Mean Squared Error (MSE): 23056.240177608146', 'Root Mean Squared Error (RMSE): 151.84281404665862', 'R-squared (R2) Score: -0.020717364728818577', 'Explained Variance Score: -1.3288390667831607e-06', 'Median Absolute Error (MedAE): 0.0', 'Max Error: 11733.88396489434', 'Mean: -21.630771051147192', 'Median: 0.0', 'Standard Deviation: 150.29442683250224', 'Minimum: -999.0', 'Maximum: 11733.90625', 'Count: 156861']\nMetrics saved to /groups/ESS3/zsun/firecasting/data/output/output_tabnet_window_7_days_forecasting_with_new_yunyao_window_time_series_landuse_vhi_latlon//20210705/metrics_20210707_predicted.txt\npredicting:  20210708\nRead from original folder for current date: 20210708\nReading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210708.txt\nreading past files for 2021-07-07 00:00:00\nreading from predicted folder\ncurrent final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n0 -999.0 -999.0  0.0  ...  101381.734375          -999.0            0.0\n1 -999.0 -999.0  0.0  ...  101381.734375          -999.0            0.0\n2 -999.0 -999.0  0.0  ...  101376.140625          -999.0            0.0\n3 -999.0 -999.0  0.0  ...  101376.140625          -999.0            0.0\n4 -999.0 -999.0  0.0  ...  101371.742188          -999.0            0.0\n[5 rows x 72 columns]\nrenaming Predicted_FRP to FRP\nremove the current predicted_frp\nreading past files for 2021-07-06 00:00:00\nreading from predicted folder\ncurrent final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n0 -999.0 -999.0  0.0  ...  101329.468750          -999.0            0.0\n1 -999.0 -999.0  0.0  ...  101329.468750          -999.0            0.0\n2 -999.0 -999.0  0.0  ...  101317.062500          -999.0            0.0\n3 -999.0 -999.0  0.0  ...  101317.062500          -999.0            0.0\n4 -999.0 -999.0  0.0  ...  101301.859375          -999.0            0.0\n[5 rows x 72 columns]\nrenaming Predicted_FRP to FRP\nremove the current predicted_frp\nreading past files for 2021-07-05 00:00:00\nreading from predicted folder\ncurrent final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n0 -999.0 -999.0  0.0  ...  101352.601562          -999.0            0.0\n1 -999.0 -999.0  0.0  ...  101352.601562          -999.0            0.0\n2 -999.0 -999.0  0.0  ...  101336.601562          -999.0            0.0\n3 -999.0 -999.0  0.0  ...  101336.601562          -999.0            0.0\n4 -999.0 -999.0  0.0  ...  101320.203125          -999.0            0.0\n[5 rows x 72 columns]\nrenaming Predicted_FRP to FRP\nremove the current predicted_frp\nreading past files for 2021-07-04 00:00:00\nreading from original folder\nReading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210704.txt\nreading past files for 2021-07-03 00:00:00\nreading from original folder\nReading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210703.txt\nreading past files for 2021-07-02 00:00:00\nreading from original folder\nReading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210702.txt\nreading past files for 2021-07-01 00:00:00\nreading from original folder\nReading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210701.txt\nNew time series dataframe:      LAT         LON    FRP  ...  VPD_7_days_ago   P_7_days_ago  FRP_7_days_ago\n0  24.5 -126.000000 -999.0  ...          -999.0  101530.867188          -999.0\n1  24.5 -125.899994 -999.0  ...          -999.0  101530.867188          -999.0\n2  24.5 -125.800003 -999.0  ...          -999.0  101528.468750          -999.0\n3  24.5 -125.699997 -999.0  ...          -999.0  101528.468750          -999.0\n4  24.5 -125.599998 -999.0  ...          -999.0  101526.070312          -999.0\n[5 rows x 74 columns]\nOriginal df is created:  (156861, 74)\nOriginal df filled the na with -9999 \nX and y are loaded into memory for 20210708\nthe loaded model is:  TabNetRegressor(n_d=17, n_a=41, n_steps=4, gamma=1.1546672563068268, cat_idxs=[], cat_dims=[], cat_emb_dim=[], n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.00042602006758391, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=71, output_dim=1, device_name='auto', n_shared_decoder=1, n_indep_decoder=1, grouped_features=[])\nLoaded model is a TabNet model.\nPrediction for 20210708 of start day 20210705 is finished\nnew columns to check:  ['FRP_1_days_ago', 'Nearest_1', 'Nearest_2', 'Nearest_3', 'Nearest_4', 'Nearest_5', 'Nearest_6', 'Nearest_7', 'Nearest_8']\ncurrent merged_df columns:  Index(['FWI', 'VPD', 'HT', 'T', 'RH', 'U', 'V', 'P', 'RAIN', 'CAPE', 'ST',\n       'SM', 'Nearest_1', 'Nearest_2', 'Nearest_3', 'Nearest_4', 'Nearest_5',\n       'Nearest_6', 'Nearest_7', 'Nearest_8', 'Nearest_9', 'Nearest_10',\n       'Nearest_11', 'Nearest_12', 'Nearest_13', 'Nearest_14', 'Nearest_15',\n       'Nearest_16', 'Nearest_17', 'Nearest_18', 'Nearest_19', 'Nearest_20',\n       'Nearest_21', 'Nearest_22', 'Nearest_23', 'Nearest_24', 'Land_Use',\n       'VCI_AVE', 'TCI_AVE', 'VHI_AVE', 'VCI_TOT', 'TCI_TOT', 'VHI_TOT',\n       'FWI_1_days_ago', 'VPD_1_days_ago', 'P_1_days_ago', 'FRP_1_days_ago',\n       'FWI_2_days_ago', 'VPD_2_days_ago', 'P_2_days_ago', 'FRP_2_days_ago',\n       'FWI_3_days_ago', 'VPD_3_days_ago', 'P_3_days_ago', 'FRP_3_days_ago',\n       'FWI_4_days_ago', 'VPD_4_days_ago', 'P_4_days_ago', 'FRP_4_days_ago',\n       'FWI_5_days_ago', 'VPD_5_days_ago', 'P_5_days_ago', 'FRP_5_days_ago',\n       'FWI_6_days_ago', 'VPD_6_days_ago', 'P_6_days_ago', 'FRP_6_days_ago',\n       'FWI_7_days_ago', 'VPD_7_days_ago', 'P_7_days_ago', 'FRP_7_days_ago',\n       'Predicted_FRP'],\n      dtype='object')\nPrediction results are saved to /groups/ESS3/zsun/firecasting/data/output/output_tabnet_window_7_days_forecasting_with_new_yunyao_window_time_series_landuse_vhi_latlon//20210705/firedata_20210708_predicted.txt\n['Mean Absolute Error (MAE): 22.020365526157462', 'Mean Squared Error (MSE): 22179.355213667073', 'Root Mean Squared Error (RMSE): 148.92734877673433', 'R-squared (R2) Score: -0.02167589498864886', 'Explained Variance Score: 4.8534510974640455e-06', 'Median Absolute Error (MedAE): 0.0', 'Max Error: 5463.914419518793', 'Mean: -21.694544765945654', 'Median: 0.0', 'Standard Deviation: 147.33952624013253', 'Minimum: -999.0', 'Maximum: 5464.172363', 'Count: 156861']\nMetrics saved to /groups/ESS3/zsun/firecasting/data/output/output_tabnet_window_7_days_forecasting_with_new_yunyao_window_time_series_landuse_vhi_latlon//20210705/metrics_20210708_predicted.txt\npredicting:  20210709\nRead from original folder for current date: 20210709\nReading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210709.txt\nreading past files for 2021-07-08 00:00:00\nreading from predicted folder\ncurrent final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n0 -999.0 -999.0  0.0  ...  101530.867188          -999.0            0.0\n1 -999.0 -999.0  0.0  ...  101530.867188          -999.0            0.0\n2 -999.0 -999.0  0.0  ...  101528.468750          -999.0            0.0\n3 -999.0 -999.0  0.0  ...  101528.468750          -999.0            0.0\n4 -999.0 -999.0  0.0  ...  101526.070312          -999.0            0.0\n[5 rows x 72 columns]\nrenaming Predicted_FRP to FRP\nremove the current predicted_frp\nreading past files for 2021-07-07 00:00:00\nreading from predicted folder\ncurrent final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n0 -999.0 -999.0  0.0  ...  101381.734375          -999.0            0.0\n1 -999.0 -999.0  0.0  ...  101381.734375          -999.0            0.0\n2 -999.0 -999.0  0.0  ...  101376.140625          -999.0            0.0\n3 -999.0 -999.0  0.0  ...  101376.140625          -999.0            0.0\n4 -999.0 -999.0  0.0  ...  101371.742188          -999.0            0.0\n[5 rows x 72 columns]\nrenaming Predicted_FRP to FRP\nremove the current predicted_frp\nreading past files for 2021-07-06 00:00:00\nreading from predicted folder\ncurrent final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n0 -999.0 -999.0  0.0  ...  101329.468750          -999.0            0.0\n1 -999.0 -999.0  0.0  ...  101329.468750          -999.0            0.0\n2 -999.0 -999.0  0.0  ...  101317.062500          -999.0            0.0\n3 -999.0 -999.0  0.0  ...  101317.062500          -999.0            0.0\n4 -999.0 -999.0  0.0  ...  101301.859375          -999.0            0.0\n[5 rows x 72 columns]\nrenaming Predicted_FRP to FRP\nremove the current predicted_frp\nreading past files for 2021-07-05 00:00:00\nreading from predicted folder\ncurrent final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n0 -999.0 -999.0  0.0  ...  101352.601562          -999.0            0.0\n1 -999.0 -999.0  0.0  ...  101352.601562          -999.0            0.0\n2 -999.0 -999.0  0.0  ...  101336.601562          -999.0            0.0\n3 -999.0 -999.0  0.0  ...  101336.601562          -999.0            0.0\n4 -999.0 -999.0  0.0  ...  101320.203125          -999.0            0.0\n[5 rows x 72 columns]\nrenaming Predicted_FRP to FRP\nremove the current predicted_frp\nreading past files for 2021-07-04 00:00:00\nreading from original folder\nReading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210704.txt\nreading past files for 2021-07-03 00:00:00\nreading from original folder\nReading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210703.txt\nreading past files for 2021-07-02 00:00:00\nreading from original folder\nReading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210702.txt\nNew time series dataframe:      LAT         LON    FRP  ...  VPD_7_days_ago   P_7_days_ago  FRP_7_days_ago\n0  24.5 -126.000000 -999.0  ...          -999.0  101617.460938          -999.0\n1  24.5 -125.899994 -999.0  ...          -999.0  101617.460938          -999.0\n2  24.5 -125.800003 -999.0  ...          -999.0  101612.257812          -999.0\n3  24.5 -125.699997 -999.0  ...          -999.0  101612.257812          -999.0\n4  24.5 -125.599998 -999.0  ...          -999.0  101606.257812          -999.0\n[5 rows x 74 columns]\nOriginal df is created:  (156861, 74)\nOriginal df filled the na with -9999 \nX and y are loaded into memory for 20210709\nthe loaded model is:  TabNetRegressor(n_d=17, n_a=41, n_steps=4, gamma=1.1546672563068268, cat_idxs=[], cat_dims=[], cat_emb_dim=[], n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.00042602006758391, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=71, output_dim=1, device_name='auto', n_shared_decoder=1, n_indep_decoder=1, grouped_features=[])\nLoaded model is a TabNet model.\nPrediction for 20210709 of start day 20210705 is finished\nnew columns to check:  ['FRP_1_days_ago', 'Nearest_1', 'Nearest_2', 'Nearest_3', 'Nearest_4', 'Nearest_5', 'Nearest_6', 'Nearest_7', 'Nearest_8']\ncurrent merged_df columns:  Index(['FWI', 'VPD', 'HT', 'T', 'RH', 'U', 'V', 'P', 'RAIN', 'CAPE', 'ST',\n       'SM', 'Nearest_1', 'Nearest_2', 'Nearest_3', 'Nearest_4', 'Nearest_5',\n       'Nearest_6', 'Nearest_7', 'Nearest_8', 'Nearest_9', 'Nearest_10',\n       'Nearest_11', 'Nearest_12', 'Nearest_13', 'Nearest_14', 'Nearest_15',\n       'Nearest_16', 'Nearest_17', 'Nearest_18', 'Nearest_19', 'Nearest_20',\n       'Nearest_21', 'Nearest_22', 'Nearest_23', 'Nearest_24', 'Land_Use',\n       'VCI_AVE', 'TCI_AVE', 'VHI_AVE', 'VCI_TOT', 'TCI_TOT', 'VHI_TOT',\n       'FWI_1_days_ago', 'VPD_1_days_ago', 'P_1_days_ago', 'FRP_1_days_ago',\n       'FWI_2_days_ago', 'VPD_2_days_ago', 'P_2_days_ago', 'FRP_2_days_ago',\n       'FWI_3_days_ago', 'VPD_3_days_ago', 'P_3_days_ago', 'FRP_3_days_ago',\n       'FWI_4_days_ago', 'VPD_4_days_ago', 'P_4_days_ago', 'FRP_4_days_ago',\n       'FWI_5_days_ago', 'VPD_5_days_ago', 'P_5_days_ago', 'FRP_5_days_ago',\n       'FWI_6_days_ago', 'VPD_6_days_ago', 'P_6_days_ago', 'FRP_6_days_ago',\n       'FWI_7_days_ago', 'VPD_7_days_ago', 'P_7_days_ago', 'FRP_7_days_ago',\n       'Predicted_FRP'],\n      dtype='object')\nPrediction results are saved to /groups/ESS3/zsun/firecasting/data/output/output_tabnet_window_7_days_forecasting_with_new_yunyao_window_time_series_landuse_vhi_latlon//20210705/firedata_20210709_predicted.txt\n['Mean Absolute Error (MAE): 22.44040970785812', 'Mean Squared Error (MSE): 27325.40162973838', 'Root Mean Squared Error (RMSE): 165.30396737446557', 'R-squared (R2) Score: -0.01682856905734087', 'Explained Variance Score: 2.148406774149514e-05', 'Median Absolute Error (MedAE): 0.0', 'Max Error: 19604.529801375353', 'Mean: -21.276627506582255', 'Median: 0.0', 'Standard Deviation: 163.93088800132404', 'Minimum: -999.0', 'Maximum: 19605.007812', 'Count: 156861']\nMetrics saved to /groups/ESS3/zsun/firecasting/data/output/output_tabnet_window_7_days_forecasting_with_new_yunyao_window_time_series_landuse_vhi_latlon//20210705/metrics_20210709_predicted.txt\npredicting:  20210710\nRead from original folder for current date: 20210710\nReading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210710.txt\nreading past files for 2021-07-09 00:00:00\nreading from predicted folder\ncurrent final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n0 -999.0 -999.0  0.0  ...  101617.460938          -999.0            0.0\n1 -999.0 -999.0  0.0  ...  101617.460938          -999.0            0.0\n2 -999.0 -999.0  0.0  ...  101612.257812          -999.0            0.0\n3 -999.0 -999.0  0.0  ...  101612.257812          -999.0            0.0\n4 -999.0 -999.0  0.0  ...  101606.257812          -999.0            0.0\n[5 rows x 72 columns]\nrenaming Predicted_FRP to FRP\nremove the current predicted_frp\nreading past files for 2021-07-08 00:00:00\nreading from predicted folder\ncurrent final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n0 -999.0 -999.0  0.0  ...  101530.867188          -999.0            0.0\n1 -999.0 -999.0  0.0  ...  101530.867188          -999.0            0.0\n2 -999.0 -999.0  0.0  ...  101528.468750          -999.0            0.0\n3 -999.0 -999.0  0.0  ...  101528.468750          -999.0            0.0\n4 -999.0 -999.0  0.0  ...  101526.070312          -999.0            0.0\n[5 rows x 72 columns]\nrenaming Predicted_FRP to FRP\nremove the current predicted_frp\nreading past files for 2021-07-07 00:00:00\nreading from predicted folder\ncurrent final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n0 -999.0 -999.0  0.0  ...  101381.734375          -999.0            0.0\n1 -999.0 -999.0  0.0  ...  101381.734375          -999.0            0.0\n2 -999.0 -999.0  0.0  ...  101376.140625          -999.0            0.0\n3 -999.0 -999.0  0.0  ...  101376.140625          -999.0            0.0\n4 -999.0 -999.0  0.0  ...  101371.742188          -999.0            0.0\n[5 rows x 72 columns]\nrenaming Predicted_FRP to FRP\nremove the current predicted_frp\nreading past files for 2021-07-06 00:00:00\nreading from predicted folder\ncurrent final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n0 -999.0 -999.0  0.0  ...  101329.468750          -999.0            0.0\n1 -999.0 -999.0  0.0  ...  101329.468750          -999.0            0.0\n2 -999.0 -999.0  0.0  ...  101317.062500          -999.0            0.0\n3 -999.0 -999.0  0.0  ...  101317.062500          -999.0            0.0\n4 -999.0 -999.0  0.0  ...  101301.859375          -999.0            0.0\n[5 rows x 72 columns]\nrenaming Predicted_FRP to FRP\nremove the current predicted_frp\nreading past files for 2021-07-05 00:00:00\nreading from predicted folder\ncurrent final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n0 -999.0 -999.0  0.0  ...  101352.601562          -999.0            0.0\n1 -999.0 -999.0  0.0  ...  101352.601562          -999.0            0.0\n2 -999.0 -999.0  0.0  ...  101336.601562          -999.0            0.0\n3 -999.0 -999.0  0.0  ...  101336.601562          -999.0            0.0\n4 -999.0 -999.0  0.0  ...  101320.203125          -999.0            0.0\n[5 rows x 72 columns]\nrenaming Predicted_FRP to FRP\nremove the current predicted_frp\nreading past files for 2021-07-04 00:00:00\nreading from original folder\nReading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210704.txt\nreading past files for 2021-07-03 00:00:00\nreading from original folder\nReading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210703.txt\nNew time series dataframe:      LAT         LON    FRP  ...  VPD_7_days_ago   P_7_days_ago  FRP_7_days_ago\n0  24.5 -126.000000 -999.0  ...          -999.0  101664.703125          -999.0\n1  24.5 -125.899994 -999.0  ...          -999.0  101664.703125          -999.0\n2  24.5 -125.800003 -999.0  ...          -999.0  101656.296875          -999.0\n3  24.5 -125.699997 -999.0  ...          -999.0  101656.296875          -999.0\n4  24.5 -125.599998 -999.0  ...          -999.0  101647.101562          -999.0\n[5 rows x 74 columns]\nOriginal df is created:  (156861, 74)\nOriginal df filled the na with -9999 \nX and y are loaded into memory for 20210710\nthe loaded model is:  TabNetRegressor(n_d=17, n_a=41, n_steps=4, gamma=1.1546672563068268, cat_idxs=[], cat_dims=[], cat_emb_dim=[], n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.00042602006758391, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=71, output_dim=1, device_name='auto', n_shared_decoder=1, n_indep_decoder=1, grouped_features=[])\nLoaded model is a TabNet model.\nPrediction for 20210710 of start day 20210705 is finished\nnew columns to check:  ['FRP_1_days_ago', 'Nearest_1', 'Nearest_2', 'Nearest_3', 'Nearest_4', 'Nearest_5', 'Nearest_6', 'Nearest_7', 'Nearest_8']\ncurrent merged_df columns:  Index(['FWI', 'VPD', 'HT', 'T', 'RH', 'U', 'V', 'P', 'RAIN', 'CAPE', 'ST',\n       'SM', 'Nearest_1', 'Nearest_2', 'Nearest_3', 'Nearest_4', 'Nearest_5',\n       'Nearest_6', 'Nearest_7', 'Nearest_8', 'Nearest_9', 'Nearest_10',\n       'Nearest_11', 'Nearest_12', 'Nearest_13', 'Nearest_14', 'Nearest_15',\n       'Nearest_16', 'Nearest_17', 'Nearest_18', 'Nearest_19', 'Nearest_20',\n       'Nearest_21', 'Nearest_22', 'Nearest_23', 'Nearest_24', 'Land_Use',\n       'VCI_AVE', 'TCI_AVE', 'VHI_AVE', 'VCI_TOT', 'TCI_TOT', 'VHI_TOT',\n       'FWI_1_days_ago', 'VPD_1_days_ago', 'P_1_days_ago', 'FRP_1_days_ago',\n       'FWI_2_days_ago', 'VPD_2_days_ago', 'P_2_days_ago', 'FRP_2_days_ago',\n       'FWI_3_days_ago', 'VPD_3_days_ago', 'P_3_days_ago', 'FRP_3_days_ago',\n       'FWI_4_days_ago', 'VPD_4_days_ago', 'P_4_days_ago', 'FRP_4_days_ago',\n       'FWI_5_days_ago', 'VPD_5_days_ago', 'P_5_days_ago', 'FRP_5_days_ago',\n       'FWI_6_days_ago', 'VPD_6_days_ago', 'P_6_days_ago', 'FRP_6_days_ago',\n       'FWI_7_days_ago', 'VPD_7_days_ago', 'P_7_days_ago', 'FRP_7_days_ago',\n       'Predicted_FRP'],\n      dtype='object')\nPrediction results are saved to /groups/ESS3/zsun/firecasting/data/output/output_tabnet_window_7_days_forecasting_with_new_yunyao_window_time_series_landuse_vhi_latlon//20210705/firedata_20210710_predicted.txt\n['Mean Absolute Error (MAE): 22.547998933762166', 'Mean Squared Error (MSE): 29426.03562287616', 'Root Mean Squared Error (RMSE): 171.54018661198944', 'R-squared (R2) Score: -0.02360944278511523', 'Explained Variance Score: -0.007809223880369975', 'Median Absolute Error (MedAE): 0.0', 'Max Error: 23213.004525149645', 'Mean: -21.179196243725322', 'Median: 0.0', 'Standard Deviation: 169.55090832070005', 'Minimum: -999.0', 'Maximum: 23213.011719', 'Count: 156861']\nMetrics saved to /groups/ESS3/zsun/firecasting/data/output/output_tabnet_window_7_days_forecasting_with_new_yunyao_window_time_series_landuse_vhi_latlon//20210705/metrics_20210710_predicted.txt\npredicting:  20210711\nRead from original folder for current date: 20210711\nReading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210711.txt\nreading past files for 2021-07-10 00:00:00\nreading from predicted folder\ncurrent final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n0 -999.0 -999.0  0.0  ...  101664.703125          -999.0            0.0\n1 -999.0 -999.0  0.0  ...  101664.703125          -999.0            0.0\n2 -999.0 -999.0  0.0  ...  101656.296875          -999.0            0.0\n3 -999.0 -999.0  0.0  ...  101656.296875          -999.0            0.0\n4 -999.0 -999.0  0.0  ...  101647.101562          -999.0            0.0\n[5 rows x 72 columns]\nrenaming Predicted_FRP to FRP\nremove the current predicted_frp\nreading past files for 2021-07-09 00:00:00\nreading from predicted folder\ncurrent final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n0 -999.0 -999.0  0.0  ...  101617.460938          -999.0            0.0\n1 -999.0 -999.0  0.0  ...  101617.460938          -999.0            0.0\n2 -999.0 -999.0  0.0  ...  101612.257812          -999.0            0.0\n3 -999.0 -999.0  0.0  ...  101612.257812          -999.0            0.0\n4 -999.0 -999.0  0.0  ...  101606.257812          -999.0            0.0\n[5 rows x 72 columns]\nrenaming Predicted_FRP to FRP\nremove the current predicted_frp\nreading past files for 2021-07-08 00:00:00\nreading from predicted folder\ncurrent final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n0 -999.0 -999.0  0.0  ...  101530.867188          -999.0            0.0\n1 -999.0 -999.0  0.0  ...  101530.867188          -999.0            0.0\n2 -999.0 -999.0  0.0  ...  101528.468750          -999.0            0.0\n3 -999.0 -999.0  0.0  ...  101528.468750          -999.0            0.0\n4 -999.0 -999.0  0.0  ...  101526.070312          -999.0            0.0\n[5 rows x 72 columns]\nrenaming Predicted_FRP to FRP\nremove the current predicted_frp\nreading past files for 2021-07-07 00:00:00\nreading from predicted folder\ncurrent final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n0 -999.0 -999.0  0.0  ...  101381.734375          -999.0            0.0\n1 -999.0 -999.0  0.0  ...  101381.734375          -999.0            0.0\n2 -999.0 -999.0  0.0  ...  101376.140625          -999.0            0.0\n3 -999.0 -999.0  0.0  ...  101376.140625          -999.0            0.0\n4 -999.0 -999.0  0.0  ...  101371.742188          -999.0            0.0\n[5 rows x 72 columns]\nrenaming Predicted_FRP to FRP\nremove the current predicted_frp\nreading past files for 2021-07-06 00:00:00\nreading from predicted folder\ncurrent final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n0 -999.0 -999.0  0.0  ...  101329.468750          -999.0            0.0\n1 -999.0 -999.0  0.0  ...  101329.468750          -999.0            0.0\n2 -999.0 -999.0  0.0  ...  101317.062500          -999.0            0.0\n3 -999.0 -999.0  0.0  ...  101317.062500          -999.0            0.0\n4 -999.0 -999.0  0.0  ...  101301.859375          -999.0            0.0\n[5 rows x 72 columns]\nrenaming Predicted_FRP to FRP\nremove the current predicted_frp\nreading past files for 2021-07-05 00:00:00\nreading from predicted folder\ncurrent final_df head:       FWI    VPD   HT  ...   P_7_days_ago  FRP_7_days_ago  Predicted_FRP\n0 -999.0 -999.0  0.0  ...  101352.601562          -999.0            0.0\n1 -999.0 -999.0  0.0  ...  101352.601562          -999.0            0.0\n2 -999.0 -999.0  0.0  ...  101336.601562          -999.0            0.0\n3 -999.0 -999.0  0.0  ...  101336.601562          -999.0            0.0\n4 -999.0 -999.0  0.0  ...  101320.203125          -999.0            0.0\n[5 rows x 72 columns]\nrenaming Predicted_FRP to FRP\nremove the current predicted_frp\nreading past files for 2021-07-04 00:00:00\nreading from original folder\nReading /groups/ESS3/yli74/data/AI_Emis/firedata_VHI/firedata_20210704.txt\nNew time series dataframe:      LAT         LON    FRP  ...  VPD_7_days_ago   P_7_days_ago  FRP_7_days_ago\n0  24.5 -126.000000 -999.0  ...          -999.0  101734.710938          -999.0\n1  24.5 -125.899994 -999.0  ...          -999.0  101734.710938          -999.0\n2  24.5 -125.800003 -999.0  ...          -999.0  101727.906250          -999.0\n3  24.5 -125.699997 -999.0  ...          -999.0  101727.906250          -999.0\n4  24.5 -125.599998 -999.0  ...          -999.0  101720.710938          -999.0\n[5 rows x 74 columns]\nOriginal df is created:  (156861, 74)\nOriginal df filled the na with -9999 \nX and y are loaded into memory for 20210711\nthe loaded model is:  TabNetRegressor(n_d=17, n_a=41, n_steps=4, gamma=1.1546672563068268, cat_idxs=[], cat_dims=[], cat_emb_dim=[], n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.00042602006758391, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=71, output_dim=1, device_name='auto', n_shared_decoder=1, n_indep_decoder=1, grouped_features=[])\nLoaded model is a TabNet model.\nPrediction for 20210711 of start day 20210705 is finished\nnew columns to check:  ['FRP_1_days_ago', 'Nearest_1', 'Nearest_2', 'Nearest_3', 'Nearest_4', 'Nearest_5', 'Nearest_6', 'Nearest_7', 'Nearest_8']\ncurrent merged_df columns:  Index(['FWI', 'VPD', 'HT', 'T', 'RH', 'U', 'V', 'P', 'RAIN', 'CAPE', 'ST',\n       'SM', 'Nearest_1', 'Nearest_2', 'Nearest_3', 'Nearest_4', 'Nearest_5',\n       'Nearest_6', 'Nearest_7', 'Nearest_8', 'Nearest_9', 'Nearest_10',\n       'Nearest_11', 'Nearest_12', 'Nearest_13', 'Nearest_14', 'Nearest_15',\n       'Nearest_16', 'Nearest_17', 'Nearest_18', 'Nearest_19', 'Nearest_20',\n       'Nearest_21', 'Nearest_22', 'Nearest_23', 'Nearest_24', 'Land_Use',\n       'VCI_AVE', 'TCI_AVE', 'VHI_AVE', 'VCI_TOT', 'TCI_TOT', 'VHI_TOT',\n       'FWI_1_days_ago', 'VPD_1_days_ago', 'P_1_days_ago', 'FRP_1_days_ago',\n       'FWI_2_days_ago', 'VPD_2_days_ago', 'P_2_days_ago', 'FRP_2_days_ago',\n       'FWI_3_days_ago', 'VPD_3_days_ago', 'P_3_days_ago', 'FRP_3_days_ago',\n       'FWI_4_days_ago', 'VPD_4_days_ago', 'P_4_days_ago', 'FRP_4_days_ago',\n       'FWI_5_days_ago', 'VPD_5_days_ago', 'P_5_days_ago', 'FRP_5_days_ago',\n       'FWI_6_days_ago', 'VPD_6_days_ago', 'P_6_days_ago', 'FRP_6_days_ago',\n       'FWI_7_days_ago', 'VPD_7_days_ago', 'P_7_days_ago', 'FRP_7_days_ago',\n       'Predicted_FRP'],\n      dtype='object')\nPrediction results are saved to /groups/ESS3/zsun/firecasting/data/output/output_tabnet_window_7_days_forecasting_with_new_yunyao_window_time_series_landuse_vhi_latlon//20210705/firedata_20210711_predicted.txt\nTraceback (most recent call last):\n  File \"<stdin>\", line 7, in <module>\n  File \"/home/zsun/gw-workspace/50lutl24lgw/fc_model_predict_2weeks.py\", line 253, in predict_2weeks\n    predict_2weeks_for_one_day(date_str, current_date, output_folder_full_path, loaded_model)\n  File \"/home/zsun/gw-workspace/50lutl24lgw/fc_model_predict_2weeks.py\", line 206, in predict_2weeks_for_one_day\n    predict_single_day_in_the_2weeks(single_day_current_date_str, date_str, specific_date_result_folder, loaded_model)\n  File \"/home/zsun/gw-workspace/50lutl24lgw/fc_model_predict_2weeks.py\", line 151, in predict_single_day_in_the_2weeks\n    mae = mean_absolute_error(y_test, y_pred)\n  File \"/home/zsun/.local/lib/python3.8/site-packages/sklearn/metrics/_regression.py\", line 191, in mean_absolute_error\n    y_type, y_true, y_pred, multioutput = _check_reg_targets(\n  File \"/home/zsun/.local/lib/python3.8/site-packages/sklearn/metrics/_regression.py\", line 96, in _check_reg_targets\n    y_pred = check_array(y_pred, ensure_2d=False, dtype=dtype)\n  File \"/home/zsun/.local/lib/python3.8/site-packages/sklearn/utils/validation.py\", line 800, in check_array\n    _assert_all_finite(array, allow_nan=force_all_finite == \"allow-nan\")\n  File \"/home/zsun/.local/lib/python3.8/site-packages/sklearn/utils/validation.py\", line 114, in _assert_all_finite\n    raise ValueError(\nValueError: Input contains NaN, infinity or a value too large for dtype('float64').\ncat: '/scratch/zsun/test_data_slurm-*-2042501.out': No such file or directory\nAll slurm job for fc_model_predict_2weeks_slurm_generated.sh finishes.\n",
  "history_begin_time" : 1720812758264,
  "history_end_time" : 1720814683543,
  "history_notes" : null,
  "history_process" : "55wou8",
  "host_id" : "100001",
  "indicator" : "Failed"
},{
  "history_id" : "kgd84izutjt",
  "history_input" : "No code saved",
  "history_output" : "Skipped",
  "history_begin_time" : 1720812753727,
  "history_end_time" : 1720812753727,
  "history_notes" : null,
  "history_process" : "uhet3k",
  "host_id" : "100001",
  "indicator" : "Skipped"
},{
  "history_id" : "6i5i5kb53vu",
  "history_input" : "No code saved",
  "history_output" : "Skipped",
  "history_begin_time" : 1720812753728,
  "history_end_time" : 1720812753728,
  "history_notes" : null,
  "history_process" : "b6x5kk",
  "host_id" : "100001",
  "indicator" : "Skipped"
},{
  "history_id" : "iw70577rohm",
  "history_input" : null,
  "history_output" : null,
  "history_begin_time" : null,
  "history_end_time" : 1720814717261,
  "history_notes" : null,
  "history_process" : "rg5g1a",
  "host_id" : "100001",
  "indicator" : "Stopped"
},{
  "history_id" : "vw7676kncw2",
  "history_input" : null,
  "history_output" : null,
  "history_begin_time" : null,
  "history_end_time" : 1720814717263,
  "history_notes" : null,
  "history_process" : "k09hf7",
  "host_id" : "100001",
  "indicator" : "Stopped"
},{
  "history_id" : "xv4u1wjrb04",
  "history_input" : "No code saved",
  "history_output" : "Skipped",
  "history_begin_time" : 1720812753731,
  "history_end_time" : 1720812753731,
  "history_notes" : null,
  "history_process" : "r7g97f",
  "host_id" : "100001",
  "indicator" : "Skipped"
}]
