[{
  "history_id" : "8jsxy1758ol",
  "history_input" : "No code saved",
  "history_output" : "Skipped",
  "history_begin_time" : 1711722163429,
  "history_end_time" : 1711723321969,
  "history_notes" : null,
  "history_process" : "1jepv8",
  "host_id" : "100001",
  "indicator" : "Stopped"
},{
  "history_id" : "l9njoassa7k",
  "history_input" : "No code saved",
  "history_output" : "Skipped",
  "history_begin_time" : 1711722163431,
  "history_end_time" : 1711723321969,
  "history_notes" : null,
  "history_process" : "w4lpt8",
  "host_id" : "100001",
  "indicator" : "Stopped"
},{
  "history_id" : "ors2og8pqhw",
  "history_input" : "No code saved",
  "history_output" : "Skipped",
  "history_begin_time" : 1711722163432,
  "history_end_time" : 1711723321969,
  "history_notes" : null,
  "history_process" : "521ngk",
  "host_id" : "100001",
  "indicator" : "Stopped"
},{
  "history_id" : "tu2jva4g6h3",
  "history_input" : "No code saved",
  "history_output" : "Skipped",
  "history_begin_time" : 1711722163432,
  "history_end_time" : 1711723321970,
  "history_notes" : null,
  "history_process" : "x8kqk7",
  "host_id" : "100001",
  "indicator" : "Stopped"
},{
  "history_id" : "wcvj8aajv71",
  "history_input" : "No code saved",
  "history_output" : "Skipped",
  "history_begin_time" : 1711722163433,
  "history_end_time" : 1711723321970,
  "history_notes" : null,
  "history_process" : "wjq4fr",
  "host_id" : "100001",
  "indicator" : "Stopped"
},{
  "history_id" : "0fvtoh5ql0e",
  "history_input" : "No code saved",
  "history_output" : "Skipped",
  "history_begin_time" : 1711722163434,
  "history_end_time" : 1711723321970,
  "history_notes" : null,
  "history_process" : "l4eb73",
  "host_id" : "100001",
  "indicator" : "Stopped"
},{
  "history_id" : "x89jhqw18m4",
  "history_input" : "No code saved",
  "history_output" : "Skipped",
  "history_begin_time" : 1711722163435,
  "history_end_time" : 1711723321970,
  "history_notes" : null,
  "history_process" : "pv7d8l",
  "host_id" : "100001",
  "indicator" : "Stopped"
},{
  "history_id" : "mc676wqc676",
  "history_input" : "No code saved",
  "history_output" : "Skipped",
  "history_begin_time" : 1711722163444,
  "history_end_time" : 1711723321971,
  "history_notes" : null,
  "history_process" : "xku47i",
  "host_id" : "100001",
  "indicator" : "Stopped"
},{
  "history_id" : "c54mcah2l7t",
  "history_input" : null,
  "history_output" : null,
  "history_begin_time" : null,
  "history_end_time" : 1711723321971,
  "history_notes" : null,
  "history_process" : "dp0hiw",
  "host_id" : "100001",
  "indicator" : "Stopped"
},{
  "history_id" : "mgzqscj42uy",
  "history_input" : null,
  "history_output" : null,
  "history_begin_time" : null,
  "history_end_time" : 1711723321974,
  "history_notes" : null,
  "history_process" : "b3cx6j",
  "host_id" : "100001",
  "indicator" : "Stopped"
},{
  "history_id" : "et6gvxb32ee",
  "history_input" : "No code saved",
  "history_output" : "Skipped",
  "history_begin_time" : 1711722163449,
  "history_end_time" : 1711723321975,
  "history_notes" : null,
  "history_process" : "k84mqm",
  "host_id" : "100001",
  "indicator" : "Stopped"
},{
  "history_id" : "k60cug05h6w",
  "history_input" : "#!/bin/bash\n\necho \"start to run fc_model_predict_2weeks.sh\"\npwd\n\n# Specify the name of the script you want to submit\nSCRIPT_NAME=\"fc_model_predict_2weeks_slurm_generated.sh\"\necho \"write the slurm script into ${SCRIPT_NAME}\"\ncat > ${SCRIPT_NAME} << EOF\n#!/bin/bash\n#SBATCH -J fc_model_predict_2weeks       # Job name\n#SBATCH --output=/scratch/%u/%x-%N-%j.out  # Output file`\n#SBATCH --error=/scratch/%u/%x-%N-%j.err   # Error file`\n#SBATCH -n 1               # Number of tasks\n#SBATCH -c 12               # Number of CPUs per task (threads)\n#SBATCH --mem=50G          # Memory per node (use units like G for gigabytes) - this job must need 200GB lol\n#SBATCH -t 0-10:00         # Runtime in D-HH:MM format\n## Slurm can send you updates via email\n#SBATCH --mail-type=FAIL  # BEGIN,END,FAIL         # ALL,NONE,BEGIN,END,FAIL,REQUEUE,..\n#SBATCH --mail-user=zsun@gmu.edu     # Put your GMU email address here\n\n# Activate your customized virtual environment\nsource /home/zsun/anaconda3/bin/activate\n\n# Call the Python script using process substitution\npython -u << INNER_EOF\n\nfrom fc_model_predict_2weeks import predict_2weeks\n\nstart_date = \"20210714\"\nend_date = \"20210714\"\n\npredict_2weeks(start_date, end_date)\n\n\nINNER_EOF\n\nEOF\n\n# Submit the Slurm job and wait for it to finish\necho \"sbatch ${SCRIPT_NAME}\"\n# should have another check. if there is another job running, should cancel it before submitting a new job.\n\n# Find and cancel existing running jobs with the same script name\n#existing_jobs=$(squeue -h -o \"%A %j\" -u $(whoami) | awk -v script=\"$SCRIPT_NAME\" '$2 == script {print $1}')\n\n# if [ -n \"$existing_jobs\" ]; then\n#     echo \"Canceling existing jobs with the script name '$SCRIPT_NAME'...\"\n#     for job_id in $existing_jobs; do\n#         scancel $job_id\n#     done\n# else\n#     echo \"No existing jobs with the script name '$SCRIPT_NAME' found.\"\n# fi\n\n# Submit the Slurm job\njob_id=$(sbatch ${SCRIPT_NAME} | awk '{print $4}')\necho \"job_id=\"${job_id}\n\nif [ -z \"${job_id}\" ]; then\n    echo \"job id is empty. something wrong with the slurm job submission.\"\n    exit 1\nfi\n\n# Wait for the Slurm job to finish\nfile_name=$(find /scratch/zsun -name '*'${job_id}'.out' -print -quit)\nprevious_content=$(cat file_name)\nexit_code=0\nwhile true; do\n    # Capture the current content\\\n    #echo ${job_id}\n    file_name=$(find /scratch/zsun -name '*'${job_id}'.out' -print -quit)\n    #echo \"file_name=\"$file_name\n    current_content=$(<\"${file_name}\")\n    #echo \"current_content = \"$current_content\n\n    # Compare current content with previous content\n    diff_result=$(diff <(echo \"$previous_content\") <(echo \"$current_content\"))\n    # Check if there is new content\n    if [ -n \"$diff_result\" ]; then\n        # Print the newly added content\n        #echo \"New content added:\"\n        echo \"$diff_result\"\n        #echo \"---------------------\"\n    fi\n    # Update previous content\n    previous_content=\"$current_content\"\n\n\n    job_status=$(scontrol show job ${job_id} | awk '/JobState=/{print $1}')\n    #echo \"job_status \"$job_status\n    #if [[ $job_status == \"JobState=COMPLETED\" ]]; then\n    #    break\n    #fi\n    if [[ $job_status == *\"COMPLETED\"* ]]; then\n        echo \"Job $job_id has finished with state: $job_status\"\n        break;\n    elif [[ $job_status == *\"CANCELLED\"* || $job_status == *\"FAILED\"* || $job_status == *\"TIMEOUT\"* || $job_status == *\"NODE_FAIL\"* || $job_status == *\"PREEMPTED\"* || $job_status == *\"OUT_OF_MEMORY\"* ]]; then\n        echo \"Job $job_id has finished with state: $job_status\"\n        exit_code=1\n        break;\n    fi\n    sleep 10  # Adjust the sleep interval as needed\ndone\n\necho \"Slurm job ($job_id) has finished.\"\n\necho \"Print the job's output logs\"\nsacct --format=JobID,JobName,State,ExitCode,MaxRSS,Start,End -j $job_id\n# find /scratch/zsun/ -type f -name \"*${job_id}.out\" -exec cat {} \\;\n\n#cat /scratch/zsun/test_data_slurm-*-$job_id.out\n\necho \"All slurm job for ${SCRIPT_NAME} finishes.\"\n\nexit $exit_code\n",
  "history_output" : "start to run fc_model_predict_2weeks.sh\n/home/zsun/gw-workspace/k60cug05h6w\nwrite the slurm script into fc_model_predict_2weeks_slurm_generated.sh\nsbatch fc_model_predict_2weeks_slurm_generated.sh\njob_id=1722098\ncat: file_name: No such file or directory\n/home/zsun/gw-workspace/k60cug05h6w/gw-iWpaxjKye0DRihJiclJhKbICWt-k60cug05h6w.sh: line 74: : No such file or directory\n/home/zsun/gw-workspace/k60cug05h6w/gw-iWpaxjKye0DRihJiclJhKbICWt-k60cug05h6w.sh: line 74: : No such file or directory\n/home/zsun/gw-workspace/k60cug05h6w/gw-iWpaxjKye0DRihJiclJhKbICWt-k60cug05h6w.sh: line 74: : No such file or directory\n/home/zsun/gw-workspace/k60cug05h6w/gw-iWpaxjKye0DRihJiclJhKbICWt-k60cug05h6w.sh: line 74: : No such file or directory\n0a1,43\n> /home/zsun/anaconda3/lib/python3.8/site-packages/dask/dataframe/utils.py:367: FutureWarning: pandas.Int64Index is deprecated and will be removed from pandas in a future version. Use pandas.Index with the appropriate dtype instead.\n>   _numeric_index_types = (pd.Int64Index, pd.Float64Index, pd.UInt64Index)\n> /home/zsun/anaconda3/lib/python3.8/site-packages/dask/dataframe/utils.py:367: FutureWarning: pandas.Float64Index is deprecated and will be removed from pandas in a future version. Use pandas.Index with the appropriate dtype instead.\n>   _numeric_index_types = (pd.Int64Index, pd.Float64Index, pd.UInt64Index)\n> /home/zsun/anaconda3/lib/python3.8/site-packages/dask/dataframe/utils.py:367: FutureWarning: pandas.UInt64Index is deprecated and will be removed from pandas in a future version. Use pandas.Index with the appropriate dtype instead.\n>   _numeric_index_types = (pd.Int64Index, pd.Float64Index, pd.UInt64Index)\n> the model in use is /groups/ESS3/zsun/firecasting/model/fc_xgb_model_v1_latest.pkl\n> current date:  2021-07-14 00:00:00\n> single_day_current_date =  2021-07-14 00:00:00\n> single_day_predict_end_date =  2021-07-21 00:00:00\n> predicting:  20210714\n> Read from original folder for current date: 20210714\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata/firedata_20210714.txt\n> reading past files for 2021-07-13 00:00:00\n> reading from original folder\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata/firedata_20210713.txt\n> reading past files for 2021-07-12 00:00:00\n> reading from original folder\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata/firedata_20210712.txt\n> reading past files for 2021-07-11 00:00:00\n> reading from original folder\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata/firedata_20210711.txt\n> reading past files for 2021-07-10 00:00:00\n> reading from original folder\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata/firedata_20210710.txt\n> reading past files for 2021-07-09 00:00:00\n> reading from original folder\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata/firedata_20210709.txt\n> reading past files for 2021-07-08 00:00:00\n> reading from original folder\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata/firedata_20210708.txt\n> reading past files for 2021-07-07 00:00:00\n> reading from original folder\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata/firedata_20210707.txt\n> original_df.describe                  LAT            LON  ...   FRP_6_days_ago   FRP_7_days_ago\n> count  156861.000000  156861.000000  ...    156861.000000    156861.000000\n> mean       37.500002     -95.999998  ...         0.163110         0.227513\n> std         7.534390      17.349407  ...        18.545293        34.938262\n> min        24.500000    -126.000000  ...         0.000000         0.000000\n> 25%        31.000000    -111.000000  ...         0.000000         0.000000\n> 50%        37.500000     -96.000000  ...         0.000000         0.000000\n> 75%        44.000000     -81.000000  ...         0.000000         0.000000\n> max        50.500000     -66.000000  ...      5464.172363     11733.906250\n1a45,50\n> [8 rows x 22 columns]\n> original_df columns:  Index(['LAT', ' LON', ' FRP', ' FWI', ' VPD', ' HT', ' T', ' RH', ' U', ' V',\n>        ' P', ' RAIN', ' CAPE', ' ST', ' SM', ' FRP_1_days_ago',\n>        ' FRP_2_days_ago', ' FRP_3_days_ago', ' FRP_4_days_ago',\n>        ' FRP_5_days_ago', ' FRP_6_days_ago', ' FRP_7_days_ago'],\n>       dtype='object')\n50a51,84\n> new_df.shape =  (156861, 24)\n> df.shape =  (156861, 22)\n> New time series dataframe:      LAT         LON   FRP  ...  Nearest_22  Nearest_23  Nearest_24\n> 0  24.5 -126.000000   0.0  ...         0.0         0.0         0.0\n> 1  24.5 -125.899994   0.0  ...         0.0         0.0         0.0\n> 2  24.5 -125.800003   0.0  ...         0.0         0.0         0.0\n> 3  24.5 -125.699997   0.0  ...         0.0         0.0         0.0\n> 4  24.5 -125.599998   0.0  ...         0.0         0.0         0.0\n> \n> [5 rows x 46 columns]\n> Original df is created:  (156861, 46)\n> Original df filled the na with -9999 \n> X and y are loaded into memory for 20210714\n> the loaded model is:  XGBRegressor(base_score=0.5, booster='gbtree', callbacks=None,\n>              colsample_bylevel=1, colsample_bynode=1, colsample_bytree=0.8,\n>              early_stopping_rounds=None, enable_categorical=False, eta=0.1,\n>              eval_metric='rmse', gamma=0, gpu_id=-1, grow_policy='depthwise',\n>              importance_type=None, interaction_constraints='',\n>              learning_rate=0.1, max_bin=256, max_cat_to_onehot=4,\n>              max_delta_step=0, max_depth=8, max_leaves=0, min_child_weight=1,\n>              missing=nan, monotone_constraints='()', n_estimators=100, n_jobs=0,\n>              num_parallel_tree=1, predictor='auto', random_state=0, reg_alpha=0, ...)\n> Prediction for 20210714 of start day 20210714 is finished\n> new columns to check:  [' FRP_1_days_ago', 'Nearest_1', 'Nearest_2', 'Nearest_3', 'Nearest_4', 'Nearest_5', 'Nearest_6', 'Nearest_7', 'Nearest_8']\n> current merged_df columns:  Index([' FWI', ' VPD', ' HT', ' T', ' RH', ' U', ' V', ' P', ' RAIN', ' CAPE',\n>        ' ST', ' SM', ' FRP_1_days_ago', ' FRP_2_days_ago', ' FRP_3_days_ago',\n>        ' FRP_4_days_ago', ' FRP_5_days_ago', ' FRP_6_days_ago',\n>        ' FRP_7_days_ago', 'Nearest_1', 'Nearest_2', 'Nearest_3', 'Nearest_4',\n>        'Nearest_5', 'Nearest_6', 'Nearest_7', 'Nearest_8', 'Nearest_9',\n>        'Nearest_10', 'Nearest_11', 'Nearest_12', 'Nearest_13', 'Nearest_14',\n>        'Nearest_15', 'Nearest_16', 'Nearest_17', 'Nearest_18', 'Nearest_19',\n>        'Nearest_20', 'Nearest_21', 'Nearest_22', 'Nearest_23', 'Nearest_24',\n>        'Predicted_FRP'],\n>       dtype='object')\n84a85,136\n> Prediction results are saved to /groups/ESS3/zsun/firecasting/data/output/output_xgboost_window_7_days_forecasting//20210714/firedata_20210714_predicted.txt\n> ['Mean Absolute Error (MAE): 7.0637911474219655', 'Mean Squared Error (MSE): 110334.72700266192', 'Root Mean Squared Error (RMSE): 332.16671567552027', 'R-squared (R2) Score: -153.98472775166303', 'Explained Variance Score: -153.92172770843976', 'Median Absolute Error (MedAE): 0.0', 'Max Error: 40459.85018875', 'Mean: 0.31889202218524665', 'Median: 0.0', 'Standard Deviation: 26.681672203030356', 'Minimum: 0.0', 'Maximum: 5842.833008', 'Count: 156861']\n> Metrics saved to /groups/ESS3/zsun/firecasting/data/output/output_xgboost_window_7_days_forecasting//20210714/metrics_20210714_predicted.txt\n> predicting:  20210715\n> Read from original folder for current date: 20210715\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata/firedata_20210715.txt\n> reading past files for 2021-07-14 00:00:00\n> reading from predicted folder\n> current final_df head:       FWI    VPD   HT  ...  Nearest_23  Nearest_24  Predicted_FRP\n> 0 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> 1 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> 2 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> 3 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> 4 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> \n> [5 rows x 44 columns]\n> renaming Predicted_FRP to FRP\n> remove the current predicted_frp\n> reading past files for 2021-07-13 00:00:00\n> reading from original folder\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata/firedata_20210713.txt\n> reading past files for 2021-07-12 00:00:00\n> reading from original folder\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata/firedata_20210712.txt\n> reading past files for 2021-07-11 00:00:00\n> reading from original folder\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata/firedata_20210711.txt\n> reading past files for 2021-07-10 00:00:00\n> reading from original folder\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata/firedata_20210710.txt\n> reading past files for 2021-07-09 00:00:00\n> reading from original folder\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata/firedata_20210709.txt\n> reading past files for 2021-07-08 00:00:00\n> reading from original folder\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata/firedata_20210708.txt\n> original_df.describe                  LAT            LON  ...   FRP_6_days_ago   FRP_7_days_ago\n> count  156861.000000  156861.000000  ...    156861.000000    156861.000000\n> mean       37.500002     -95.999998  ...         0.580826         0.163110\n> std         7.534390      17.349407  ...        74.094883        18.545293\n> min        24.500000    -126.000000  ...         0.000000         0.000000\n> 25%        31.000000    -111.000000  ...         0.000000         0.000000\n> 50%        37.500000     -96.000000  ...         0.000000         0.000000\n> 75%        44.000000     -81.000000  ...         0.000000         0.000000\n> max        50.500000     -66.000000  ...     19605.007812      5464.172363\n> \n> [8 rows x 22 columns]\n> original_df columns:  Index(['LAT', ' LON', ' FRP', ' FWI', ' VPD', ' HT', ' T', ' RH', ' U', ' V',\n>        ' P', ' RAIN', ' CAPE', ' ST', ' SM', ' FRP_1_days_ago',\n>        ' FRP_2_days_ago', ' FRP_3_days_ago', ' FRP_4_days_ago',\n>        ' FRP_5_days_ago', ' FRP_6_days_ago', ' FRP_7_days_ago'],\n>       dtype='object')\n136a137,158\n> new_df.shape =  (156861, 24)\n> df.shape =  (156861, 22)\n> New time series dataframe:      LAT         LON    FRP  ...  Nearest_22  Nearest_23  Nearest_24\n> 0  24.5 -126.000000 -999.0  ...         0.0         0.0         0.0\n> 1  24.5 -125.899994 -999.0  ...         0.0         0.0         0.0\n> 2  24.5 -125.800003 -999.0  ...         0.0         0.0         0.0\n> 3  24.5 -125.699997 -999.0  ...         0.0         0.0         0.0\n> 4  24.5 -125.599998 -999.0  ...         0.0         0.0         0.0\n> \n> [5 rows x 46 columns]\n> Original df is created:  (156861, 46)\n> Original df filled the na with -9999 \n> X and y are loaded into memory for 20210715\n> the loaded model is:  XGBRegressor(base_score=0.5, booster='gbtree', callbacks=None,\n>              colsample_bylevel=1, colsample_bynode=1, colsample_bytree=0.8,\n>              early_stopping_rounds=None, enable_categorical=False, eta=0.1,\n>              eval_metric='rmse', gamma=0, gpu_id=-1, grow_policy='depthwise',\n>              importance_type=None, interaction_constraints='',\n>              learning_rate=0.1, max_bin=256, max_cat_to_onehot=4,\n>              max_delta_step=0, max_depth=8, max_leaves=0, min_child_weight=1,\n>              missing=nan, monotone_constraints='()', n_estimators=100, n_jobs=0,\n>              num_parallel_tree=1, predictor='auto', random_state=0, reg_alpha=0, ...)\n158a159,174\n> Prediction for 20210715 of start day 20210714 is finished\n> new columns to check:  [' FRP_1_days_ago', 'Nearest_1', 'Nearest_2', 'Nearest_3', 'Nearest_4', 'Nearest_5', 'Nearest_6', 'Nearest_7', 'Nearest_8']\n> current merged_df columns:  Index([' FWI', ' VPD', ' HT', ' T', ' RH', ' U', ' V', ' P', ' RAIN', ' CAPE',\n>        ' ST', ' SM', ' FRP_1_days_ago', ' FRP_2_days_ago', ' FRP_3_days_ago',\n>        ' FRP_4_days_ago', ' FRP_5_days_ago', ' FRP_6_days_ago',\n>        ' FRP_7_days_ago', 'Nearest_1', 'Nearest_2', 'Nearest_3', 'Nearest_4',\n>        'Nearest_5', 'Nearest_6', 'Nearest_7', 'Nearest_8', 'Nearest_9',\n>        'Nearest_10', 'Nearest_11', 'Nearest_12', 'Nearest_13', 'Nearest_14',\n>        'Nearest_15', 'Nearest_16', 'Nearest_17', 'Nearest_18', 'Nearest_19',\n>        'Nearest_20', 'Nearest_21', 'Nearest_22', 'Nearest_23', 'Nearest_24',\n>        'Predicted_FRP'],\n>       dtype='object')\n> Prediction results are saved to /groups/ESS3/zsun/firecasting/data/output/output_xgboost_window_7_days_forecasting//20210714/firedata_20210715_predicted.txt\n> ['Mean Absolute Error (MAE): 1010.5386538757407', 'Mean Squared Error (MSE): 1223397.8971351804', 'Root Mean Squared Error (RMSE): 1106.0731879650552', 'R-squared (R2) Score: 0.0', 'Explained Variance Score: 0.0', 'Median Absolute Error (MedAE): 999.0', 'Max Error: 47970.3046875', 'Mean: -999.0', 'Median: -999.0', 'Standard Deviation: 0.0', 'Minimum: -999.0', 'Maximum: -999.0', 'Count: 156861']\n> Metrics saved to /groups/ESS3/zsun/firecasting/data/output/output_xgboost_window_7_days_forecasting//20210714/metrics_20210715_predicted.txt\n> predicting:  20210716\n174a175,231\n> Read from original folder for current date: 20210716\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata/firedata_20210716.txt\n> reading past files for 2021-07-15 00:00:00\n> reading from predicted folder\n> current final_df head:       FWI    VPD   HT  ...  Nearest_23  Nearest_24  Predicted_FRP\n> 0 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> 1 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> 2 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> 3 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> 4 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> \n> [5 rows x 44 columns]\n> renaming Predicted_FRP to FRP\n> remove the current predicted_frp\n> reading past files for 2021-07-14 00:00:00\n> reading from predicted folder\n> current final_df head:       FWI    VPD   HT  ...  Nearest_23  Nearest_24  Predicted_FRP\n> 0 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> 1 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> 2 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> 3 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> 4 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> \n> [5 rows x 44 columns]\n> renaming Predicted_FRP to FRP\n> remove the current predicted_frp\n> reading past files for 2021-07-13 00:00:00\n> reading from original folder\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata/firedata_20210713.txt\n> reading past files for 2021-07-12 00:00:00\n> reading from original folder\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata/firedata_20210712.txt\n> reading past files for 2021-07-11 00:00:00\n> reading from original folder\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata/firedata_20210711.txt\n> reading past files for 2021-07-10 00:00:00\n> reading from original folder\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata/firedata_20210710.txt\n> reading past files for 2021-07-09 00:00:00\n> reading from original folder\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata/firedata_20210709.txt\n> original_df.describe                  LAT            LON  ...   FRP_6_days_ago   FRP_7_days_ago\n> count  156861.000000  156861.000000  ...    156861.000000    156861.000000\n> mean       37.500002     -95.999998  ...         0.678789         0.580826\n> std         7.534390      17.349407  ...        85.790401        74.094883\n> min        24.500000    -126.000000  ...         0.000000         0.000000\n> 25%        31.000000    -111.000000  ...         0.000000         0.000000\n> 50%        37.500000     -96.000000  ...         0.000000         0.000000\n> 75%        44.000000     -81.000000  ...         0.000000         0.000000\n> max        50.500000     -66.000000  ...     23213.011719     19605.007812\n> \n> [8 rows x 22 columns]\n> original_df columns:  Index(['LAT', ' LON', ' FRP', ' FWI', ' VPD', ' HT', ' T', ' RH', ' U', ' V',\n>        ' P', ' RAIN', ' CAPE', ' ST', ' SM', ' FRP_1_days_ago',\n>        ' FRP_2_days_ago', ' FRP_3_days_ago', ' FRP_4_days_ago',\n>        ' FRP_5_days_ago', ' FRP_6_days_ago', ' FRP_7_days_ago'],\n>       dtype='object')\n231a232,253\n> new_df.shape =  (156861, 24)\n> df.shape =  (156861, 22)\n> New time series dataframe:      LAT         LON    FRP  ...  Nearest_22  Nearest_23  Nearest_24\n> 0  24.5 -126.000000 -999.0  ...         0.0         0.0         0.0\n> 1  24.5 -125.899994 -999.0  ...         0.0         0.0         0.0\n> 2  24.5 -125.800003 -999.0  ...         0.0         0.0         0.0\n> 3  24.5 -125.699997 -999.0  ...         0.0         0.0         0.0\n> 4  24.5 -125.599998 -999.0  ...         0.0         0.0         0.0\n> \n> [5 rows x 46 columns]\n> Original df is created:  (156861, 46)\n> Original df filled the na with -9999 \n> X and y are loaded into memory for 20210716\n> the loaded model is:  XGBRegressor(base_score=0.5, booster='gbtree', callbacks=None,\n>              colsample_bylevel=1, colsample_bynode=1, colsample_bytree=0.8,\n>              early_stopping_rounds=None, enable_categorical=False, eta=0.1,\n>              eval_metric='rmse', gamma=0, gpu_id=-1, grow_policy='depthwise',\n>              importance_type=None, interaction_constraints='',\n>              learning_rate=0.1, max_bin=256, max_cat_to_onehot=4,\n>              max_delta_step=0, max_depth=8, max_leaves=0, min_child_weight=1,\n>              missing=nan, monotone_constraints='()', n_estimators=100, n_jobs=0,\n>              num_parallel_tree=1, predictor='auto', random_state=0, reg_alpha=0, ...)\n253a254,335\n> Prediction for 20210716 of start day 20210714 is finished\n> new columns to check:  [' FRP_1_days_ago', 'Nearest_1', 'Nearest_2', 'Nearest_3', 'Nearest_4', 'Nearest_5', 'Nearest_6', 'Nearest_7', 'Nearest_8']\n> current merged_df columns:  Index([' FWI', ' VPD', ' HT', ' T', ' RH', ' U', ' V', ' P', ' RAIN', ' CAPE',\n>        ' ST', ' SM', ' FRP_1_days_ago', ' FRP_2_days_ago', ' FRP_3_days_ago',\n>        ' FRP_4_days_ago', ' FRP_5_days_ago', ' FRP_6_days_ago',\n>        ' FRP_7_days_ago', 'Nearest_1', 'Nearest_2', 'Nearest_3', 'Nearest_4',\n>        'Nearest_5', 'Nearest_6', 'Nearest_7', 'Nearest_8', 'Nearest_9',\n>        'Nearest_10', 'Nearest_11', 'Nearest_12', 'Nearest_13', 'Nearest_14',\n>        'Nearest_15', 'Nearest_16', 'Nearest_17', 'Nearest_18', 'Nearest_19',\n>        'Nearest_20', 'Nearest_21', 'Nearest_22', 'Nearest_23', 'Nearest_24',\n>        'Predicted_FRP'],\n>       dtype='object')\n> Prediction results are saved to /groups/ESS3/zsun/firecasting/data/output/output_xgboost_window_7_days_forecasting//20210714/firedata_20210716_predicted.txt\n> ['Mean Absolute Error (MAE): 1023.7484581032489', 'Mean Squared Error (MSE): 1592135.8799275386', 'Root Mean Squared Error (RMSE): 1261.7986685392955', 'R-squared (R2) Score: 0.0', 'Explained Variance Score: 0.0', 'Median Absolute Error (MedAE): 999.0', 'Max Error: 53240.0859375', 'Mean: -999.0', 'Median: -999.0', 'Standard Deviation: 0.0', 'Minimum: -999.0', 'Maximum: -999.0', 'Count: 156861']\n> Metrics saved to /groups/ESS3/zsun/firecasting/data/output/output_xgboost_window_7_days_forecasting//20210714/metrics_20210716_predicted.txt\n> predicting:  20210717\n> Read from original folder for current date: 20210717\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata/firedata_20210717.txt\n> reading past files for 2021-07-16 00:00:00\n> reading from predicted folder\n> current final_df head:       FWI    VPD   HT  ...  Nearest_23  Nearest_24  Predicted_FRP\n> 0 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> 1 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> 2 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> 3 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> 4 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> \n> [5 rows x 44 columns]\n> renaming Predicted_FRP to FRP\n> remove the current predicted_frp\n> reading past files for 2021-07-15 00:00:00\n> reading from predicted folder\n> current final_df head:       FWI    VPD   HT  ...  Nearest_23  Nearest_24  Predicted_FRP\n> 0 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> 1 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> 2 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> 3 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> 4 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> \n> [5 rows x 44 columns]\n> renaming Predicted_FRP to FRP\n> remove the current predicted_frp\n> reading past files for 2021-07-14 00:00:00\n> reading from predicted folder\n> current final_df head:       FWI    VPD   HT  ...  Nearest_23  Nearest_24  Predicted_FRP\n> 0 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> 1 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> 2 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> 3 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> 4 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> \n> [5 rows x 44 columns]\n> renaming Predicted_FRP to FRP\n> remove the current predicted_frp\n> reading past files for 2021-07-13 00:00:00\n> reading from original folder\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata/firedata_20210713.txt\n> reading past files for 2021-07-12 00:00:00\n> reading from original folder\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata/firedata_20210712.txt\n> reading past files for 2021-07-11 00:00:00\n> reading from original folder\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata/firedata_20210711.txt\n> reading past files for 2021-07-10 00:00:00\n> reading from original folder\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata/firedata_20210710.txt\n> original_df.describe                  LAT            LON  ...   FRP_6_days_ago   FRP_7_days_ago\n> count  156861.000000  156861.000000  ...    156861.000000    156861.000000\n> mean       37.500002     -95.999998  ...         0.302685         0.678789\n> std         7.534390      17.349407  ...        23.155200        85.790401\n> min        24.500000    -126.000000  ...         0.000000         0.000000\n> 25%        31.000000    -111.000000  ...         0.000000         0.000000\n> 50%        37.500000     -96.000000  ...         0.000000         0.000000\n> 75%        44.000000     -81.000000  ...         0.000000         0.000000\n> max        50.500000     -66.000000  ...      5055.526367     23213.011719\n> \n> [8 rows x 22 columns]\n> original_df columns:  Index(['LAT', ' LON', ' FRP', ' FWI', ' VPD', ' HT', ' T', ' RH', ' U', ' V',\n>        ' P', ' RAIN', ' CAPE', ' ST', ' SM', ' FRP_1_days_ago',\n>        ' FRP_2_days_ago', ' FRP_3_days_ago', ' FRP_4_days_ago',\n>        ' FRP_5_days_ago', ' FRP_6_days_ago', ' FRP_7_days_ago'],\n>       dtype='object')\n335a336,369\n> new_df.shape =  (156861, 24)\n> df.shape =  (156861, 22)\n> New time series dataframe:      LAT         LON    FRP  ...  Nearest_22  Nearest_23  Nearest_24\n> 0  24.5 -126.000000 -999.0  ...         0.0         0.0         0.0\n> 1  24.5 -125.899994 -999.0  ...         0.0         0.0         0.0\n> 2  24.5 -125.800003 -999.0  ...         0.0         0.0         0.0\n> 3  24.5 -125.699997 -999.0  ...         0.0         0.0         0.0\n> 4  24.5 -125.599998 -999.0  ...         0.0         0.0         0.0\n> \n> [5 rows x 46 columns]\n> Original df is created:  (156861, 46)\n> Original df filled the na with -9999 \n> X and y are loaded into memory for 20210717\n> the loaded model is:  XGBRegressor(base_score=0.5, booster='gbtree', callbacks=None,\n>              colsample_bylevel=1, colsample_bynode=1, colsample_bytree=0.8,\n>              early_stopping_rounds=None, enable_categorical=False, eta=0.1,\n>              eval_metric='rmse', gamma=0, gpu_id=-1, grow_policy='depthwise',\n>              importance_type=None, interaction_constraints='',\n>              learning_rate=0.1, max_bin=256, max_cat_to_onehot=4,\n>              max_delta_step=0, max_depth=8, max_leaves=0, min_child_weight=1,\n>              missing=nan, monotone_constraints='()', n_estimators=100, n_jobs=0,\n>              num_parallel_tree=1, predictor='auto', random_state=0, reg_alpha=0, ...)\n> Prediction for 20210717 of start day 20210714 is finished\n> new columns to check:  [' FRP_1_days_ago', 'Nearest_1', 'Nearest_2', 'Nearest_3', 'Nearest_4', 'Nearest_5', 'Nearest_6', 'Nearest_7', 'Nearest_8']\n> current merged_df columns:  Index([' FWI', ' VPD', ' HT', ' T', ' RH', ' U', ' V', ' P', ' RAIN', ' CAPE',\n>        ' ST', ' SM', ' FRP_1_days_ago', ' FRP_2_days_ago', ' FRP_3_days_ago',\n>        ' FRP_4_days_ago', ' FRP_5_days_ago', ' FRP_6_days_ago',\n>        ' FRP_7_days_ago', 'Nearest_1', 'Nearest_2', 'Nearest_3', 'Nearest_4',\n>        'Nearest_5', 'Nearest_6', 'Nearest_7', 'Nearest_8', 'Nearest_9',\n>        'Nearest_10', 'Nearest_11', 'Nearest_12', 'Nearest_13', 'Nearest_14',\n>        'Nearest_15', 'Nearest_16', 'Nearest_17', 'Nearest_18', 'Nearest_19',\n>        'Nearest_20', 'Nearest_21', 'Nearest_22', 'Nearest_23', 'Nearest_24',\n>        'Predicted_FRP'],\n>       dtype='object')\n369a370,448\n> Prediction results are saved to /groups/ESS3/zsun/firecasting/data/output/output_xgboost_window_7_days_forecasting//20210714/firedata_20210717_predicted.txt\n> ['Mean Absolute Error (MAE): 1036.9677704128044', 'Mean Squared Error (MSE): 1915095.6410541935', 'Root Mean Squared Error (RMSE): 1383.8698063958884', 'R-squared (R2) Score: 0.0', 'Explained Variance Score: 0.0', 'Median Absolute Error (MedAE): 999.0', 'Max Error: 53971.37109375', 'Mean: -999.0', 'Median: -999.0', 'Standard Deviation: 0.0', 'Minimum: -999.0', 'Maximum: -999.0', 'Count: 156861']\n> Metrics saved to /groups/ESS3/zsun/firecasting/data/output/output_xgboost_window_7_days_forecasting//20210714/metrics_20210717_predicted.txt\n> predicting:  20210718\n> Read from original folder for current date: 20210718\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata/firedata_20210718.txt\n> reading past files for 2021-07-17 00:00:00\n> reading from predicted folder\n> current final_df head:       FWI    VPD   HT  ...  Nearest_23  Nearest_24  Predicted_FRP\n> 0 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> 1 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> 2 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> 3 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> 4 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> \n> [5 rows x 44 columns]\n> renaming Predicted_FRP to FRP\n> remove the current predicted_frp\n> reading past files for 2021-07-16 00:00:00\n> reading from predicted folder\n> current final_df head:       FWI    VPD   HT  ...  Nearest_23  Nearest_24  Predicted_FRP\n> 0 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> 1 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> 2 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> 3 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> 4 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> \n> [5 rows x 44 columns]\n> renaming Predicted_FRP to FRP\n> remove the current predicted_frp\n> reading past files for 2021-07-15 00:00:00\n> reading from predicted folder\n> current final_df head:       FWI    VPD   HT  ...  Nearest_23  Nearest_24  Predicted_FRP\n> 0 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> 1 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> 2 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> 3 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> 4 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> \n> [5 rows x 44 columns]\n> renaming Predicted_FRP to FRP\n> remove the current predicted_frp\n> reading past files for 2021-07-14 00:00:00\n> reading from predicted folder\n> current final_df head:       FWI    VPD   HT  ...  Nearest_23  Nearest_24  Predicted_FRP\n> 0 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> 1 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> 2 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> 3 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> 4 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> \n> [5 rows x 44 columns]\n> renaming Predicted_FRP to FRP\n> remove the current predicted_frp\n> reading past files for 2021-07-13 00:00:00\n> reading from original folder\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata/firedata_20210713.txt\n> reading past files for 2021-07-12 00:00:00\n> reading from original folder\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata/firedata_20210712.txt\n> reading past files for 2021-07-11 00:00:00\n> reading from original folder\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata/firedata_20210711.txt\n> original_df.describe                  LAT            LON  ...   FRP_6_days_ago   FRP_7_days_ago\n> count  156861.000000  156861.000000  ...    156861.000000    156861.000000\n> mean       37.500002     -95.999998  ...         0.469768         0.302685\n> std         7.534390      17.349407  ...        52.007267        23.155200\n> min        24.500000    -126.000000  ...         0.000000         0.000000\n> 25%        31.000000    -111.000000  ...         0.000000         0.000000\n> 50%        37.500000     -96.000000  ...         0.000000         0.000000\n> 75%        44.000000     -81.000000  ...         0.000000         0.000000\n> max        50.500000     -66.000000  ...     15687.671875      5055.526367\n> \n> [8 rows x 22 columns]\n> original_df columns:  Index(['LAT', ' LON', ' FRP', ' FWI', ' VPD', ' HT', ' T', ' RH', ' U', ' V',\n>        ' P', ' RAIN', ' CAPE', ' ST', ' SM', ' FRP_1_days_ago',\n>        ' FRP_2_days_ago', ' FRP_3_days_ago', ' FRP_4_days_ago',\n>        ' FRP_5_days_ago', ' FRP_6_days_ago', ' FRP_7_days_ago'],\n>       dtype='object')\n448a449,482\n> new_df.shape =  (156861, 24)\n> df.shape =  (156861, 22)\n> New time series dataframe:      LAT         LON    FRP  ...  Nearest_22  Nearest_23  Nearest_24\n> 0  24.5 -126.000000 -999.0  ...         0.0         0.0         0.0\n> 1  24.5 -125.899994 -999.0  ...         0.0         0.0         0.0\n> 2  24.5 -125.800003 -999.0  ...         0.0         0.0         0.0\n> 3  24.5 -125.699997 -999.0  ...         0.0         0.0         0.0\n> 4  24.5 -125.599998 -999.0  ...         0.0         0.0         0.0\n> \n> [5 rows x 46 columns]\n> Original df is created:  (156861, 46)\n> Original df filled the na with -9999 \n> X and y are loaded into memory for 20210718\n> the loaded model is:  XGBRegressor(base_score=0.5, booster='gbtree', callbacks=None,\n>              colsample_bylevel=1, colsample_bynode=1, colsample_bytree=0.8,\n>              early_stopping_rounds=None, enable_categorical=False, eta=0.1,\n>              eval_metric='rmse', gamma=0, gpu_id=-1, grow_policy='depthwise',\n>              importance_type=None, interaction_constraints='',\n>              learning_rate=0.1, max_bin=256, max_cat_to_onehot=4,\n>              max_delta_step=0, max_depth=8, max_leaves=0, min_child_weight=1,\n>              missing=nan, monotone_constraints='()', n_estimators=100, n_jobs=0,\n>              num_parallel_tree=1, predictor='auto', random_state=0, reg_alpha=0, ...)\n> Prediction for 20210718 of start day 20210714 is finished\n> new columns to check:  [' FRP_1_days_ago', 'Nearest_1', 'Nearest_2', 'Nearest_3', 'Nearest_4', 'Nearest_5', 'Nearest_6', 'Nearest_7', 'Nearest_8']\n> current merged_df columns:  Index([' FWI', ' VPD', ' HT', ' T', ' RH', ' U', ' V', ' P', ' RAIN', ' CAPE',\n>        ' ST', ' SM', ' FRP_1_days_ago', ' FRP_2_days_ago', ' FRP_3_days_ago',\n>        ' FRP_4_days_ago', ' FRP_5_days_ago', ' FRP_6_days_ago',\n>        ' FRP_7_days_ago', 'Nearest_1', 'Nearest_2', 'Nearest_3', 'Nearest_4',\n>        'Nearest_5', 'Nearest_6', 'Nearest_7', 'Nearest_8', 'Nearest_9',\n>        'Nearest_10', 'Nearest_11', 'Nearest_12', 'Nearest_13', 'Nearest_14',\n>        'Nearest_15', 'Nearest_16', 'Nearest_17', 'Nearest_18', 'Nearest_19',\n>        'Nearest_20', 'Nearest_21', 'Nearest_22', 'Nearest_23', 'Nearest_24',\n>        'Predicted_FRP'],\n>       dtype='object')\n482a483,570\n> Prediction results are saved to /groups/ESS3/zsun/firecasting/data/output/output_xgboost_window_7_days_forecasting//20210714/firedata_20210718_predicted.txt\n> ['Mean Absolute Error (MAE): 1064.1203963045004', 'Mean Squared Error (MSE): 2855520.0982109807', 'Root Mean Squared Error (RMSE): 1689.8284227136733', 'R-squared (R2) Score: 0.0', 'Explained Variance Score: 0.0', 'Median Absolute Error (MedAE): 999.0', 'Max Error: 64953.19140625', 'Mean: -999.0', 'Median: -999.0', 'Standard Deviation: 0.0', 'Minimum: -999.0', 'Maximum: -999.0', 'Count: 156861']\n> Metrics saved to /groups/ESS3/zsun/firecasting/data/output/output_xgboost_window_7_days_forecasting//20210714/metrics_20210718_predicted.txt\n> predicting:  20210719\n> Read from original folder for current date: 20210719\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata/firedata_20210719.txt\n> reading past files for 2021-07-18 00:00:00\n> reading from predicted folder\n> current final_df head:       FWI    VPD   HT  ...  Nearest_23  Nearest_24  Predicted_FRP\n> 0 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> 1 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> 2 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> 3 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> 4 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> \n> [5 rows x 44 columns]\n> renaming Predicted_FRP to FRP\n> remove the current predicted_frp\n> reading past files for 2021-07-17 00:00:00\n> reading from predicted folder\n> current final_df head:       FWI    VPD   HT  ...  Nearest_23  Nearest_24  Predicted_FRP\n> 0 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> 1 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> 2 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> 3 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> 4 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> \n> [5 rows x 44 columns]\n> renaming Predicted_FRP to FRP\n> remove the current predicted_frp\n> reading past files for 2021-07-16 00:00:00\n> reading from predicted folder\n> current final_df head:       FWI    VPD   HT  ...  Nearest_23  Nearest_24  Predicted_FRP\n> 0 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> 1 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> 2 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> 3 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> 4 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> \n> [5 rows x 44 columns]\n> renaming Predicted_FRP to FRP\n> remove the current predicted_frp\n> reading past files for 2021-07-15 00:00:00\n> reading from predicted folder\n> current final_df head:       FWI    VPD   HT  ...  Nearest_23  Nearest_24  Predicted_FRP\n> 0 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> 1 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> 2 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> 3 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> 4 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> \n> [5 rows x 44 columns]\n> renaming Predicted_FRP to FRP\n> remove the current predicted_frp\n> reading past files for 2021-07-14 00:00:00\n> reading from predicted folder\n> current final_df head:       FWI    VPD   HT  ...  Nearest_23  Nearest_24  Predicted_FRP\n> 0 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> 1 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> 2 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> 3 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> 4 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> \n> [5 rows x 44 columns]\n> renaming Predicted_FRP to FRP\n> remove the current predicted_frp\n> reading past files for 2021-07-13 00:00:00\n> reading from original folder\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata/firedata_20210713.txt\n> reading past files for 2021-07-12 00:00:00\n> reading from original folder\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata/firedata_20210712.txt\n> original_df.describe                  LAT            LON  ...   FRP_6_days_ago   FRP_7_days_ago\n> count  156861.000000  156861.000000  ...    156861.000000    156861.000000\n> mean       37.500002     -95.999998  ...         0.240383         0.469768\n> std         7.534390      17.349407  ...        17.442142        52.007267\n> min        24.500000    -126.000000  ...         0.000000         0.000000\n> 25%        31.000000    -111.000000  ...         0.000000         0.000000\n> 50%        37.500000     -96.000000  ...         0.000000         0.000000\n> 75%        44.000000     -81.000000  ...         0.000000         0.000000\n> max        50.500000     -66.000000  ...      3668.386230     15687.671875\n> \n> [8 rows x 22 columns]\n> original_df columns:  Index(['LAT', ' LON', ' FRP', ' FWI', ' VPD', ' HT', ' T', ' RH', ' U', ' V',\n>        ' P', ' RAIN', ' CAPE', ' ST', ' SM', ' FRP_1_days_ago',\n>        ' FRP_2_days_ago', ' FRP_3_days_ago', ' FRP_4_days_ago',\n>        ' FRP_5_days_ago', ' FRP_6_days_ago', ' FRP_7_days_ago'],\n>       dtype='object')\n570a571,604\n> new_df.shape =  (156861, 24)\n> df.shape =  (156861, 22)\n> New time series dataframe:      LAT         LON    FRP  ...  Nearest_22  Nearest_23  Nearest_24\n> 0  24.5 -126.000000 -999.0  ...         0.0         0.0         0.0\n> 1  24.5 -125.899994 -999.0  ...         0.0         0.0         0.0\n> 2  24.5 -125.800003 -999.0  ...         0.0         0.0         0.0\n> 3  24.5 -125.699997 -999.0  ...         0.0         0.0         0.0\n> 4  24.5 -125.599998 -999.0  ...         0.0         0.0         0.0\n> \n> [5 rows x 46 columns]\n> Original df is created:  (156861, 46)\n> Original df filled the na with -9999 \n> X and y are loaded into memory for 20210719\n> the loaded model is:  XGBRegressor(base_score=0.5, booster='gbtree', callbacks=None,\n>              colsample_bylevel=1, colsample_bynode=1, colsample_bytree=0.8,\n>              early_stopping_rounds=None, enable_categorical=False, eta=0.1,\n>              eval_metric='rmse', gamma=0, gpu_id=-1, grow_policy='depthwise',\n>              importance_type=None, interaction_constraints='',\n>              learning_rate=0.1, max_bin=256, max_cat_to_onehot=4,\n>              max_delta_step=0, max_depth=8, max_leaves=0, min_child_weight=1,\n>              missing=nan, monotone_constraints='()', n_estimators=100, n_jobs=0,\n>              num_parallel_tree=1, predictor='auto', random_state=0, reg_alpha=0, ...)\n> Prediction for 20210719 of start day 20210714 is finished\n> new columns to check:  [' FRP_1_days_ago', 'Nearest_1', 'Nearest_2', 'Nearest_3', 'Nearest_4', 'Nearest_5', 'Nearest_6', 'Nearest_7', 'Nearest_8']\n> current merged_df columns:  Index([' FWI', ' VPD', ' HT', ' T', ' RH', ' U', ' V', ' P', ' RAIN', ' CAPE',\n>        ' ST', ' SM', ' FRP_1_days_ago', ' FRP_2_days_ago', ' FRP_3_days_ago',\n>        ' FRP_4_days_ago', ' FRP_5_days_ago', ' FRP_6_days_ago',\n>        ' FRP_7_days_ago', 'Nearest_1', 'Nearest_2', 'Nearest_3', 'Nearest_4',\n>        'Nearest_5', 'Nearest_6', 'Nearest_7', 'Nearest_8', 'Nearest_9',\n>        'Nearest_10', 'Nearest_11', 'Nearest_12', 'Nearest_13', 'Nearest_14',\n>        'Nearest_15', 'Nearest_16', 'Nearest_17', 'Nearest_18', 'Nearest_19',\n>        'Nearest_20', 'Nearest_21', 'Nearest_22', 'Nearest_23', 'Nearest_24',\n>        'Predicted_FRP'],\n>       dtype='object')\n604a605,701\n> Prediction results are saved to /groups/ESS3/zsun/firecasting/data/output/output_xgboost_window_7_days_forecasting//20210714/firedata_20210719_predicted.txt\n> ['Mean Absolute Error (MAE): 1086.4414279024884', 'Mean Squared Error (MSE): 3502934.3279240676', 'Root Mean Squared Error (RMSE): 1871.6127612099858', 'R-squared (R2) Score: 0.0', 'Explained Variance Score: 0.0', 'Median Absolute Error (MedAE): 999.0', 'Max Error: 57099.109375', 'Mean: -999.0', 'Median: -999.0', 'Standard Deviation: 0.0', 'Minimum: -999.0', 'Maximum: -999.0', 'Count: 156861']\n> Metrics saved to /groups/ESS3/zsun/firecasting/data/output/output_xgboost_window_7_days_forecasting//20210714/metrics_20210719_predicted.txt\n> predicting:  20210720\n> Read from original folder for current date: 20210720\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata/firedata_20210720.txt\n> reading past files for 2021-07-19 00:00:00\n> reading from predicted folder\n> current final_df head:       FWI    VPD   HT  ...  Nearest_23  Nearest_24  Predicted_FRP\n> 0 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> 1 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> 2 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> 3 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> 4 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> \n> [5 rows x 44 columns]\n> renaming Predicted_FRP to FRP\n> remove the current predicted_frp\n> reading past files for 2021-07-18 00:00:00\n> reading from predicted folder\n> current final_df head:       FWI    VPD   HT  ...  Nearest_23  Nearest_24  Predicted_FRP\n> 0 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> 1 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> 2 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> 3 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> 4 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> \n> [5 rows x 44 columns]\n> renaming Predicted_FRP to FRP\n> remove the current predicted_frp\n> reading past files for 2021-07-17 00:00:00\n> reading from predicted folder\n> current final_df head:       FWI    VPD   HT  ...  Nearest_23  Nearest_24  Predicted_FRP\n> 0 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> 1 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> 2 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> 3 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> 4 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> \n> [5 rows x 44 columns]\n> renaming Predicted_FRP to FRP\n> remove the current predicted_frp\n> reading past files for 2021-07-16 00:00:00\n> reading from predicted folder\n> current final_df head:       FWI    VPD   HT  ...  Nearest_23  Nearest_24  Predicted_FRP\n> 0 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> 1 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> 2 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> 3 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> 4 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> \n> [5 rows x 44 columns]\n> renaming Predicted_FRP to FRP\n> remove the current predicted_frp\n> reading past files for 2021-07-15 00:00:00\n> reading from predicted folder\n> current final_df head:       FWI    VPD   HT  ...  Nearest_23  Nearest_24  Predicted_FRP\n> 0 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> 1 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> 2 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> 3 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> 4 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> \n> [5 rows x 44 columns]\n> renaming Predicted_FRP to FRP\n> remove the current predicted_frp\n> reading past files for 2021-07-14 00:00:00\n> reading from predicted folder\n> current final_df head:       FWI    VPD   HT  ...  Nearest_23  Nearest_24  Predicted_FRP\n> 0 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> 1 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> 2 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> 3 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> 4 -999.0 -999.0  0.0  ...         0.0         0.0            0.0\n> \n> [5 rows x 44 columns]\n> renaming Predicted_FRP to FRP\n> remove the current predicted_frp\n> reading past files for 2021-07-13 00:00:00\n> reading from original folder\n> Reading /groups/ESS3/yli74/data/AI_Emis/firedata/firedata_20210713.txt\n> original_df.describe                  LAT            LON  ...   FRP_6_days_ago   FRP_7_days_ago\n> count  156861.000000  156861.000000  ...    156861.000000    156861.000000\n> mean       37.500002     -95.999998  ...         7.015920         0.240383\n> std         7.534390      17.349407  ...       337.766953        17.442142\n> min        24.500000    -126.000000  ...         0.000000         0.000000\n> 25%        31.000000    -111.000000  ...         0.000000         0.000000\n> 50%        37.500000     -96.000000  ...         0.000000         0.000000\n> 75%        44.000000     -81.000000  ...         0.000000         0.000000\n> max        50.500000     -66.000000  ...     40771.699219      3668.386230\n> \n> [8 rows x 22 columns]\n> original_df columns:  Index(['LAT', ' LON', ' FRP', ' FWI', ' VPD', ' HT', ' T', ' RH', ' U', ' V',\n>        ' P', ' RAIN', ' CAPE', ' ST', ' SM', ' FRP_1_days_ago',\n>        ' FRP_2_days_ago', ' FRP_3_days_ago', ' FRP_4_days_ago',\n>        ' FRP_5_days_ago', ' FRP_6_days_ago', ' FRP_7_days_ago'],\n>       dtype='object')\n701a702,738\n> new_df.shape =  (156861, 24)\n> df.shape =  (156861, 22)\n> New time series dataframe:      LAT         LON    FRP  ...  Nearest_22  Nearest_23  Nearest_24\n> 0  24.5 -126.000000 -999.0  ...         0.0         0.0         0.0\n> 1  24.5 -125.899994 -999.0  ...         0.0         0.0         0.0\n> 2  24.5 -125.800003 -999.0  ...         0.0         0.0         0.0\n> 3  24.5 -125.699997 -999.0  ...         0.0         0.0         0.0\n> 4  24.5 -125.599998 -999.0  ...         0.0         0.0         0.0\n> \n> [5 rows x 46 columns]\n> Original df is created:  (156861, 46)\n> Original df filled the na with -9999 \n> X and y are loaded into memory for 20210720\n> the loaded model is:  XGBRegressor(base_score=0.5, booster='gbtree', callbacks=None,\n>              colsample_bylevel=1, colsample_bynode=1, colsample_bytree=0.8,\n>              early_stopping_rounds=None, enable_categorical=False, eta=0.1,\n>              eval_metric='rmse', gamma=0, gpu_id=-1, grow_policy='depthwise',\n>              importance_type=None, interaction_constraints='',\n>              learning_rate=0.1, max_bin=256, max_cat_to_onehot=4,\n>              max_delta_step=0, max_depth=8, max_leaves=0, min_child_weight=1,\n>              missing=nan, monotone_constraints='()', n_estimators=100, n_jobs=0,\n>              num_parallel_tree=1, predictor='auto', random_state=0, reg_alpha=0, ...)\n> Prediction for 20210720 of start day 20210714 is finished\n> new columns to check:  [' FRP_1_days_ago', 'Nearest_1', 'Nearest_2', 'Nearest_3', 'Nearest_4', 'Nearest_5', 'Nearest_6', 'Nearest_7', 'Nearest_8']\n> current merged_df columns:  Index([' FWI', ' VPD', ' HT', ' T', ' RH', ' U', ' V', ' P', ' RAIN', ' CAPE',\n>        ' ST', ' SM', ' FRP_1_days_ago', ' FRP_2_days_ago', ' FRP_3_days_ago',\n>        ' FRP_4_days_ago', ' FRP_5_days_ago', ' FRP_6_days_ago',\n>        ' FRP_7_days_ago', 'Nearest_1', 'Nearest_2', 'Nearest_3', 'Nearest_4',\n>        'Nearest_5', 'Nearest_6', 'Nearest_7', 'Nearest_8', 'Nearest_9',\n>        'Nearest_10', 'Nearest_11', 'Nearest_12', 'Nearest_13', 'Nearest_14',\n>        'Nearest_15', 'Nearest_16', 'Nearest_17', 'Nearest_18', 'Nearest_19',\n>        'Nearest_20', 'Nearest_21', 'Nearest_22', 'Nearest_23', 'Nearest_24',\n>        'Predicted_FRP'],\n>       dtype='object')\n> Prediction results are saved to /groups/ESS3/zsun/firecasting/data/output/output_xgboost_window_7_days_forecasting//20210714/firedata_20210720_predicted.txt\n> ['Mean Absolute Error (MAE): 1115.6116133826852', 'Mean Squared Error (MSE): 4550616.762912058', 'Root Mean Squared Error (RMSE): 2133.2174673277123', 'R-squared (R2) Score: 0.0', 'Explained Variance Score: 0.0', 'Median Absolute Error (MedAE): 999.0', 'Max Error: 66408.69921875', 'Mean: -999.0', 'Median: -999.0', 'Standard Deviation: 0.0', 'Minimum: -999.0', 'Maximum: -999.0', 'Count: 156861']\n> Metrics saved to /groups/ESS3/zsun/firecasting/data/output/output_xgboost_window_7_days_forecasting//20210714/metrics_20210720_predicted.txt\nJob 1722098 has finished with state: JobState=COMPLETED\nSlurm job (1722098) has finished.\nPrint the job's output logs\nJobID           JobName      State ExitCode     MaxRSS               Start                 End \n------------ ---------- ---------- -------- ---------- ------------------- ------------------- \n1722098      fc_model_+  COMPLETED      0:0            2024-03-29T10:22:49 2024-03-29T10:47:59 \n1722098.bat+      batch  COMPLETED      0:0    629412K 2024-03-29T10:22:49 2024-03-29T10:47:59 \n1722098.ext+     extern  COMPLETED      0:0          0 2024-03-29T10:22:49 2024-03-29T10:47:59 \nAll slurm job for fc_model_predict_2weeks_slurm_generated.sh finishes.\n",
  "history_begin_time" : 1711722164395,
  "history_end_time" : 1711723682609,
  "history_notes" : "we removed the predicted fire for those rows having zero fire in 1day ago and all the neighbors",
  "history_process" : "55wou8",
  "host_id" : "100001",
  "indicator" : "Done"
},{
  "history_id" : "nra8jkqwmna",
  "history_input" : "No code saved",
  "history_output" : "Skipped",
  "history_begin_time" : 1711722163451,
  "history_end_time" : 1711723321978,
  "history_notes" : null,
  "history_process" : "uhet3k",
  "host_id" : "100001",
  "indicator" : "Stopped"
},{
  "history_id" : "7vu7q40dm1o",
  "history_input" : "No code saved",
  "history_output" : "Skipped",
  "history_begin_time" : 1711722163452,
  "history_end_time" : 1711723321978,
  "history_notes" : null,
  "history_process" : "b6x5kk",
  "host_id" : "100001",
  "indicator" : "Stopped"
},{
  "history_id" : "8e4hwqjnxx6",
  "history_input" : null,
  "history_output" : null,
  "history_begin_time" : null,
  "history_end_time" : 1711723321978,
  "history_notes" : null,
  "history_process" : "rg5g1a",
  "host_id" : "100001",
  "indicator" : "Stopped"
},{
  "history_id" : "eedtpnvazt7",
  "history_input" : null,
  "history_output" : null,
  "history_begin_time" : null,
  "history_end_time" : 1711723321980,
  "history_notes" : null,
  "history_process" : "k09hf7",
  "host_id" : "100001",
  "indicator" : "Stopped"
},{
  "history_id" : "k57y85pvhat",
  "history_input" : "No code saved",
  "history_output" : "Skipped",
  "history_begin_time" : 1711722163455,
  "history_end_time" : 1711723321982,
  "history_notes" : null,
  "history_process" : "r7g97f",
  "host_id" : "100001",
  "indicator" : "Stopped"
}]
